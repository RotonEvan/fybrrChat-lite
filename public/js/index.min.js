(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Ipfs = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Ipfs=(()=>{var B_e=Object.defineProperty;var li=(r,e)=>()=>(r&&(e=r(r=0)),e),p=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),oP=(r,e)=>{for(var t in e)B_e(r,t,{get:e[t],enumerable:!0})};var H3=p(Ob=>{l();"use strict";Ob.byteLength=N_e;Ob.toByteArray=D_e;Ob.fromByteArray=q_e;var ba=[],qs=[],M_e=typeof Uint8Array!="undefined"?Uint8Array:Array,z3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Sh=0,L_e=z3.length;Sh<L_e;++Sh)ba[Sh]=z3[Sh],qs[z3.charCodeAt(Sh)]=Sh;qs["-".charCodeAt(0)]=62;qs["_".charCodeAt(0)]=63;function aP(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function N_e(r){var e=aP(r),t=e[0],i=e[1];return(t+i)*3/4-i}function F_e(r,e,t){return(e+t)*3/4-t}function D_e(r){var e,t=aP(r),i=t[0],n=t[1],s=new M_e(F_e(r,i,n)),o=0,a=n>0?i-4:i,c;for(c=0;c<a;c+=4)e=qs[r.charCodeAt(c)]<<18|qs[r.charCodeAt(c+1)]<<12|qs[r.charCodeAt(c+2)]<<6|qs[r.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=qs[r.charCodeAt(c)]<<2|qs[r.charCodeAt(c+1)]>>4,s[o++]=e&255),n===1&&(e=qs[r.charCodeAt(c)]<<10|qs[r.charCodeAt(c+1)]<<4|qs[r.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function U_e(r){return ba[r>>18&63]+ba[r>>12&63]+ba[r>>6&63]+ba[r&63]}function K_e(r,e,t){for(var i,n=[],s=e;s<t;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),n.push(U_e(i));return n.join("")}function q_e(r){for(var e,t=r.length,i=t%3,n=[],s=16383,o=0,a=t-i;o<a;o+=s)n.push(K_e(r,o,o+s>a?a:o+s));return i===1?(e=r[t-1],n.push(ba[e>>2]+ba[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push(ba[e>>10]+ba[e>>4&63]+ba[e<<2&63]+"=")),n.join("")}});var $0=p(G3=>{l();G3.read=function(r,e,t,i,n){var s,o,a=n*8-i-1,c=(1<<a)-1,u=c>>1,f=-7,h=t?n-1:0,d=t?-1:1,y=r[e+h];for(h+=d,s=y&(1<<-f)-1,y>>=-f,f+=a;f>0;s=s*256+r[e+h],h+=d,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=i;f>0;o=o*256+r[e+h],h+=d,f-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(y?-1:1)*Infinity;o=o+Math.pow(2,i),s=s-u}return(y?-1:1)*o*Math.pow(2,s-i)};G3.write=function(r,e,t,i,n,s){var o,a,c,u=s*8-n-1,f=(1<<u)-1,h=f>>1,d=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=i?0:s-1,g=i?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===Infinity?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+h>=1?e+=d/c:e+=d*Math.pow(2,1-h),e*c>=2&&(o++,c/=2),o+h>=f?(a=0,o=f):o+h>=1?(a=(e*c-1)*Math.pow(2,n),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;r[t+y]=a&255,y+=g,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;r[t+y]=o&255,y+=g,o/=256,u-=8);r[t+y-g]|=m*128}});var xt=p(xh=>{l();"use strict";var $3=H3(),Ah=$0(),cP=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;xh.Buffer=pe;xh.SlowBuffer=j_e;xh.INSPECT_MAX_BYTES=50;var Bb=2147483647;xh.kMaxLength=Bb;pe.TYPED_ARRAY_SUPPORT=V_e();!pe.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function V_e(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch(r){return!1}}Object.defineProperty(pe.prototype,"parent",{enumerable:!0,get:function(){if(!!pe.isBuffer(this))return this.buffer}});Object.defineProperty(pe.prototype,"offset",{enumerable:!0,get:function(){if(!!pe.isBuffer(this))return this.byteOffset}});function Ic(r){if(r>Bb)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,pe.prototype),e}function pe(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return W3(r)}return uP(r,e,t)}pe.poolSize=8192;function uP(r,e,t){if(typeof r=="string")return z_e(r,e);if(ArrayBuffer.isView(r))return H_e(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(ma(r,ArrayBuffer)||r&&ma(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(ma(r,SharedArrayBuffer)||r&&ma(r.buffer,SharedArrayBuffer)))return Y3(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return pe.from(i,e,t);let n=G_e(r);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return pe.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}pe.from=function(r,e,t){return uP(r,e,t)};Object.setPrototypeOf(pe.prototype,Uint8Array.prototype);Object.setPrototypeOf(pe,Uint8Array);function fP(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function $_e(r,e,t){return fP(r),r<=0?Ic(r):e!==void 0?typeof t=="string"?Ic(r).fill(e,t):Ic(r).fill(e):Ic(r)}pe.alloc=function(r,e,t){return $_e(r,e,t)};function W3(r){return fP(r),Ic(r<0?0:X3(r)|0)}pe.allocUnsafe=function(r){return W3(r)};pe.allocUnsafeSlow=function(r){return W3(r)};function z_e(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!pe.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=lP(r,e)|0,i=Ic(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function J3(r){let e=r.length<0?0:X3(r.length)|0,t=Ic(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function H_e(r){if(ma(r,Uint8Array)){let e=new Uint8Array(r);return Y3(e.buffer,e.byteOffset,e.byteLength)}return J3(r)}function Y3(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,pe.prototype),i}function G_e(r){if(pe.isBuffer(r)){let e=X3(r.length)|0,t=Ic(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||Q3(r.length)?Ic(0):J3(r);if(r.type==="Buffer"&&Array.isArray(r.data))return J3(r.data)}function X3(r){if(r>=Bb)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Bb.toString(16)+" bytes");return r|0}function j_e(r){return+r!=r&&(r=0),pe.alloc(+r)}pe.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==pe.prototype};pe.compare=function(e,t){if(ma(e,Uint8Array)&&(e=pe.from(e,e.offset,e.byteLength)),ma(t,Uint8Array)&&(t=pe.from(t,t.offset,t.byteLength)),!pe.isBuffer(e)||!pe.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0};pe.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};pe.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return pe.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=pe.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){let o=e[i];if(ma(o,Uint8Array))s+o.length>n.length?(pe.isBuffer(o)||(o=pe.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(pe.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function lP(r,e){if(pe.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||ma(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Z3(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return hP(r).length;default:if(n)return i?-1:Z3(r).length;e=(""+e).toLowerCase(),n=!0}}pe.byteLength=lP;function Z_e(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return J_e(this,e,t);case"utf8":case"utf-8":return dP(this,e,t);case"ascii":return Y_e(this,e,t);case"latin1":case"binary":return X_e(this,e,t);case"base64":return W_e(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q_e(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}pe.prototype._isBuffer=!0;function Lf(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}pe.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)Lf(this,t,t+1);return this};pe.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)Lf(this,t,t+3),Lf(this,t+1,t+2);return this};pe.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)Lf(this,t,t+7),Lf(this,t+1,t+6),Lf(this,t+2,t+5),Lf(this,t+3,t+4);return this};pe.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?dP(this,0,e):Z_e.apply(this,arguments)};pe.prototype.toLocaleString=pe.prototype.toString;pe.prototype.equals=function(e){if(!pe.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:pe.compare(this,e)===0};pe.prototype.inspect=function(){let e="",t=xh.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};cP&&(pe.prototype[cP]=pe.prototype.inspect);pe.prototype.compare=function(e,t,i,n,s){if(ma(e,Uint8Array)&&(e=pe.from(e,e.offset,e.byteLength)),!pe.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-t,c=Math.min(o,a),u=this.slice(n,s),f=e.slice(t,i);for(let h=0;h<c;++h)if(u[h]!==f[h]){o=u[h],a=f[h];break}return o<a?-1:a<o?1:0};function yP(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Q3(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=pe.from(e,i)),pe.isBuffer(e))return e.length===0?-1:pP(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):pP(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function pP(r,e,t,i,n){let s=1,o=r.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,o/=2,a/=2,t/=2}function c(f,h){return s===1?f[h]:f.readUInt16BE(h*s)}let u;if(n){let f=-1;for(u=t;u<o;u++)if(c(r,u)===c(e,f===-1?0:u-f)){if(f===-1&&(f=u),u-f+1===a)return f*s}else f!==-1&&(u-=u-f),f=-1}else for(t+a>o&&(t=o-a),u=t;u>=0;u--){let f=!0;for(let h=0;h<a;h++)if(c(r,u+h)!==c(e,h)){f=!1;break}if(f)return u}return-1}pe.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};pe.prototype.indexOf=function(e,t,i){return yP(this,e,t,i,!0)};pe.prototype.lastIndexOf=function(e,t,i){return yP(this,e,t,i,!1)};function eEe(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(Q3(a))return o;r[t+o]=a}return o}function tEe(r,e,t,i){return Nb(Z3(e,r.length-t),r,t,i)}function iEe(r,e,t,i){return Nb(rEe(e),r,t,i)}function nEe(r,e,t,i){return Nb(hP(e),r,t,i)}function oEe(r,e,t,i){return Nb(sEe(e,r.length-t),r,t,i)}pe.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return eEe(this,e,t,i);case"utf8":case"utf-8":return tEe(this,e,t,i);case"ascii":case"latin1":case"binary":return iEe(this,e,t,i);case"base64":return nEe(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oEe(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};pe.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W_e(r,e,t){return e===0&&t===r.length?$3.fromByteArray(r):$3.fromByteArray(r.slice(e,t))}function dP(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let s=r[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=t){let c,u,f,h;switch(a){case 1:s<128&&(o=s);break;case 2:c=r[n+1],(c&192)==128&&(h=(s&31)<<6|c&63,h>127&&(o=h));break;case 3:c=r[n+1],u=r[n+2],(c&192)==128&&(u&192)==128&&(h=(s&15)<<12|(c&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:c=r[n+1],u=r[n+2],f=r[n+3],(c&192)==128&&(u&192)==128&&(f&192)==128&&(h=(s&15)<<18|(c&63)<<12|(u&63)<<6|f&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return aEe(i)}var gP=4096;function aEe(r){let e=r.length;if(e<=gP)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=gP));return t}function Y_e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function X_e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function J_e(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let s=e;s<t;++s)n+=cEe[r[s]];return n}function Q_e(r,e,t){let i=r.slice(e,t),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}pe.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,pe.prototype),n};function Ni(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}pe.prototype.readUintLE=pe.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ni(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return n};pe.prototype.readUintBE=pe.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ni(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n};pe.prototype.readUint8=pe.prototype.readUInt8=function(e,t){return e=e>>>0,t||Ni(e,1,this.length),this[e]};pe.prototype.readUint16LE=pe.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||Ni(e,2,this.length),this[e]|this[e+1]<<8};pe.prototype.readUint16BE=pe.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||Ni(e,2,this.length),this[e]<<8|this[e+1]};pe.prototype.readUint32LE=pe.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||Ni(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};pe.prototype.readUint32BE=pe.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||Ni(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};pe.prototype.readBigUInt64LE=Su(function(e){e=e>>>0,Ih(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&W0(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});pe.prototype.readBigUInt64BE=Su(function(e){e=e>>>0,Ih(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&W0(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});pe.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ni(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n};pe.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ni(e,t,this.length);let n=t,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};pe.prototype.readInt8=function(e,t){return e=e>>>0,t||Ni(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};pe.prototype.readInt16LE=function(e,t){e=e>>>0,t||Ni(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};pe.prototype.readInt16BE=function(e,t){e=e>>>0,t||Ni(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};pe.prototype.readInt32LE=function(e,t){return e=e>>>0,t||Ni(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};pe.prototype.readInt32BE=function(e,t){return e=e>>>0,t||Ni(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};pe.prototype.readBigInt64LE=Su(function(e){e=e>>>0,Ih(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&W0(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});pe.prototype.readBigInt64BE=Su(function(e){e=e>>>0,Ih(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&W0(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});pe.prototype.readFloatLE=function(e,t){return e=e>>>0,t||Ni(e,4,this.length),Ah.read(this,e,!0,23,4)};pe.prototype.readFloatBE=function(e,t){return e=e>>>0,t||Ni(e,4,this.length),Ah.read(this,e,!1,23,4)};pe.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||Ni(e,8,this.length),Ah.read(this,e,!0,52,8)};pe.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||Ni(e,8,this.length),Ah.read(this,e,!1,52,8)};function Hn(r,e,t,i,n,s){if(!pe.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}pe.prototype.writeUintLE=pe.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Hn(this,e,t,i,a,0)}let s=1,o=0;for(this[t]=e&255;++o<i&&(s*=256);)this[t+o]=e/s&255;return t+i};pe.prototype.writeUintBE=pe.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Hn(this,e,t,i,a,0)}let s=i-1,o=1;for(this[t+s]=e&255;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+i};pe.prototype.writeUint8=pe.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,1,255,0),this[t]=e&255,t+1};pe.prototype.writeUint16LE=pe.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};pe.prototype.writeUint16BE=pe.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};pe.prototype.writeUint32LE=pe.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};pe.prototype.writeUint32BE=pe.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function mP(r,e,t,i,n){bP(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,t}function vP(r,e,t,i,n){bP(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=o,o=o>>8,r[t+2]=o,o=o>>8,r[t+1]=o,o=o>>8,r[t]=o,t+8}pe.prototype.writeBigUInt64LE=Su(function(e,t=0){return mP(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});pe.prototype.writeBigUInt64BE=Su(function(e,t=0){return vP(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});pe.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);Hn(this,e,t,i,c-1,-c)}let s=0,o=1,a=0;for(this[t]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[t+s-1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};pe.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);Hn(this,e,t,i,c-1,-c)}let s=i-1,o=1,a=0;for(this[t+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[t+s+1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};pe.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};pe.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};pe.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};pe.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};pe.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};pe.prototype.writeBigInt64LE=Su(function(e,t=0){return mP(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});pe.prototype.writeBigInt64BE=Su(function(e,t=0){return vP(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function wP(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function _P(r,e,t,i,n){return e=+e,t=t>>>0,n||wP(r,e,t,4,34028234663852886e22,-34028234663852886e22),Ah.write(r,e,t,i,23,4),t+4}pe.prototype.writeFloatLE=function(e,t,i){return _P(this,e,t,!0,i)};pe.prototype.writeFloatBE=function(e,t,i){return _P(this,e,t,!1,i)};function EP(r,e,t,i,n){return e=+e,t=t>>>0,n||wP(r,e,t,8,17976931348623157e292,-17976931348623157e292),Ah.write(r,e,t,i,52,8),t+8}pe.prototype.writeDoubleLE=function(e,t,i){return EP(this,e,t,!0,i)};pe.prototype.writeDoubleBE=function(e,t,i){return EP(this,e,t,!1,i)};pe.prototype.copy=function(e,t,i,n){if(!pe.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s};pe.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!pe.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<i;++s)this[s]=e;else{let o=pe.isBuffer(e)?e:pe.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%a]}return this};var Th={};function eS(r,e,t){Th[r]=class extends t{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}eS("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);eS("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);eS("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=SP(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=SP(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function SP(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function uEe(r,e,t){Ih(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&W0(e,r.length-(t+1))}function bP(r,e,t,i,n,s){if(r>t||r<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${t}${o}`,new Th.ERR_OUT_OF_RANGE("value",a,r)}uEe(i,n,s)}function Ih(r,e){if(typeof r!="number")throw new Th.ERR_INVALID_ARG_TYPE(e,"number",r)}function W0(r,e,t){throw Math.floor(r)!==r?(Ih(r,t),new Th.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new Th.ERR_BUFFER_OUT_OF_BOUNDS:new Th.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var fEe=/[^+/0-9A-Za-z-_]/g;function lEe(r){if(r=r.split("=")[0],r=r.trim().replace(fEe,""),r.length<2)return"";for(;r.length%4!=0;)r=r+"=";return r}function Z3(r,e){e=e||Infinity;let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function rEe(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function sEe(r,e){let t,i,n,s=[];for(let o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function hP(r){return $3.toByteArray(lEe(r))}function Nb(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function ma(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function Q3(r){return r!==r}var cEe=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function Su(r){return typeof BigInt=="undefined"?hEe:r}function hEe(){throw new Error("BigInt not supported")}});var RP=p((r0t,xP)=>{l();var ii=xP.exports={},va,wa;function tS(){throw new Error("setTimeout has not been defined")}function rS(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?va=setTimeout:va=tS}catch(r){va=tS}try{typeof clearTimeout=="function"?wa=clearTimeout:wa=rS}catch(r){wa=rS}})();function AP(r){if(va===setTimeout)return setTimeout(r,0);if((va===tS||!va)&&setTimeout)return va=setTimeout,setTimeout(r,0);try{return va(r,0)}catch(e){try{return va.call(null,r,0)}catch(t){return va.call(this,r,0)}}}function dEe(r){if(wa===clearTimeout)return clearTimeout(r);if((wa===rS||!wa)&&clearTimeout)return wa=clearTimeout,clearTimeout(r);try{return wa(r)}catch(e){try{return wa.call(null,r)}catch(t){return wa.call(this,r)}}}var Tc=[],Rh=!1,Ff,Db=-1;function pEe(){!Rh||!Ff||(Rh=!1,Ff.length?Tc=Ff.concat(Tc):Db=-1,Tc.length&&IP())}function IP(){if(!Rh){var r=AP(pEe);Rh=!0;for(var e=Tc.length;e;){for(Ff=Tc,Tc=[];++Db<e;)Ff&&Ff[Db].run();Db=-1,e=Tc.length}Ff=null,Rh=!1,dEe(r)}}ii.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Tc.push(new TP(r,e)),Tc.length===1&&!Rh&&AP(IP)};function TP(r,e){this.fun=r,this.array=e}TP.prototype.run=function(){this.fun.apply(null,this.array)};ii.title="browser";ii.browser=!0;ii.env={};ii.argv=[];ii.version="";ii.versions={};function Rc(){}ii.on=Rc;ii.addListener=Rc;ii.once=Rc;ii.off=Rc;ii.removeListener=Rc;ii.removeAllListeners=Rc;ii.emit=Rc;ii.prependListener=Rc;ii.prependOnceListener=Rc;ii.listeners=function(r){return[]};ii.binding=function(r){throw new Error("process.binding is not supported")};ii.cwd=function(){return"/"};ii.chdir=function(r){throw new Error("process.chdir is not supported")};ii.umask=function(){return 0}});var Buffer,process,l=li(()=>{({Buffer}=xt()),process=RP()});var kP=p(()=>{l()});var iS=p(qb=>{l();"use strict";var CP=class extends Error{constructor(e="Request timed out"){super(e);this.name="TimeoutError"}};qb.TimeoutError=CP;var PP=class extends Error{constructor(e="The operation was aborted."){super(e);this.name="AbortError"}};qb.AbortError=PP;var OP=class extends Error{constructor(e){super(e.statusText);this.name="HTTPError",this.response=e}};qb.HTTPError=OP});var nS=p((a0t,BP)=>{l();function yEe(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}BP.exports=yEe});var Lb=p((c0t,NP)=>{l();"use strict";var gEe=nS(),Mb=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Y0=gEe(),bEe=Mb&&!Y0,mEe=Y0&&!Mb,vEe=Y0&&Mb,wEe=typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!Y0,_Ee=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,EEe=typeof process!="undefined"&&typeof process.env!="undefined"&&process.env.NODE_ENV==="test",SEe=typeof navigator!="undefined"&&navigator.product==="ReactNative";NP.exports={isTest:EEe,isElectron:Y0,isElectronMain:mEe,isElectronRenderer:vEe,isNode:wEe,isBrowser:bEe,isWebWorker:_Ee,isEnvWithDom:Mb,isReactNative:SEe}});var DP=p(()=>{l()});var X0=p((kh,qP)=>{l();"use strict";var xEe=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof kc!="undefined")return kc;throw new Error("unable to locate global object")},kc=xEe();qP.exports=kh=kc.fetch;kc.fetch&&(kh.default=kc.fetch.bind(kc));kh.Headers=kc.Headers;kh.Request=kc.Request;kh.Response=kc.Response});var oS=p((l0t,sS)=>{l();"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?sS.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:sS.exports={default:X0().default,Headers:X0().Headers,Request:X0().Request,Response:X0().Response}});var MP=p((h0t,aS)=>{l();"use strict";var{isElectronMain:AEe}=Lb();AEe?aS.exports=DP():aS.exports=oS()});var KP=p((d0t,LP)=>{l();"use strict";var{TimeoutError:IEe,AbortError:TEe}=iS(),{Response:FP,Request:REe,Headers:cS,default:kEe}=MP(),PEe=(r,e={})=>{let t=new XMLHttpRequest;t.open(e.method||"GET",r.toString(),!0);let{timeout:i,headers:n}=e;if(i&&i>0&&i<Infinity&&(t.timeout=i),e.overrideMimeType!=null&&t.overrideMimeType(e.overrideMimeType),n)for(let[s,o]of new cS(n))t.setRequestHeader(s,o);return e.signal&&(e.signal.onabort=()=>t.abort()),e.onUploadProgress&&(t.upload.onprogress=e.onUploadProgress),t.responseType="arraybuffer",new Promise((s,o)=>{let a=c=>{switch(c.type){case"error":{s(FP.error());break}case"load":{s(new UP(t.responseURL,t.response,{status:t.status,statusText:t.statusText,headers:CEe(t.getAllResponseHeaders())}));break}case"timeout":{o(new IEe);break}case"abort":{o(new TEe);break}default:break}};t.onerror=a,t.onload=a,t.ontimeout=a,t.onabort=a,t.send(e.body)})},OEe=kEe,BEe=(r,e={})=>e.onUploadProgress!=null?PEe(r,e):OEe(r,e),CEe=r=>{let e=new cS;for(let t of r.trim().split(/[\r\n]+/)){let i=t.indexOf(": ");i>0&&e.set(t.slice(0,i),t.slice(i+1))}return e},UP=class extends FP{constructor(e,t,i){super(t,i);Object.defineProperty(this,"url",{value:e})}};LP.exports={fetch:BEe,Request:REe,Headers:cS}});var VP=p((p0t,jP)=>{l();"use strict";jP.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var Gr=p((zP,HP)=>{l();"use strict";var Fb=VP(),{hasOwnProperty:GP}=Object.prototype,{propertyIsEnumerable:NEe}=Object,Ch=(r,e,t)=>Object.defineProperty(r,e,{value:t,writable:!0,enumerable:!0,configurable:!0}),DEe=zP,$P={concatArrays:!1,ignoreUndefined:!1},Ub=r=>{let e=[];for(let t in r)GP.call(r,t)&&e.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(r);for(let i of t)NEe.call(r,i)&&e.push(i)}return e};function Ph(r){return Array.isArray(r)?qEe(r):Fb(r)?MEe(r):r}function qEe(r){let e=r.slice(0,0);return Ub(r).forEach(t=>{Ch(e,t,Ph(r[t]))}),e}function MEe(r){let e=Object.getPrototypeOf(r)===null?Object.create(null):{};return Ub(r).forEach(t=>{Ch(e,t,Ph(r[t]))}),e}var WP=(r,e,t,i)=>(t.forEach(n=>{typeof e[n]=="undefined"&&i.ignoreUndefined||(n in r&&r[n]!==Object.getPrototypeOf(r)?Ch(r,n,uS(r[n],e[n],i)):Ch(r,n,Ph(e[n])))}),r),LEe=(r,e,t)=>{let i=r.slice(0,0),n=0;return[r,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!GP.call(s,a)||(o.push(String(a)),s===r?Ch(i,n++,s[a]):Ch(i,n++,Ph(s[a])));i=WP(i,s,Ub(s).filter(a=>!o.includes(a)),t)}),i};function uS(r,e,t){return t.concatArrays&&Array.isArray(r)&&Array.isArray(e)?LEe(r,e,t):!Fb(e)||!Fb(r)?Ph(e):WP(r,e,Ub(e),t)}HP.exports=function(...r){let e=uS(Ph($P),this!==DEe&&this||{},$P),t={_:{}};for(let i of r)if(i!==void 0){if(!Fb(i))throw new TypeError("`"+i+"` is not an Option Object");t=uS(t,{_:i},e)}return t._}});var fS=p((y0t,YP)=>{l();"use strict";var FEe=typeof navigator!="undefined"&&navigator.product==="ReactNative";function UEe(){return FEe?"http://localhost":self.location.protocol+"//"+self.location.host}var J0=self.URL,XP=UEe(),JP=class{constructor(e="",t=XP){this.super=new J0(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return J0.createObjectURL(e)}static revokeObjectURL(e){J0.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function KEe(r){if(typeof r=="string")return new J0(r).toString();if(!(r instanceof J0)){let e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",i=r.port?":"+r.port:"",n=r.protocol?r.protocol+"//":"",s=r.host||"",o=r.hostname||"",a=r.search||(r.query?"?"+r.query:""),c=r.hash||"",u=r.pathname||"",f=r.path||u+a;return`${n}${e||t}${s||o+i}${f}${c}`}}YP.exports={URLWithLegacySupport:JP,URLSearchParams:self.URLSearchParams,defaultBase:XP,format:KEe}});var eO=p((g0t,QP)=>{l();"use strict";var{URLWithLegacySupport:ZP,format:jEe}=fS();QP.exports=(r,e={},t={},i)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(t[n]||i||n)+":";let s;try{s=new ZP(r)}catch(a){s={}}let o=Object.assign({},e,{protocol:n||s.protocol,host:e.host||s.host});return new ZP(r,jEe(o)).toString()}});var Oh=p((b0t,tO)=>{l();"use strict";var{URLWithLegacySupport:VEe,format:zEe,URLSearchParams:HEe,defaultBase:GEe}=fS(),$Ee=eO();tO.exports={URL:VEe,URLSearchParams:HEe,format:zEe,relative:$Ee,defaultBase:GEe}});var Uf=p((m0t,Kb)=>{l();"use strict";var{AbortController:rO,AbortSignal:WEe}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;Kb.exports=rO;Kb.exports.AbortSignal=WEe;Kb.exports.default=rO});var Q0=p((v0t,iO)=>{l();"use strict";var jb;globalThis.AbortController&&globalThis.AbortSignal?jb=globalThis:jb=Uf();iO.exports={AbortController:jb.AbortController,AbortSignal:jb.AbortSignal}});var Bh=p((w0t,lS)=>{l();var{AbortController:YEe}=Q0();function nO(r){let e=new YEe;function t(){e.abort();for(let i of r)!i||!i.removeEventListener||i.removeEventListener("abort",t)}for(let i of r)if(!(!i||!i.addEventListener)){if(i.aborted){t();break}i.addEventListener("abort",t)}return e.signal}lS.exports=nO;lS.exports.anySignal=nO});var Vb=p((_0t,sO)=>{l();"use strict";var{fetch:XEe,Request:JEe,Headers:QEe}=KP(),{TimeoutError:hS,HTTPError:oO}=iS(),aO=Gr().bind({ignoreUndefined:!0}),{URL:cO,URLSearchParams:uO}=Oh(),{AbortController:ZEe}=Q0(),e3e=Bh(),t3e=(r,e,t)=>{if(e===void 0)return r;let i=Date.now(),n=()=>Date.now()-i>=e;return new Promise((s,o)=>{let a=setTimeout(()=>{n()&&(o(new hS),t.abort())},e),c=u=>h=>{if(clearTimeout(a),n()){o(new hS);return}u(h)};r.then(c(s),c(o))})},r3e={throwHttpErrors:!0,credentials:"same-origin"},In=class{constructor(e={}){this.opts=aO(r3e,e)}async fetch(e,t={}){let i=aO(this.opts,t),n=new QEe(i.headers);if(typeof e!="string"&&!(e instanceof cO||e instanceof JEe))throw new TypeError("`resource` must be a string, URL, or Request");let s=new cO(e.toString(),i.base),{searchParams:o,transformSearchParams:a,json:c}=i;o&&(typeof a=="function"?s.search=a(new uO(i.searchParams)):s.search=new uO(i.searchParams)),c&&(i.body=JSON.stringify(i.json),n.set("content-type","application/json"));let u=new ZEe,f=e3e([u.signal,i.signal]),h=await t3e(XEe(s.toString(),{...i,signal:f,timeout:void 0,headers:n}),i.timeout,u);if(!h.ok&&i.throwHttpErrors)throw i.handleError&&await i.handleError(h),new oO(h);return h.iterator=function(){return fO(h.body)},h.ndjson=async function*(){for await(let d of i3e(h.iterator()))t.transform?yield t.transform(d):yield d},h}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}},i3e=async function*(r){let e=new TextDecoder,t="";for await(let i of r){t+=e.decode(i,{stream:!0});let n=t.split(/\r?\n/);for(let s=0;s<n.length-1;s++){let o=n[s].trim();o.length>0&&(yield JSON.parse(o))}t=n[n.length-1]}t+=e.decode(),t=t.trim(),t.length!==0&&(yield JSON.parse(t))},fO=r=>{if(o3e(r)){let e=r[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(t){return r.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:t})}}}}}if(s3e(r)){let e=r.getReader();return async function*(){try{for(;;){let{done:t,value:i}=await e.read();if(t)return;i&&(yield i)}}finally{e.releaseLock()}}()}if(n3e(r))return r;throw new TypeError("Body can't be converted to AsyncIterable")},n3e=r=>typeof r=="object"&&r!==null&&typeof r[Symbol.asyncIterator]=="function",s3e=r=>r&&typeof r.getReader=="function",o3e=r=>Object.prototype.hasOwnProperty.call(r,"readable")&&Object.prototype.hasOwnProperty.call(r,"writable");In.HTTPError=oO;In.TimeoutError=hS;In.streamToAsyncIterator=fO;In.post=(r,e)=>new In(e).post(r,e);In.get=(r,e)=>new In(e).get(r,e);In.put=(r,e)=>new In(e).put(r,e);In.delete=(r,e)=>new In(e).delete(r,e);In.options=(r,e)=>new In(e).options(r,e);sO.exports=In});var hO=p((E0t,lO)=>{l();"use strict";var a3e=Vb(),u3e=(r,e)=>({path:decodeURIComponent(new URL(r).pathname.split("/").pop()||""),content:c3e(r,e)});async function*c3e(r,e){yield*(await new a3e().get(r,e)).iterator()}lO.exports=u3e});var pO=p((S0t,dO)=>{l();"use strict";function f3e(r){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),t=0;t<e.length;t++)e[t]=255;for(var i=0;i<r.length;i++){var n=r.charAt(i),s=n.charCodeAt(0);if(e[s]!==255)throw new TypeError(n+" is ambiguous");e[s]=i}var o=r.length,a=r.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function f(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,m=0,x=0,_=y.length;x!==_&&y[x]===0;)x++,g++;for(var P=(_-x)*u+1>>>0,q=new Uint8Array(P);x!==_;){for(var X=y[x],W=0,z=P-1;(X!==0||W<m)&&z!==-1;z--,W++)X+=256*q[z]>>>0,q[z]=X%o>>>0,X=X/o>>>0;if(X!==0)throw new Error("Non-zero carry");m=W,x++}for(var Z=P-m;Z!==P&&q[Z]===0;)Z++;for(var ee=a.repeat(g);Z<P;++Z)ee+=r.charAt(q[Z]);return ee}function h(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var m=0,x=0;y[g]===a;)m++,g++;for(var _=(y.length-g)*c+1>>>0,P=new Uint8Array(_);y[g];){var q=e[y.charCodeAt(g)];if(q===255)return;for(var X=0,W=_-1;(q!==0||X<x)&&W!==-1;W--,X++)q+=o*P[W]>>>0,P[W]=q%256>>>0,q=q/256>>>0;if(q!==0)throw new Error("Non-zero carry");x=X,g++}if(y[g]!==" "){for(var z=_-x;z!==_&&P[z]===0;)z++;for(var Z=new Uint8Array(m+(_-z)),ee=m;z!==_;)Z[ee++]=P[z++];return Z}}}function d(y){var g=h(y);if(g)return g;throw new Error("Non-base"+o+" character")}return{encode:f,decodeUnsafe:h,decode:d}}dO.exports=f3e});var zb=p((x0t,yO)=>{l();"use strict";var l3e=new TextDecoder,h3e=r=>l3e.decode(r),d3e=new TextEncoder,p3e=r=>d3e.encode(r);function y3e(r,e){let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}yO.exports={decodeText:h3e,encodeText:p3e,concat:y3e}});var mO=p((A0t,gO)=>{l();"use strict";var{encodeText:g3e}=zb(),bO=class{constructor(e,t,i,n){this.name=e,this.code=t,this.codeBuf=g3e(this.code),this.alphabet=n,this.codec=i(n)}encode(e){return this.codec.encode(e)}decode(e){for(let t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.codec.decode(e)}};gO.exports=bO});var wO=p((I0t,vO)=>{l();"use strict";var b3e=(r,e,t)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let n=r.length;for(;r[n-1]==="=";)--n;let s=new Uint8Array(n*t/8|0),o=0,a=0,c=0;for(let u=0;u<n;++u){let f=i[r[u]];if(f===void 0)throw new SyntaxError("Invalid character "+r[u]);a=a<<t|f,o+=t,o>=8&&(o-=8,s[c++]=255&a>>o)}if(o>=t||255&a<<8-o)throw new SyntaxError("Unexpected end of data");return s},m3e=(r,e,t)=>{let i=e[e.length-1]==="=",n=(1<<t)-1,s="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,s+=e[n&a>>o];if(o&&(s+=e[n&a<<t-o]),i)for(;s.length*t&7;)s+="=";return s},v3e=r=>e=>({encode(t){return m3e(t,e,r)},decode(t){return b3e(t,e,r)}});vO.exports={rfc4648:v3e}});var xO=p((T0t,_O)=>{l();"use strict";var Z0=pO(),w3e=mO(),{rfc4648:Zi}=wO(),{decodeText:_3e,encodeText:E3e}=zb(),S3e=()=>({encode:_3e,decode:E3e}),EO=[["identity","\0",S3e,""],["base2","0",Zi(1),"01"],["base8","7",Zi(3),"01234567"],["base10","9",Z0,"0123456789"],["base16","f",Zi(4),"0123456789abcdef"],["base16upper","F",Zi(4),"0123456789ABCDEF"],["base32hex","v",Zi(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",Zi(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",Zi(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",Zi(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",Zi(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",Zi(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",Zi(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",Zi(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",Zi(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",Z0,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",Z0,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",Z0,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",Z0,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",Zi(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",Zi(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",Zi(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",Zi(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],SO=EO.reduce((r,e)=>(r[e[0]]=new w3e(e[0],e[1],e[2],e[3]),r),{}),x3e=EO.reduce((r,e)=>(r[e[1]]=SO[e[0]],r),{});_O.exports={names:SO,codes:x3e}});var en=p((Cc,AO)=>{l();"use strict";var Nh=xO(),{encodeText:A3e,decodeText:Hb,concat:IO}=zb();function T3e(r,e){if(!e)throw new Error("requires an encoded Uint8Array");let{name:t,codeBuf:i}=Kf(r);return I3e(t,e),IO([i,e],i.length+e.length)}function R3e(r,e){let t=Kf(r),i=A3e(t.encode(e));return IO([t.codeBuf,i],t.codeBuf.length+i.length)}function k3e(r){r instanceof Uint8Array&&(r=Hb(r));let e=r[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(e)&&(r=r.toLowerCase()),Kf(r[0]).decode(r.substring(1))}function C3e(r){if(r instanceof Uint8Array&&(r=Hb(r)),Object.prototype.toString.call(r)!=="[object String]")return!1;try{return Kf(r[0]).name}catch(e){return!1}}function I3e(r,e){Kf(r).decode(Hb(e))}function Kf(r){if(Object.prototype.hasOwnProperty.call(Nh.names,r))return Nh.names[r];if(Object.prototype.hasOwnProperty.call(Nh.codes,r))return Nh.codes[r];throw new Error(`Unsupported encoding: ${r}`)}function P3e(r){return r instanceof Uint8Array&&(r=Hb(r)),Kf(r[0])}Cc=AO.exports=T3e;Cc.encode=R3e;Cc.decode=k3e;Cc.isEncoded=C3e;Cc.encoding=Kf;Cc.encodingFromData=P3e;var O3e=Object.freeze(Nh.names),B3e=Object.freeze(Nh.codes);Cc.names=O3e;Cc.codes=B3e});var CO=p((R0t,TO)=>{l();TO.exports=RO;var kO=128,N3e=127,D3e=~N3e,q3e=Math.pow(2,31);function RO(r,e,t){e=e||[],t=t||0;for(var i=t;r>=q3e;)e[t++]=r&255|kO,r/=128;for(;r&D3e;)e[t++]=r&255|kO,r>>>=7;return e[t]=r|0,RO.bytes=t-i+1,e}});var BO=p((k0t,PO)=>{l();PO.exports=dS;var M3e=128,OO=127;function dS(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o)throw dS.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&OO)<<i:(s&OO)*Math.pow(2,i),i+=7}while(s>=M3e);return dS.bytes=n-e,t}});var DO=p((C0t,NO)=>{l();var L3e=Math.pow(2,7),F3e=Math.pow(2,14),U3e=Math.pow(2,21),K3e=Math.pow(2,28),j3e=Math.pow(2,35),V3e=Math.pow(2,42),z3e=Math.pow(2,49),H3e=Math.pow(2,56),G3e=Math.pow(2,63);NO.exports=function(r){return r<L3e?1:r<F3e?2:r<U3e?3:r<K3e?4:r<j3e?5:r<V3e?6:r<z3e?7:r<H3e?8:r<G3e?9:10}});var ey=p((P0t,qO)=>{l();qO.exports={encode:CO(),decode:BO(),encodingLength:DO()}});var LO=p((O0t,MO)=>{l();"use strict";var $3e=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});MO.exports={names:$3e}});var tt=p((B0t,FO)=>{l();"use strict";var{encoding:W3e}=en(),Y3e=new TextDecoder("utf8");function X3e(r){let e="";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e}function J3e(r,e="utf8"){return e==="utf8"||e==="utf-8"?Y3e.decode(r):e==="ascii"?X3e(r):W3e(e).encode(r)}FO.exports=J3e});var ct=p((N0t,UO)=>{l();"use strict";var{encoding:Q3e}=en(),Z3e=new TextEncoder;function eSe(r){let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}function tSe(r,e="utf8"){return e==="utf8"||e==="utf-8"?Z3e.encode(r):e==="ascii"?eSe(r):Q3e(e).decode(r)}UO.exports=tSe});var vi=p((D0t,KO)=>{l();"use strict";function rSe(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}KO.exports=rSe});var ko=p((q0t,jO)=>{l();"use strict";var VO=en(),Dh=ey(),{names:ty}=LO(),Gb=tt(),iSe=ct(),nSe=vi(),qh={};for(let r in ty){let e=r;qh[ty[e]]=e}Object.freeze(qh);function sSe(r){if(!(r instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return Gb(r,"base16")}function oSe(r){return iSe(r,"base16")}function aSe(r){if(!(r instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return Gb(VO.encode("base58btc",r)).slice(1)}function cSe(r){let e=r instanceof Uint8Array?Gb(r):r;return VO.decode("z"+e)}function HO(r){if(!(r instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(r.length<2)throw new Error("multihash too short. must be > 2 bytes.");let e=Dh.decode(r);if(!zO(e))throw new Error(`multihash unknown function code: 0x${e.toString(16)}`);r=r.slice(Dh.decode.bytes);let t=Dh.decode(r);if(t<0)throw new Error(`multihash invalid length: ${t}`);if(r=r.slice(Dh.decode.bytes),r.length!==t)throw new Error(`multihash length inconsistent: 0x${Gb(r,"base16")}`);return{code:e,name:qh[e],length:t,digest:r}}function uSe(r,e,t){if(!r||e===void 0)throw new Error("multihash encode requires at least two args: digest, code");let i=GO(e);if(!(r instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(t==null&&(t=r.length),t&&r.length!==t)throw new Error("digest length should be equal to specified length.");let n=Dh.encode(i),s=Dh.encode(t);return nSe([n,s,r],n.length+s.length+r.length)}function GO(r){let e=r;if(typeof r=="string"){if(ty[r]===void 0)throw new Error(`Unrecognized hash function named: ${r}`);e=ty[r]}if(typeof e!="number")throw new Error(`Hash function code should be a number. Got: ${e}`);if(qh[e]===void 0&&!pS(e))throw new Error(`Unrecognized function code: ${e}`);return e}function pS(r){return r>0&&r<16}function zO(r){return!!(pS(r)||qh[r])}function $O(r){HO(r)}function fSe(r){return $O(r),r.subarray(0,2)}jO.exports={names:ty,codes:qh,toHexString:sSe,fromHexString:oSe,toB58String:aSe,fromB58String:cSe,decode:HO,encode:uSe,coerceCode:GO,isAppCode:pS,validate:$O,prefix:fSe,isValidCode:zO}});var yS=p((M0t,WO)=>{l();"use strict";var YO=ey(),lSe=tt(),hSe=ct();WO.exports={numberToUint8Array:dSe,uint8ArrayToNumber:XO,varintUint8ArrayEncode:pSe,varintEncode:ySe};function XO(r){return parseInt(lSe(r,"base16"),16)}function dSe(r){let e=r.toString(16);return e.length%2==1&&(e="0"+e),hSe(e,"base16")}function pSe(r){return Uint8Array.from(YO.encode(XO(r)))}function ySe(r){return Uint8Array.from(YO.encode(r))}});var QO=p((L0t,JO)=>{l();"use strict";var gSe=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,docid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,thread:406,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,json:512,messagepack:513,"libp2p-peer-record":769,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056});JO.exports={baseTable:gSe}});var eB=p((F0t,ZO)=>{l();"use strict";var{baseTable:gS}=QO(),bSe=yS().varintEncode,bS={},mS={},$b={};for(let r in gS){let e=r,t=gS[e];bS[e]=bSe(t);let i=e.toUpperCase().replace(/-/g,"_");mS[i]=t,$b[t]||($b[t]=e)}Object.freeze(bS);Object.freeze(mS);Object.freeze($b);var mSe=Object.freeze(gS);ZO.exports={nameToVarint:bS,constantToCode:mS,nameToCode:mSe,codeToName:$b}});var $r=p((U0t,tB)=>{l();"use strict";var Wb=ey(),vSe=vi(),rB=yS(),{nameToVarint:Yb,constantToCode:wSe,nameToCode:iB,codeToName:vS}=eB();function _Se(r,e){let t;if(r instanceof Uint8Array)t=rB.varintUint8ArrayEncode(r);else if(Yb[r])t=Yb[r];else throw new Error("multicodec not recognized");return vSe([t,e],t.length+e.length)}function ESe(r){return Wb.decode(r),r.slice(Wb.decode.bytes)}function nB(r){let e=Wb.decode(r),t=vS[e];if(t===void 0)throw new Error(`Code "${e}" not found`);return t}function sB(r){return vS[r]}function oB(r){let e=iB[r];if(e===void 0)throw new Error(`Codec "${r}" not found`);return e}function aB(r){return Wb.decode(r)}function cB(r){let e=Yb[r];if(e===void 0)throw new Error(`Codec "${r}" not found`);return e}function uB(r){return rB.varintEncode(r)}function SSe(r){return nB(r)}function xSe(r){return sB(r)}function ASe(r){return oB(r)}function ISe(r){return aB(r)}function TSe(r){return cB(r)}function RSe(r){return Array.from(uB(r))}tB.exports={addPrefix:_Se,rmPrefix:ESe,getNameFromData:nB,getNameFromCode:sB,getCodeFromName:oB,getCodeFromData:aB,getVarintFromName:cB,getVarintFromCode:uB,getCodec:SSe,getName:xSe,getNumber:ASe,getCode:ISe,getCodeVarint:TSe,getVarint:RSe,...wSe,nameToVarint:Yb,nameToCode:iB,codeToName:vS}});var lB=p((K0t,fB)=>{l();"use strict";var kSe=ko(),CSe={checkCIDComponents:function(r){if(r==null)return"null values are not valid CIDs";if(!(r.version===0||r.version===1))return"Invalid version, must be a number equal to 1 or 0";if(typeof r.codec!="string")return"codec must be string";if(r.version===0){if(r.codec!=="dag-pb")return"codec must be 'dag-pb' for CIDv0";if(r.multibaseName!=="base58btc")return"multibaseName must be 'base58btc' for CIDv0"}if(!(r.multihash instanceof Uint8Array))return"multihash must be a Uint8Array";try{kSe.validate(r.multihash)}catch(e){let t=e.message;return t||(t="Multihash validation failed"),t}}};fB.exports=CSe});var Dr=p((j0t,hB)=>{l();"use strict";function PSe(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}hB.exports=PSe});var Qe=p((V0t,dB)=>{l();"use strict";var Xb=ko(),wS=en(),jf=$r(),OSe=lB(),pB=vi(),BSe=tt(),NSe=Dr(),Jb=jf.nameToCode,DSe=Object.keys(Jb).reduce((r,e)=>(r[Jb[e]]=e,r),{}),yB=Symbol.for("@ipld/js-cid/CID"),Co=class{constructor(e,t,i,n){if(this.version,this.codec,this.multihash,Object.defineProperty(this,yB,{value:!0}),Co.isCID(e)){let s=e;this.version=s.version,this.codec=s.codec,this.multihash=s.multihash,this.multibaseName=s.multibaseName||(s.version===0?"base58btc":"base32");return}if(typeof e=="string"){let s=wS.isEncoded(e);if(s){let o=wS.decode(e);this.version=parseInt(o[0].toString(),16),this.codec=jf.getCodec(o.slice(1)),this.multihash=jf.rmPrefix(o.slice(1)),this.multibaseName=s}else this.version=0,this.codec="dag-pb",this.multihash=Xb.fromB58String(e),this.multibaseName="base58btc";Co.validateCID(this),Object.defineProperty(this,"string",{value:e});return}if(e instanceof Uint8Array){let s=parseInt(e[0].toString(),16);if(s===1){let o=e;this.version=s,this.codec=jf.getCodec(o.slice(1)),this.multihash=jf.rmPrefix(o.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=e,this.multibaseName="base58btc";Co.validateCID(this);return}this.version=e,typeof t=="number"&&(t=DSe[t]),this.codec=t,this.multihash=i,this.multibaseName=n||(e===0?"base58btc":"base32"),Co.validateCID(this)}get bytes(){let e=this._bytes;if(!e){if(this.version===0)e=this.multihash;else if(this.version===1){let t=jf.getCodeVarint(this.codec);e=pB([[1],t,this.multihash],1+t.byteLength+this.multihash.byteLength)}else throw new Error("unsupported version");Object.defineProperty(this,"_bytes",{value:e})}return e}get prefix(){let e=jf.getCodeVarint(this.codec),t=Xb.prefix(this.multihash);return pB([[this.version],e,t],1+e.byteLength+t.byteLength)}get code(){return Jb[this.codec]}toV0(){if(this.codec!=="dag-pb")throw new Error("Cannot convert a non dag-pb CID to CIDv0");let{name:e,length:t}=Xb.decode(this.multihash);if(e!=="sha2-256")throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(t!==32)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new Co(0,this.codec,this.multihash)}toV1(){return new Co(1,this.codec,this.multihash,this.multibaseName)}toBaseEncodedString(e=this.multibaseName){if(this.string&&this.string.length!==0&&e===this.multibaseName)return this.string;let t;if(this.version===0){if(e!=="base58btc")throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");t=Xb.toB58String(this.multihash)}else if(this.version===1)t=BSe(wS.encode(e,this.bytes));else throw new Error("unsupported version");return e===this.multibaseName&&Object.defineProperty(this,"string",{value:t}),t}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(e){return this.toBaseEncodedString(e)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(e){return this.codec===e.codec&&this.version===e.version&&NSe(this.multihash,e.multihash)}static validateCID(e){let t=OSe.checkCIDComponents(e);if(t)throw new Error(t)}static isCID(e){return e instanceof Co||Boolean(e&&e[yB])}};Co.codecs=Jb;dB.exports=Co});var bB=p((z0t,gB)=>{l();"use strict";gB.exports=qSe;function qSe(r,e){for(var t=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)t[i++]=arguments[n++];return new Promise(function(a,c){t[i]=function(f){if(s)if(s=!1,f)c(f);else{for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d++]=arguments[d];a.apply(null,h)}};try{r.apply(e||null,t)}catch(u){s&&(s=!1,c(u))}})}});var _B=p(mB=>{l();"use strict";var Qb=mB;Qb.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&e.charAt(t)==="=";)++i;return Math.ceil(e.length*3)/4-i};var Mh=new Array(64),vB=new Array(123);for(var _a=0;_a<64;)vB[Mh[_a]=_a<26?_a+65:_a<52?_a+71:_a<62?_a-4:_a-59|43]=_a++;Qb.encode=function(e,t,i){for(var n=null,s=[],o=0,a=0,c;t<i;){var u=e[t++];switch(a){case 0:s[o++]=Mh[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=Mh[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=Mh[c|u>>6],s[o++]=Mh[u&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Mh[c],s[o++]=61,a===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var wB="invalid encoding";Qb.decode=function(e,t,i){for(var n=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=vB[c])===void 0)throw Error(wB);switch(s){case 0:o=c,s=1;break;case 1:t[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(wB);return i-n};Qb.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var SB=p((G0t,EB)=>{l();"use strict";EB.exports=Zb;function Zb(){this._listeners={}}Zb.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};Zb.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this};Zb.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}});var CB=p(($0t,xB)=>{l();"use strict";xB.exports=AB(AB);function AB(r){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function n(c,u,f){e[0]=c,u[f]=t[0],u[f+1]=t[1],u[f+2]=t[2],u[f+3]=t[3]}function s(c,u,f){e[0]=c,u[f]=t[3],u[f+1]=t[2],u[f+2]=t[1],u[f+3]=t[0]}r.writeFloatLE=i?n:s,r.writeFloatBE=i?s:n;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],e[0]}function a(c,u){return t[3]=c[u],t[2]=c[u+1],t[1]=c[u+2],t[0]=c[u+3],e[0]}r.readFloatLE=i?o:a,r.readFloatBE=i?a:o}():function(){function e(i,n,s,o){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(n)/Math.LN2),u=Math.round(n*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|u)>>>0,s,o)}}r.writeFloatLE=e.bind(null,IB),r.writeFloatBE=e.bind(null,TB);function t(i,n,s){var o=i(n,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*Infinity:c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}r.readFloatLE=t.bind(null,RB),r.readFloatBE=t.bind(null,kB)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function n(c,u,f){e[0]=c,u[f]=t[0],u[f+1]=t[1],u[f+2]=t[2],u[f+3]=t[3],u[f+4]=t[4],u[f+5]=t[5],u[f+6]=t[6],u[f+7]=t[7]}function s(c,u,f){e[0]=c,u[f]=t[7],u[f+1]=t[6],u[f+2]=t[5],u[f+3]=t[4],u[f+4]=t[3],u[f+5]=t[2],u[f+6]=t[1],u[f+7]=t[0]}r.writeDoubleLE=i?n:s,r.writeDoubleBE=i?s:n;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],t[4]=c[u+4],t[5]=c[u+5],t[6]=c[u+6],t[7]=c[u+7],e[0]}function a(c,u){return t[7]=c[u],t[6]=c[u+1],t[5]=c[u+2],t[4]=c[u+3],t[3]=c[u+4],t[2]=c[u+5],t[1]=c[u+6],t[0]=c[u+7],e[0]}r.readDoubleLE=i?o:a,r.readDoubleBE=i?a:o}():function(){function e(i,n,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)i(0,a,c+n),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+n),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+n),i((u<<31|2146435072)>>>0,a,c+s);else{var f;if(o<22250738585072014e-324)f=o/5e-324,i(f>>>0,a,c+n),i((u<<31|f/4294967296)>>>0,a,c+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),f=o*Math.pow(2,-h),i(f*4503599627370496>>>0,a,c+n),i((u<<31|h+1023<<20|f*1048576&1048575)>>>0,a,c+s)}}}r.writeDoubleLE=e.bind(null,IB,0,4),r.writeDoubleBE=e.bind(null,TB,4,0);function t(i,n,s,o,a){var c=i(o,a+n),u=i(o,a+s),f=(u>>31)*2+1,h=u>>>20&2047,d=4294967296*(u&1048575)+c;return h===2047?d?NaN:f*Infinity:h===0?f*5e-324*d:f*Math.pow(2,h-1075)*(d+4503599627370496)}r.readDoubleLE=t.bind(null,RB,0,4),r.readDoubleBE=t.bind(null,kB,4,0)}(),r}function IB(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function TB(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function RB(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function kB(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var PB=p((exports,module)=>{l();"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var BB=p(OB=>{l();"use strict";var _S=OB;_S.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?t+=1:i<2048?t+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,t+=4):t+=3;return t};_S.read=function(e,t,i){var n=i-t;if(n<1)return"";for(var s=null,o=[],a=0,c;t<i;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};_S.write=function(e,t,i){for(var n=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-n}});var DB=p((Y0t,NB)=>{l();"use strict";NB.exports=MSe;function MSe(r,e,t){var i=t||8192,n=i>>>1,s=null,o=i;return function(c){if(c<1||c>n)return r(c);o+c>i&&(s=r(i),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var MB=p((X0t,qB)=>{l();"use strict";qB.exports=Di;var ry=xu();function Di(r,e){this.lo=r>>>0,this.hi=e>>>0}var Vf=Di.zero=new Di(0,0);Vf.toNumber=function(){return 0};Vf.zzEncode=Vf.zzDecode=function(){return this};Vf.length=function(){return 1};var LSe=Di.zeroHash="\0\0\0\0\0\0\0\0";Di.fromNumber=function(e){if(e===0)return Vf;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new Di(i,n)};Di.from=function(e){if(typeof e=="number")return Di.fromNumber(e);if(ry.isString(e))if(ry.Long)e=ry.Long.fromString(e);else return Di.fromNumber(parseInt(e,10));return e.low||e.high?new Di(e.low>>>0,e.high>>>0):Vf};Di.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+i*4294967296)}return this.lo+this.hi*4294967296};Di.prototype.toLong=function(e){return ry.Long?new ry.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Au=String.prototype.charCodeAt;Di.fromHash=function(e){return e===LSe?Vf:new Di((Au.call(e,0)|Au.call(e,1)<<8|Au.call(e,2)<<16|Au.call(e,3)<<24)>>>0,(Au.call(e,4)|Au.call(e,5)<<8|Au.call(e,6)<<16|Au.call(e,7)<<24)>>>0)};Di.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Di.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Di.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Di.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}});var xu=p(ES=>{l();"use strict";var Je=ES;Je.asPromise=bB();Je.base64=_B();Je.EventEmitter=SB();Je.float=CB();Je.inquire=PB();Je.utf8=BB();Je.pool=DB();Je.LongBits=MB();Je.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);Je.global=Je.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||ES;Je.emptyArray=Object.freeze?Object.freeze([]):[];Je.emptyObject=Object.freeze?Object.freeze({}):{};Je.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Je.isString=function(e){return typeof e=="string"||e instanceof String};Je.isObject=function(e){return e&&typeof e=="object"};Je.isset=Je.isSet=function(e,t){var i=e[t];return i!=null&&e.hasOwnProperty(t)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};Je.Buffer=function(){try{var r=Je.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch(e){return null}}();Je._Buffer_from=null;Je._Buffer_allocUnsafe=null;Je.newBuffer=function(e){return typeof e=="number"?Je.Buffer?Je._Buffer_allocUnsafe(e):new Je.Array(e):Je.Buffer?Je._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};Je.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;Je.Long=Je.global.dcodeIO&&Je.global.dcodeIO.Long||Je.global.Long||Je.inquire("long");Je.key2Re=/^true|false|0|1$/;Je.key32Re=/^-?(?:0|[1-9][0-9]*)$/;Je.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;Je.longToHash=function(e){return e?Je.LongBits.from(e).toHash():Je.LongBits.zeroHash};Je.longFromHash=function(e,t){var i=Je.LongBits.fromHash(e);return Je.Long?Je.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))};function LB(r,e,t){for(var i=Object.keys(e),n=0;n<i.length;++n)(r[i[n]]===void 0||!t)&&(r[i[n]]=e[i[n]]);return r}Je.merge=LB;Je.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function FB(r){function e(t,i){if(!(this instanceof e))return new e(t,i);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&LB(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return r}}),e.prototype.toString=function(){return this.name+": "+this.message},e}Je.newError=FB;Je.ProtocolError=FB("ProtocolError");Je.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(t[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};Je.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}};Je.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};Je._configure=function(){var r=Je.Buffer;if(!r){Je._Buffer_from=Je._Buffer_allocUnsafe=null;return}Je._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,i){return new r(t,i)},Je._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var kS=p((Q0t,UB)=>{l();"use strict";UB.exports=qt;var Ms=xu(),SS,em=Ms.LongBits,KB=Ms.base64,jB=Ms.utf8;function iy(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function xS(){}function FSe(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function qt(){this.len=0,this.head=new iy(xS,0,0),this.tail=this.head,this.states=null}var VB=function(){return Ms.Buffer?function(){return(qt.create=function(){return new SS})()}:function(){return new qt}};qt.create=VB();qt.alloc=function(e){return new Ms.Array(e)};Ms.Array!==Array&&(qt.alloc=Ms.pool(qt.alloc,Ms.Array.prototype.subarray));qt.prototype._push=function(e,t,i){return this.tail=this.tail.next=new iy(e,t,i),this.len+=t,this};function AS(r,e,t){e[t]=r&255}function USe(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function IS(r,e){this.len=r,this.next=void 0,this.val=e}IS.prototype=Object.create(iy.prototype);IS.prototype.fn=USe;qt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new IS((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};qt.prototype.int32=function(e){return e<0?this._push(TS,10,em.fromNumber(e)):this.uint32(e)};qt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function TS(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}qt.prototype.uint64=function(e){var t=em.from(e);return this._push(TS,t.length(),t)};qt.prototype.int64=qt.prototype.uint64;qt.prototype.sint64=function(e){var t=em.from(e).zzEncode();return this._push(TS,t.length(),t)};qt.prototype.bool=function(e){return this._push(AS,1,e?1:0)};function RS(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}qt.prototype.fixed32=function(e){return this._push(RS,4,e>>>0)};qt.prototype.sfixed32=qt.prototype.fixed32;qt.prototype.fixed64=function(e){var t=em.from(e);return this._push(RS,4,t.lo)._push(RS,4,t.hi)};qt.prototype.sfixed64=qt.prototype.fixed64;qt.prototype.float=function(e){return this._push(Ms.float.writeFloatLE,4,e)};qt.prototype.double=function(e){return this._push(Ms.float.writeDoubleLE,8,e)};var KSe=Ms.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};qt.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(AS,1,0);if(Ms.isString(e)){var i=qt.alloc(t=KB.length(e));KB.decode(e,i,0),e=i}return this.uint32(t)._push(KSe,t,e)};qt.prototype.string=function(e){var t=jB.length(e);return t?this.uint32(t)._push(jB.write,t,e):this._push(AS,1,0)};qt.prototype.fork=function(){return this.states=new FSe(this),this.head=this.tail=new iy(xS,0,0),this.len=0,this};qt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new iy(xS,0,0),this.len=0),this};qt.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};qt.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};qt._configure=function(r){SS=r,qt.create=VB(),SS._configure()}});var GB=p((Z0t,zB)=>{l();"use strict";zB.exports=Ea;var HB=kS();(Ea.prototype=Object.create(HB.prototype)).constructor=Ea;var Iu=xu();function Ea(){HB.call(this)}Ea._configure=function(){Ea.alloc=Iu._Buffer_allocUnsafe,Ea.writeBytesBuffer=Iu.Buffer&&Iu.Buffer.prototype instanceof Uint8Array&&Iu.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}};Ea.prototype.bytes=function(e){Iu.isString(e)&&(e=Iu._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Ea.writeBytesBuffer,t,e),this};function jSe(r,e,t){r.length<40?Iu.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}Ea.prototype.string=function(e){var t=Iu.Buffer.byteLength(e);return this.uint32(t),t&&this._push(jSe,t,e),this};Ea._configure()});var OS=p((eyt,$B)=>{l();"use strict";$B.exports=ni;var Sa=xu(),CS,WB=Sa.LongBits,VSe=Sa.utf8;function Po(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function ni(r){this.buf=r,this.pos=0,this.len=r.length}var YB=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ni(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ni(e);throw Error("illegal buffer")},XB=function(){return Sa.Buffer?function(t){return(ni.create=function(n){return Sa.Buffer.isBuffer(n)?new CS(n):YB(n)})(t)}:YB};ni.create=XB();ni.prototype._slice=Sa.Array.prototype.subarray||Sa.Array.prototype.slice;ni.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Po(this,10);return e}}();ni.prototype.int32=function(){return this.uint32()|0};ni.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function PS(){var r=new WB(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Po(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw Po(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}ni.prototype.bool=function(){return this.uint32()!==0};function tm(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}ni.prototype.fixed32=function(){if(this.pos+4>this.len)throw Po(this,4);return tm(this.buf,this.pos+=4)};ni.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Po(this,4);return tm(this.buf,this.pos+=4)|0};function JB(){if(this.pos+8>this.len)throw Po(this,8);return new WB(tm(this.buf,this.pos+=4),tm(this.buf,this.pos+=4))}ni.prototype.float=function(){if(this.pos+4>this.len)throw Po(this,4);var e=Sa.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ni.prototype.double=function(){if(this.pos+8>this.len)throw Po(this,4);var e=Sa.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ni.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw Po(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)};ni.prototype.string=function(){var e=this.bytes();return VSe.read(e,0,e.length)};ni.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Po(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Po(this);while(this.buf[this.pos++]&128);return this};ni.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!=4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};ni._configure=function(r){CS=r,ni.create=XB(),CS._configure();var e=Sa.Long?"toLong":"toNumber";Sa.merge(ni.prototype,{int64:function(){return PS.call(this)[e](!1)},uint64:function(){return PS.call(this)[e](!0)},sint64:function(){return PS.call(this).zzDecode()[e](!1)},fixed64:function(){return JB.call(this)[e](!0)},sfixed64:function(){return JB.call(this)[e](!1)}})}});var tN=p((tyt,QB)=>{l();"use strict";QB.exports=zf;var ZB=OS();(zf.prototype=Object.create(ZB.prototype)).constructor=zf;var eN=xu();function zf(r){ZB.call(this,r)}zf._configure=function(){eN.Buffer&&(zf.prototype._slice=eN.Buffer.prototype.slice)};zf.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};zf._configure()});var iN=p((ryt,rN)=>{l();"use strict";rN.exports=ny;var BS=xu();(ny.prototype=Object.create(BS.EventEmitter.prototype)).constructor=ny;function ny(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");BS.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}ny.prototype.rpcCall=function r(e,t,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return BS.asPromise(r,o,e,t,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof i))try{u=i[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(f){return o.emit("error",f,e),s(f)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};ny.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var sN=p(nN=>{l();"use strict";var zSe=nN;zSe.Service=iN()});var aN=p((nyt,oN)=>{l();"use strict";oN.exports={}});var fN=p(cN=>{l();"use strict";var Gn=cN;Gn.build="minimal";Gn.Writer=kS();Gn.BufferWriter=GB();Gn.Reader=OS();Gn.BufferReader=tN();Gn.util=xu();Gn.rpc=sN();Gn.roots=aN();Gn.configure=uN;function uN(){Gn.util._configure(),Gn.Writer._configure(Gn.BufferWriter),Gn.Reader._configure(Gn.BufferReader)}uN()});var hi=p((oyt,lN)=>{l();"use strict";lN.exports=fN()});var im=p((ayt,hN)=>{l();"use strict";var Hf=hi(),rm=Hf.Reader,dN=Hf.Writer,ln=Hf.util,Ls=Hf.roots["libp2p-crypto-keys"]||(Hf.roots["libp2p-crypto-keys"]={});Ls.KeyType=function(){var r={},e=Object.create(r);return e[r[0]="RSA"]=0,e[r[1]="Ed25519"]=1,e[r[2]="Secp256k1"]=2,e}();Ls.PublicKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=ln.newBuffer([]),r.encode=function(t,i){return i||(i=dN.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof rm||(t=rm.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ls.PublicKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw ln.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw ln.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Ls.PublicKey)return t;var i=new Ls.PublicKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?ln.base64.decode(t.Data,i.Data=ln.newBuffer(ln.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=ln.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?Ls.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?ln.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Hf.util.toJSONOptions)},r}();Ls.PrivateKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=ln.newBuffer([]),r.encode=function(t,i){return i||(i=dN.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof rm||(t=rm.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ls.PrivateKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw ln.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw ln.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Ls.PrivateKey)return t;var i=new Ls.PrivateKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?ln.base64.decode(t.Data,i.Data=ln.newBuffer(ln.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=ln.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?Ls.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?ln.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Hf.util.toJSONOptions)},r}();hN.exports=Ls});var bt=p((cyt,pN)=>{l();pN.exports={options:{usePureJavaScript:!1}}});var bN=p((uyt,yN)=>{l();var NS={};yN.exports=NS;var gN={};NS.encode=function(r,e,t){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(t!==void 0&&typeof t!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(r instanceof Uint8Array))i=HSe(r,e);else{var n=0,s=e.length,o=e.charAt(0),a=[0];for(n=0;n<r.length;++n){for(var c=0,u=r[n];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(n=0;r[n]===0&&n<r.length-1;++n)i+=o;for(n=a.length-1;n>=0;--n)i+=e[a[n]]}if(t){var f=new RegExp(".{1,"+t+"}","g");i=i.match(f).join(`\r
`)}return i};NS.decode=function(r,e){if(typeof r!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var t=gN[e];if(!t){t=gN[e]=[];for(var i=0;i<e.length;++i)t[e.charCodeAt(i)]=i}r=r.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),o=[0],i=0;i<r.length;i++){var a=t[r.charCodeAt(i)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*n,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var f=0;r[f]===s&&f<r.length-1;++f)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function HSe(r,e){var t=0,i=e.length,n=e.charAt(0),s=[0];for(t=0;t<r.length();++t){for(var o=0,a=r.at(t);o<s.length;++o)a+=s[o]<<8,s[o]=a%i,a=a/i|0;for(;a>0;)s.push(a%i),a=a/i|0}var c="";for(t=0;r.at(t)===0&&t<r.length()-1;++t)c+=n;for(t=s.length-1;t>=0;--t)c+=e[s[t]];return c}});var yr=p((fyt,mN)=>{l();var vN=bt(),wN=bN(),oe=mN.exports=vN.util=vN.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){oe.nextTick=process.nextTick,typeof setImmediate=="function"?oe.setImmediate=setImmediate:oe.setImmediate=oe.nextTick;return}if(typeof setImmediate=="function"){oe.setImmediate=function(){return setImmediate.apply(void 0,arguments)},oe.nextTick=function(a){return setImmediate(a)};return}if(oe.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===r){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(f){f()})}};var o=a,r="forge.setImmediate",e=[];oe.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(r,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var t=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(n,{attributes:!0});var s=oe.setImmediate;oe.setImmediate=function(c){Date.now()-t>15?(t=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}oe.nextTick=oe.setImmediate})();oe.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;oe.globalScope=function(){return oe.isNodejs?globalThis:typeof self=="undefined"?window:self}();oe.isArray=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};oe.isArrayBuffer=function(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer};oe.isArrayBufferView=function(r){return r&&oe.isArrayBuffer(r.buffer)&&r.byteLength!==void 0};function sy(r){if(!(r===8||r===16||r===24||r===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+r)}oe.ByteBuffer=DS;function DS(r){if(this.data="",this.read=0,typeof r=="string")this.data=r;else if(oe.isArrayBuffer(r)||oe.isArrayBufferView(r))if(typeof Buffer!="undefined"&&r instanceof Buffer)this.data=r.toString("binary");else{var e=new Uint8Array(r);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var t=0;t<e.length;++t)this.putByte(e[t])}}else(r instanceof DS||typeof r=="object"&&typeof r.data=="string"&&typeof r.read=="number")&&(this.data=r.data,this.read=r.read);this._constructedStringLength=0}oe.ByteStringBuffer=DS;var GSe=4096;oe.ByteStringBuffer.prototype._optimizeConstructedString=function(r){this._constructedStringLength+=r,this._constructedStringLength>GSe&&(this.data.substr(0,1),this._constructedStringLength=0)};oe.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};oe.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};oe.ByteStringBuffer.prototype.putByte=function(r){return this.putBytes(String.fromCharCode(r))};oe.ByteStringBuffer.prototype.fillWithByte=function(r,e){r=String.fromCharCode(r);for(var t=this.data;e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return this.data=t,this._optimizeConstructedString(e),this};oe.ByteStringBuffer.prototype.putBytes=function(r){return this.data+=r,this._optimizeConstructedString(r.length),this};oe.ByteStringBuffer.prototype.putString=function(r){return this.putBytes(oe.encodeUtf8(r))};oe.ByteStringBuffer.prototype.putInt16=function(r){return this.putBytes(String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};oe.ByteStringBuffer.prototype.putInt24=function(r){return this.putBytes(String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};oe.ByteStringBuffer.prototype.putInt32=function(r){return this.putBytes(String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};oe.ByteStringBuffer.prototype.putInt16Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255))};oe.ByteStringBuffer.prototype.putInt24Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255))};oe.ByteStringBuffer.prototype.putInt32Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>24&255))};oe.ByteStringBuffer.prototype.putInt=function(r,e){sy(e);var t="";do e-=8,t+=String.fromCharCode(r>>e&255);while(e>0);return this.putBytes(t)};oe.ByteStringBuffer.prototype.putSignedInt=function(r,e){return r<0&&(r+=2<<e-1),this.putInt(r,e)};oe.ByteStringBuffer.prototype.putBuffer=function(r){return this.putBytes(r.getBytes())};oe.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};oe.ByteStringBuffer.prototype.getInt16=function(){var r=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,r};oe.ByteStringBuffer.prototype.getInt24=function(){var r=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,r};oe.ByteStringBuffer.prototype.getInt32=function(){var r=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,r};oe.ByteStringBuffer.prototype.getInt16Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,r};oe.ByteStringBuffer.prototype.getInt24Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,r};oe.ByteStringBuffer.prototype.getInt32Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,r};oe.ByteStringBuffer.prototype.getInt=function(r){sy(r);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),r-=8;while(r>0);return e};oe.ByteStringBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};oe.ByteStringBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};oe.ByteStringBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};oe.ByteStringBuffer.prototype.at=function(r){return this.data.charCodeAt(this.read+r)};oe.ByteStringBuffer.prototype.setAt=function(r,e){return this.data=this.data.substr(0,this.read+r)+String.fromCharCode(e)+this.data.substr(this.read+r+1),this};oe.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};oe.ByteStringBuffer.prototype.copy=function(){var r=oe.createBuffer(this.data);return r.read=this.read,r};oe.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};oe.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};oe.ByteStringBuffer.prototype.truncate=function(r){var e=Math.max(0,this.length()-r);return this.data=this.data.substr(this.read,e),this.read=0,this};oe.ByteStringBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.length;++e){var t=this.data.charCodeAt(e);t<16&&(r+="0"),r+=t.toString(16)}return r};oe.ByteStringBuffer.prototype.toString=function(){return oe.decodeUtf8(this.bytes())};function $Se(r,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var t=oe.isArrayBuffer(r),i=oe.isArrayBufferView(r);if(t||i){t?this.data=new DataView(r):this.data=new DataView(r.buffer,r.byteOffset,r.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,r!=null&&this.putBytes(r),"writeOffset"in e&&(this.write=e.writeOffset)}oe.DataBuffer=$Se;oe.DataBuffer.prototype.length=function(){return this.write-this.read};oe.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};oe.DataBuffer.prototype.accommodate=function(r,e){if(this.length()>=r)return this;e=Math.max(e||this.growSize,r);var t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(t),this.data=new DataView(i.buffer),this};oe.DataBuffer.prototype.putByte=function(r){return this.accommodate(1),this.data.setUint8(this.write++,r),this};oe.DataBuffer.prototype.fillWithByte=function(r,e){this.accommodate(e);for(var t=0;t<e;++t)this.data.setUint8(r);return this};oe.DataBuffer.prototype.putBytes=function(r,e){if(oe.isArrayBufferView(r)){var t=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),i=t.byteLength-t.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(t),this.write+=i,this}if(oe.isArrayBuffer(r)){var t=new Uint8Array(r);this.accommodate(t.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(t,this.write),this.write+=t.byteLength,this}if(r instanceof oe.DataBuffer||typeof r=="object"&&typeof r.read=="number"&&typeof r.write=="number"&&oe.isArrayBufferView(r.data)){var t=new Uint8Array(r.data.byteLength,r.read,r.length());this.accommodate(t.byteLength);var n=new Uint8Array(r.data.byteLength,this.write);return n.set(t),this.write+=t.byteLength,this}if(r instanceof oe.ByteStringBuffer&&(r=r.data,e="binary"),e=e||"binary",typeof r=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(r.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=oe.binary.hex.decode(r,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(r.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=oe.binary.base64.decode(r,s,this.write),this;if(e==="utf8"&&(r=oe.encodeUtf8(r),e="binary"),e==="binary"||e==="raw")return this.accommodate(r.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=oe.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(r.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=oe.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+r)};oe.DataBuffer.prototype.putBuffer=function(r){return this.putBytes(r),r.clear(),this};oe.DataBuffer.prototype.putString=function(r){return this.putBytes(r,"utf16")};oe.DataBuffer.prototype.putInt16=function(r){return this.accommodate(2),this.data.setInt16(this.write,r),this.write+=2,this};oe.DataBuffer.prototype.putInt24=function(r){return this.accommodate(3),this.data.setInt16(this.write,r>>8&65535),this.data.setInt8(this.write,r>>16&255),this.write+=3,this};oe.DataBuffer.prototype.putInt32=function(r){return this.accommodate(4),this.data.setInt32(this.write,r),this.write+=4,this};oe.DataBuffer.prototype.putInt16Le=function(r){return this.accommodate(2),this.data.setInt16(this.write,r,!0),this.write+=2,this};oe.DataBuffer.prototype.putInt24Le=function(r){return this.accommodate(3),this.data.setInt8(this.write,r>>16&255),this.data.setInt16(this.write,r>>8&65535,!0),this.write+=3,this};oe.DataBuffer.prototype.putInt32Le=function(r){return this.accommodate(4),this.data.setInt32(this.write,r,!0),this.write+=4,this};oe.DataBuffer.prototype.putInt=function(r,e){sy(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,r>>e&255);while(e>0);return this};oe.DataBuffer.prototype.putSignedInt=function(r,e){return sy(e),this.accommodate(e/8),r<0&&(r+=2<<e-1),this.putInt(r,e)};oe.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};oe.DataBuffer.prototype.getInt16=function(){var r=this.data.getInt16(this.read);return this.read+=2,r};oe.DataBuffer.prototype.getInt24=function(){var r=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,r};oe.DataBuffer.prototype.getInt32=function(){var r=this.data.getInt32(this.read);return this.read+=4,r};oe.DataBuffer.prototype.getInt16Le=function(){var r=this.data.getInt16(this.read,!0);return this.read+=2,r};oe.DataBuffer.prototype.getInt24Le=function(){var r=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,r};oe.DataBuffer.prototype.getInt32Le=function(){var r=this.data.getInt32(this.read,!0);return this.read+=4,r};oe.DataBuffer.prototype.getInt=function(r){sy(r);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),r-=8;while(r>0);return e};oe.DataBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};oe.DataBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};oe.DataBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};oe.DataBuffer.prototype.at=function(r){return this.data.getUint8(this.read+r)};oe.DataBuffer.prototype.setAt=function(r,e){return this.data.setUint8(r,e),this};oe.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};oe.DataBuffer.prototype.copy=function(){return new oe.DataBuffer(this)};oe.DataBuffer.prototype.compact=function(){if(this.read>0){var r=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(r.byteLength);e.set(r),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};oe.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};oe.DataBuffer.prototype.truncate=function(r){return this.write=Math.max(0,this.length()-r),this.read=Math.min(this.read,this.write),this};oe.DataBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.byteLength;++e){var t=this.data.getUint8(e);t<16&&(r+="0"),r+=t.toString(16)}return r};oe.DataBuffer.prototype.toString=function(r){var e=new Uint8Array(this.data,this.read,this.length());if(r=r||"utf8",r==="binary"||r==="raw")return oe.binary.raw.encode(e);if(r==="hex")return oe.binary.hex.encode(e);if(r==="base64")return oe.binary.base64.encode(e);if(r==="utf8")return oe.text.utf8.decode(e);if(r==="utf16")return oe.text.utf16.decode(e);throw new Error("Invalid encoding: "+r)};oe.createBuffer=function(r,e){return e=e||"raw",r!==void 0&&e==="utf8"&&(r=oe.encodeUtf8(r)),new oe.ByteBuffer(r)};oe.fillString=function(r,e){for(var t="";e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return t};oe.xorBytes=function(r,e,t){for(var i="",n="",s="",o=0,a=0;t>0;--t,++o)n=r.charCodeAt(o)^e.charCodeAt(o),a>=10&&(i+=s,s="",a=0),s+=String.fromCharCode(n),++a;return i+=s,i};oe.hexToBytes=function(r){var e="",t=0;for(r.length&!0&&(t=1,e+=String.fromCharCode(parseInt(r[0],16)));t<r.length;t+=2)e+=String.fromCharCode(parseInt(r.substr(t,2),16));return e};oe.bytesToHex=function(r){return oe.createBuffer(r).toHex()};oe.int32ToBytes=function(r){return String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255)};var Tu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ru=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_N="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";oe.encode64=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.length;)n=r.charCodeAt(a++),s=r.charCodeAt(a++),o=r.charCodeAt(a++),t+=Tu.charAt(n>>2),t+=Tu.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=Tu.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":Tu.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};oe.decode64=function(r){r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",t,i,n,s,o=0;o<r.length;)t=Ru[r.charCodeAt(o++)-43],i=Ru[r.charCodeAt(o++)-43],n=Ru[r.charCodeAt(o++)-43],s=Ru[r.charCodeAt(o++)-43],e+=String.fromCharCode(t<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};oe.encodeUtf8=function(r){return unescape(encodeURIComponent(r))};oe.decodeUtf8=function(r){return decodeURIComponent(escape(r))};oe.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:wN.encode,decode:wN.decode}};oe.binary.raw.encode=function(r){return String.fromCharCode.apply(null,r)};oe.binary.raw.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};oe.binary.hex.encode=oe.bytesToHex;oe.binary.hex.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/2))),t=t||0;var n=0,s=t;for(r.length&1&&(n=1,i[s++]=parseInt(r[0],16));n<r.length;n+=2)i[s++]=parseInt(r.substr(n,2),16);return e?s-t:i};oe.binary.base64.encode=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.byteLength;)n=r[a++],s=r[a++],o=r[a++],t+=Tu.charAt(n>>2),t+=Tu.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=Tu.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":Tu.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};oe.binary.base64.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/4)*3)),r=r.replace(/[^A-Za-z0-9\+\/\=]/g,""),t=t||0;for(var n,s,o,a,c=0,u=t;c<r.length;)n=Ru[r.charCodeAt(c++)-43],s=Ru[r.charCodeAt(c++)-43],o=Ru[r.charCodeAt(c++)-43],a=Ru[r.charCodeAt(c++)-43],i[u++]=n<<2|s>>4,o!==64&&(i[u++]=(s&15)<<4|o>>2,a!==64&&(i[u++]=(o&3)<<6|a));return e?u-t:i.subarray(0,u)};oe.binary.base58.encode=function(r,e){return oe.binary.baseN.encode(r,_N,e)};oe.binary.base58.decode=function(r,e){return oe.binary.baseN.decode(r,_N,e)};oe.text={utf8:{},utf16:{}};oe.text.utf8.encode=function(r,e,t){r=oe.encodeUtf8(r);var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};oe.text.utf8.decode=function(r){return oe.decodeUtf8(String.fromCharCode.apply(null,r))};oe.text.utf16.encode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length*2));var n=new Uint16Array(i.buffer);t=t||0;for(var s=t,o=t,a=0;a<r.length;++a)n[o++]=r.charCodeAt(a),s+=2;return e?s-t:i};oe.text.utf16.decode=function(r){return String.fromCharCode.apply(null,new Uint16Array(r.buffer))};oe.deflate=function(r,e,t){if(e=oe.decode64(r.deflate(oe.encode64(e)).rval),t){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};oe.inflate=function(r,e,t){var i=r.inflate(oe.encode64(e)).rval;return i===null?null:oe.decode64(i)};var qS=function(r,e,t){if(!r)throw new Error("WebStorage not available.");var i;if(t===null?i=r.removeItem(e):(t=oe.encode64(JSON.stringify(t)),i=r.setItem(e,t)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},MS=function(r,e){if(!r)throw new Error("WebStorage not available.");var t=r.getItem(e);if(r.init)if(t.rval===null){if(t.error){var i=new Error(t.error.message);throw i.id=t.error.id,i.name=t.error.name,i}t=null}else t=t.rval;return t!==null&&(t=JSON.parse(oe.decode64(t))),t},WSe=function(r,e,t,i){var n=MS(r,e);n===null&&(n={}),n[t]=i,qS(r,e,n)},YSe=function(r,e,t){var i=MS(r,e);return i!==null&&(i=t in i?i[t]:null),i},XSe=function(r,e,t){var i=MS(r,e);if(i!==null&&t in i){delete i[t];var n=!0;for(var s in i){n=!1;break}n&&(i=null),qS(r,e,i)}},JSe=function(r,e){qS(r,e,null)},nm=function(r,e,t){var i=null;typeof t=="undefined"&&(t=["web","flash"]);var n,s=!1,o=null;for(var a in t){n=t[a];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=r.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=r.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return i};oe.setItem=function(r,e,t,i,n){nm(WSe,arguments,n)};oe.getItem=function(r,e,t,i){return nm(YSe,arguments,i)};oe.removeItem=function(r,e,t,i){nm(XSe,arguments,i)};oe.clearItems=function(r,e,t){nm(JSe,arguments,t)};oe.parseUrl=function(r){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var t=e.exec(r),i=t===null?null:{full:r,scheme:t[1],host:t[2],port:t[3],path:t[4]};return i&&(i.fullHost=i.host,i.port?(i.port!==80&&i.scheme==="http"||i.port!==443&&i.scheme==="https")&&(i.fullHost+=":"+i.port):i.scheme==="http"?i.port=80:i.scheme==="https"&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var sm=null;oe.getQueryVariables=function(r){var e=function(i){for(var n={},s=i.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("="),c,u;a>0?(c=s[o].substring(0,a),u=s[o].substring(a+1)):(c=s[o],u=null),c in n||(n[c]=[]),!(c in Object.prototype)&&u!==null&&n[c].push(unescape(u))}return n},t;return typeof r=="undefined"?(sm===null&&(typeof window!="undefined"&&window.location&&window.location.search?sm=e(window.location.search.substring(1)):sm={}),t=sm):t=e(r),t};oe.parseFragment=function(r){var e=r,t="",i=r.indexOf("?");i>0&&(e=r.substring(0,i),t=r.substring(i+1));var n=e.split("/");n.length>0&&n[0]===""&&n.shift();var s=t===""?{}:oe.getQueryVariables(t);return{pathString:e,queryString:t,path:n,query:s}};oe.makeRequest=function(r){var e=oe.parseFragment(r),t={path:e.pathString,query:e.queryString,getPath:function(i){return typeof i=="undefined"?e.path:e.path[i]},getQuery:function(i,n){var s;return typeof i=="undefined"?s=e.query:(s=e.query[i],s&&typeof n!="undefined"&&(s=s[n])),s},getQueryLast:function(i,n){var s,o=t.getQuery(i);return o?s=o[o.length-1]:s=n,s}};return t};oe.makeLink=function(r,e,t){r=jQuery.isArray(r)?r.join("/"):r;var i=jQuery.param(e||{});return t=t||"",r+(i.length>0?"?"+i:"")+(t.length>0?"#"+t:"")};oe.isEmpty=function(r){for(var e in r)if(r.hasOwnProperty(e))return!1;return!0};oe.format=function(r){for(var e=/%./g,t,i,n=0,s=[],o=0;t=e.exec(r);){i=r.substring(o,e.lastIndex-2),i.length>0&&s.push(i),o=e.lastIndex;var a=t[0][1];switch(a){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(r.substring(o)),s.join("")};oe.formatNumber=function(r,e,t,i){var n=r,s=isNaN(e=Math.abs(e))?2:e,o=t===void 0?",":t,a=i===void 0?".":i,c=n<0?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",f=u.length>3?u.length%3:0;return c+(f?u.substr(0,f)+a:"")+u.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(n-u).toFixed(s).slice(2):"")};oe.formatSize=function(r){return r>=1073741824?r=oe.formatNumber(r/1073741824,2,".","")+" GiB":r>=1048576?r=oe.formatNumber(r/1048576,2,".","")+" MiB":r>=1024?r=oe.formatNumber(r/1024,0)+" KiB":r=oe.formatNumber(r,0)+" bytes",r};oe.bytesFromIP=function(r){return r.indexOf(".")!==-1?oe.bytesFromIPv4(r):r.indexOf(":")!==-1?oe.bytesFromIPv6(r):null};oe.bytesFromIPv4=function(r){if(r=r.split("."),r.length!==4)return null;for(var e=oe.createBuffer(),t=0;t<r.length;++t){var i=parseInt(r[t],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};oe.bytesFromIPv6=function(r){var e=0;r=r.split(":").filter(function(o){return o.length===0&&++e,!0});for(var t=(8-r.length+e)*2,i=oe.createBuffer(),n=0;n<8;++n){if(!r[n]||r[n].length===0){i.fillWithByte(0,t),t=0;continue}var s=oe.hexToBytes(r[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};oe.bytesToIP=function(r){return r.length===4?oe.bytesToIPv4(r):r.length===16?oe.bytesToIPv6(r):null};oe.bytesToIPv4=function(r){if(r.length!==4)return null;for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t));return e.join(".")};oe.bytesToIPv6=function(r){if(r.length!==16)return null;for(var e=[],t=[],i=0,n=0;n<r.length;n+=2){for(var s=oe.bytesToHex(r[n]+r[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=t[t.length-1],a=e.length;!o||a!==o.end+1?t.push({start:a,end:a}):(o.end=a,o.end-o.start>t[i].end-t[i].start&&(i=t.length-1))}e.push(s)}if(t.length>0){var c=t[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};oe.estimateCores=function(r,e){if(typeof r=="function"&&(e=r,r={}),r=r||{},"cores"in oe&&!r.update)return e(null,oe.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return oe.cores=navigator.hardwareConcurrency,e(null,oe.cores);if(typeof Worker=="undefined")return oe.cores=1,e(null,oe.cores);if(typeof Blob=="undefined")return oe.cores=2,e(null,oe.cores);var t=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(f,h){return f+h},0)/o.length);return oe.cores=Math.max(1,u),URL.revokeObjectURL(t),e(null,oe.cores)}n(c,function(f,h){o.push(s(c,h)),i(o,a-1,c)})}function n(o,a){for(var c=[],u=[],f=0;f<o;++f){var h=new Worker(t);h.addEventListener("message",function(d){if(u.push(d.data),u.length===o){for(var y=0;y<o;++y)c[y].terminate();a(null,u)}}),c.push(h)}for(var f=0;f<o;++f)c[f].postMessage(f)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var f=a[u],h=c[u]=[],d=0;d<o;++d)if(u!==d){var y=a[d];(f.st>y.st&&f.st<y.et||y.st>f.st&&y.st<f.et)&&h.push(d)}return c.reduce(function(g,m){return Math.max(g,m.length)},0)}}});var Lh=p((lyt,EN)=>{l();var oy=bt();oy.pki=oy.pki||{};var LS=EN.exports=oy.pki.oids=oy.oids=oy.oids||{};function Te(r,e){LS[r]=e,LS[e]=r}function rr(r,e){LS[r]=e}Te("1.2.840.113549.1.1.1","rsaEncryption");Te("1.2.840.113549.1.1.4","md5WithRSAEncryption");Te("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Te("1.2.840.113549.1.1.7","RSAES-OAEP");Te("1.2.840.113549.1.1.8","mgf1");Te("1.2.840.113549.1.1.9","pSpecified");Te("1.2.840.113549.1.1.10","RSASSA-PSS");Te("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Te("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Te("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Te("1.3.101.112","EdDSA25519");Te("1.2.840.10040.4.3","dsa-with-sha1");Te("1.3.14.3.2.7","desCBC");Te("1.3.14.3.2.26","sha1");Te("2.16.840.1.101.3.4.2.1","sha256");Te("2.16.840.1.101.3.4.2.2","sha384");Te("2.16.840.1.101.3.4.2.3","sha512");Te("1.2.840.113549.2.5","md5");Te("1.2.840.113549.1.7.1","data");Te("1.2.840.113549.1.7.2","signedData");Te("1.2.840.113549.1.7.3","envelopedData");Te("1.2.840.113549.1.7.4","signedAndEnvelopedData");Te("1.2.840.113549.1.7.5","digestedData");Te("1.2.840.113549.1.7.6","encryptedData");Te("1.2.840.113549.1.9.1","emailAddress");Te("1.2.840.113549.1.9.2","unstructuredName");Te("1.2.840.113549.1.9.3","contentType");Te("1.2.840.113549.1.9.4","messageDigest");Te("1.2.840.113549.1.9.5","signingTime");Te("1.2.840.113549.1.9.6","counterSignature");Te("1.2.840.113549.1.9.7","challengePassword");Te("1.2.840.113549.1.9.8","unstructuredAddress");Te("1.2.840.113549.1.9.14","extensionRequest");Te("1.2.840.113549.1.9.20","friendlyName");Te("1.2.840.113549.1.9.21","localKeyId");Te("1.2.840.113549.1.9.22.1","x509Certificate");Te("1.2.840.113549.1.12.10.1.1","keyBag");Te("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Te("1.2.840.113549.1.12.10.1.3","certBag");Te("1.2.840.113549.1.12.10.1.4","crlBag");Te("1.2.840.113549.1.12.10.1.5","secretBag");Te("1.2.840.113549.1.12.10.1.6","safeContentsBag");Te("1.2.840.113549.1.5.13","pkcs5PBES2");Te("1.2.840.113549.1.5.12","pkcs5PBKDF2");Te("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Te("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Te("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Te("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Te("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Te("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Te("1.2.840.113549.2.7","hmacWithSHA1");Te("1.2.840.113549.2.8","hmacWithSHA224");Te("1.2.840.113549.2.9","hmacWithSHA256");Te("1.2.840.113549.2.10","hmacWithSHA384");Te("1.2.840.113549.2.11","hmacWithSHA512");Te("1.2.840.113549.3.7","des-EDE3-CBC");Te("2.16.840.1.101.3.4.1.2","aes128-CBC");Te("2.16.840.1.101.3.4.1.22","aes192-CBC");Te("2.16.840.1.101.3.4.1.42","aes256-CBC");Te("2.5.4.3","commonName");Te("2.5.4.5","serialName");Te("2.5.4.6","countryName");Te("2.5.4.7","localityName");Te("2.5.4.8","stateOrProvinceName");Te("2.5.4.9","streetAddress");Te("2.5.4.10","organizationName");Te("2.5.4.11","organizationalUnitName");Te("2.5.4.13","description");Te("2.5.4.15","businessCategory");Te("2.5.4.17","postalCode");Te("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Te("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Te("2.16.840.1.113730.1.1","nsCertType");Te("2.16.840.1.113730.1.13","nsComment");rr("2.5.29.1","authorityKeyIdentifier");rr("2.5.29.2","keyAttributes");rr("2.5.29.3","certificatePolicies");rr("2.5.29.4","keyUsageRestriction");rr("2.5.29.5","policyMapping");rr("2.5.29.6","subtreesConstraint");rr("2.5.29.7","subjectAltName");rr("2.5.29.8","issuerAltName");rr("2.5.29.9","subjectDirectoryAttributes");rr("2.5.29.10","basicConstraints");rr("2.5.29.11","nameConstraints");rr("2.5.29.12","policyConstraints");rr("2.5.29.13","basicConstraints");Te("2.5.29.14","subjectKeyIdentifier");Te("2.5.29.15","keyUsage");rr("2.5.29.16","privateKeyUsagePeriod");Te("2.5.29.17","subjectAltName");Te("2.5.29.18","issuerAltName");Te("2.5.29.19","basicConstraints");rr("2.5.29.20","cRLNumber");rr("2.5.29.21","cRLReason");rr("2.5.29.22","expirationDate");rr("2.5.29.23","instructionCode");rr("2.5.29.24","invalidityDate");rr("2.5.29.25","cRLDistributionPoints");rr("2.5.29.26","issuingDistributionPoint");rr("2.5.29.27","deltaCRLIndicator");rr("2.5.29.28","issuingDistributionPoint");rr("2.5.29.29","certificateIssuer");rr("2.5.29.30","nameConstraints");Te("2.5.29.31","cRLDistributionPoints");Te("2.5.29.32","certificatePolicies");rr("2.5.29.33","policyMappings");rr("2.5.29.34","policyConstraints");Te("2.5.29.35","authorityKeyIdentifier");rr("2.5.29.36","policyConstraints");Te("2.5.29.37","extKeyUsage");rr("2.5.29.46","freshestCRL");rr("2.5.29.54","inhibitAnyPolicy");Te("1.3.6.1.4.1.11129.2.4.2","timestampList");Te("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Te("1.3.6.1.5.5.7.3.1","serverAuth");Te("1.3.6.1.5.5.7.3.2","clientAuth");Te("1.3.6.1.5.5.7.3.3","codeSigning");Te("1.3.6.1.5.5.7.3.4","emailProtection");Te("1.3.6.1.5.5.7.3.8","timeStamping")});var Pc=p((hyt,SN)=>{l();var Ur=bt();yr();Lh();var Ue=SN.exports=Ur.asn1=Ur.asn1||{};Ue.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Ue.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Ue.create=function(r,e,t,i,n){if(Ur.util.isArray(i)){for(var s=[],o=0;o<i.length;++o)i[o]!==void 0&&s.push(i[o]);i=s}var a={tagClass:r,type:e,constructed:t,composed:t||Ur.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(a.bitStringContents=n.bitStringContents,a.original=Ue.copy(a)),a};Ue.copy=function(r,e){var t;if(Ur.util.isArray(r)){t=[];for(var i=0;i<r.length;++i)t.push(Ue.copy(r[i],e));return t}return typeof r=="string"?r:(t={tagClass:r.tagClass,type:r.type,constructed:r.constructed,composed:r.composed,value:Ue.copy(r.value,e)},e&&!e.excludeBitStringContents&&(t.bitStringContents=r.bitStringContents),t)};Ue.equals=function(r,e,t){if(Ur.util.isArray(r)){if(!Ur.util.isArray(e)||r.length!==e.length)return!1;for(var i=0;i<r.length;++i)if(!Ue.equals(r[i],e[i]))return!1;return!0}if(typeof r!=typeof e)return!1;if(typeof r=="string")return r===e;var n=r.tagClass===e.tagClass&&r.type===e.type&&r.constructed===e.constructed&&r.composed===e.composed&&Ue.equals(r.value,e.value);return t&&t.includeBitStringContents&&(n=n&&r.bitStringContents===e.bitStringContents),n};Ue.getBerValueLength=function(r){var e=r.getByte();if(e!==128){var t,i=e&128;return i?t=r.getInt((e&127)<<3):t=e,t}};function ay(r,e,t){if(t>e){var i=new Error("Too few bytes to parse DER.");throw i.available=r.length(),i.remaining=e,i.requested=t,i}}var QSe=function(r,e){var t=r.getByte();if(e--,t!==128){var i,n=t&128;if(!n)i=t;else{var s=t&127;ay(r,e,s),i=r.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};Ue.fromDer=function(r,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof r=="string"&&(r=Ur.util.createBuffer(r)),om(r,r.length(),0,e)};function om(r,e,t,i){var n;ay(r,e,2);var s=r.getByte();e--;var o=s&192,a=s&31;n=r.length();var c=QSe(r,e);if(e-=n-r.length(),c!==void 0&&c>e){if(i.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=r.length(),u.remaining=e,u.requested=c,u}c=e}var f,h,d=(s&32)==32;if(d)if(f=[],c===void 0)for(;;){if(ay(r,e,2),r.bytes(2)===String.fromCharCode(0,0)){r.getBytes(2),e-=2;break}n=r.length(),f.push(om(r,e,t+1,i)),e-=n-r.length()}else for(;c>0;)n=r.length(),f.push(om(r,c,t+1,i)),e-=n-r.length(),c-=n-r.length();if(f===void 0&&o===Ue.Class.UNIVERSAL&&a===Ue.Type.BITSTRING&&(h=r.bytes(c)),f===void 0&&i.decodeBitStrings&&o===Ue.Class.UNIVERSAL&&a===Ue.Type.BITSTRING&&c>1){var y=r.read,g=e,m=0;if(a===Ue.Type.BITSTRING&&(ay(r,e,1),m=r.getByte(),e--),m===0)try{n=r.length();var x={verbose:i.verbose,strict:!0,decodeBitStrings:!0},_=om(r,e,t+1,x),P=n-r.length();e-=P,a==Ue.Type.BITSTRING&&P++;var q=_.tagClass;P===c&&(q===Ue.Class.UNIVERSAL||q===Ue.Class.CONTEXT_SPECIFIC)&&(f=[_])}catch(W){}f===void 0&&(r.read=y,e=g)}if(f===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Ue.Type.BMPSTRING)for(f="";c>0;c-=2)ay(r,e,2),f+=String.fromCharCode(r.getInt16()),e-=2;else f=r.getBytes(c)}var X=h===void 0?null:{bitStringContents:h};return Ue.create(o,a,d,f,X)}Ue.toDer=function(r){var e=Ur.util.createBuffer(),t=r.tagClass|r.type,i=Ur.util.createBuffer(),n=!1;if("bitStringContents"in r&&(n=!0,r.original&&(n=Ue.equals(r,r.original))),n)i.putBytes(r.bitStringContents);else if(r.composed){r.constructed?t|=32:i.putByte(0);for(var s=0;s<r.value.length;++s)r.value[s]!==void 0&&i.putBuffer(Ue.toDer(r.value[s]))}else if(r.type===Ue.Type.BMPSTRING)for(var s=0;s<r.value.length;++s)i.putInt16(r.value.charCodeAt(s));else r.type===Ue.Type.INTEGER&&r.value.length>1&&(r.value.charCodeAt(0)===0&&(r.value.charCodeAt(1)&128)==0||r.value.charCodeAt(0)===255&&(r.value.charCodeAt(1)&128)==128)?i.putBytes(r.value.substr(1)):i.putBytes(r.value);if(e.putByte(t),i.length()<=127)e.putByte(i.length()&127);else{var o=i.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(i),e};Ue.oidToDer=function(r){var e=r.split("."),t=Ur.util.createBuffer();t.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,o,a=2;a<e.length;++a){i=!0,n=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,i||(o|=128),n.push(o),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)t.putByte(n[c])}return t};Ue.derToOid=function(r){var e;typeof r=="string"&&(r=Ur.util.createBuffer(r));var t=r.getByte();e=Math.floor(t/40)+"."+t%40;for(var i=0;r.length()>0;)t=r.getByte(),i=i<<7,t&128?i+=t&127:(e+="."+(i+t),i=0);return e};Ue.utcTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,2),10);t=t>=50?1900+t:2e3+t;var i=parseInt(r.substr(2,2),10)-1,n=parseInt(r.substr(4,2),10),s=parseInt(r.substr(6,2),10),o=parseInt(r.substr(8,2),10),a=0;if(r.length>11){var c=r.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(r.substr(10,2),10),u+=2)}if(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,0),u&&(c=r.charAt(u),c==="+"||c==="-")){var f=parseInt(r.substr(u+1,2),10),h=parseInt(r.substr(u+4,2),10),d=f*60+h;d*=6e4,c==="+"?e.setTime(+e-d):e.setTime(+e+d)}return e};Ue.generalizedTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,4),10),i=parseInt(r.substr(4,2),10)-1,n=parseInt(r.substr(6,2),10),s=parseInt(r.substr(8,2),10),o=parseInt(r.substr(10,2),10),a=parseInt(r.substr(12,2),10),c=0,u=0,f=!1;r.charAt(r.length-1)==="Z"&&(f=!0);var h=r.length-5,d=r.charAt(h);if(d==="+"||d==="-"){var y=parseInt(r.substr(h+1,2),10),g=parseInt(r.substr(h+4,2),10);u=y*60+g,u*=6e4,d==="+"&&(u*=-1),f=!0}return r.charAt(14)==="."&&(c=parseFloat(r.substr(14),10)*1e3),f?(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(t,i,n),e.setHours(s,o,a,c)),e};Ue.dateToUtcTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push((""+r.getUTCFullYear()).substr(2)),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Ue.dateToGeneralizedTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push(""+r.getUTCFullYear()),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Ue.integerToDer=function(r){var e=Ur.util.createBuffer();if(r>=-128&&r<128)return e.putSignedInt(r,8);if(r>=-32768&&r<32768)return e.putSignedInt(r,16);if(r>=-8388608&&r<8388608)return e.putSignedInt(r,24);if(r>=-2147483648&&r<2147483648)return e.putSignedInt(r,32);var t=new Error("Integer too large; max is 32-bits.");throw t.integer=r,t};Ue.derToInteger=function(r){typeof r=="string"&&(r=Ur.util.createBuffer(r));var e=r.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return r.getSignedInt(e)};Ue.validate=function(r,e,t,i){var n=!1;if((r.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(r.type===e.type||typeof e.type=="undefined"))if(r.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&Ur.util.isArray(e.value))for(var s=0,o=0;n&&o<e.value.length;++o)n=e.value[o].optional||!1,r.value[s]&&(n=Ue.validate(r.value[s],e.value[o],t,i),n?++s:e.value[o].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+r.value.length+'"');if(n&&t&&(e.capture&&(t[e.capture]=r.value),e.captureAsn1&&(t[e.captureAsn1]=r),e.captureBitStringContents&&"bitStringContents"in r&&(t[e.captureBitStringContents]=r.bitStringContents),e.captureBitStringValue&&"bitStringContents"in r)){var a;if(r.bitStringContents.length<2)t[e.captureBitStringValue]="";else{var c=r.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");t[e.captureBitStringValue]=r.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+r.constructed+'"');else i&&(r.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+r.tagClass+'"'),r.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+r.type+'"'));return n};var xN=/[^\\u0000-\\u00ff]/;Ue.prettyPrint=function(r,e,t){var i="";e=e||0,t=t||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*t;++s)n+=" ";switch(i+=n+"Tag: ",r.tagClass){case Ue.Class.UNIVERSAL:i+="Universal:";break;case Ue.Class.APPLICATION:i+="Application:";break;case Ue.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case Ue.Class.PRIVATE:i+="Private:";break}if(r.tagClass===Ue.Class.UNIVERSAL)switch(i+=r.type,r.type){case Ue.Type.NONE:i+=" (None)";break;case Ue.Type.BOOLEAN:i+=" (Boolean)";break;case Ue.Type.INTEGER:i+=" (Integer)";break;case Ue.Type.BITSTRING:i+=" (Bit string)";break;case Ue.Type.OCTETSTRING:i+=" (Octet string)";break;case Ue.Type.NULL:i+=" (Null)";break;case Ue.Type.OID:i+=" (Object Identifier)";break;case Ue.Type.ODESC:i+=" (Object Descriptor)";break;case Ue.Type.EXTERNAL:i+=" (External or Instance of)";break;case Ue.Type.REAL:i+=" (Real)";break;case Ue.Type.ENUMERATED:i+=" (Enumerated)";break;case Ue.Type.EMBEDDED:i+=" (Embedded PDV)";break;case Ue.Type.UTF8:i+=" (UTF8)";break;case Ue.Type.ROID:i+=" (Relative Object Identifier)";break;case Ue.Type.SEQUENCE:i+=" (Sequence)";break;case Ue.Type.SET:i+=" (Set)";break;case Ue.Type.PRINTABLESTRING:i+=" (Printable String)";break;case Ue.Type.IA5String:i+=" (IA5String (ASCII))";break;case Ue.Type.UTCTIME:i+=" (UTC time)";break;case Ue.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case Ue.Type.BMPSTRING:i+=" (BMP String)";break}else i+=r.type;if(i+=`
`,i+=n+"Constructed: "+r.constructed+`
`,r.composed){for(var o=0,a="",s=0;s<r.value.length;++s)r.value[s]!==void 0&&(o+=1,a+=Ue.prettyPrint(r.value[s],e+1,t),s+1<r.value.length&&(a+=","));i+=n+"Sub values: "+o+a}else{if(i+=n+"Value: ",r.type===Ue.Type.OID){var c=Ue.derToOid(r.value);i+=c,Ur.pki&&Ur.pki.oids&&c in Ur.pki.oids&&(i+=" ("+Ur.pki.oids[c]+") ")}if(r.type===Ue.Type.INTEGER)try{i+=Ue.derToInteger(r.value)}catch(f){i+="0x"+Ur.util.bytesToHex(r.value)}else if(r.type===Ue.Type.BITSTRING){if(r.value.length>1?i+="0x"+Ur.util.bytesToHex(r.value.slice(1)):i+="(none)",r.value.length>0){var u=r.value.charCodeAt(0);u==1?i+=" (1 unused bit shown)":u>1&&(i+=" ("+u+" unused bits shown)")}}else r.type===Ue.Type.OCTETSTRING?(xN.test(r.value)||(i+="("+r.value+") "),i+="0x"+Ur.util.bytesToHex(r.value)):r.type===Ue.Type.UTF8?i+=Ur.util.decodeUtf8(r.value):r.type===Ue.Type.PRINTABLESTRING||r.type===Ue.Type.IA5String?i+=r.value:xN.test(r.value)?i+="0x"+Ur.util.bytesToHex(r.value):r.value.length===0?i+="[null]":i+=r.value}return i}});var US=p((dyt,AN)=>{l();var qi=bt();yr();AN.exports=qi.cipher=qi.cipher||{};qi.cipher.algorithms=qi.cipher.algorithms||{};qi.cipher.createCipher=function(r,e){var t=r;if(typeof t=="string"&&(t=qi.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new qi.cipher.BlockCipher({algorithm:t,key:e,decrypt:!1})};qi.cipher.createDecipher=function(r,e){var t=r;if(typeof t=="string"&&(t=qi.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new qi.cipher.BlockCipher({algorithm:t,key:e,decrypt:!0})};qi.cipher.registerAlgorithm=function(r,e){r=r.toUpperCase(),qi.cipher.algorithms[r]=e};qi.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in qi.cipher.algorithms?qi.cipher.algorithms[r]:null};var FS=qi.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};FS.prototype.start=function(r){r=r||{};var e={};for(var t in r)e[t]=r[t];e.decrypt=this._decrypt,this._finish=!1,this._input=qi.util.createBuffer(),this.output=r.output||qi.util.createBuffer(),this.mode.start(e)};FS.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};FS.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(t){return r(this.blockSize,t,!1)},this.mode.unpad=function(t){return r(this.blockSize,t,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var jS=p((pyt,IN)=>{l();var Mi=bt();yr();Mi.cipher=Mi.cipher||{};var At=IN.exports=Mi.cipher.modes=Mi.cipher.modes||{};At.ecb=function(r){r=r||{},this.name="ECB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};At.ecb.prototype.start=function(r){};At.ecb.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};At.ecb.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};At.ecb.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};At.ecb.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};At.cbc=function(r){r=r||{},this.name="CBC",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};At.cbc.prototype.start=function(r){if(r.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in r)this._iv=am(r.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};At.cbc.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};At.cbc.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};At.cbc.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};At.cbc.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};At.cfb=function(r){r=r||{},this.name="CFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Mi.util.createBuffer(),this._partialBytes=0};At.cfb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=am(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};At.cfb.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};At.cfb.prototype.decrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};At.ofb=function(r){r=r||{},this.name="OFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Mi.util.createBuffer(),this._partialBytes=0};At.ofb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=am(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};At.ofb.prototype.encrypt=function(r,e,t){var i=r.length();if(r.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};At.ofb.prototype.decrypt=At.ofb.prototype.encrypt;At.ctr=function(r){r=r||{},this.name="CTR",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Mi.util.createBuffer(),this._partialBytes=0};At.ctr.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=am(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};At.ctr.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0&&(r.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}cm(this._inBlock)};At.ctr.prototype.decrypt=At.ctr.prototype.encrypt;At.gcm=function(r){r=r||{},this.name="GCM",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Mi.util.createBuffer(),this._partialBytes=0,this._R=3774873600};At.gcm.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");var e=Mi.util.createBuffer(r.iv);this._cipherLength=0;var t;if("additionalData"in r?t=Mi.util.createBuffer(r.additionalData):t=Mi.util.createBuffer(),"tagLength"in r?this._tagLength=r.tagLength:this._tagLength=128,this._tag=null,r.decrypt&&(this._tag=Mi.util.createBuffer(r.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(KS(i*8)))}this._inBlock=this._j0.slice(0),cm(this._inBlock),this._partialBytes=0,t=Mi.util.createBuffer(t),this._aDataLength=KS(t.length()*8);var n=t.length()%this.blockSize;for(n&&t.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])};At.gcm.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=r.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s<=0||t){if(t){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return r.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),cm(this._inBlock)};At.gcm.prototype.decrypt=function(r,e,t){var i=r.length();if(i<this.blockSize&&!(t&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),cm(this._inBlock),this._hashBlock[0]=r.getInt32(),this._hashBlock[1]=r.getInt32(),this._hashBlock[2]=r.getInt32(),this._hashBlock[3]=r.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};At.gcm.prototype.afterFinish=function(r,e){var t=!0;e.decrypt&&e.overflow&&r.truncate(this.blockSize-e.overflow),this.tag=Mi.util.createBuffer();var i=this._aDataLength.concat(KS(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t};At.gcm.prototype.multiply=function(r,e){for(var t=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=r[n/32|0]&1<<31-n%32;s&&(t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]),this.pow(i,i)}return t};At.gcm.prototype.pow=function(r,e){for(var t=r[3]&1,i=3;i>0;--i)e[i]=r[i]>>>1|(r[i-1]&1)<<31;e[0]=r[0]>>>1,t&&(e[0]^=this._R)};At.gcm.prototype.tableMultiply=function(r){for(var e=[0,0,0,0],t=0;t<32;++t){var i=t/8|0,n=r[i]>>>(7-t%8)*4&15,s=this._m[t][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};At.gcm.prototype.ghash=function(r,e,t){return e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3],this.tableMultiply(e)};At.gcm.prototype.generateHashTable=function(r,e){for(var t=8/e,i=4*t,n=16*t,s=new Array(n),o=0;o<n;++o){var a=[0,0,0,0],c=o/i|0,u=(i-1-o%i)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,r),e)}return s};At.gcm.prototype.generateSubHashTable=function(r,e){var t=1<<e,i=t>>>1,n=new Array(t);n[i]=r.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var o=1;o<s;++o){var a=n[s],c=n[o];n[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<t;++s){var u=n[s^i];n[s]=[r[0]^u[0],r[1]^u[1],r[2]^u[2],r[3]^u[3]]}return n};function am(r,e){if(typeof r=="string"&&(r=Mi.util.createBuffer(r)),Mi.util.isArray(r)&&r.length>4){var t=r;r=Mi.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}if(r.length()<e)throw new Error("Invalid IV length; got "+r.length()+" bytes and expected "+e+" bytes.");if(!Mi.util.isArray(r)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(r.getInt32());r=n}return r}function cm(r){r[r.length-1]=r[r.length-1]+1&4294967295}function KS(r){return[r/4294967296|0,r&4294967295]}});var Kh=p((yyt,TN)=>{l();var _r=bt();US();jS();yr();TN.exports=_r.aes=_r.aes||{};_r.aes.startEncrypting=function(r,e,t,i){var n=um({key:r,output:t,decrypt:!1,mode:i});return n.start(e),n};_r.aes.createEncryptionCipher=function(r,e){return um({key:r,output:null,decrypt:!1,mode:e})};_r.aes.startDecrypting=function(r,e,t,i){var n=um({key:r,output:t,decrypt:!0,mode:i});return n.start(e),n};_r.aes.createDecryptionCipher=function(r,e){return um({key:r,output:null,decrypt:!0,mode:e})};_r.aes.Algorithm=function(r,e){VS||RN();var t=this;t.name=r,t.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return zS(t._w,i,n,!1)},decrypt:function(i,n){return zS(t._w,i,n,!0)}}}),t._init=!1};_r.aes.Algorithm.prototype.initialize=function(r){if(!this._init){var e=r.key,t;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=_r.util.createBuffer(e);else if(_r.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){t=e,e=_r.util.createBuffer();for(var i=0;i<t.length;++i)e.putByte(t[i])}if(!_r.util.isArray(e)){t=e,e=[];var n=t.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(t.getInt32())}}if(!_r.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=kN(e,r.decrypt&&!o),this._init=!0}};_r.aes._expandKey=function(r,e){return VS||RN(),kN(r,e)};_r.aes._updateBlock=zS;Fh("AES-ECB",_r.cipher.modes.ecb);Fh("AES-CBC",_r.cipher.modes.cbc);Fh("AES-CFB",_r.cipher.modes.cfb);Fh("AES-OFB",_r.cipher.modes.ofb);Fh("AES-CTR",_r.cipher.modes.ctr);Fh("AES-GCM",_r.cipher.modes.gcm);function Fh(r,e){var t=function(){return new _r.aes.Algorithm(r,e)};_r.cipher.registerAlgorithm(r,t)}var VS=!1,Uh=4,Tn,HS,CN,Gf,Oo;function RN(){VS=!0,CN=[0,1,2,4,8,16,32,64,128,27,54];for(var r=new Array(256),e=0;e<128;++e)r[e]=e<<1,r[e+128]=e+128<<1^283;Tn=new Array(256),HS=new Array(256),Gf=new Array(4),Oo=new Array(4);for(var e=0;e<4;++e)Gf[e]=new Array(256),Oo[e]=new Array(256);for(var t=0,i=0,n,s,o,a,c,u,f,e=0;e<256;++e){a=i^i<<1^i<<2^i<<3^i<<4,a=a>>8^a&255^99,Tn[t]=a,HS[a]=t,c=r[a],n=r[t],s=r[n],o=r[s],u=c<<24^a<<16^a<<8^(a^c),f=(n^s^o)<<24^(t^o)<<16^(t^s^o)<<8^(t^n^o);for(var h=0;h<4;++h)Gf[h][t]=u,Oo[h][a]=f,u=u<<24|u>>>8,f=f<<24|f>>>8;t===0?t=i=1:(t=n^r[r[r[n^o]]],i^=r[r[i]])}}function kN(r,e){for(var t=r.slice(0),i,n=1,s=t.length,o=s+6+1,a=Uh*o,c=s;c<a;++c)i=t[c-1],c%s==0?(i=Tn[i>>>16&255]<<24^Tn[i>>>8&255]<<16^Tn[i&255]<<8^Tn[i>>>24]^CN[n]<<24,n++):s>6&&c%s==4&&(i=Tn[i>>>24]<<24^Tn[i>>>16&255]<<16^Tn[i>>>8&255]<<8^Tn[i&255]),t[c]=t[c-s]^i;if(e){var u,f=Oo[0],h=Oo[1],d=Oo[2],y=Oo[3],g=t.slice(0);a=t.length;for(var c=0,m=a-Uh;c<a;c+=Uh,m-=Uh)if(c===0||c===a-Uh)g[c]=t[m],g[c+1]=t[m+3],g[c+2]=t[m+2],g[c+3]=t[m+1];else for(var x=0;x<Uh;++x)u=t[m+x],g[c+(3&-x)]=f[Tn[u>>>24]]^h[Tn[u>>>16&255]]^d[Tn[u>>>8&255]]^y[Tn[u&255]];t=g}return t}function zS(r,e,t,i){var n=r.length/4-1,s,o,a,c,u;i?(s=Oo[0],o=Oo[1],a=Oo[2],c=Oo[3],u=HS):(s=Gf[0],o=Gf[1],a=Gf[2],c=Gf[3],u=Tn);var f,h,d,y,g,m,x;f=e[0]^r[0],h=e[i?3:1]^r[1],d=e[2]^r[2],y=e[i?1:3]^r[3];for(var _=3,P=1;P<n;++P)g=s[f>>>24]^o[h>>>16&255]^a[d>>>8&255]^c[y&255]^r[++_],m=s[h>>>24]^o[d>>>16&255]^a[y>>>8&255]^c[f&255]^r[++_],x=s[d>>>24]^o[y>>>16&255]^a[f>>>8&255]^c[h&255]^r[++_],y=s[y>>>24]^o[f>>>16&255]^a[h>>>8&255]^c[d&255]^r[++_],f=g,h=m,d=x;t[0]=u[f>>>24]<<24^u[h>>>16&255]<<16^u[d>>>8&255]<<8^u[y&255]^r[++_],t[i?3:1]=u[h>>>24]<<24^u[d>>>16&255]<<16^u[y>>>8&255]<<8^u[f&255]^r[++_],t[2]=u[d>>>24]<<24^u[y>>>16&255]<<16^u[f>>>8&255]<<8^u[h&255]^r[++_],t[i?1:3]=u[y>>>24]<<24^u[f>>>16&255]<<16^u[h>>>8&255]<<8^u[d&255]^r[++_]}function um(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="AES-"+e,i;r.decrypt?i=_r.cipher.createDecipher(t,r.key):i=_r.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof _r.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var lm=p((gyt,PN)=>{l();var Kr=bt();US();jS();yr();PN.exports=Kr.des=Kr.des||{};Kr.des.startEncrypting=function(r,e,t,i){var n=fm({key:r,output:t,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Kr.des.createEncryptionCipher=function(r,e){return fm({key:r,output:null,decrypt:!1,mode:e})};Kr.des.startDecrypting=function(r,e,t,i){var n=fm({key:r,output:t,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Kr.des.createDecryptionCipher=function(r,e){return fm({key:r,output:null,decrypt:!0,mode:e})};Kr.des.Algorithm=function(r,e){var t=this;t.name=r,t.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return ON(t._keys,i,n,!1)},decrypt:function(i,n){return ON(t._keys,i,n,!0)}}}),t._init=!1};Kr.des.Algorithm.prototype.initialize=function(r){if(!this._init){var e=Kr.util.createBuffer(r.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=ZSe(e),this._init=!0}};xa("DES-ECB",Kr.cipher.modes.ecb);xa("DES-CBC",Kr.cipher.modes.cbc);xa("DES-CFB",Kr.cipher.modes.cfb);xa("DES-OFB",Kr.cipher.modes.ofb);xa("DES-CTR",Kr.cipher.modes.ctr);xa("3DES-ECB",Kr.cipher.modes.ecb);xa("3DES-CBC",Kr.cipher.modes.cbc);xa("3DES-CFB",Kr.cipher.modes.cfb);xa("3DES-OFB",Kr.cipher.modes.ofb);xa("3DES-CTR",Kr.cipher.modes.ctr);function xa(r,e){var t=function(){return new Kr.des.Algorithm(r,e)};Kr.cipher.registerAlgorithm(r,t)}var exe=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],txe=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],rxe=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],ixe=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],nxe=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],sxe=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],oxe=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],axe=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function ZSe(r){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=r.length()>8?3:1,x=[],_=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],P=0,q,X=0;X<m;X++){var W=r.getInt32(),z=r.getInt32();q=(W>>>4^z)&252645135,z^=q,W^=q<<4,q=(z>>>-16^W)&65535,W^=q,z^=q<<-16,q=(W>>>2^z)&858993459,z^=q,W^=q<<2,q=(z>>>-16^W)&65535,W^=q,z^=q<<-16,q=(W>>>1^z)&1431655765,z^=q,W^=q<<1,q=(z>>>8^W)&16711935,W^=q,z^=q<<8,q=(W>>>1^z)&1431655765,z^=q,W^=q<<1,q=W<<8|z>>>20&240,W=z<<24|z<<8&16711680|z>>>8&65280|z>>>24&240,z=q;for(var Z=0;Z<_.length;++Z){_[Z]?(W=W<<2|W>>>26,z=z<<2|z>>>26):(W=W<<1|W>>>27,z=z<<1|z>>>27),W&=-15,z&=-15;var ee=e[W>>>28]|t[W>>>24&15]|i[W>>>20&15]|n[W>>>16&15]|s[W>>>12&15]|o[W>>>8&15]|a[W>>>4&15],re=c[z>>>28]|u[z>>>24&15]|f[z>>>20&15]|h[z>>>16&15]|d[z>>>12&15]|y[z>>>8&15]|g[z>>>4&15];q=(re>>>16^ee)&65535,x[P++]=ee^q,x[P++]=re^q<<16}}return x}function ON(r,e,t,i){var n=r.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<n;u+=3){for(var f=s[u+1],h=s[u+2],d=s[u];d!=f;d+=h){var y=c^r[d],g=(c>>>4|c<<28)^r[d+1];o=a,a=c,c=o^(txe[y>>>24&63]|ixe[y>>>16&63]|sxe[y>>>8&63]|axe[y&63]|exe[g>>>24&63]|rxe[g>>>16&63]|nxe[g>>>8&63]|oxe[g&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,t[0]=a,t[1]=c}function fm(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="DES-"+e,i;r.decrypt?i=Kr.cipher.createDecipher(t,r.key):i=Kr.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof Kr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var ku=p((byt,BN)=>{l();var hm=bt();BN.exports=hm.md=hm.md||{};hm.md.algorithms=hm.md.algorithms||{}});var DN=p((myt,NN)=>{l();var Oc=bt();ku();yr();var cxe=NN.exports=Oc.hmac=Oc.hmac||{};cxe.create=function(){var r=null,e=null,t=null,i=null,n={};return n.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Oc.md.algorithms)e=Oc.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=r;else{if(typeof o=="string")o=Oc.util.createBuffer(o);else if(Oc.util.isArray(o)){var a=o;o=Oc.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),t=Oc.util.createBuffer(),i=Oc.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);t.putByte(54^a),i.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)t.putByte(54),i.putByte(92);r=o,t=t.bytes(),i=i.bytes()}e.start(),e.update(t)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var jh=p(()=>{l()});var GS=p((_yt,qN)=>{l();var Rn=bt();DN();ku();yr();var uxe=Rn.pkcs5=Rn.pkcs5||{},Bc;Rn.util.isNodejs&&!Rn.options.usePureJavaScript&&(Bc=jh());qN.exports=Rn.pbkdf2=uxe.pbkdf2=function(r,e,t,i,n,s){if(typeof n=="function"&&(s=n,n=null),Rn.util.isNodejs&&!Rn.options.usePureJavaScript&&Bc.pbkdf2&&(n===null||typeof n!="object")&&(Bc.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),r=Buffer.from(r,"binary"),e=Buffer.from(e,"binary"),s?Bc.pbkdf2Sync.length===4?Bc.pbkdf2(r,e,t,i,function(q,X){if(q)return s(q);s(null,X.toString("binary"))}):Bc.pbkdf2(r,e,t,i,n,function(q,X){if(q)return s(q);s(null,X.toString("binary"))}):Bc.pbkdf2Sync.length===4?Bc.pbkdf2Sync(r,e,t,i).toString("binary"):Bc.pbkdf2Sync(r,e,t,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in Rn.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=Rn.md[n].create()}var o=n.digestLength;if(i>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(i/o),u=i-(c-1)*o,f=Rn.hmac.create();f.start(n,r);var h="",d,y,g;if(!s){for(var m=1;m<=c;++m){f.start(null,null),f.update(e),f.update(Rn.util.int32ToBytes(m)),d=g=f.digest().getBytes();for(var x=2;x<=t;++x)f.start(null,null),f.update(g),y=f.digest().getBytes(),d=Rn.util.xorBytes(d,y,o),g=y;h+=m<c?d:d.substr(0,u)}return h}var m=1,x;function _(){if(m>c)return s(null,h);f.start(null,null),f.update(e),f.update(Rn.util.int32ToBytes(m)),d=g=f.digest().getBytes(),x=2,P()}function P(){if(x<=t)return f.start(null,null),f.update(g),y=f.digest().getBytes(),d=Rn.util.xorBytes(d,y,o),g=y,++x,Rn.util.setImmediate(P);h+=m<c?d:d.substr(0,u),++m,_()}_()}});var ym=p((Eyt,MN)=>{l();var dm=bt();yr();var LN=MN.exports=dm.pem=dm.pem||{};LN.encode=function(r,e){e=e||{};var t="-----BEGIN "+r.type+`-----\r
`,i;if(r.procType&&(i={name:"Proc-Type",values:[String(r.procType.version),r.procType.type]},t+=pm(i)),r.contentDomain&&(i={name:"Content-Domain",values:[r.contentDomain]},t+=pm(i)),r.dekInfo&&(i={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&i.values.push(r.dekInfo.parameters),t+=pm(i)),r.headers)for(var n=0;n<r.headers.length;++n)t+=pm(r.headers[n]);return r.procType&&(t+=`\r
`),t+=dm.util.encode64(r.body,e.maxline||64)+`\r
`,t+="-----END "+r.type+`-----\r
`,t};LN.decode=function(r){for(var e=[],t=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=t.exec(r),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:dm.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var a=s[2].split(n),c=0;s&&c<a.length;){for(var u=a[c].replace(/\s+$/,""),f=c+1;f<a.length;++f){var h=a[f];if(!/\s/.test(h[0]))break;u+=h,c=f}if(s=u.match(i),s){for(var d={name:s[1],values:[]},y=s[2].split(","),g=0;g<y.length;++g)d.values.push(fxe(y[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=y[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:y[0],parameters:y[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:y[0],type:y[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function pm(r){for(var e=r.name+": ",t=[],i=function(c,u){return" "+u},n=0;n<r.values.length;++n)t.push(r.values[n].replace(/^(\S+\r\n)/,i));e+=t.join(",")+`\r
`;for(var s=0,o=-1,n=0;n<e.length;++n,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=n-o-1,o=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(o=n);return e}function fxe(r){return r.replace(/^\s+/,"")}});var zN=p((Syt,FN)=>{l();var Aa=bt();ku();yr();var UN=FN.exports=Aa.sha256=Aa.sha256||{};Aa.md.sha256=Aa.md.algorithms.sha256=UN;UN.create=function(){KN||lxe();var r=null,e=Aa.util.createBuffer(),t=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Aa.util.createBuffer(),r={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Aa.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),jN(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Aa.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes($S.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,f=0;f<i.fullMessageLength.length-1;++f)a=i.fullMessageLength[f+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var h={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4,h5:r.h5,h6:r.h6,h7:r.h7};jN(h,t,n);var d=Aa.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d.putInt32(h.h5),d.putInt32(h.h6),d.putInt32(h.h7),d},i};var $S=null,KN=!1,VN=null;function lxe(){$S=String.fromCharCode(128),$S+=Aa.util.fillString(String.fromCharCode(0),64),VN=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],KN=!0}function jN(r,e,t){for(var i,n,s,o,a,c,u,f,h,d,y,g,m,x,_,P=t.length();P>=64;){for(u=0;u<16;++u)e[u]=t.getInt32();for(;u<64;++u)i=e[u-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[u-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[u]=i+e[u-7]+n+e[u-16]|0;for(f=r.h0,h=r.h1,d=r.h2,y=r.h3,g=r.h4,m=r.h5,x=r.h6,_=r.h7,u=0;u<64;++u)o=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),a=x^g&(m^x),s=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),c=f&h|d&(f^h),i=_+o+a+VN[u]+e[u],n=s+c,_=x,x=m,m=g,g=y+i>>>0,y=d,d=h,h=f,f=i+n>>>0;r.h0=r.h0+f|0,r.h1=r.h1+h|0,r.h2=r.h2+d|0,r.h3=r.h3+y|0,r.h4=r.h4+g|0,r.h5=r.h5+m|0,r.h6=r.h6+x|0,r.h7=r.h7+_|0,P-=64}}});var GN=p((xyt,HN)=>{l();var Ia=bt();yr();var gm=null;Ia.util.isNodejs&&!Ia.options.usePureJavaScript&&!process.versions["node-webkit"]&&(gm=jh());var hxe=HN.exports=Ia.prng=Ia.prng||{};hxe.create=function(r){for(var e={plugin:r,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},t=r.md,i=new Array(32),n=0;n<32;++n)i[n]=t.create();e.pools=i,e.pool=0,e.generate=function(u,f){if(!f)return e.generateSync(u);var h=e.plugin.cipher,d=e.plugin.increment,y=e.plugin.formatKey,g=e.plugin.formatSeed,m=Ia.util.createBuffer();e.key=null,x();function x(_){if(_)return f(_);if(m.length()>=u)return f(null,m.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Ia.util.nextTick(function(){s(x)});var P=h(e.key,e.seed);e.generated+=P.length,m.putBytes(P),e.key=y(h(e.key,d(e.seed))),e.seed=g(h(e.key,e.seed)),Ia.util.setImmediate(x)}},e.generateSync=function(u){var f=e.plugin.cipher,h=e.plugin.increment,d=e.plugin.formatKey,y=e.plugin.formatSeed;e.key=null;for(var g=Ia.util.createBuffer();g.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var m=f(e.key,e.seed);e.generated+=m.length,g.putBytes(m),e.key=d(f(e.key,h(e.seed))),e.seed=y(f(e.key,e.seed))}return g.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var f=32-e.pools[0].messageLength<<5;e.seedFile(f,function(h,d){if(h)return u(h);e.collect(d),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var f=1,h=0;h<32;++h)e.reseeds%f==0&&(u.update(e.pools[h].digest().getBytes()),e.pools[h].start()),f=f<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var d=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(d),e.generated=0}function c(u){var f=null,h=Ia.util.globalScope,d=h.crypto||h.msCrypto;d&&d.getRandomValues&&(f=function(W){return d.getRandomValues(W)});var y=Ia.util.createBuffer();if(f)for(;y.length()<u;){var g=Math.max(1,Math.min(u-y.length(),65536)/4),m=new Uint32Array(Math.floor(g));try{f(m);for(var x=0;x<m.length;++x)y.putInt32(m[x])}catch(W){if(!(typeof QuotaExceededError!="undefined"&&W instanceof QuotaExceededError))throw W}}if(y.length()<u)for(var _,P,q,X=Math.floor(Math.random()*65536);y.length()<u;){P=16807*(X&65535),_=16807*(X>>16),P+=(_&32767)<<16,P+=_>>15,P=(P&2147483647)+(P>>31),X=P&4294967295;for(var x=0;x<3;++x)q=X>>>(x<<3),q^=Math.floor(Math.random()*256),y.putByte(String.fromCharCode(q&255))}return y.getBytes(u)}return gm?(e.seedFile=function(u,f){gm.randomBytes(u,function(h,d){if(h)return f(h);f(null,d.toString())})},e.seedFileSync=function(u){return gm.randomBytes(u).toString()}):(e.seedFile=function(u,f){try{f(null,c(u))}catch(h){f(h)}},e.seedFileSync=c),e.collect=function(u){for(var f=u.length,h=0;h<f;++h)e.pools[e.pool].update(u.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,f){for(var h="",d=0;d<f;d+=8)h+=String.fromCharCode(u>>d&255);e.collect(h)},e.registerWorker=function(u){if(u===self)e.seedFile=function(h,d){function y(g){var m=g.data;m.forge&&m.forge.prng&&(self.removeEventListener("message",y),d(m.forge.prng.err,m.forge.prng.bytes))}self.addEventListener("message",y),self.postMessage({forge:{prng:{needed:h}}})};else{var f=function(h){var d=h.data;d.forge&&d.forge.prng&&e.seedFile(d.forge.prng.needed,function(y,g){u.postMessage({forge:{prng:{err:y,bytes:g}}})})};u.addEventListener("message",f)}},e}});var Cu=p((Ayt,WS)=>{l();var Li=bt();Kh();zN();GN();yr();(function(){if(Li.random&&Li.random.getBytes){WS.exports=Li.random;return}(function(r){var e={},t=new Array(4),i=Li.util.createBuffer();e.formatKey=function(h){var d=Li.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),Li.aes._expandKey(h,!1)},e.formatSeed=function(h){var d=Li.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),h},e.cipher=function(h,d){return Li.aes._updateBlock(h,d,t,!1),i.putInt32(t[0]),i.putInt32(t[1]),i.putInt32(t[2]),i.putInt32(t[3]),i.getBytes()},e.increment=function(h){return++h[3],h},e.md=Li.md.sha256;function n(){var h=Li.prng.create(e);return h.getBytes=function(d,y){return h.generate(d,y)},h.getBytesSync=function(d){return h.generate(d)},h}var s=n(),o=null,a=Li.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(h){return c.getRandomValues(h)}),Li.options.usePureJavaScript||!Li.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var f in navigator)try{typeof navigator[f]=="string"&&(u+=navigator[f])}catch(h){}s.collect(u),u=null}r&&(r().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),r().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Li.random)Li.random=s;else for(var f in s)Li.random[f]=s[f];Li.random.createInstance=n,WS.exports=Li.random})(typeof jQuery!="undefined"?jQuery:null)})()});var XN=p((Iyt,$N)=>{l();var $n=bt();yr();var YS=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],WN=[1,2,3,5],dxe=function(r,e){return r<<e&65535|(r&65535)>>16-e},pxe=function(r,e){return(r&65535)>>e|r<<16-e&65535};$N.exports=$n.rc2=$n.rc2||{};$n.rc2.expandKey=function(r,e){typeof r=="string"&&(r=$n.util.createBuffer(r)),e=e||128;var t=r,i=r.length(),n=e,s=Math.ceil(n/8),o=255>>(n&7),a;for(a=i;a<128;a++)t.putByte(YS[t.at(a-1)+t.at(a-i)&255]);for(t.setAt(128-s,YS[t.at(128-s)&o]),a=127-s;a>=0;a--)t.setAt(a,YS[t.at(a+1)^t.at(a+s)]);return t};var YN=function(r,e,t){var i=!1,n=null,s=null,o=null,a,c,u,f,h=[];for(r=$n.rc2.expandKey(r,e),u=0;u<64;u++)h.push(r.getInt16Le());t?(a=function(g){for(u=0;u<4;u++)g[u]+=h[f]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),g[u]=dxe(g[u],WN[u]),f++},c=function(g){for(u=0;u<4;u++)g[u]+=h[g[(u+3)%4]&63]}):(a=function(g){for(u=3;u>=0;u--)g[u]=pxe(g[u],WN[u]),g[u]-=h[f]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),f--},c=function(g){for(u=3;u>=0;u--)g[u]-=h[g[(u+3)%4]&63]});var d=function(g){var m=[];for(u=0;u<4;u++){var x=n.getInt16Le();o!==null&&(t?x^=o.getInt16Le():o.putInt16Le(x)),m.push(x&65535)}f=t?0:63;for(var _=0;_<g.length;_++)for(var P=0;P<g[_][0];P++)g[_][1](m);for(u=0;u<4;u++)o!==null&&(t?o.putInt16Le(m[u]):m[u]^=o.getInt16Le()),s.putInt16Le(m[u])},y=null;return y={start:function(g,m){g&&typeof g=="string"&&(g=$n.util.createBuffer(g)),i=!1,n=$n.util.createBuffer(),s=m||new $n.util.createBuffer,o=g,y.output=s},update:function(g){for(i||n.putBuffer(g);n.length()>=8;)d([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(g){var m=!0;if(t)if(g)m=g(8,n,!t);else{var x=n.length()===8?8:8-n.length();n.fillWithByte(x,x)}if(m&&(i=!0,y.update()),!t&&(m=n.length()===0,m))if(g)m=g(8,s,!t);else{var _=s.length(),P=s.at(_-1);P>_?m=!1:s.truncate(P)}return m}},y};$n.rc2.startEncrypting=function(r,e,t){var i=$n.rc2.createEncryptionCipher(r,128);return i.start(e,t),i};$n.rc2.createEncryptionCipher=function(r,e){return YN(r,e,!0)};$n.rc2.startDecrypting=function(r,e,t){var i=$n.rc2.createDecryptionCipher(r,128);return i.start(e,t),i};$n.rc2.createDecryptionCipher=function(r,e){return YN(r,e,!1)}});var uy=p((Tyt,JN)=>{l();var XS=bt();JN.exports=XS.jsbn=XS.jsbn||{};var Nc,yxe=244837814094590,QN=(yxe&16777215)==15715070;function Ee(r,e,t){this.data=[],r!=null&&(typeof r=="number"?this.fromNumber(r,e,t):e==null&&typeof r!="string"?this.fromString(r,256):this.fromString(r,e))}XS.jsbn.BigInteger=Ee;function Mt(){return new Ee(null)}function gxe(r,e,t,i,n,s){for(;--s>=0;){var o=e*this.data[r++]+t.data[i]+n;n=Math.floor(o/67108864),t.data[i++]=o&67108863}return n}function bxe(r,e,t,i,n,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[r]&32767,u=this.data[r++]>>15,f=a*c+u*o;c=o*c+((f&32767)<<15)+t.data[i]+(n&1073741823),n=(c>>>30)+(f>>>15)+a*u+(n>>>30),t.data[i++]=c&1073741823}return n}function ZN(r,e,t,i,n,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[r]&16383,u=this.data[r++]>>14,f=a*c+u*o;c=o*c+((f&16383)<<14)+t.data[i]+n,n=(c>>28)+(f>>14)+a*u,t.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(Ee.prototype.am=ZN,Nc=28):QN&&navigator.appName=="Microsoft Internet Explorer"?(Ee.prototype.am=bxe,Nc=30):QN&&navigator.appName!="Netscape"?(Ee.prototype.am=gxe,Nc=26):(Ee.prototype.am=ZN,Nc=28);Ee.prototype.DB=Nc;Ee.prototype.DM=(1<<Nc)-1;Ee.prototype.DV=1<<Nc;var JS=52;Ee.prototype.FV=Math.pow(2,JS);Ee.prototype.F1=JS-Nc;Ee.prototype.F2=2*Nc-JS;var mxe="0123456789abcdefghijklmnopqrstuvwxyz",bm=new Array,Vh,Fs;Vh="0".charCodeAt(0);for(Fs=0;Fs<=9;++Fs)bm[Vh++]=Fs;Vh="a".charCodeAt(0);for(Fs=10;Fs<36;++Fs)bm[Vh++]=Fs;Vh="A".charCodeAt(0);for(Fs=10;Fs<36;++Fs)bm[Vh++]=Fs;function eD(r){return mxe.charAt(r)}function tD(r,e){var t=bm[r.charCodeAt(e)];return t??-1}function vxe(r){for(var e=this.t-1;e>=0;--e)r.data[e]=this.data[e];r.t=this.t,r.s=this.s}function wxe(r){this.t=1,this.s=r<0?-1:0,r>0?this.data[0]=r:r<-1?this.data[0]=r+this.DV:this.t=0}function Pu(r){var e=Mt();return e.fromInt(r),e}function _xe(r,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(r,e);return}this.t=0,this.s=0;for(var i=r.length,n=!1,s=0;--i>=0;){var o=t==8?r[i]&255:tD(r,i);if(o<0){r.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=o:s+t>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=t,s>=this.DB&&(s-=this.DB)}t==8&&(r[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&Ee.ZERO.subTo(this,this)}function Exe(){for(var r=this.s&this.DM;this.t>0&&this.data[this.t-1]==r;)--this.t}function Sxe(r){if(this.s<0)return"-"+this.negate().toString(r);var e;if(r==16)e=4;else if(r==8)e=3;else if(r==2)e=1;else if(r==32)e=5;else if(r==4)e=2;else return this.toRadix(r);var t=(1<<e)-1,i,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this.data[o]>>a)>0&&(n=!0,s=eD(i));o>=0;)a<e?(i=(this.data[o]&(1<<a)-1)<<e-a,i|=this.data[--o]>>(a+=this.DB-e)):(i=this.data[o]>>(a-=e)&t,a<=0&&(a+=this.DB,--o)),i>0&&(n=!0),n&&(s+=eD(i));return n?s:"0"}function xxe(){var r=Mt();return Ee.ZERO.subTo(this,r),r}function Axe(){return this.s<0?this.negate():this}function Ixe(r){var e=this.s-r.s;if(e!=0)return e;var t=this.t;if(e=t-r.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this.data[t]-r.data[t])!=0)return e;return 0}function mm(r){var e=1,t;return(t=r>>>16)!=0&&(r=t,e+=16),(t=r>>8)!=0&&(r=t,e+=8),(t=r>>4)!=0&&(r=t,e+=4),(t=r>>2)!=0&&(r=t,e+=2),(t=r>>1)!=0&&(r=t,e+=1),e}function Txe(){return this.t<=0?0:this.DB*(this.t-1)+mm(this.data[this.t-1]^this.s&this.DM)}function Rxe(r,e){var t;for(t=this.t-1;t>=0;--t)e.data[t+r]=this.data[t];for(t=r-1;t>=0;--t)e.data[t]=0;e.t=this.t+r,e.s=this.s}function kxe(r,e){for(var t=r;t<this.t;++t)e.data[t-r]=this.data[t];e.t=Math.max(this.t-r,0),e.s=this.s}function Cxe(r,e){var t=r%this.DB,i=this.DB-t,n=(1<<i)-1,s=Math.floor(r/this.DB),o=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>i|o,o=(this.data[a]&n)<<t;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function Pxe(r,e){e.s=this.s;var t=Math.floor(r/this.DB);if(t>=this.t){e.t=0;return}var i=r%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[t]>>i;for(var o=t+1;o<this.t;++o)e.data[o-t-1]|=(this.data[o]&s)<<n,e.data[o-t]=this.data[o]>>i;i>0&&(e.data[this.t-t-1]|=(this.s&s)<<n),e.t=this.t-t,e.clamp()}function Oxe(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]-r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i-=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i-=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i-=r.s}e.s=i<0?-1:0,i<-1?e.data[t++]=this.DV+i:i>0&&(e.data[t++]=i),e.t=t,e.clamp()}function Bxe(r,e){var t=this.abs(),i=r.abs(),n=t.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+t.t]=t.am(0,i.data[n],e,n,0,t.t);e.s=0,e.clamp(),this.s!=r.s&&Ee.ZERO.subTo(e,e)}function Nxe(r){for(var e=this.abs(),t=r.t=2*e.t;--t>=0;)r.data[t]=0;for(t=0;t<e.t-1;++t){var i=e.am(t,e.data[t],r,2*t,0,1);(r.data[t+e.t]+=e.am(t+1,2*e.data[t],r,2*t+1,i,e.t-t-1))>=e.DV&&(r.data[t+e.t]-=e.DV,r.data[t+e.t+1]=1)}r.t>0&&(r.data[r.t-1]+=e.am(t,e.data[t],r,2*t,0,1)),r.s=0,r.clamp()}function Dxe(r,e,t){var i=r.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=Mt());var s=Mt(),o=this.s,a=r.s,c=this.DB-mm(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,t)):(i.copyTo(s),n.copyTo(t));var u=s.t,f=s.data[u-1];if(f!=0){var h=f*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),d=this.FV/h,y=(1<<this.F1)/h,g=1<<this.F2,m=t.t,x=m-u,_=e??Mt();for(s.dlShiftTo(x,_),t.compareTo(_)>=0&&(t.data[t.t++]=1,t.subTo(_,t)),Ee.ONE.dlShiftTo(u,_),_.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--x>=0;){var P=t.data[--m]==f?this.DM:Math.floor(t.data[m]*d+(t.data[m-1]+g)*y);if((t.data[m]+=s.am(0,P,t,x,0,u))<P)for(s.dlShiftTo(x,_),t.subTo(_,t);t.data[m]<--P;)t.subTo(_,t)}e!=null&&(t.drShiftTo(u,e),o!=a&&Ee.ZERO.subTo(e,e)),t.t=u,t.clamp(),c>0&&t.rShiftTo(c,t),o<0&&Ee.ZERO.subTo(t,t)}}}function qxe(r){var e=Mt();return this.abs().divRemTo(r,null,e),this.s<0&&e.compareTo(Ee.ZERO)>0&&r.subTo(e,e),e}function $f(r){this.m=r}function Mxe(r){return r.s<0||r.compareTo(this.m)>=0?r.mod(this.m):r}function Lxe(r){return r}function Fxe(r){r.divRemTo(this.m,null,r)}function Uxe(r,e,t){r.multiplyTo(e,t),this.reduce(t)}function Kxe(r,e){r.squareTo(e),this.reduce(e)}$f.prototype.convert=Mxe;$f.prototype.revert=Lxe;$f.prototype.reduce=Fxe;$f.prototype.mulTo=Uxe;$f.prototype.sqrTo=Kxe;function jxe(){if(this.t<1)return 0;var r=this.data[0];if((r&1)==0)return 0;var e=r&3;return e=e*(2-(r&15)*e)&15,e=e*(2-(r&255)*e)&255,e=e*(2-((r&65535)*e&65535))&65535,e=e*(2-r*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Wf(r){this.m=r,this.mp=r.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<r.DB-15)-1,this.mt2=2*r.t}function Vxe(r){var e=Mt();return r.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),r.s<0&&e.compareTo(Ee.ZERO)>0&&this.m.subTo(e,e),e}function zxe(r){var e=Mt();return r.copyTo(e),this.reduce(e),e}function Hxe(r){for(;r.t<=this.mt2;)r.data[r.t++]=0;for(var e=0;e<this.m.t;++e){var t=r.data[e]&32767,i=t*this.mpl+((t*this.mph+(r.data[e]>>15)*this.mpl&this.um)<<15)&r.DM;for(t=e+this.m.t,r.data[t]+=this.m.am(0,i,r,e,0,this.m.t);r.data[t]>=r.DV;)r.data[t]-=r.DV,r.data[++t]++}r.clamp(),r.drShiftTo(this.m.t,r),r.compareTo(this.m)>=0&&r.subTo(this.m,r)}function Gxe(r,e){r.squareTo(e),this.reduce(e)}function $xe(r,e,t){r.multiplyTo(e,t),this.reduce(t)}Wf.prototype.convert=Vxe;Wf.prototype.revert=zxe;Wf.prototype.reduce=Hxe;Wf.prototype.mulTo=$xe;Wf.prototype.sqrTo=Gxe;function Wxe(){return(this.t>0?this.data[0]&1:this.s)==0}function Yxe(r,e){if(r>4294967295||r<1)return Ee.ONE;var t=Mt(),i=Mt(),n=e.convert(this),s=mm(r)-1;for(n.copyTo(t);--s>=0;)if(e.sqrTo(t,i),(r&1<<s)>0)e.mulTo(i,n,t);else{var o=t;t=i,i=o}return e.revert(t)}function Xxe(r,e){var t;return r<256||e.isEven()?t=new $f(e):t=new Wf(e),this.exp(r,t)}Ee.prototype.copyTo=vxe;Ee.prototype.fromInt=wxe;Ee.prototype.fromString=_xe;Ee.prototype.clamp=Exe;Ee.prototype.dlShiftTo=Rxe;Ee.prototype.drShiftTo=kxe;Ee.prototype.lShiftTo=Cxe;Ee.prototype.rShiftTo=Pxe;Ee.prototype.subTo=Oxe;Ee.prototype.multiplyTo=Bxe;Ee.prototype.squareTo=Nxe;Ee.prototype.divRemTo=Dxe;Ee.prototype.invDigit=jxe;Ee.prototype.isEven=Wxe;Ee.prototype.exp=Yxe;Ee.prototype.toString=Sxe;Ee.prototype.negate=xxe;Ee.prototype.abs=Axe;Ee.prototype.compareTo=Ixe;Ee.prototype.bitLength=Txe;Ee.prototype.mod=qxe;Ee.prototype.modPowInt=Xxe;Ee.ZERO=Pu(0);Ee.ONE=Pu(1);function Jxe(){var r=Mt();return this.copyTo(r),r}function Qxe(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Zxe(){return this.t==0?this.s:this.data[0]<<24>>24}function e6e(){return this.t==0?this.s:this.data[0]<<16>>16}function t6e(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function r6e(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function i6e(r){if(r==null&&(r=10),this.signum()==0||r<2||r>36)return"0";var e=this.chunkSize(r),t=Math.pow(r,e),i=Pu(t),n=Mt(),s=Mt(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(t+s.intValue()).toString(r).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(r)+o}function n6e(r,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),i=Math.pow(e,t),n=!1,s=0,o=0,a=0;a<r.length;++a){var c=tD(r,a);if(c<0){r.charAt(a)=="-"&&this.signum()==0&&(n=!0);continue}o=e*o+c,++s>=t&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&Ee.ZERO.subTo(this,this)}function s6e(r,e,t){if(typeof e=="number")if(r<2)this.fromInt(1);else for(this.fromNumber(r,t),this.testBit(r-1)||this.bitwiseTo(Ee.ONE.shiftLeft(r-1),QS,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>r&&this.subTo(Ee.ONE.shiftLeft(r-1),this);else{var i=new Array,n=r&7;i.length=(r>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function o6e(){var r=this.t,e=new Array;e[0]=this.s;var t=this.DB-r*this.DB%8,i,n=0;if(r-- >0)for(t<this.DB&&(i=this.data[r]>>t)!=(this.s&this.DM)>>t&&(e[n++]=i|this.s<<this.DB-t);r>=0;)t<8?(i=(this.data[r]&(1<<t)-1)<<8-t,i|=this.data[--r]>>(t+=this.DB-8)):(i=this.data[r]>>(t-=8)&255,t<=0&&(t+=this.DB,--r)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function a6e(r){return this.compareTo(r)==0}function c6e(r){return this.compareTo(r)<0?this:r}function u6e(r){return this.compareTo(r)>0?this:r}function f6e(r,e,t){var i,n,s=Math.min(r.t,this.t);for(i=0;i<s;++i)t.data[i]=e(this.data[i],r.data[i]);if(r.t<this.t){for(n=r.s&this.DM,i=s;i<this.t;++i)t.data[i]=e(this.data[i],n);t.t=this.t}else{for(n=this.s&this.DM,i=s;i<r.t;++i)t.data[i]=e(n,r.data[i]);t.t=r.t}t.s=e(this.s,r.s),t.clamp()}function l6e(r,e){return r&e}function h6e(r){var e=Mt();return this.bitwiseTo(r,l6e,e),e}function QS(r,e){return r|e}function d6e(r){var e=Mt();return this.bitwiseTo(r,QS,e),e}function rD(r,e){return r^e}function p6e(r){var e=Mt();return this.bitwiseTo(r,rD,e),e}function iD(r,e){return r&~e}function y6e(r){var e=Mt();return this.bitwiseTo(r,iD,e),e}function g6e(){for(var r=Mt(),e=0;e<this.t;++e)r.data[e]=this.DM&~this.data[e];return r.t=this.t,r.s=~this.s,r}function b6e(r){var e=Mt();return r<0?this.rShiftTo(-r,e):this.lShiftTo(r,e),e}function m6e(r){var e=Mt();return r<0?this.lShiftTo(-r,e):this.rShiftTo(r,e),e}function v6e(r){if(r==0)return-1;var e=0;return(r&65535)==0&&(r>>=16,e+=16),(r&255)==0&&(r>>=8,e+=8),(r&15)==0&&(r>>=4,e+=4),(r&3)==0&&(r>>=2,e+=2),(r&1)==0&&++e,e}function w6e(){for(var r=0;r<this.t;++r)if(this.data[r]!=0)return r*this.DB+v6e(this.data[r]);return this.s<0?this.t*this.DB:-1}function _6e(r){for(var e=0;r!=0;)r&=r-1,++e;return e}function E6e(){for(var r=0,e=this.s&this.DM,t=0;t<this.t;++t)r+=_6e(this.data[t]^e);return r}function S6e(r){var e=Math.floor(r/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<r%this.DB)!=0}function x6e(r,e){var t=Ee.ONE.shiftLeft(r);return this.bitwiseTo(t,e,t),t}function A6e(r){return this.changeBit(r,QS)}function I6e(r){return this.changeBit(r,iD)}function T6e(r){return this.changeBit(r,rD)}function R6e(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]+r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i+=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i+=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=r.s}e.s=i<0?-1:0,i>0?e.data[t++]=i:i<-1&&(e.data[t++]=this.DV+i),e.t=t,e.clamp()}function k6e(r){var e=Mt();return this.addTo(r,e),e}function C6e(r){var e=Mt();return this.subTo(r,e),e}function P6e(r){var e=Mt();return this.multiplyTo(r,e),e}function O6e(r){var e=Mt();return this.divRemTo(r,e,null),e}function B6e(r){var e=Mt();return this.divRemTo(r,null,e),e}function N6e(r){var e=Mt(),t=Mt();return this.divRemTo(r,e,t),new Array(e,t)}function D6e(r){this.data[this.t]=this.am(0,r-1,this,0,0,this.t),++this.t,this.clamp()}function q6e(r,e){if(r!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=r;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function cy(){}function nD(r){return r}function M6e(r,e,t){r.multiplyTo(e,t)}function L6e(r,e){r.squareTo(e)}cy.prototype.convert=nD;cy.prototype.revert=nD;cy.prototype.mulTo=M6e;cy.prototype.sqrTo=L6e;function F6e(r){return this.exp(r,new cy)}function U6e(r,e,t){var i=Math.min(this.t+r.t,e);for(t.s=0,t.t=i;i>0;)t.data[--i]=0;var n;for(n=t.t-this.t;i<n;++i)t.data[i+this.t]=this.am(0,r.data[i],t,i,0,this.t);for(n=Math.min(r.t,e);i<n;++i)this.am(0,r.data[i],t,i,0,e-i);t.clamp()}function K6e(r,e,t){--e;var i=t.t=this.t+r.t-e;for(t.s=0;--i>=0;)t.data[i]=0;for(i=Math.max(e-this.t,0);i<r.t;++i)t.data[this.t+i-e]=this.am(e-i,r.data[i],t,0,0,this.t+i-e);t.clamp(),t.drShiftTo(1,t)}function zh(r){this.r2=Mt(),this.q3=Mt(),Ee.ONE.dlShiftTo(2*r.t,this.r2),this.mu=this.r2.divide(r),this.m=r}function j6e(r){if(r.s<0||r.t>2*this.m.t)return r.mod(this.m);if(r.compareTo(this.m)<0)return r;var e=Mt();return r.copyTo(e),this.reduce(e),e}function V6e(r){return r}function z6e(r){for(r.drShiftTo(this.m.t-1,this.r2),r.t>this.m.t+1&&(r.t=this.m.t+1,r.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);r.compareTo(this.r2)<0;)r.dAddOffset(1,this.m.t+1);for(r.subTo(this.r2,r);r.compareTo(this.m)>=0;)r.subTo(this.m,r)}function H6e(r,e){r.squareTo(e),this.reduce(e)}function G6e(r,e,t){r.multiplyTo(e,t),this.reduce(t)}zh.prototype.convert=j6e;zh.prototype.revert=V6e;zh.prototype.reduce=z6e;zh.prototype.mulTo=G6e;zh.prototype.sqrTo=H6e;function $6e(r,e){var t=r.bitLength(),i,n=Pu(1),s;if(t<=0)return n;t<18?i=1:t<48?i=3:t<144?i=4:t<768?i=5:i=6,t<8?s=new $f(e):e.isEven()?s=new zh(e):s=new Wf(e);var o=new Array,a=3,c=i-1,u=(1<<i)-1;if(o[1]=s.convert(this),i>1){var f=Mt();for(s.sqrTo(o[1],f);a<=u;)o[a]=Mt(),s.mulTo(f,o[a-2],o[a]),a+=2}var h=r.t-1,d,y=!0,g=Mt(),m;for(t=mm(r.data[h])-1;h>=0;){for(t>=c?d=r.data[h]>>t-c&u:(d=(r.data[h]&(1<<t+1)-1)<<c-t,h>0&&(d|=r.data[h-1]>>this.DB+t-c)),a=i;(d&1)==0;)d>>=1,--a;if((t-=a)<0&&(t+=this.DB,--h),y)o[d].copyTo(n),y=!1;else{for(;a>1;)s.sqrTo(n,g),s.sqrTo(g,n),a-=2;a>0?s.sqrTo(n,g):(m=n,n=g,g=m),s.mulTo(g,o[d],n)}for(;h>=0&&(r.data[h]&1<<t)==0;)s.sqrTo(n,g),m=n,n=g,g=m,--t<0&&(t=this.DB-1,--h)}return s.revert(n)}function W6e(r){var e=this.s<0?this.negate():this.clone(),t=r.s<0?r.negate():r.clone();if(e.compareTo(t)<0){var i=e;e=t,t=i}var n=e.getLowestSetBit(),s=t.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),t.rShiftTo(s,t));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return s>0&&t.lShiftTo(s,t),t}function Y6e(r){if(r<=0)return 0;var e=this.DV%r,t=this.s<0?r-1:0;if(this.t>0)if(e==0)t=this.data[0]%r;else for(var i=this.t-1;i>=0;--i)t=(e*t+this.data[i])%r;return t}function X6e(r){var e=r.isEven();if(this.isEven()&&e||r.signum()==0)return Ee.ZERO;for(var t=r.clone(),i=this.clone(),n=Pu(1),s=Pu(0),o=Pu(0),a=Pu(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(r,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(r,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(r,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(r,a),a.rShiftTo(1,a);t.compareTo(i)>=0?(t.subTo(i,t),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(t,i),e&&o.subTo(n,o),a.subTo(s,a))}if(i.compareTo(Ee.ONE)!=0)return Ee.ZERO;if(a.compareTo(r)>=0)return a.subtract(r);if(a.signum()<0)a.addTo(r,a);else return a;return a.signum()<0?a.add(r):a}var Bo=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],J6e=(1<<26)/Bo[Bo.length-1];function Q6e(r){var e,t=this.abs();if(t.t==1&&t.data[0]<=Bo[Bo.length-1]){for(e=0;e<Bo.length;++e)if(t.data[0]==Bo[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<Bo.length;){for(var i=Bo[e],n=e+1;n<Bo.length&&i<J6e;)i*=Bo[n++];for(i=t.modInt(i);e<n;)if(i%Bo[e++]==0)return!1}return t.millerRabin(r)}function e4e(r){var e=this.subtract(Ee.ONE),t=e.getLowestSetBit();if(t<=0)return!1;for(var i=e.shiftRight(t),n=Z6e(),s,o=0;o<r;++o){do s=new Ee(this.bitLength(),n);while(s.compareTo(Ee.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(i,this);if(a.compareTo(Ee.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<t&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(Ee.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function Z6e(){return{nextBytes:function(r){for(var e=0;e<r.length;++e)r[e]=Math.floor(Math.random()*256)}}}Ee.prototype.chunkSize=t6e;Ee.prototype.toRadix=i6e;Ee.prototype.fromRadix=n6e;Ee.prototype.fromNumber=s6e;Ee.prototype.bitwiseTo=f6e;Ee.prototype.changeBit=x6e;Ee.prototype.addTo=R6e;Ee.prototype.dMultiply=D6e;Ee.prototype.dAddOffset=q6e;Ee.prototype.multiplyLowerTo=U6e;Ee.prototype.multiplyUpperTo=K6e;Ee.prototype.modInt=Y6e;Ee.prototype.millerRabin=e4e;Ee.prototype.clone=Jxe;Ee.prototype.intValue=Qxe;Ee.prototype.byteValue=Zxe;Ee.prototype.shortValue=e6e;Ee.prototype.signum=r6e;Ee.prototype.toByteArray=o6e;Ee.prototype.equals=a6e;Ee.prototype.min=c6e;Ee.prototype.max=u6e;Ee.prototype.and=h6e;Ee.prototype.or=d6e;Ee.prototype.xor=p6e;Ee.prototype.andNot=y6e;Ee.prototype.not=g6e;Ee.prototype.shiftLeft=b6e;Ee.prototype.shiftRight=m6e;Ee.prototype.getLowestSetBit=w6e;Ee.prototype.bitCount=E6e;Ee.prototype.testBit=S6e;Ee.prototype.setBit=A6e;Ee.prototype.clearBit=I6e;Ee.prototype.flipBit=T6e;Ee.prototype.add=k6e;Ee.prototype.subtract=C6e;Ee.prototype.multiply=P6e;Ee.prototype.divide=O6e;Ee.prototype.remainder=B6e;Ee.prototype.divideAndRemainder=N6e;Ee.prototype.modPow=$6e;Ee.prototype.modInverse=X6e;Ee.prototype.pow=F6e;Ee.prototype.gcd=W6e;Ee.prototype.isProbablePrime=Q6e});var uD=p((Ryt,sD)=>{l();var Ta=bt();ku();yr();var oD=sD.exports=Ta.sha1=Ta.sha1||{};Ta.md.sha1=Ta.md.algorithms.sha1=oD;oD.create=function(){aD||t4e();var r=null,e=Ta.util.createBuffer(),t=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Ta.util.createBuffer(),r={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Ta.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),cD(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Ta.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(ZS.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,f=0;f<i.fullMessageLength.length-1;++f)a=i.fullMessageLength[f+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var h={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4};cD(h,t,n);var d=Ta.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d},i};var ZS=null,aD=!1;function t4e(){ZS=String.fromCharCode(128),ZS+=Ta.util.fillString(String.fromCharCode(0),64),aD=!0}function cD(r,e,t){for(var i,n,s,o,a,c,u,f,h=t.length();h>=64;){for(n=r.h0,s=r.h1,o=r.h2,a=r.h3,c=r.h4,f=0;f<16;++f)i=t.getInt32(),e[f]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<20;++f)i=e[f-3]^e[f-8]^e[f-14]^e[f-16],i=i<<1|i>>>31,e[f]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<32;++f)i=e[f-3]^e[f-8]^e[f-14]^e[f-16],i=i<<1|i>>>31,e[f]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<40;++f)i=e[f-6]^e[f-16]^e[f-28]^e[f-32],i=i<<2|i>>>30,e[f]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<60;++f)i=e[f-6]^e[f-16]^e[f-28]^e[f-32],i=i<<2|i>>>30,e[f]=i,u=s&o|a&(s^o),i=(n<<5|n>>>27)+u+c+2400959708+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<80;++f)i=e[f-6]^e[f-16]^e[f-28]^e[f-32],i=i<<2|i>>>30,e[f]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+3395469782+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;r.h0=r.h0+n|0,r.h1=r.h1+s|0,r.h2=r.h2+o|0,r.h3=r.h3+a|0,r.h4=r.h4+c|0,h-=64}}});var hD=p((kyt,fD)=>{l();var Ra=bt();yr();Cu();uD();var lD=fD.exports=Ra.pkcs1=Ra.pkcs1||{};lD.encode_rsa_oaep=function(r,e,t){var i,n,s,o;typeof t=="string"?(i=t,n=arguments[3]||void 0,s=arguments[4]||void 0):t&&(i=t.label||void 0,n=t.seed||void 0,s=t.md||void 0,t.mgf1&&t.mgf1.md&&(o=t.mgf1.md)),s?s.start():s=Ra.md.sha1.create(),o||(o=s);var a=Math.ceil(r.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}i||(i=""),s.update(i,"raw");for(var f=s.digest(),h="",d=c-e.length,y=0;y<d;y++)h+="\0";var g=f.getBytes()+h+""+e;if(!n)n=Ra.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=n.length,u.digestLength=s.digestLength,u}var m=vm(n,a-s.digestLength-1,o),x=Ra.util.xorBytes(g,m,g.length),_=vm(x,s.digestLength,o),P=Ra.util.xorBytes(n,_,n.length);return"\0"+P+x};lD.decode_rsa_oaep=function(r,e,t){var i,n,s;typeof t=="string"?(i=t,n=arguments[3]||void 0):t&&(i=t.label||void 0,n=t.md||void 0,t.mgf1&&t.mgf1.md&&(s=t.mgf1.md));var o=Math.ceil(r.n.bitLength()/8);if(e.length!==o){var x=new Error("RSAES-OAEP encoded message length is invalid.");throw x.length=e.length,x.expectedLength=o,x}if(n===void 0?n=Ra.md.sha1.create():n.start(),s||(s=n),o<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var a=n.digest().getBytes(),c=e.charAt(0),u=e.substring(1,n.digestLength+1),f=e.substring(1+n.digestLength),h=vm(f,n.digestLength,s),d=Ra.util.xorBytes(u,h,u.length),y=vm(d,o-n.digestLength-1,s),g=Ra.util.xorBytes(f,y,f.length),m=g.substring(0,n.digestLength),x=c!=="\0",_=0;_<n.digestLength;++_)x|=a.charAt(_)!==m.charAt(_);for(var P=1,q=n.digestLength,X=n.digestLength;X<g.length;X++){var W=g.charCodeAt(X),z=W&1^1,Z=P?65534:0;x|=W&Z,P=P&z,q+=P}if(x||g.charCodeAt(q)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(q+1)};function vm(r,e,t){t||(t=Ra.md.sha1.create());for(var i="",n=Math.ceil(e/t.digestLength),s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);t.start(),t.update(r+o),i+=t.digest().getBytes()}return i.substring(0,e)}});var dD=p((Cyt,ex)=>{l();var Ou=bt();yr();uy();Cu();(function(){if(Ou.prime){ex.exports=Ou.prime;return}var r=ex.exports=Ou.prime=Ou.prime||{},e=Ou.jsbn.BigInteger,t=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(h,d){return h|d};r.generateProbablePrime=function(h,d,y){typeof d=="function"&&(y=d,d={}),d=d||{};var g=d.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var m=d.prng||Ou.random,x={nextBytes:function(_){for(var P=m.getBytesSync(_.length),q=0;q<_.length;++q)_[q]=P.charCodeAt(q)}};if(g.name==="PRIMEINC")return s(h,x,g.options,y);throw new Error("Invalid prime generation algorithm: "+g.name)};function s(h,d,y,g){return"workers"in y?c(h,d,y,g):o(h,d,y,g)}function o(h,d,y,g){var m=u(h,d),x=0,_=f(m.bitLength());"millerRabinTests"in y&&(_=y.millerRabinTests);var P=10;"maxBlockTime"in y&&(P=y.maxBlockTime),a(m,h,d,x,_,P,g)}function a(h,d,y,g,m,x,_){var P=+new Date;do{if(h.bitLength()>d&&(h=u(d,y)),h.isProbablePrime(m))return _(null,h);h.dAddOffset(t[g++%8],0)}while(x<0||+new Date-P<x);Ou.util.setImmediate(function(){a(h,d,y,g,m,x,_)})}function c(h,d,y,g){if(typeof Worker=="undefined")return o(h,d,y,g);var m=u(h,d),x=y.workers,_=y.workLoad||100,P=_*30/8,q=y.workerScript||"forge/prime.worker.js";if(x===-1)return Ou.util.estimateCores(function(W,z){W&&(z=2),x=z-1,X()});X();function X(){x=Math.max(1,x);for(var W=[],z=0;z<x;++z)W[z]=new Worker(q);for(var Z=x,z=0;z<x;++z)W[z].addEventListener("message",re);var ee=!1;function re(L){if(!ee){--Z;var b=L.data;if(b.found){for(var w=0;w<W.length;++w)W[w].terminate();return ee=!0,g(null,new e(b.prime,16))}m.bitLength()>h&&(m=u(h,d));var R=m.toString(16);L.target.postMessage({hex:R,workLoad:_}),m.dAddOffset(P,0)}}}}function u(h,d){var y=new e(h,d),g=h-1;return y.testBit(g)||y.bitwiseTo(e.ONE.shiftLeft(g),n,y),y.dAddOffset(31-y.mod(i).byteValue(),0),y}function f(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var fy=p((Pyt,pD)=>{l();var lt=bt();Pc();uy();Lh();hD();dD();Cu();yr();typeof Bt=="undefined"&&(Bt=lt.jsbn.BigInteger);var Bt,tx=lt.util.isNodejs?jh():null,le=lt.asn1,Us=lt.util;lt.pki=lt.pki||{};pD.exports=lt.pki.rsa=lt.rsa=lt.rsa||{};var ht=lt.pki,r4e=[6,4,2,4,2,4,6,2],i4e={name:"PrivateKeyInfo",tagClass:le.Class.UNIVERSAL,type:le.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:le.Class.UNIVERSAL,type:le.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:le.Class.UNIVERSAL,type:le.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:le.Class.UNIVERSAL,type:le.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},n4e={name:"RSAPrivateKey",tagClass:le.Class.UNIVERSAL,type:le.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},s4e={name:"RSAPublicKey",tagClass:le.Class.UNIVERSAL,type:le.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:le.Class.UNIVERSAL,type:le.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},o4e=lt.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:le.Class.UNIVERSAL,type:le.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:le.Class.UNIVERSAL,type:le.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:le.Class.UNIVERSAL,type:le.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:le.Class.UNIVERSAL,type:le.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:le.Class.UNIVERSAL,type:le.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},a4e=function(r){var e;if(r.algorithm in ht.oids)e=ht.oids[r.algorithm];else{var t=new Error("Unknown message digest algorithm.");throw t.algorithm=r.algorithm,t}var i=le.oidToDer(e).getBytes(),n=le.create(le.Class.UNIVERSAL,le.Type.SEQUENCE,!0,[]),s=le.create(le.Class.UNIVERSAL,le.Type.SEQUENCE,!0,[]);s.value.push(le.create(le.Class.UNIVERSAL,le.Type.OID,!1,i)),s.value.push(le.create(le.Class.UNIVERSAL,le.Type.NULL,!1,""));var o=le.create(le.Class.UNIVERSAL,le.Type.OCTETSTRING,!1,r.digest().getBytes());return n.value.push(s),n.value.push(o),le.toDer(n).getBytes()},yD=function(r,e,t){if(t)return r.modPow(e.e,e.n);if(!e.p||!e.q)return r.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Bt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Bt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new Bt(lt.util.bytesToHex(lt.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(Bt.ONE));r=r.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=r.mod(e.p).modPow(e.dP,e.p),s=r.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var o=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(i.modInverse(e.n)).mod(e.n),o};ht.rsa.encrypt=function(r,e,t){var i=t,n,s=Math.ceil(e.n.bitLength()/8);t!==!1&&t!==!0?(i=t===2,n=gD(r,e,t)):(n=lt.util.createBuffer(),n.putBytes(r));for(var o=new Bt(n.toHex(),16),a=yD(o,e,i),c=a.toString(16),u=lt.util.createBuffer(),f=s-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(lt.util.hexToBytes(c)),u.getBytes()};ht.rsa.decrypt=function(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8);if(r.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=r.length,s.expected=n,s}var o=new Bt(lt.util.createBuffer(r).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=yD(o,e,t),c=a.toString(16),u=lt.util.createBuffer(),f=n-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(lt.util.hexToBytes(c)),i!==!1?wm(u.getBytes(),e,t):u.getBytes()};ht.rsa.createKeyPairGenerationState=function(r,e,t){typeof r=="string"&&(r=parseInt(r,10)),r=r||2048,t=t||{};var i=t.prng||lt.random,n={nextBytes:function(a){for(var c=i.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=t.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:r,rng:n,eInt:e||65537,e:new Bt(null),p:null,q:null,qBits:r>>1,pBits:r-(r>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};ht.rsa.stepKeyPairGenerationState=function(r,e){"algorithm"in r||(r.algorithm="PRIMEINC");var t=new Bt(null);t.fromInt(30);for(var i=0,n=function(h,d){return h|d},s=+new Date,o,a=0;r.keys===null&&(e<=0||a<e);){if(r.state===0){var c=r.p===null?r.pBits:r.qBits,u=c-1;r.pqState===0?(r.num=new Bt(c,r.rng),r.num.testBit(u)||r.num.bitwiseTo(Bt.ONE.shiftLeft(u),n,r.num),r.num.dAddOffset(31-r.num.mod(t).byteValue(),0),i=0,++r.pqState):r.pqState===1?r.num.bitLength()>c?r.pqState=0:r.num.isProbablePrime(c4e(r.num.bitLength()))?++r.pqState:r.num.dAddOffset(r4e[i++%8],0):r.pqState===2?r.pqState=r.num.subtract(Bt.ONE).gcd(r.e).compareTo(Bt.ONE)===0?3:0:r.pqState===3&&(r.pqState=0,r.p===null?r.p=r.num:r.q=r.num,r.p!==null&&r.q!==null&&++r.state,r.num=null)}else if(r.state===1)r.p.compareTo(r.q)<0&&(r.num=r.p,r.p=r.q,r.q=r.num),++r.state;else if(r.state===2)r.p1=r.p.subtract(Bt.ONE),r.q1=r.q.subtract(Bt.ONE),r.phi=r.p1.multiply(r.q1),++r.state;else if(r.state===3)r.phi.gcd(r.e).compareTo(Bt.ONE)===0?++r.state:(r.p=null,r.q=null,r.state=0);else if(r.state===4)r.n=r.p.multiply(r.q),r.n.bitLength()===r.bits?++r.state:(r.q=null,r.state=0);else if(r.state===5){var f=r.e.modInverse(r.phi);r.keys={privateKey:ht.rsa.setPrivateKey(r.n,r.e,f,r.p,r.q,f.mod(r.p1),f.mod(r.q1),r.q.modInverse(r.p)),publicKey:ht.rsa.setPublicKey(r.n,r.e)}}o=+new Date,a+=o-s,s=o}return r.keys!==null};ht.rsa.generateKeyPair=function(r,e,t,i){if(arguments.length===1?typeof r=="object"?(t=r,r=void 0):typeof r=="function"&&(i=r,r=void 0):arguments.length===2?typeof r=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(t=e,e=void 0):(t=r,i=e,r=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof t=="function"&&(i=t,t=void 0):(i=t,t=e,e=void 0)),t=t||{},r===void 0&&(r=t.bits||2048),e===void 0&&(e=t.e||65537),!lt.options.usePureJavaScript&&!t.prng&&r>=256&&r<=16384&&(e===65537||e===3)){if(i){if(bD("generateKeyPair"))return tx.generateKeyPair("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return i(a);i(null,{privateKey:ht.privateKeyFromPem(u),publicKey:ht.publicKeyFromPem(c)})});if(mD("generateKey")&&mD("exportKey"))return Us.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:wD(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Us.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){i(a)}).then(function(a){if(a){var c=ht.privateKeyFromAsn1(le.fromDer(lt.util.createBuffer(a)));i(null,{privateKey:c,publicKey:ht.setRsaPublicKey(c.n,c.e)})}});if(vD("generateKey")&&vD("exportKey")){var n=Us.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:wD(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(a){var c=a.target.result,u=Us.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(f){var h=f.target.result,d=ht.privateKeyFromAsn1(le.fromDer(lt.util.createBuffer(h)));i(null,{privateKey:d,publicKey:ht.setRsaPublicKey(d.n,d.e)})},u.onerror=function(f){i(f)}},n.onerror=function(a){i(a)};return}}else if(bD("generateKeyPairSync")){var s=tx.generateKeyPairSync("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ht.privateKeyFromPem(s.privateKey),publicKey:ht.publicKeyFromPem(s.publicKey)}}}var o=ht.rsa.createKeyPairGenerationState(r,e,t);if(!i)return ht.rsa.stepKeyPairGenerationState(o,0),o.keys;u4e(o,t,i)};ht.setRsaPublicKey=ht.rsa.setPublicKey=function(r,e){var t={n:r,e};return t.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(a,c,u){return gD(a,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(a,c){return lt.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(a){return a}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var o=n.encode(i,t,!0);return ht.rsa.encrypt(o,t,!0)},t.verify=function(i,n,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,c){c=wm(c,t,!0);var u=le.fromDer(c);return a===u.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,c){return c=wm(c,t,!0),a===c}});var o=ht.rsa.decrypt(n,t,!0,!1);return s.verify(i,o,t.n.bitLength())},t};ht.setRsaPrivateKey=ht.rsa.setPrivateKey=function(r,e,t,i,n,s,o,a){var c={n:r,e,d:t,p:i,q:n,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,f,h){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var d=ht.rsa.decrypt(u,c,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:wm};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:function(y,g){return lt.pkcs1.decode_rsa_oaep(g,y,h)}};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:function(y){return y}};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(d,c,!1)},c.sign=function(u,f){var h=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:a4e},h=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:function(){return u}},h=1);var d=f.encode(u,c.n.bitLength());return ht.rsa.encrypt(d,c,h)},c};ht.wrapRsaPrivateKey=function(r){return le.create(le.Class.UNIVERSAL,le.Type.SEQUENCE,!0,[le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,le.integerToDer(0).getBytes()),le.create(le.Class.UNIVERSAL,le.Type.SEQUENCE,!0,[le.create(le.Class.UNIVERSAL,le.Type.OID,!1,le.oidToDer(ht.oids.rsaEncryption).getBytes()),le.create(le.Class.UNIVERSAL,le.Type.NULL,!1,"")]),le.create(le.Class.UNIVERSAL,le.Type.OCTETSTRING,!1,le.toDer(r).getBytes())])};ht.privateKeyFromAsn1=function(r){var e={},t=[];if(le.validate(r,i4e,e,t)&&(r=le.fromDer(lt.util.createBuffer(e.privateKey))),e={},t=[],!le.validate(r,n4e,e,t)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=t,i}var n,s,o,a,c,u,f,h;return n=lt.util.createBuffer(e.privateKeyModulus).toHex(),s=lt.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=lt.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=lt.util.createBuffer(e.privateKeyPrime1).toHex(),c=lt.util.createBuffer(e.privateKeyPrime2).toHex(),u=lt.util.createBuffer(e.privateKeyExponent1).toHex(),f=lt.util.createBuffer(e.privateKeyExponent2).toHex(),h=lt.util.createBuffer(e.privateKeyCoefficient).toHex(),ht.setRsaPrivateKey(new Bt(n,16),new Bt(s,16),new Bt(o,16),new Bt(a,16),new Bt(c,16),new Bt(u,16),new Bt(f,16),new Bt(h,16))};ht.privateKeyToAsn1=ht.privateKeyToRSAPrivateKey=function(r){return le.create(le.Class.UNIVERSAL,le.Type.SEQUENCE,!0,[le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,le.integerToDer(0).getBytes()),le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.n)),le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.e)),le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.d)),le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.p)),le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.q)),le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.dP)),le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.dQ)),le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.qInv))])};ht.publicKeyFromAsn1=function(r){var e={},t=[];if(le.validate(r,o4e,e,t)){var i=le.derToOid(e.publicKeyOid);if(i!==ht.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}r=e.rsaPublicKey}if(t=[],!le.validate(r,s4e,e,t)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=t,n}var s=lt.util.createBuffer(e.publicKeyModulus).toHex(),o=lt.util.createBuffer(e.publicKeyExponent).toHex();return ht.setRsaPublicKey(new Bt(s,16),new Bt(o,16))};ht.publicKeyToAsn1=ht.publicKeyToSubjectPublicKeyInfo=function(r){return le.create(le.Class.UNIVERSAL,le.Type.SEQUENCE,!0,[le.create(le.Class.UNIVERSAL,le.Type.SEQUENCE,!0,[le.create(le.Class.UNIVERSAL,le.Type.OID,!1,le.oidToDer(ht.oids.rsaEncryption).getBytes()),le.create(le.Class.UNIVERSAL,le.Type.NULL,!1,"")]),le.create(le.Class.UNIVERSAL,le.Type.BITSTRING,!1,[ht.publicKeyToRSAPublicKey(r)])])};ht.publicKeyToRSAPublicKey=function(r){return le.create(le.Class.UNIVERSAL,le.Type.SEQUENCE,!0,[le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.n)),le.create(le.Class.UNIVERSAL,le.Type.INTEGER,!1,ka(r.e))])};function gD(r,e,t){var i=lt.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(r.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=r.length,s.max=n-11,s}i.putByte(0),i.putByte(t);var o=n-3-r.length,a;if(t===0||t===1){a=t===0?0:255;for(var c=0;c<o;++c)i.putByte(a)}else for(;o>0;){for(var u=0,f=lt.random.getBytes(o),c=0;c<o;++c)a=f.charCodeAt(c),a===0?++u:i.putByte(a);o=u}return i.putByte(0),i.putBytes(r),i}function wm(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8),s=lt.util.createBuffer(r),o=s.getByte(),a=s.getByte();if(o!==0||t&&a!==0&&a!==1||!t&&a!=2||t&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=n-3-i;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var f=s.getByte();if(f!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function u4e(r,e,t){typeof e=="function"&&(t=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(r.pBits,function(a,c){if(a)return t(a);if(r.p=c,r.q!==null)return o(a,r.q);s(r.qBits,o)})}function s(a,c){lt.prime.generateProbablePrime(a,i,c)}function o(a,c){if(a)return t(a);if(r.q=c,r.p.compareTo(r.q)<0){var u=r.p;r.p=r.q,r.q=u}if(r.p.subtract(Bt.ONE).gcd(r.e).compareTo(Bt.ONE)!==0){r.p=null,n();return}if(r.q.subtract(Bt.ONE).gcd(r.e).compareTo(Bt.ONE)!==0){r.q=null,s(r.qBits,o);return}if(r.p1=r.p.subtract(Bt.ONE),r.q1=r.q.subtract(Bt.ONE),r.phi=r.p1.multiply(r.q1),r.phi.gcd(r.e).compareTo(Bt.ONE)!==0){r.p=r.q=null,n();return}if(r.n=r.p.multiply(r.q),r.n.bitLength()!==r.bits){r.q=null,s(r.qBits,o);return}var f=r.e.modInverse(r.phi);r.keys={privateKey:ht.rsa.setPrivateKey(r.n,r.e,f,r.p,r.q,f.mod(r.p1),f.mod(r.q1),r.q.modInverse(r.p)),publicKey:ht.rsa.setPublicKey(r.n,r.e)},t(null,r.keys)}}function ka(r){var e=r.toString(16);e[0]>="8"&&(e="00"+e);var t=lt.util.hexToBytes(e);return t.length>1&&(t.charCodeAt(0)===0&&(t.charCodeAt(1)&128)==0||t.charCodeAt(0)===255&&(t.charCodeAt(1)&128)==128)?t.substr(1):t}function c4e(r){return r<=100?27:r<=150?18:r<=200?15:r<=250?12:r<=300?9:r<=350?8:r<=400?7:r<=500?6:r<=600?5:r<=800?4:r<=1250?3:2}function bD(r){return lt.util.isNodejs&&typeof tx[r]=="function"}function mD(r){return typeof Us.globalScope!="undefined"&&typeof Us.globalScope.crypto=="object"&&typeof Us.globalScope.crypto.subtle=="object"&&typeof Us.globalScope.crypto.subtle[r]=="function"}function vD(r){return typeof Us.globalScope!="undefined"&&typeof Us.globalScope.msCrypto=="object"&&typeof Us.globalScope.msCrypto.subtle=="object"&&typeof Us.globalScope.msCrypto.subtle[r]=="function"}function wD(r){for(var e=lt.util.hexToBytes(r.toString(16)),t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=e.charCodeAt(i);return t}});var rx=p((Oyt,_D)=>{l();var He=bt();Kh();Pc();lm();ku();Lh();GS();ym();Cu();XN();fy();yr();typeof ED=="undefined"&&(ED=He.jsbn.BigInteger);var ED,ye=He.asn1,gt=He.pki=He.pki||{};_D.exports=gt.pbe=He.pbe=He.pbe||{};var Yf=gt.oids,f4e={name:"EncryptedPrivateKeyInfo",tagClass:ye.Class.UNIVERSAL,type:ye.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:ye.Class.UNIVERSAL,type:ye.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ye.Class.UNIVERSAL,type:ye.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:ye.Class.UNIVERSAL,type:ye.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:ye.Class.UNIVERSAL,type:ye.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},l4e={name:"PBES2Algorithms",tagClass:ye.Class.UNIVERSAL,type:ye.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:ye.Class.UNIVERSAL,type:ye.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:ye.Class.UNIVERSAL,type:ye.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:ye.Class.UNIVERSAL,type:ye.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:ye.Class.UNIVERSAL,type:ye.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:ye.Class.UNIVERSAL,type:ye.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:ye.Class.UNIVERSAL,type:ye.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:ye.Class.UNIVERSAL,type:ye.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:ye.Class.UNIVERSAL,type:ye.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:ye.Class.UNIVERSAL,type:ye.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:ye.Class.UNIVERSAL,type:ye.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:ye.Class.UNIVERSAL,type:ye.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},h4e={name:"pkcs-12PbeParams",tagClass:ye.Class.UNIVERSAL,type:ye.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:ye.Class.UNIVERSAL,type:ye.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:ye.Class.UNIVERSAL,type:ye.Type.INTEGER,constructed:!1,capture:"iterations"}]};gt.encryptPrivateKeyInfo=function(r,e,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||"aes128",t.prfAlgorithm=t.prfAlgorithm||"sha1";var i=He.random.getBytesSync(t.saltSize),n=t.count,s=ye.integerToDer(n),o,a,c;if(t.algorithm.indexOf("aes")===0||t.algorithm==="des"){var u,f,h;switch(t.algorithm){case"aes128":o=16,u=16,f=Yf["aes128-CBC"],h=He.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,f=Yf["aes192-CBC"],h=He.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,f=Yf["aes256-CBC"],h=He.aes.createEncryptionCipher;break;case"des":o=8,u=8,f=Yf.desCBC,h=He.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=t.algorithm,d}var y="hmacWith"+t.prfAlgorithm.toUpperCase(),g=SD(y),m=He.pkcs5.pbkdf2(e,i,n,o,g),x=He.random.getBytesSync(u),_=h(m);_.start(x),_.update(ye.toDer(r)),_.finish(),c=_.output.getBytes();var P=d4e(i,s,o,y);a=ye.create(ye.Class.UNIVERSAL,ye.Type.SEQUENCE,!0,[ye.create(ye.Class.UNIVERSAL,ye.Type.OID,!1,ye.oidToDer(Yf.pkcs5PBES2).getBytes()),ye.create(ye.Class.UNIVERSAL,ye.Type.SEQUENCE,!0,[ye.create(ye.Class.UNIVERSAL,ye.Type.SEQUENCE,!0,[ye.create(ye.Class.UNIVERSAL,ye.Type.OID,!1,ye.oidToDer(Yf.pkcs5PBKDF2).getBytes()),P]),ye.create(ye.Class.UNIVERSAL,ye.Type.SEQUENCE,!0,[ye.create(ye.Class.UNIVERSAL,ye.Type.OID,!1,ye.oidToDer(f).getBytes()),ye.create(ye.Class.UNIVERSAL,ye.Type.OCTETSTRING,!1,x)])])])}else if(t.algorithm==="3des"){o=24;var q=new He.util.ByteBuffer(i),m=gt.pbe.generatePkcs12Key(e,q,1,n,o),x=gt.pbe.generatePkcs12Key(e,q,2,n,o),_=He.des.createEncryptionCipher(m);_.start(x),_.update(ye.toDer(r)),_.finish(),c=_.output.getBytes(),a=ye.create(ye.Class.UNIVERSAL,ye.Type.SEQUENCE,!0,[ye.create(ye.Class.UNIVERSAL,ye.Type.OID,!1,ye.oidToDer(Yf["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),ye.create(ye.Class.UNIVERSAL,ye.Type.SEQUENCE,!0,[ye.create(ye.Class.UNIVERSAL,ye.Type.OCTETSTRING,!1,i),ye.create(ye.Class.UNIVERSAL,ye.Type.INTEGER,!1,s.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=t.algorithm,d}var X=ye.create(ye.Class.UNIVERSAL,ye.Type.SEQUENCE,!0,[a,ye.create(ye.Class.UNIVERSAL,ye.Type.OCTETSTRING,!1,c)]);return X};gt.decryptPrivateKeyInfo=function(r,e){var t=null,i={},n=[];if(!ye.validate(r,f4e,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=ye.derToOid(i.encryptionOid),a=gt.pbe.getCipher(o,i.encryptionParams,e),c=He.util.createBuffer(i.encryptedData);return a.update(c),a.finish()&&(t=ye.fromDer(a.output)),t};gt.encryptedPrivateKeyToPem=function(r,e){var t={type:"ENCRYPTED PRIVATE KEY",body:ye.toDer(r).getBytes()};return He.pem.encode(t,{maxline:e})};gt.encryptedPrivateKeyFromPem=function(r){var e=He.pem.decode(r)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var t=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return ye.fromDer(e.body)};gt.encryptRsaPrivateKey=function(r,e,t){if(t=t||{},!t.legacy){var i=gt.wrapRsaPrivateKey(gt.privateKeyToAsn1(r));return i=gt.encryptPrivateKeyInfo(i,e,t),gt.encryptedPrivateKeyToPem(i)}var n,s,o,a;switch(t.algorithm){case"aes128":n="AES-128-CBC",o=16,s=He.random.getBytesSync(16),a=He.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",o=24,s=He.random.getBytesSync(16),a=He.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",o=32,s=He.random.getBytesSync(16),a=He.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",o=24,s=He.random.getBytesSync(8),a=He.des.createEncryptionCipher;break;case"des":n="DES-CBC",o=8,s=He.random.getBytesSync(8),a=He.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+t.algorithm+'".');throw c.algorithm=t.algorithm,c}var u=He.pbe.opensslDeriveBytes(e,s.substr(0,8),o),f=a(u);f.start(s),f.update(ye.toDer(gt.privateKeyToAsn1(r))),f.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:He.util.bytesToHex(s).toUpperCase()},body:f.output.getBytes()};return He.pem.encode(h)};gt.decryptRsaPrivateKey=function(r,e){var t=null,i=He.pem.decode(r)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,o;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,o=He.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=He.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=He.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=He.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=He.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return He.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return He.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return He.rc2.createDecryptionCipher(h,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var a=He.util.hexToBytes(i.dekInfo.parameters),c=He.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(He.util.createBuffer(i.body)),u.finish())t=u.output.getBytes();else return t}else t=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?t=gt.decryptPrivateKeyInfo(ye.fromDer(t),e):t=ye.fromDer(t),t!==null&&(t=gt.privateKeyFromAsn1(t)),t};gt.pbe.generatePkcs12Key=function(r,e,t,i,n,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in He.md))throw new Error('"sha1" hash algorithm unavailable.');s=He.md.sha1.create()}var c=s.digestLength,u=s.blockLength,f=new He.util.ByteBuffer,h=new He.util.ByteBuffer;if(r!=null){for(a=0;a<r.length;a++)h.putInt16(r.charCodeAt(a));h.putInt16(0)}var d=h.length(),y=e.length(),g=new He.util.ByteBuffer;g.fillWithByte(t,u);var m=u*Math.ceil(y/u),x=new He.util.ByteBuffer;for(a=0;a<m;a++)x.putByte(e.at(a%y));var _=u*Math.ceil(d/u),P=new He.util.ByteBuffer;for(a=0;a<_;a++)P.putByte(h.at(a%d));var q=x;q.putBuffer(P);for(var X=Math.ceil(n/c),W=1;W<=X;W++){var z=new He.util.ByteBuffer;z.putBytes(g.bytes()),z.putBytes(q.bytes());for(var Z=0;Z<i;Z++)s.start(),s.update(z.getBytes()),z=s.digest();var ee=new He.util.ByteBuffer;for(a=0;a<u;a++)ee.putByte(z.at(a%c));var re=Math.ceil(y/u)+Math.ceil(d/u),L=new He.util.ByteBuffer;for(o=0;o<re;o++){var b=new He.util.ByteBuffer(q.getBytes(u)),w=511;for(a=ee.length()-1;a>=0;a--)w=w>>8,w+=ee.at(a)+b.at(a),b.setAt(a,w&255);L.putBuffer(b)}q=L,f.putBuffer(z)}return f.truncate(f.length()-n),f};gt.pbe.getCipher=function(r,e,t){switch(r){case gt.oids.pkcs5PBES2:return gt.pbe.getCipherForPBES2(r,e,t);case gt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case gt.oids["pbewithSHAAnd40BitRC2-CBC"]:return gt.pbe.getCipherForPKCS12PBE(r,e,t);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=r,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};gt.pbe.getCipherForPBES2=function(r,e,t){var i={},n=[];if(!ye.validate(e,l4e,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(r=ye.derToOid(i.kdfOid),r!==gt.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=r,s.supportedOids=["pkcs5PBKDF2"],s}if(r=ye.derToOid(i.encOid),r!==gt.oids["aes128-CBC"]&&r!==gt.oids["aes192-CBC"]&&r!==gt.oids["aes256-CBC"]&&r!==gt.oids["des-EDE3-CBC"]&&r!==gt.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=r,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=i.kdfSalt,a=He.util.createBuffer(i.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(gt.oids[r]){case"aes128-CBC":c=16,u=He.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=He.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=He.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=He.des.createDecryptionCipher;break;case"desCBC":c=8,u=He.des.createDecryptionCipher;break}var f=xD(i.prfOid),h=He.pkcs5.pbkdf2(t,o,a,c,f),d=i.encIv,y=u(h);return y.start(d),y};gt.pbe.getCipherForPKCS12PBE=function(r,e,t){var i={},n=[];if(!ye.validate(e,h4e,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=He.util.createBuffer(i.salt),a=He.util.createBuffer(i.iterations);a=a.getInt(a.length()<<3);var c,u,f;switch(r){case gt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,f=He.des.startDecrypting;break;case gt.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,f=function(m,x){var _=He.rc2.createDecryptionCipher(m,40);return _.start(x,null),_};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=r,s}var h=xD(i.prfOid),d=gt.pbe.generatePkcs12Key(t,o,1,a,c,h);h.start();var y=gt.pbe.generatePkcs12Key(t,o,2,a,u,h);return f(d,y)};gt.pbe.opensslDeriveBytes=function(r,e,t,i){if(typeof i=="undefined"||i===null){if(!("md5"in He.md))throw new Error('"md5" hash algorithm unavailable.');i=He.md.md5.create()}e===null&&(e="");for(var n=[AD(i,r+e)],s=16,o=1;s<t;++o,s+=16)n.push(AD(i,n[o-1]+r+e));return n.join("").substr(0,t)};function AD(r,e){return r.start().update(e).digest().getBytes()}function xD(r){var e;if(!r)e="hmacWithSHA1";else if(e=gt.oids[ye.derToOid(r)],!e){var t=new Error("Unsupported PRF OID.");throw t.oid=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}return SD(e)}function SD(r){var e=He.md;switch(r){case"hmacWithSHA224":e=He.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":r=r.substr(8).toLowerCase();break;default:var t=new Error("Unsupported PRF algorithm.");throw t.algorithm=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}if(!e||!(r in e))throw new Error("Unknown hash algorithm: "+r);return e[r].create()}function d4e(r,e,t,i){var n=ye.create(ye.Class.UNIVERSAL,ye.Type.SEQUENCE,!0,[ye.create(ye.Class.UNIVERSAL,ye.Type.OCTETSTRING,!1,r),ye.create(ye.Class.UNIVERSAL,ye.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(ye.create(ye.Class.UNIVERSAL,ye.Type.INTEGER,!1,He.util.hexToBytes(t.toString(16))),ye.create(ye.Class.UNIVERSAL,ye.Type.SEQUENCE,!0,[ye.create(ye.Class.UNIVERSAL,ye.Type.OID,!1,ye.oidToDer(gt.oids[i]).getBytes()),ye.create(ye.Class.UNIVERSAL,ye.Type.NULL,!1,"")])),n}});var ge=p((Byt,ID)=>{l();"use strict";function TD(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function p4e(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return TD(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),TD(new n,t)}}ID.exports=p4e});var ly=p(RD=>{l();"use strict";RD.get=(r=self)=>{let e=r.crypto||r.msCrypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var ix=p((Dyt,kD)=>{l();"use strict";var y4e=vi(),CD=ct(),g4e=ly();function b4e({algorithm:r="AES-GCM",nonceLength:e=12,keyLength:t=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=g4e.get();t*=8;async function a(u,f){let h=o.getRandomValues(new Uint8Array(n)),d=o.getRandomValues(new Uint8Array(e)),y={name:r,iv:d},g={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},m=await o.subtle.importKey("raw",CD(f),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),x=await o.subtle.deriveKey(g,m,{name:r,length:t},!0,["encrypt"]),_=await o.subtle.encrypt(y,x,u);return y4e([h,y.iv,new Uint8Array(_)])}async function c(u,f){let h=u.slice(0,n),d=u.slice(n,n+e),y=u.slice(n+e),g={name:r,iv:d},m={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},x=await o.subtle.importKey("raw",CD(f),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),_=await o.subtle.deriveKey(m,x,{name:r,length:t},!0,["decrypt"]),P=await o.subtle.decrypt(g,_,y);return new Uint8Array(P)}return{encrypt:a,decrypt:c}}kD.exports={create:b4e}});var OD=p((qyt,PD)=>{l();"use strict";var m4e=en(),v4e=ix();PD.exports={import:async function(r,e){let i=m4e.names.base64.decode(r);return await v4e.create().decrypt(i,e)}}});var Gh=p((Myt,BD)=>{l();"use strict";var w4e=ko(),Hh=self.crypto||self.msCrypto,nx=async(r,e)=>{if(typeof self=="undefined"||!Hh)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");switch(e){case"sha1":return new Uint8Array(await Hh.subtle.digest({name:"SHA-1"},r));case"sha2-256":return new Uint8Array(await Hh.subtle.digest({name:"SHA-256"},r));case"sha2-512":return new Uint8Array(await Hh.subtle.digest({name:"SHA-512"},r));case"dbl-sha2-256":{let t=await Hh.subtle.digest({name:"SHA-256"},r);return new Uint8Array(await Hh.subtle.digest({name:"SHA-256"},t))}default:throw new Error(`${e} is not a supported algorithm`)}};BD.exports={factory:r=>async e=>nx(e,r),digest:nx,multihashing:async(r,e,t)=>{let i=await nx(r,e);return w4e.encode(i,e,t)}}});var _m=p((Lyt,ND)=>{l();var qr=bt();ku();yr();var hy=ND.exports=qr.sha512=qr.sha512||{};qr.md.sha512=qr.md.algorithms.sha512=hy;var DD=qr.sha384=qr.sha512.sha384=qr.sha512.sha384||{};DD.create=function(){return hy.create("SHA-384")};qr.md.sha384=qr.md.algorithms.sha384=DD;qr.sha512.sha256=qr.sha512.sha256||{create:function(){return hy.create("SHA-512/256")}};qr.md["sha512/256"]=qr.md.algorithms["sha512/256"]=qr.sha512.sha256;qr.sha512.sha224=qr.sha512.sha224||{create:function(){return hy.create("SHA-512/224")}};qr.md["sha512/224"]=qr.md.algorithms["sha512/224"]=qr.sha512.sha224;hy.create=function(r){if(qD||_4e(),typeof r=="undefined"&&(r="SHA-512"),!(r in Xf))throw new Error("Invalid SHA-512 algorithm: "+r);for(var e=Xf[r],t=null,i=qr.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var o=64;switch(r){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:r.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);i=qr.util.createBuffer(),t=new Array(e.length);for(var u=0;u<e.length;++u)t[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=qr.util.encodeUtf8(c));var f=c.length;a.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=f[1],f[1]=f[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,f[0]=f[1]/4294967296>>>0;return i.putBytes(c),MD(t,n,i),(i.read>2048||i.length()===0)&&i.compact(),a},a.digest=function(){var c=qr.util.createBuffer();c.putBytes(i.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,f=u&a.blockLength-1;c.putBytes(sx.substr(0,a.blockLength-f));for(var h,d,y=a.fullMessageLength[0]*8,g=0;g<a.fullMessageLength.length-1;++g)h=a.fullMessageLength[g+1]*8,d=h/4294967296>>>0,y+=d,c.putInt32(y>>>0),y=h>>>0;c.putInt32(y);for(var m=new Array(t.length),g=0;g<t.length;++g)m[g]=t[g].slice(0);MD(m,n,c);var x=qr.util.createBuffer(),_;r==="SHA-512"?_=m.length:r==="SHA-384"?_=m.length-2:_=m.length-4;for(var g=0;g<_;++g)x.putInt32(m[g][0]),(g!==_-1||r!=="SHA-512/224")&&x.putInt32(m[g][1]);return x},a};var sx=null,qD=!1,ox=null,Xf=null;function _4e(){sx=String.fromCharCode(128),sx+=qr.util.fillString(String.fromCharCode(0),128),ox=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Xf={},Xf["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Xf["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Xf["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Xf["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],qD=!0}function MD(r,e,t){for(var i,n,s,o,a,c,u,f,h,d,y,g,m,x,_,P,q,X,W,z,Z,ee,re,L,b,w,R,B,U,Q,G,M,v,V,de,J=t.length();J>=128;){for(U=0;U<16;++U)e[U][0]=t.getInt32()>>>0,e[U][1]=t.getInt32()>>>0;for(;U<80;++U)M=e[U-2],Q=M[0],G=M[1],i=((Q>>>19|G<<13)^(G>>>29|Q<<3)^Q>>>6)>>>0,n=((Q<<13|G>>>19)^(G<<3|Q>>>29)^(Q<<26|G>>>6))>>>0,V=e[U-15],Q=V[0],G=V[1],s=((Q>>>1|G<<31)^(Q>>>8|G<<24)^Q>>>7)>>>0,o=((Q<<31|G>>>1)^(Q<<24|G>>>8)^(Q<<25|G>>>7))>>>0,v=e[U-7],de=e[U-16],G=n+v[1]+o+de[1],e[U][0]=i+v[0]+s+de[0]+(G/4294967296>>>0)>>>0,e[U][1]=G>>>0;for(m=r[0][0],x=r[0][1],_=r[1][0],P=r[1][1],q=r[2][0],X=r[2][1],W=r[3][0],z=r[3][1],Z=r[4][0],ee=r[4][1],re=r[5][0],L=r[5][1],b=r[6][0],w=r[6][1],R=r[7][0],B=r[7][1],U=0;U<80;++U)u=((Z>>>14|ee<<18)^(Z>>>18|ee<<14)^(ee>>>9|Z<<23))>>>0,f=((Z<<18|ee>>>14)^(Z<<14|ee>>>18)^(ee<<23|Z>>>9))>>>0,h=(b^Z&(re^b))>>>0,d=(w^ee&(L^w))>>>0,a=((m>>>28|x<<4)^(x>>>2|m<<30)^(x>>>7|m<<25))>>>0,c=((m<<4|x>>>28)^(x<<30|m>>>2)^(x<<25|m>>>7))>>>0,y=(m&_|q&(m^_))>>>0,g=(x&P|X&(x^P))>>>0,G=B+f+d+ox[U][1]+e[U][1],i=R+u+h+ox[U][0]+e[U][0]+(G/4294967296>>>0)>>>0,n=G>>>0,G=c+g,s=a+y+(G/4294967296>>>0)>>>0,o=G>>>0,R=b,B=w,b=re,w=L,re=Z,L=ee,G=z+n,Z=W+i+(G/4294967296>>>0)>>>0,ee=G>>>0,W=q,z=X,q=_,X=P,_=m,P=x,G=n+o,m=i+s+(G/4294967296>>>0)>>>0,x=G>>>0;G=r[0][1]+x,r[0][0]=r[0][0]+m+(G/4294967296>>>0)>>>0,r[0][1]=G>>>0,G=r[1][1]+P,r[1][0]=r[1][0]+_+(G/4294967296>>>0)>>>0,r[1][1]=G>>>0,G=r[2][1]+X,r[2][0]=r[2][0]+q+(G/4294967296>>>0)>>>0,r[2][1]=G>>>0,G=r[3][1]+z,r[3][0]=r[3][0]+W+(G/4294967296>>>0)>>>0,r[3][1]=G>>>0,G=r[4][1]+ee,r[4][0]=r[4][0]+Z+(G/4294967296>>>0)>>>0,r[4][1]=G>>>0,G=r[5][1]+L,r[5][0]=r[5][0]+re+(G/4294967296>>>0)>>>0,r[5][1]=G>>>0,G=r[6][1]+w,r[6][0]=r[6][0]+b+(G/4294967296>>>0)>>>0,r[6][1]=G>>>0,G=r[7][1]+B,r[7][0]=r[7][0]+R+(G/4294967296>>>0)>>>0,r[7][1]=G>>>0,J-=128}}});var LD=p(ax=>{l();var E4e=bt();Pc();var Fi=E4e.asn1;ax.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Fi.Class.UNIVERSAL,type:Fi.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Fi.Class.UNIVERSAL,type:Fi.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Fi.Class.UNIVERSAL,type:Fi.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Fi.Class.UNIVERSAL,type:Fi.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Fi.Class.UNIVERSAL,type:Fi.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};ax.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Fi.Class.UNIVERSAL,type:Fi.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Fi.Class.UNIVERSAL,type:Fi.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Fi.Class.UNIVERSAL,type:Fi.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Fi.Class.UNIVERSAL,type:Fi.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var gx=p((Uyt,FD)=>{l();var tn=bt();uy();Cu();_m();yr();var UD=LD(),S4e=UD.publicKeyValidator,x4e=UD.privateKeyValidator;typeof KD=="undefined"&&(KD=tn.jsbn.BigInteger);var KD,cx=tn.util.ByteBuffer,Wn=typeof Buffer=="undefined"?Uint8Array:Buffer;tn.pki=tn.pki||{};FD.exports=tn.pki.ed25519=tn.ed25519=tn.ed25519||{};var It=tn.ed25519;It.constants={};It.constants.PUBLIC_KEY_BYTE_LENGTH=32;It.constants.PRIVATE_KEY_BYTE_LENGTH=64;It.constants.SEED_BYTE_LENGTH=32;It.constants.SIGN_BYTE_LENGTH=64;It.constants.HASH_BYTE_LENGTH=64;It.generateKeyPair=function(r){r=r||{};var e=r.seed;if(e===void 0)e=tn.random.getBytesSync(It.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==It.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+It.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=Dc({message:e,encoding:"binary"});for(var t=new Wn(It.constants.PUBLIC_KEY_BYTE_LENGTH),i=new Wn(It.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)i[n]=e[n];return A4e(t,i),{publicKey:t,privateKey:i}};It.privateKeyFromAsn1=function(r){var e={},t=[],i=tn.asn1.validate(r,x4e,e,t);if(!i){var n=new Error("Invalid Key.");throw n.errors=t,n}var s=tn.asn1.derToOid(e.privateKeyOid),o=tn.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.privateKey,c=Dc({message:tn.asn1.fromDer(a).value,encoding:"binary"});return{privateKeyBytes:c}};It.publicKeyFromAsn1=function(r){var e={},t=[],i=tn.asn1.validate(r,S4e,e,t);if(!i){var n=new Error("Invalid Key.");throw n.errors=t,n}var s=tn.asn1.derToOid(e.publicKeyOid),o=tn.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.ed25519PublicKey;if(a.length!==It.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Dc({message:a,encoding:"binary"})};It.publicKeyFromPrivateKey=function(r){r=r||{};var e=Dc({message:r.privateKey,encoding:"binary"});if(e.length!==It.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+It.constants.PRIVATE_KEY_BYTE_LENGTH);for(var t=new Wn(It.constants.PUBLIC_KEY_BYTE_LENGTH),i=0;i<t.length;++i)t[i]=e[32+i];return t};It.sign=function(r){r=r||{};var e=Dc(r),t=Dc({message:r.privateKey,encoding:"binary"});if(t.length===It.constants.SEED_BYTE_LENGTH){var i=It.generateKeyPair({seed:t});t=i.privateKey}else if(t.length!==It.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+It.constants.SEED_BYTE_LENGTH+" or "+It.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new Wn(It.constants.SIGN_BYTE_LENGTH+e.length);I4e(n,e,e.length,t);for(var s=new Wn(It.constants.SIGN_BYTE_LENGTH),o=0;o<s.length;++o)s[o]=n[o];return s};It.verify=function(r){r=r||{};var e=Dc(r);if(r.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var t=Dc({message:r.signature,encoding:"binary"});if(t.length!==It.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+It.constants.SIGN_BYTE_LENGTH);var i=Dc({message:r.publicKey,encoding:"binary"});if(i.length!==It.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+It.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new Wn(It.constants.SIGN_BYTE_LENGTH+e.length),s=new Wn(It.constants.SIGN_BYTE_LENGTH+e.length),o;for(o=0;o<It.constants.SIGN_BYTE_LENGTH;++o)n[o]=t[o];for(o=0;o<e.length;++o)n[o+It.constants.SIGN_BYTE_LENGTH]=e[o];return T4e(s,n,n.length,i)>=0};function Dc(r){var e=r.message;if(e instanceof Uint8Array||e instanceof Wn)return e;var t=r.encoding;if(e===void 0)if(r.md)e=r.md.digest().getBytes(),t="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!t)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer!="undefined")return Buffer.from(e,t);e=new cx(e,t)}else if(!(e instanceof cx))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new Wn(e.length()),n=0;n<i.length;++n)i[n]=e.at(n);return i}var ux=it(),Em=it([1]),R4e=it([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),k4e=it([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),jD=it([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),VD=it([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),fx=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),C4e=it([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function dy(r,e){var t=tn.md.sha512.create(),i=new cx(r);t.update(i.getBytes(e),"binary");var n=t.digest().getBytes();if(typeof Buffer!="undefined")return Buffer.from(n,"binary");for(var s=new Wn(It.constants.HASH_BYTE_LENGTH),o=0;o<64;++o)s[o]=n.charCodeAt(o);return s}function A4e(r,e){var t=[it(),it(),it(),it()],i,n=dy(e,32);for(n[0]&=248,n[31]&=127,n[31]|=64,hx(t,n),lx(r,t),i=0;i<32;++i)e[i+32]=r[i];return 0}function I4e(r,e,t,i){var n,s,o=new Float64Array(64),a=[it(),it(),it(),it()],c=dy(i,32);c[0]&=248,c[31]&=127,c[31]|=64;var u=t+64;for(n=0;n<t;++n)r[64+n]=e[n];for(n=0;n<32;++n)r[32+n]=c[32+n];var f=dy(r.subarray(32),t+32);for(dx(f),hx(a,f),lx(r,a),n=32;n<64;++n)r[n]=i[n];var h=dy(r,t+64);for(dx(h),n=32;n<64;++n)o[n]=0;for(n=0;n<32;++n)o[n]=f[n];for(n=0;n<32;++n)for(s=0;s<32;s++)o[n+s]+=h[n]*c[s];return zD(r.subarray(32),o),u}function T4e(r,e,t,i){var n,s,o=new Wn(32),a=[it(),it(),it(),it()],c=[it(),it(),it(),it()];if(s=-1,t<64||P4e(c,i))return-1;for(n=0;n<t;++n)r[n]=e[n];for(n=0;n<32;++n)r[n+32]=i[n];var u=dy(r,t);if(dx(u),GD(a,c,u),hx(c,e.subarray(32)),px(a,c),lx(o,a),t-=64,HD(e,0,o,0)){for(n=0;n<t;++n)r[n]=0;return-1}for(n=0;n<t;++n)r[n]=e[n+64];return s=t,s}function zD(r,e){var t,i,n,s;for(i=63;i>=32;--i){for(t=0,n=i-32,s=i-12;n<s;++n)e[n]+=t-16*e[i]*fx[n-(i-32)],t=e[n]+128>>8,e[n]-=t*256;e[n]+=t,e[i]=0}for(t=0,n=0;n<32;++n)e[n]+=t-(e[31]>>4)*fx[n],t=e[n]>>8,e[n]&=255;for(n=0;n<32;++n)e[n]-=t*fx[n];for(i=0;i<32;++i)e[i+1]+=e[i]>>8,r[i]=e[i]&255}function dx(r){for(var e=new Float64Array(64),t=0;t<64;++t)e[t]=r[t],r[t]=0;zD(r,e)}function px(r,e){var t=it(),i=it(),n=it(),s=it(),o=it(),a=it(),c=it(),u=it(),f=it();Wh(t,r[1],r[0]),Wh(f,e[1],e[0]),gr(t,t,f),$h(i,r[0],r[1]),$h(f,e[0],e[1]),gr(i,i,f),gr(n,r[3],e[3]),gr(n,n,k4e),gr(s,r[2],e[2]),$h(s,s,s),Wh(o,i,t),Wh(a,s,n),$h(c,s,n),$h(u,i,t),gr(r[0],o,a),gr(r[1],u,c),gr(r[2],c,a),gr(r[3],o,u)}function WD(r,e,t){for(var i=0;i<4;++i)$D(r[i],e[i],t)}function lx(r,e){var t=it(),i=it(),n=it();O4e(n,e[2]),gr(t,e[0],n),gr(i,e[1],n),Sm(r,i),r[31]^=YD(t)<<7}function Sm(r,e){var t,i,n,s=it(),o=it();for(t=0;t<16;++t)o[t]=e[t];for(yx(o),yx(o),yx(o),i=0;i<2;++i){for(s[0]=o[0]-65517,t=1;t<15;++t)s[t]=o[t]-65535-(s[t-1]>>16&1),s[t-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,$D(o,s,1-n)}for(t=0;t<16;t++)r[2*t]=o[t]&255,r[2*t+1]=o[t]>>8}function P4e(r,e){var t=it(),i=it(),n=it(),s=it(),o=it(),a=it(),c=it();return Bu(r[2],Em),B4e(r[1],e),Jf(n,r[1]),gr(s,n,R4e),Wh(n,n,r[2]),$h(s,r[2],s),Jf(o,s),Jf(a,o),gr(c,a,o),gr(t,c,n),gr(t,t,s),N4e(t,t),gr(t,t,n),gr(t,t,s),gr(t,t,s),gr(r[0],t,s),Jf(i,r[0]),gr(i,i,s),XD(i,n)&&gr(r[0],r[0],C4e),Jf(i,r[0]),gr(i,i,s),XD(i,n)?-1:(YD(r[0])===e[31]>>7&&Wh(r[0],ux,r[0]),gr(r[3],r[0],r[1]),0)}function B4e(r,e){var t;for(t=0;t<16;++t)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function N4e(r,e){var t=it(),i;for(i=0;i<16;++i)t[i]=e[i];for(i=250;i>=0;--i)Jf(t,t),i!==1&&gr(t,t,e);for(i=0;i<16;++i)r[i]=t[i]}function XD(r,e){var t=new Wn(32),i=new Wn(32);return Sm(t,r),Sm(i,e),HD(t,0,i,0)}function HD(r,e,t,i){return D4e(r,e,t,i,32)}function D4e(r,e,t,i,n){var s,o=0;for(s=0;s<n;++s)o|=r[e+s]^t[i+s];return(1&o-1>>>8)-1}function YD(r){var e=new Wn(32);return Sm(e,r),e[0]&1}function GD(r,e,t){var i,n;for(Bu(r[0],ux),Bu(r[1],Em),Bu(r[2],Em),Bu(r[3],ux),n=255;n>=0;--n)i=t[n/8|0]>>(n&7)&1,WD(r,e,i),px(e,r),px(r,r),WD(r,e,i)}function hx(r,e){var t=[it(),it(),it(),it()];Bu(t[0],jD),Bu(t[1],VD),Bu(t[2],Em),gr(t[3],jD,VD),GD(r,t,e)}function Bu(r,e){var t;for(t=0;t<16;t++)r[t]=e[t]|0}function O4e(r,e){var t=it(),i;for(i=0;i<16;++i)t[i]=e[i];for(i=253;i>=0;--i)Jf(t,t),i!==2&&i!==4&&gr(t,t,e);for(i=0;i<16;++i)r[i]=t[i]}function yx(r){var e,t,i=1;for(e=0;e<16;++e)t=r[e]+i+65535,i=Math.floor(t/65536),r[e]=t-i*65536;r[0]+=i-1+37*(i-1)}function $D(r,e,t){for(var i,n=~(t-1),s=0;s<16;++s)i=n&(r[s]^e[s]),r[s]^=i,e[s]^=i}function it(r){var e,t=new Float64Array(16);if(r)for(e=0;e<r.length;++e)t[e]=r[e];return t}function $h(r,e,t){for(var i=0;i<16;++i)r[i]=e[i]+t[i]}function Wh(r,e,t){for(var i=0;i<16;++i)r[i]=e[i]-t[i]}function Jf(r,e){gr(r,e,e)}function gr(r,e,t){var i,n,s=0,o=0,a=0,c=0,u=0,f=0,h=0,d=0,y=0,g=0,m=0,x=0,_=0,P=0,q=0,X=0,W=0,z=0,Z=0,ee=0,re=0,L=0,b=0,w=0,R=0,B=0,U=0,Q=0,G=0,M=0,v=0,V=t[0],de=t[1],J=t[2],ue=t[3],S=t[4],A=t[5],ie=t[6],ae=t[7],E=t[8],I=t[9],j=t[10],H=t[11],T=t[12],K=t[13],F=t[14],N=t[15];i=e[0],s+=i*V,o+=i*de,a+=i*J,c+=i*ue,u+=i*S,f+=i*A,h+=i*ie,d+=i*ae,y+=i*E,g+=i*I,m+=i*j,x+=i*H,_+=i*T,P+=i*K,q+=i*F,X+=i*N,i=e[1],o+=i*V,a+=i*de,c+=i*J,u+=i*ue,f+=i*S,h+=i*A,d+=i*ie,y+=i*ae,g+=i*E,m+=i*I,x+=i*j,_+=i*H,P+=i*T,q+=i*K,X+=i*F,W+=i*N,i=e[2],a+=i*V,c+=i*de,u+=i*J,f+=i*ue,h+=i*S,d+=i*A,y+=i*ie,g+=i*ae,m+=i*E,x+=i*I,_+=i*j,P+=i*H,q+=i*T,X+=i*K,W+=i*F,z+=i*N,i=e[3],c+=i*V,u+=i*de,f+=i*J,h+=i*ue,d+=i*S,y+=i*A,g+=i*ie,m+=i*ae,x+=i*E,_+=i*I,P+=i*j,q+=i*H,X+=i*T,W+=i*K,z+=i*F,Z+=i*N,i=e[4],u+=i*V,f+=i*de,h+=i*J,d+=i*ue,y+=i*S,g+=i*A,m+=i*ie,x+=i*ae,_+=i*E,P+=i*I,q+=i*j,X+=i*H,W+=i*T,z+=i*K,Z+=i*F,ee+=i*N,i=e[5],f+=i*V,h+=i*de,d+=i*J,y+=i*ue,g+=i*S,m+=i*A,x+=i*ie,_+=i*ae,P+=i*E,q+=i*I,X+=i*j,W+=i*H,z+=i*T,Z+=i*K,ee+=i*F,re+=i*N,i=e[6],h+=i*V,d+=i*de,y+=i*J,g+=i*ue,m+=i*S,x+=i*A,_+=i*ie,P+=i*ae,q+=i*E,X+=i*I,W+=i*j,z+=i*H,Z+=i*T,ee+=i*K,re+=i*F,L+=i*N,i=e[7],d+=i*V,y+=i*de,g+=i*J,m+=i*ue,x+=i*S,_+=i*A,P+=i*ie,q+=i*ae,X+=i*E,W+=i*I,z+=i*j,Z+=i*H,ee+=i*T,re+=i*K,L+=i*F,b+=i*N,i=e[8],y+=i*V,g+=i*de,m+=i*J,x+=i*ue,_+=i*S,P+=i*A,q+=i*ie,X+=i*ae,W+=i*E,z+=i*I,Z+=i*j,ee+=i*H,re+=i*T,L+=i*K,b+=i*F,w+=i*N,i=e[9],g+=i*V,m+=i*de,x+=i*J,_+=i*ue,P+=i*S,q+=i*A,X+=i*ie,W+=i*ae,z+=i*E,Z+=i*I,ee+=i*j,re+=i*H,L+=i*T,b+=i*K,w+=i*F,R+=i*N,i=e[10],m+=i*V,x+=i*de,_+=i*J,P+=i*ue,q+=i*S,X+=i*A,W+=i*ie,z+=i*ae,Z+=i*E,ee+=i*I,re+=i*j,L+=i*H,b+=i*T,w+=i*K,R+=i*F,B+=i*N,i=e[11],x+=i*V,_+=i*de,P+=i*J,q+=i*ue,X+=i*S,W+=i*A,z+=i*ie,Z+=i*ae,ee+=i*E,re+=i*I,L+=i*j,b+=i*H,w+=i*T,R+=i*K,B+=i*F,U+=i*N,i=e[12],_+=i*V,P+=i*de,q+=i*J,X+=i*ue,W+=i*S,z+=i*A,Z+=i*ie,ee+=i*ae,re+=i*E,L+=i*I,b+=i*j,w+=i*H,R+=i*T,B+=i*K,U+=i*F,Q+=i*N,i=e[13],P+=i*V,q+=i*de,X+=i*J,W+=i*ue,z+=i*S,Z+=i*A,ee+=i*ie,re+=i*ae,L+=i*E,b+=i*I,w+=i*j,R+=i*H,B+=i*T,U+=i*K,Q+=i*F,G+=i*N,i=e[14],q+=i*V,X+=i*de,W+=i*J,z+=i*ue,Z+=i*S,ee+=i*A,re+=i*ie,L+=i*ae,b+=i*E,w+=i*I,R+=i*j,B+=i*H,U+=i*T,Q+=i*K,G+=i*F,M+=i*N,i=e[15],X+=i*V,W+=i*de,z+=i*J,Z+=i*ue,ee+=i*S,re+=i*A,L+=i*ie,b+=i*ae,w+=i*E,R+=i*I,B+=i*j,U+=i*H,Q+=i*T,G+=i*K,M+=i*F,v+=i*N,s+=38*W,o+=38*z,a+=38*Z,c+=38*ee,u+=38*re,f+=38*L,h+=38*b,d+=38*w,y+=38*R,g+=38*B,m+=38*U,x+=38*Q,_+=38*G,P+=38*M,q+=38*v,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=x+n+65535,n=Math.floor(i/65536),x=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,i=P+n+65535,n=Math.floor(i/65536),P=i-n*65536,i=q+n+65535,n=Math.floor(i/65536),q=i-n*65536,i=X+n+65535,n=Math.floor(i/65536),X=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=x+n+65535,n=Math.floor(i/65536),x=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,i=P+n+65535,n=Math.floor(i/65536),P=i-n*65536,i=q+n+65535,n=Math.floor(i/65536),q=i-n*65536,i=X+n+65535,n=Math.floor(i/65536),X=i-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=o,r[2]=a,r[3]=c,r[4]=u,r[5]=f,r[6]=h,r[7]=d,r[8]=y,r[9]=g,r[10]=m,r[11]=x,r[12]=_,r[13]=P,r[14]=q,r[15]=X}});var QD=p((Kyt,JD)=>{l();"use strict";var xm=65536;function q4e(r){let e=new Uint8Array(r),t=0;if(r>0)if(r>xm)for(;t<r;)t+xm>r?(crypto.getRandomValues(e.subarray(t,t+(r-t))),t+=r-t):(crypto.getRandomValues(e.subarray(t,t+xm)),t+=xm);else crypto.getRandomValues(e);return e}JD.exports=q4e});var py=p((jyt,ZD)=>{l();"use strict";var M4e=QD(),L4e=ge();ZD.exports=function(r){if(isNaN(r)||r<=0)throw L4e(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return M4e(r)}});var Am=p(yy=>{l();"use strict";yr();uy();var F4e=bt(),U4e=ct(),eq=tt(),tq=vi();yy.bigIntegerToUintBase64url=(r,e)=>{let t=Uint8Array.from(r.abs().toByteArray());if(t=t[0]===0?t.slice(1):t,e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=tq([new Uint8Array(e-t.length),t])}return eq(t,"base64url")};yy.base64urlToBigInteger=r=>{let e=yy.base64urlToBuffer(r);return new F4e.jsbn.BigInteger(eq(e,"base16"),16)};yy.base64urlToBuffer=(r,e)=>{let t=U4e(r,"base64urlpad");if(e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=tq([new Uint8Array(e-t.length),t])}return t}});var nq=p(gy=>{l();"use strict";Pc();fy();var Nu=bt(),{bigIntegerToUintBase64url:Ca,base64urlToBigInteger:Pa}=Am(),rq=ct(),iq=tt();gy.pkcs1ToJwk=function(r){let e=Nu.asn1.fromDer(iq(r,"ascii")),t=Nu.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Ca(t.n),e:Ca(t.e),d:Ca(t.d),p:Ca(t.p),q:Ca(t.q),dp:Ca(t.dP),dq:Ca(t.dQ),qi:Ca(t.qInv),alg:"RS256",kid:"2011-04-29"}};gy.jwkToPkcs1=function(r){let e=Nu.pki.privateKeyToAsn1({n:Pa(r.n),e:Pa(r.e),d:Pa(r.d),p:Pa(r.p),q:Pa(r.q),dP:Pa(r.dp),dQ:Pa(r.dq),qInv:Pa(r.qi)});return rq(Nu.asn1.toDer(e).getBytes(),"ascii")};gy.pkixToJwk=function(r){let e=Nu.asn1.fromDer(iq(r,"ascii")),t=Nu.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Ca(t.n),e:Ca(t.e),alg:"RS256",kid:"2011-04-29"}};gy.jwkToPkix=function(r){let e=Nu.pki.publicKeyToAsn1({n:Pa(r.n),e:Pa(r.e)});return rq(Nu.asn1.toDer(e).getBytes(),"ascii")}});var cq=p((Hyt,sq)=>{l();"use strict";fy();var oq=bt(),{base64urlToBigInteger:K4e}=Am();function aq(r,e){return e.map(t=>K4e(r[t]))}function j4e(r){return oq.pki.setRsaPrivateKey(...aq(r,["n","e","d","p","q","dp","dq","qi"]))}function V4e(r){return oq.pki.setRsaPublicKey(...aq(r,["n","e"]))}sq.exports={jwk2pub:V4e,jwk2priv:j4e}});var lq=p(qc=>{l();"use strict";var Mc=ly(),z4e=py(),H4e=tt(),G4e=ct();qc.utils=nq();qc.generateKey=async function(r){let e=await Mc.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),t=await uq(e);return{privateKey:t[0],publicKey:t[1]}};qc.unmarshalPrivateKey=async function(r){let t=[await Mc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await $4e(r)],i=await uq({privateKey:t[0],publicKey:t[1]});return{privateKey:i[0],publicKey:i[1]}};qc.getRandomValues=z4e;qc.hashAndSign=async function(r,e){let t=await Mc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await Mc.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},t,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};qc.hashAndVerify=async function(r,e,t){let i=await Mc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Mc.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,t)};function uq(r){return Promise.all([Mc.get().subtle.exportKey("jwk",r.privateKey),Mc.get().subtle.exportKey("jwk",r.publicKey)])}function $4e(r){return Mc.get().subtle.importKey("jwk",{kty:r.kty,n:r.n,e:r.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:W4e,jwk2priv:Y4e}=cq();function fq(r,e,t,i){let n=e?W4e(r):Y4e(r),s=H4e(Uint8Array.from(t),"ascii"),o=i(s,n);return G4e(o,"ascii")}qc.encrypt=function(r,e){return fq(r,!0,e,(t,i)=>i.encrypt(t))};qc.decrypt=function(r,e){return fq(r,!1,e,(t,i)=>i.decrypt(t))}});var Im=p(($yt,hq)=>{l();"use strict";var X4e=en(),J4e=ix();hq.exports={export:async function(r,e){let i=await J4e.create().encrypt(r,e);return X4e.names.base64.encode(i)}}});var bq=p((Wyt,dq)=>{l();"use strict";var pq=Gh(),yq=ge(),gq=Dr(),Q4e=tt();_m();gx();var Tm=bt(),Ks=lq(),Rm=im(),Z4e=Im(),km=class{constructor(e){this._key=e}async verify(e,t){return Ks.hashAndVerify(this._key,t,e)}marshal(){return Ks.utils.jwkToPkix(this._key)}get bytes(){return Rm.PublicKey.encode({Type:Rm.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return Ks.encrypt(this._key,e)}equals(e){return gq(this.bytes,e.bytes)}async hash(){return pq.multihashing(this.bytes,"sha2-256")}},by=class{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return Ks.getRandomValues(16)}async sign(e){return Ks.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw yq(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new km(this._publicKey)}decrypt(e){return Ks.decrypt(this._key,e)}marshal(){return Ks.utils.jwkToPkcs1(this._key)}get bytes(){return Rm.PrivateKey.encode({Type:Rm.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return gq(this.bytes,e.bytes)}async hash(){return pq.multihashing(this.bytes,"sha2-256")}async id(){let e=await this.public.hash();return Q4e(e,"base58btc")}async export(e,t="pkcs-8"){if(t==="pkcs-8"){let i=new Tm.util.ByteBuffer(this.marshal()),n=Tm.asn1.fromDer(i),s=Tm.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Tm.pki.encryptRsaPrivateKey(s,e,o)}else{if(t==="libp2p-key")return Z4e.export(this.bytes,e);throw yq(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function eAe(r){let e=Ks.utils.pkcs1ToJwk(r),t=await Ks.unmarshalPrivateKey(e);return new by(t.privateKey,t.publicKey)}function tAe(r){let e=Ks.utils.pkixToJwk(r);return new km(e)}async function rAe(r){let e=await Ks.unmarshalPrivateKey(r);return new by(e.privateKey,e.publicKey)}async function iAe(r){let e=await Ks.generateKey(r);return new by(e.privateKey,e.publicKey)}dq.exports={RsaPublicKey:km,RsaPrivateKey:by,unmarshalRsaPublicKey:tAe,unmarshalRsaPrivateKey:eAe,generateKeyPair:iAe,fromJwk:rAe}});var mq=p(Qf=>{l();"use strict";gx();var Yh=bt();Qf.publicKeyLength=Yh.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH;Qf.privateKeyLength=Yh.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH;Qf.generateKey=async function(){return Yh.pki.ed25519.generateKeyPair()};Qf.generateKeyFromSeed=async function(r){return Yh.pki.ed25519.generateKeyPair({seed:r})};Qf.hashAndSign=async function(r,e){return Yh.pki.ed25519.sign({message:e,privateKey:r})};Qf.hashAndVerify=async function(r,e,t){return Yh.pki.ed25519.verify({signature:e,message:t,publicKey:r})}});var xq=p((Xyt,vq)=>{l();"use strict";var wq=Gh(),_q=ge(),Eq=Dr(),Sq=ko(),hn=mq(),Cm=im(),nAe=Im(),Pm=class{constructor(e){this._key=Xh(e,hn.publicKeyLength)}async verify(e,t){return hn.hashAndVerify(this._key,t,e)}marshal(){return this._key}get bytes(){return Cm.PublicKey.encode({Type:Cm.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Eq(this.bytes,e.bytes)}async hash(){return wq.multihashing(this.bytes,"sha2-256")}},Jh=class{constructor(e,t){this._key=Xh(e,hn.privateKeyLength),this._publicKey=Xh(t,hn.publicKeyLength)}async sign(e){return hn.hashAndSign(this._key,e)}get public(){return new Pm(this._publicKey)}marshal(){return this._key}get bytes(){return Cm.PrivateKey.encode({Type:Cm.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Eq(this.bytes,e.bytes)}async hash(){return wq.multihashing(this.bytes,"sha2-256")}async id(){let e=Sq.encode(this.public.bytes,"identity");return await Sq.toB58String(e)}async export(e,t="libp2p-key"){if(t==="libp2p-key")return nAe.export(this.bytes,e);throw _q(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function sAe(r){if(r.length>hn.privateKeyLength){r=Xh(r,hn.privateKeyLength+hn.publicKeyLength);let i=r.slice(0,hn.privateKeyLength),n=r.slice(hn.privateKeyLength,r.length);return new Jh(i,n)}r=Xh(r,hn.privateKeyLength);let e=r.slice(0,hn.privateKeyLength),t=r.slice(hn.publicKeyLength);return new Jh(e,t)}function oAe(r){return r=Xh(r,hn.publicKeyLength),new Pm(r)}async function aAe(){let{privateKey:r,publicKey:e}=await hn.generateKey();return new Jh(r,e)}async function cAe(r){let{privateKey:e,publicKey:t}=await hn.generateKeyFromSeed(r);return new Jh(e,t)}function Xh(r,e){if(r=Uint8Array.from(r||[]),r.length!==e)throw _q(new Error(`Key must be a Uint8Array of length ${e}, got ${r.length}`),"ERR_INVALID_KEY_TYPE");return r}vq.exports={Ed25519PublicKey:Pm,Ed25519PrivateKey:Jh,unmarshalEd25519PrivateKey:sAe,unmarshalEd25519PublicKey:oAe,generateKeyPair:aAe,generateKeyPairFromSeed:cAe}});var Iq=p((Jyt,Aq)=>{l();var jt={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function js(r,e){if(!r)throw new Error(e)}function Nt(r,e,t){if(js(e instanceof Uint8Array,`Expected ${r} to be an Uint8Array`),t!==void 0)if(Array.isArray(t)){let i=t.join(", "),n=`Expected ${r} to be an Uint8Array with length [${i}]`;js(t.includes(e.length),n)}else{let i=`Expected ${r} to be an Uint8Array with length ${t}`;js(e.length===t,i)}}function Zf(r){js(Qh(r)==="Boolean","Expected compressed to be a Boolean")}function No(r=t=>new Uint8Array(t),e){return typeof r=="function"&&(r=r(e)),Nt("output",r,e),r}function Qh(r){return Object.prototype.toString.call(r).slice(8,-1)}Aq.exports=r=>({contextRandomize(e){switch(js(e===null||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),e!==null&&Nt("seed",e,32),r.contextRandomize(e)){case 1:throw new Error(jt.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(e){return Nt("private key",e,32),r.privateKeyVerify(e)===0},privateKeyNegate(e){switch(Nt("private key",e,32),r.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(jt.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(e,t){switch(Nt("private key",e,32),Nt("tweak",t,32),r.privateKeyTweakAdd(e,t)){case 0:return e;case 1:throw new Error(jt.TWEAK_ADD)}},privateKeyTweakMul(e,t){switch(Nt("private key",e,32),Nt("tweak",t,32),r.privateKeyTweakMul(e,t)){case 0:return e;case 1:throw new Error(jt.TWEAK_MUL)}},publicKeyVerify(e){return Nt("public key",e,[33,65]),r.publicKeyVerify(e)===0},publicKeyCreate(e,t=!0,i){switch(Nt("private key",e,32),Zf(t),i=No(i,t?33:65),r.publicKeyCreate(i,e)){case 0:return i;case 1:throw new Error(jt.SECKEY_INVALID);case 2:throw new Error(jt.PUBKEY_SERIALIZE)}},publicKeyConvert(e,t=!0,i){switch(Nt("public key",e,[33,65]),Zf(t),i=No(i,t?33:65),r.publicKeyConvert(i,e)){case 0:return i;case 1:throw new Error(jt.PUBKEY_PARSE);case 2:throw new Error(jt.PUBKEY_SERIALIZE)}},publicKeyNegate(e,t=!0,i){switch(Nt("public key",e,[33,65]),Zf(t),i=No(i,t?33:65),r.publicKeyNegate(i,e)){case 0:return i;case 1:throw new Error(jt.PUBKEY_PARSE);case 2:throw new Error(jt.IMPOSSIBLE_CASE);case 3:throw new Error(jt.PUBKEY_SERIALIZE)}},publicKeyCombine(e,t=!0,i){js(Array.isArray(e),"Expected public keys to be an Array"),js(e.length>0,"Expected public keys array will have more than zero items");for(let n of e)Nt("public key",n,[33,65]);switch(Zf(t),i=No(i,t?33:65),r.publicKeyCombine(i,e)){case 0:return i;case 1:throw new Error(jt.PUBKEY_PARSE);case 2:throw new Error(jt.PUBKEY_COMBINE);case 3:throw new Error(jt.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(e,t,i=!0,n){switch(Nt("public key",e,[33,65]),Nt("tweak",t,32),Zf(i),n=No(n,i?33:65),r.publicKeyTweakAdd(n,e,t)){case 0:return n;case 1:throw new Error(jt.PUBKEY_PARSE);case 2:throw new Error(jt.TWEAK_ADD)}},publicKeyTweakMul(e,t,i=!0,n){switch(Nt("public key",e,[33,65]),Nt("tweak",t,32),Zf(i),n=No(n,i?33:65),r.publicKeyTweakMul(n,e,t)){case 0:return n;case 1:throw new Error(jt.PUBKEY_PARSE);case 2:throw new Error(jt.TWEAK_MUL)}},signatureNormalize(e){switch(Nt("signature",e,64),r.signatureNormalize(e)){case 0:return e;case 1:throw new Error(jt.SIG_PARSE)}},signatureExport(e,t){Nt("signature",e,64),t=No(t,72);let i={output:t,outputlen:72};switch(r.signatureExport(i,e)){case 0:return t.slice(0,i.outputlen);case 1:throw new Error(jt.SIG_PARSE);case 2:throw new Error(jt.IMPOSSIBLE_CASE)}},signatureImport(e,t){switch(Nt("signature",e),t=No(t,64),r.signatureImport(t,e)){case 0:return t;case 1:throw new Error(jt.SIG_PARSE);case 2:throw new Error(jt.IMPOSSIBLE_CASE)}},ecdsaSign(e,t,i={},n){Nt("message",e,32),Nt("private key",t,32),js(Qh(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Nt("options.data",i.data),i.noncefn!==void 0&&js(Qh(i.noncefn)==="Function","Expected options.noncefn to be a Function"),n=No(n,64);let s={signature:n,recid:null};switch(r.ecdsaSign(s,e,t,i.data,i.noncefn)){case 0:return s;case 1:throw new Error(jt.SIGN);case 2:throw new Error(jt.IMPOSSIBLE_CASE)}},ecdsaVerify(e,t,i){switch(Nt("signature",e,64),Nt("message",t,32),Nt("public key",i,[33,65]),r.ecdsaVerify(e,t,i)){case 0:return!0;case 3:return!1;case 1:throw new Error(jt.SIG_PARSE);case 2:throw new Error(jt.PUBKEY_PARSE)}},ecdsaRecover(e,t,i,n=!0,s){switch(Nt("signature",e,64),js(Qh(t)==="Number"&&t>=0&&t<=3,"Expected recovery id to be a Number within interval [0, 3]"),Nt("message",i,32),Zf(n),s=No(s,n?33:65),r.ecdsaRecover(s,e,t,i)){case 0:return s;case 1:throw new Error(jt.SIG_PARSE);case 2:throw new Error(jt.RECOVER);case 3:throw new Error(jt.IMPOSSIBLE_CASE)}},ecdh(e,t,i={},n){switch(Nt("public key",e,[33,65]),Nt("private key",t,32),js(Qh(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Nt("options.data",i.data),i.hashfn!==void 0?(js(Qh(i.hashfn)==="Function","Expected options.hashfn to be a Function"),i.xbuf!==void 0&&Nt("options.xbuf",i.xbuf,32),i.ybuf!==void 0&&Nt("options.ybuf",i.ybuf,32),Nt("output",n)):n=No(n,32),r.ecdh(n,e,t,i.data,i.hashfn,i.xbuf,i.ybuf)){case 0:return n;case 1:throw new Error(jt.PUBKEY_PARSE);case 2:throw new Error(jt.ECDH)}}})});var Rq=p((Qyt,Tq)=>{Tq.exports={_from:"elliptic@^6.5.2",_id:"elliptic@6.5.4",_inBundle:!1,_integrity:"sha512-iLhC6ULemrljPZb+QutR5TQGB+pdW6KGD5RSegS+8sorOZT+rdQFbsQFJgvN3eRqNALqJer4oQ16YvJHlU8hzQ==",_location:"/elliptic",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"elliptic@^6.5.2",name:"elliptic",escapedName:"elliptic",rawSpec:"^6.5.2",saveSpec:null,fetchSpec:"^6.5.2"},_requiredBy:["/secp256k1"],_resolved:"https://registry.npmjs.org/elliptic/-/elliptic-6.5.4.tgz",_shasum:"da37cebd31e79a1367e941b592ed1fbebd58abbb",_spec:"elliptic@^6.5.2",_where:"/Users/alex/Documents/Workspaces/ipfs/js-ipfs/node_modules/secp256k1",author:{name:"Fedor Indutny",email:"fedor@indutny.com"},bugs:{url:"https://github.com/indutny/elliptic/issues"},bundleDependencies:!1,dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},deprecated:!1,description:"EC cryptography",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},files:["lib"],homepage:"https://github.com/indutny/elliptic",keywords:["EC","Elliptic","curve","Cryptography"],license:"MIT",main:"lib/elliptic.js",name:"elliptic",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.5.4"}});var kq=p(()=>{l()});var Oa=p((Cq,bx)=>{l();(function(r,e){"use strict";function t(L,b){if(!L)throw new Error(b||"Assertion failed")}function i(L,b){L.super_=b;var w=function(){};w.prototype=b.prototype,L.prototype=new w,L.prototype.constructor=L}function n(L,b,w){if(n.isBN(L))return L;this.negative=0,this.words=null,this.length=0,this.red=null,L!==null&&((b==="le"||b==="be")&&(w=b,b=10),this._init(L||0,b||10,w||"be"))}typeof r=="object"?r.exports=n:e.BN=n,n.BN=n,n.wordSize=26;var s;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?s=window.Buffer:s=kq().Buffer}catch(L){}n.isBN=function(b){return b instanceof n?!0:b!==null&&typeof b=="object"&&b.constructor.wordSize===n.wordSize&&Array.isArray(b.words)},n.max=function(b,w){return b.cmp(w)>0?b:w},n.min=function(b,w){return b.cmp(w)<0?b:w},n.prototype._init=function(b,w,R){if(typeof b=="number")return this._initNumber(b,w,R);if(typeof b=="object")return this._initArray(b,w,R);w==="hex"&&(w=16),t(w===(w|0)&&w>=2&&w<=36),b=b.toString().replace(/\s+/g,"");var B=0;b[0]==="-"&&(B++,this.negative=1),B<b.length&&(w===16?this._parseHex(b,B,R):(this._parseBase(b,w,B),R==="le"&&this._initArray(this.toArray(),w,R)))},n.prototype._initNumber=function(b,w,R){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[b&67108863],this.length=1):b<4503599627370496?(this.words=[b&67108863,b/67108864&67108863],this.length=2):(t(b<9007199254740992),this.words=[b&67108863,b/67108864&67108863,1],this.length=3),R==="le"&&this._initArray(this.toArray(),w,R)},n.prototype._initArray=function(b,w,R){if(t(typeof b.length=="number"),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var B=0;B<this.length;B++)this.words[B]=0;var U,Q,G=0;if(R==="be")for(B=b.length-1,U=0;B>=0;B-=3)Q=b[B]|b[B-1]<<8|b[B-2]<<16,this.words[U]|=Q<<G&67108863,this.words[U+1]=Q>>>26-G&67108863,G+=24,G>=26&&(G-=26,U++);else if(R==="le")for(B=0,U=0;B<b.length;B+=3)Q=b[B]|b[B+1]<<8|b[B+2]<<16,this.words[U]|=Q<<G&67108863,this.words[U+1]=Q>>>26-G&67108863,G+=24,G>=26&&(G-=26,U++);return this.strip()};function o(L,b){var w=L.charCodeAt(b);return w>=65&&w<=70?w-55:w>=97&&w<=102?w-87:w-48&15}function a(L,b,w){var R=o(L,w);return w-1>=b&&(R|=o(L,w-1)<<4),R}n.prototype._parseHex=function(b,w,R){this.length=Math.ceil((b.length-w)/6),this.words=new Array(this.length);for(var B=0;B<this.length;B++)this.words[B]=0;var U=0,Q=0,G;if(R==="be")for(B=b.length-1;B>=w;B-=2)G=a(b,w,B)<<U,this.words[Q]|=G&67108863,U>=18?(U-=18,Q+=1,this.words[Q]|=G>>>26):U+=8;else{var M=b.length-w;for(B=M%2==0?w+1:w;B<b.length;B+=2)G=a(b,w,B)<<U,this.words[Q]|=G&67108863,U>=18?(U-=18,Q+=1,this.words[Q]|=G>>>26):U+=8}this.strip()};function c(L,b,w,R){for(var B=0,U=Math.min(L.length,w),Q=b;Q<U;Q++){var G=L.charCodeAt(Q)-48;B*=R,G>=49?B+=G-49+10:G>=17?B+=G-17+10:B+=G}return B}n.prototype._parseBase=function(b,w,R){this.words=[0],this.length=1;for(var B=0,U=1;U<=67108863;U*=w)B++;B--,U=U/w|0;for(var Q=b.length-R,G=Q%B,M=Math.min(Q,Q-G)+R,v=0,V=R;V<M;V+=B)v=c(b,V,V+B,w),this.imuln(U),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v);if(G!==0){var de=1;for(v=c(b,V,b.length,w),V=0;V<G;V++)de*=w;this.imuln(de),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v)}this.strip()},n.prototype.copy=function(b){b.words=new Array(this.length);for(var w=0;w<this.length;w++)b.words[w]=this.words[w];b.length=this.length,b.negative=this.negative,b.red=this.red},n.prototype.clone=function(){var b=new n(null);return this.copy(b),b},n.prototype._expand=function(b){for(;this.length<b;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(b,w){b=b||10,w=w|0||1;var R;if(b===16||b==="hex"){R="";for(var B=0,U=0,Q=0;Q<this.length;Q++){var G=this.words[Q],M=((G<<B|U)&16777215).toString(16);U=G>>>24-B&16777215,U!==0||Q!==this.length-1?R=u[6-M.length]+M+R:R=M+R,B+=2,B>=26&&(B-=26,Q--)}for(U!==0&&(R=U.toString(16)+R);R.length%w!=0;)R="0"+R;return this.negative!==0&&(R="-"+R),R}if(b===(b|0)&&b>=2&&b<=36){var v=f[b],V=h[b];R="";var de=this.clone();for(de.negative=0;!de.isZero();){var J=de.modn(V).toString(b);de=de.idivn(V),de.isZero()?R=J+R:R=u[v-J.length]+J+R}for(this.isZero()&&(R="0"+R);R.length%w!=0;)R="0"+R;return this.negative!==0&&(R="-"+R),R}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var b=this.words[0];return this.length===2?b+=this.words[1]*67108864:this.length===3&&this.words[2]===1?b+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-b:b},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(b,w){return t(typeof s!="undefined"),this.toArrayLike(s,b,w)},n.prototype.toArray=function(b,w){return this.toArrayLike(Array,b,w)},n.prototype.toArrayLike=function(b,w,R){var B=this.byteLength(),U=R||Math.max(1,B);t(B<=U,"byte array longer than desired length"),t(U>0,"Requested array length <= 0"),this.strip();var Q=w==="le",G=new b(U),M,v,V=this.clone();if(Q){for(v=0;!V.isZero();v++)M=V.andln(255),V.iushrn(8),G[v]=M;for(;v<U;v++)G[v]=0}else{for(v=0;v<U-B;v++)G[v]=0;for(v=0;!V.isZero();v++)M=V.andln(255),V.iushrn(8),G[U-v-1]=M}return G},Math.clz32?n.prototype._countBits=function(b){return 32-Math.clz32(b)}:n.prototype._countBits=function(b){var w=b,R=0;return w>=4096&&(R+=13,w>>>=13),w>=64&&(R+=7,w>>>=7),w>=8&&(R+=4,w>>>=4),w>=2&&(R+=2,w>>>=2),R+w},n.prototype._zeroBits=function(b){if(b===0)return 26;var w=b,R=0;return(w&8191)==0&&(R+=13,w>>>=13),(w&127)==0&&(R+=7,w>>>=7),(w&15)==0&&(R+=4,w>>>=4),(w&3)==0&&(R+=2,w>>>=2),(w&1)==0&&R++,R},n.prototype.bitLength=function(){var b=this.words[this.length-1],w=this._countBits(b);return(this.length-1)*26+w};function d(L){for(var b=new Array(L.bitLength()),w=0;w<b.length;w++){var R=w/26|0,B=w%26;b[w]=(L.words[R]&1<<B)>>>B}return b}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,w=0;w<this.length;w++){var R=this._zeroBits(this.words[w]);if(b+=R,R!==26)break}return b},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(b){return this.negative!==0?this.abs().inotn(b).iaddn(1):this.clone()},n.prototype.fromTwos=function(b){return this.testn(b-1)?this.notn(b).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var w=0;w<b.length;w++)this.words[w]=this.words[w]|b.words[w];return this.strip()},n.prototype.ior=function(b){return t((this.negative|b.negative)==0),this.iuor(b)},n.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},n.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},n.prototype.iuand=function(b){var w;this.length>b.length?w=b:w=this;for(var R=0;R<w.length;R++)this.words[R]=this.words[R]&b.words[R];return this.length=w.length,this.strip()},n.prototype.iand=function(b){return t((this.negative|b.negative)==0),this.iuand(b)},n.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},n.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},n.prototype.iuxor=function(b){var w,R;this.length>b.length?(w=this,R=b):(w=b,R=this);for(var B=0;B<R.length;B++)this.words[B]=w.words[B]^R.words[B];if(this!==w)for(;B<w.length;B++)this.words[B]=w.words[B];return this.length=w.length,this.strip()},n.prototype.ixor=function(b){return t((this.negative|b.negative)==0),this.iuxor(b)},n.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},n.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},n.prototype.inotn=function(b){t(typeof b=="number"&&b>=0);var w=Math.ceil(b/26)|0,R=b%26;this._expand(w),R>0&&w--;for(var B=0;B<w;B++)this.words[B]=~this.words[B]&67108863;return R>0&&(this.words[B]=~this.words[B]&67108863>>26-R),this.strip()},n.prototype.notn=function(b){return this.clone().inotn(b)},n.prototype.setn=function(b,w){t(typeof b=="number"&&b>=0);var R=b/26|0,B=b%26;return this._expand(R+1),w?this.words[R]=this.words[R]|1<<B:this.words[R]=this.words[R]&~(1<<B),this.strip()},n.prototype.iadd=function(b){var w;if(this.negative!==0&&b.negative===0)return this.negative=0,w=this.isub(b),this.negative^=1,this._normSign();if(this.negative===0&&b.negative!==0)return b.negative=0,w=this.isub(b),b.negative=1,w._normSign();var R,B;this.length>b.length?(R=this,B=b):(R=b,B=this);for(var U=0,Q=0;Q<B.length;Q++)w=(R.words[Q]|0)+(B.words[Q]|0)+U,this.words[Q]=w&67108863,U=w>>>26;for(;U!==0&&Q<R.length;Q++)w=(R.words[Q]|0)+U,this.words[Q]=w&67108863,U=w>>>26;if(this.length=R.length,U!==0)this.words[this.length]=U,this.length++;else if(R!==this)for(;Q<R.length;Q++)this.words[Q]=R.words[Q];return this},n.prototype.add=function(b){var w;return b.negative!==0&&this.negative===0?(b.negative=0,w=this.sub(b),b.negative^=1,w):b.negative===0&&this.negative!==0?(this.negative=0,w=b.sub(this),this.negative=1,w):this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},n.prototype.isub=function(b){if(b.negative!==0){b.negative=0;var w=this.iadd(b);return b.negative=1,w._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var R=this.cmp(b);if(R===0)return this.negative=0,this.length=1,this.words[0]=0,this;var B,U;R>0?(B=this,U=b):(B=b,U=this);for(var Q=0,G=0;G<U.length;G++)w=(B.words[G]|0)-(U.words[G]|0)+Q,Q=w>>26,this.words[G]=w&67108863;for(;Q!==0&&G<B.length;G++)w=(B.words[G]|0)+Q,Q=w>>26,this.words[G]=w&67108863;if(Q===0&&G<B.length&&B!==this)for(;G<B.length;G++)this.words[G]=B.words[G];return this.length=Math.max(this.length,G),B!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(b){return this.clone().isub(b)};function y(L,b,w){w.negative=b.negative^L.negative;var R=L.length+b.length|0;w.length=R,R=R-1|0;var B=L.words[0]|0,U=b.words[0]|0,Q=B*U,G=Q&67108863,M=Q/67108864|0;w.words[0]=G;for(var v=1;v<R;v++){for(var V=M>>>26,de=M&67108863,J=Math.min(v,b.length-1),ue=Math.max(0,v-L.length+1);ue<=J;ue++){var S=v-ue|0;B=L.words[S]|0,U=b.words[ue]|0,Q=B*U+de,V+=Q/67108864|0,de=Q&67108863}w.words[v]=de|0,M=V|0}return M!==0?w.words[v]=M|0:w.length--,w.strip()}var g=function(b,w,R){var B=b.words,U=w.words,Q=R.words,G=0,M,v,V,de=B[0]|0,J=de&8191,ue=de>>>13,S=B[1]|0,A=S&8191,ie=S>>>13,ae=B[2]|0,E=ae&8191,I=ae>>>13,j=B[3]|0,H=j&8191,T=j>>>13,K=B[4]|0,F=K&8191,N=K>>>13,Y=B[5]|0,ne=Y&8191,te=Y>>>13,he=B[6]|0,me=he&8191,fe=he>>>13,je=B[7]|0,Ae=je&8191,Ve=je>>>13,Xe=B[8]|0,Ge=Xe&8191,ve=Xe>>>13,at=B[9]|0,St=at&8191,kt=at>>>13,Fr=U[0]|0,mt=Fr&8191,Ie=Fr>>>13,tr=U[1]|0,Ze=tr&8191,Kt=tr>>>13,cs=U[2]|0,Gt=cs&8191,De=cs>>>13,us=U[3]|0,$t=us&8191,Wt=us>>>13,fs=U[4]|0,Yt=fs&8191,yt=fs>>>13,So=U[5]|0,ar=So&8191,cr=So>>>13,xo=U[6]|0,Ye=xo&8191,ur=xo>>>13,Ao=U[7]|0,fr=Ao&8191,Xt=Ao>>>13,ls=U[8]|0,Jt=ls&8191,Qt=ls>>>13,rt=U[9]|0,Zt=rt&8191,Ct=rt>>>13;R.negative=b.negative^w.negative,R.length=19,M=Math.imul(J,mt),v=Math.imul(J,Ie),v=v+Math.imul(ue,mt)|0,V=Math.imul(ue,Ie);var xn=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(xn>>>26)|0,xn&=67108863,M=Math.imul(A,mt),v=Math.imul(A,Ie),v=v+Math.imul(ie,mt)|0,V=Math.imul(ie,Ie),M=M+Math.imul(J,Ze)|0,v=v+Math.imul(J,Kt)|0,v=v+Math.imul(ue,Ze)|0,V=V+Math.imul(ue,Kt)|0;var Fn=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(Fn>>>26)|0,Fn&=67108863,M=Math.imul(E,mt),v=Math.imul(E,Ie),v=v+Math.imul(I,mt)|0,V=Math.imul(I,Ie),M=M+Math.imul(A,Ze)|0,v=v+Math.imul(A,Kt)|0,v=v+Math.imul(ie,Ze)|0,V=V+Math.imul(ie,Kt)|0,M=M+Math.imul(J,Gt)|0,v=v+Math.imul(J,De)|0,v=v+Math.imul(ue,Gt)|0,V=V+Math.imul(ue,De)|0;var Un=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(Un>>>26)|0,Un&=67108863,M=Math.imul(H,mt),v=Math.imul(H,Ie),v=v+Math.imul(T,mt)|0,V=Math.imul(T,Ie),M=M+Math.imul(E,Ze)|0,v=v+Math.imul(E,Kt)|0,v=v+Math.imul(I,Ze)|0,V=V+Math.imul(I,Kt)|0,M=M+Math.imul(A,Gt)|0,v=v+Math.imul(A,De)|0,v=v+Math.imul(ie,Gt)|0,V=V+Math.imul(ie,De)|0,M=M+Math.imul(J,$t)|0,v=v+Math.imul(J,Wt)|0,v=v+Math.imul(ue,$t)|0,V=V+Math.imul(ue,Wt)|0;var Kn=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(Kn>>>26)|0,Kn&=67108863,M=Math.imul(F,mt),v=Math.imul(F,Ie),v=v+Math.imul(N,mt)|0,V=Math.imul(N,Ie),M=M+Math.imul(H,Ze)|0,v=v+Math.imul(H,Kt)|0,v=v+Math.imul(T,Ze)|0,V=V+Math.imul(T,Kt)|0,M=M+Math.imul(E,Gt)|0,v=v+Math.imul(E,De)|0,v=v+Math.imul(I,Gt)|0,V=V+Math.imul(I,De)|0,M=M+Math.imul(A,$t)|0,v=v+Math.imul(A,Wt)|0,v=v+Math.imul(ie,$t)|0,V=V+Math.imul(ie,Wt)|0,M=M+Math.imul(J,Yt)|0,v=v+Math.imul(J,yt)|0,v=v+Math.imul(ue,Yt)|0,V=V+Math.imul(ue,yt)|0;var jn=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(jn>>>26)|0,jn&=67108863,M=Math.imul(ne,mt),v=Math.imul(ne,Ie),v=v+Math.imul(te,mt)|0,V=Math.imul(te,Ie),M=M+Math.imul(F,Ze)|0,v=v+Math.imul(F,Kt)|0,v=v+Math.imul(N,Ze)|0,V=V+Math.imul(N,Kt)|0,M=M+Math.imul(H,Gt)|0,v=v+Math.imul(H,De)|0,v=v+Math.imul(T,Gt)|0,V=V+Math.imul(T,De)|0,M=M+Math.imul(E,$t)|0,v=v+Math.imul(E,Wt)|0,v=v+Math.imul(I,$t)|0,V=V+Math.imul(I,Wt)|0,M=M+Math.imul(A,Yt)|0,v=v+Math.imul(A,yt)|0,v=v+Math.imul(ie,Yt)|0,V=V+Math.imul(ie,yt)|0,M=M+Math.imul(J,ar)|0,v=v+Math.imul(J,cr)|0,v=v+Math.imul(ue,ar)|0,V=V+Math.imul(ue,cr)|0;var Vn=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(Vn>>>26)|0,Vn&=67108863,M=Math.imul(me,mt),v=Math.imul(me,Ie),v=v+Math.imul(fe,mt)|0,V=Math.imul(fe,Ie),M=M+Math.imul(ne,Ze)|0,v=v+Math.imul(ne,Kt)|0,v=v+Math.imul(te,Ze)|0,V=V+Math.imul(te,Kt)|0,M=M+Math.imul(F,Gt)|0,v=v+Math.imul(F,De)|0,v=v+Math.imul(N,Gt)|0,V=V+Math.imul(N,De)|0,M=M+Math.imul(H,$t)|0,v=v+Math.imul(H,Wt)|0,v=v+Math.imul(T,$t)|0,V=V+Math.imul(T,Wt)|0,M=M+Math.imul(E,Yt)|0,v=v+Math.imul(E,yt)|0,v=v+Math.imul(I,Yt)|0,V=V+Math.imul(I,yt)|0,M=M+Math.imul(A,ar)|0,v=v+Math.imul(A,cr)|0,v=v+Math.imul(ie,ar)|0,V=V+Math.imul(ie,cr)|0,M=M+Math.imul(J,Ye)|0,v=v+Math.imul(J,ur)|0,v=v+Math.imul(ue,Ye)|0,V=V+Math.imul(ue,ur)|0;var ze=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(ze>>>26)|0,ze&=67108863,M=Math.imul(Ae,mt),v=Math.imul(Ae,Ie),v=v+Math.imul(Ve,mt)|0,V=Math.imul(Ve,Ie),M=M+Math.imul(me,Ze)|0,v=v+Math.imul(me,Kt)|0,v=v+Math.imul(fe,Ze)|0,V=V+Math.imul(fe,Kt)|0,M=M+Math.imul(ne,Gt)|0,v=v+Math.imul(ne,De)|0,v=v+Math.imul(te,Gt)|0,V=V+Math.imul(te,De)|0,M=M+Math.imul(F,$t)|0,v=v+Math.imul(F,Wt)|0,v=v+Math.imul(N,$t)|0,V=V+Math.imul(N,Wt)|0,M=M+Math.imul(H,Yt)|0,v=v+Math.imul(H,yt)|0,v=v+Math.imul(T,Yt)|0,V=V+Math.imul(T,yt)|0,M=M+Math.imul(E,ar)|0,v=v+Math.imul(E,cr)|0,v=v+Math.imul(I,ar)|0,V=V+Math.imul(I,cr)|0,M=M+Math.imul(A,Ye)|0,v=v+Math.imul(A,ur)|0,v=v+Math.imul(ie,Ye)|0,V=V+Math.imul(ie,ur)|0,M=M+Math.imul(J,fr)|0,v=v+Math.imul(J,Xt)|0,v=v+Math.imul(ue,fr)|0,V=V+Math.imul(ue,Xt)|0;var zn=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(zn>>>26)|0,zn&=67108863,M=Math.imul(Ge,mt),v=Math.imul(Ge,Ie),v=v+Math.imul(ve,mt)|0,V=Math.imul(ve,Ie),M=M+Math.imul(Ae,Ze)|0,v=v+Math.imul(Ae,Kt)|0,v=v+Math.imul(Ve,Ze)|0,V=V+Math.imul(Ve,Kt)|0,M=M+Math.imul(me,Gt)|0,v=v+Math.imul(me,De)|0,v=v+Math.imul(fe,Gt)|0,V=V+Math.imul(fe,De)|0,M=M+Math.imul(ne,$t)|0,v=v+Math.imul(ne,Wt)|0,v=v+Math.imul(te,$t)|0,V=V+Math.imul(te,Wt)|0,M=M+Math.imul(F,Yt)|0,v=v+Math.imul(F,yt)|0,v=v+Math.imul(N,Yt)|0,V=V+Math.imul(N,yt)|0,M=M+Math.imul(H,ar)|0,v=v+Math.imul(H,cr)|0,v=v+Math.imul(T,ar)|0,V=V+Math.imul(T,cr)|0,M=M+Math.imul(E,Ye)|0,v=v+Math.imul(E,ur)|0,v=v+Math.imul(I,Ye)|0,V=V+Math.imul(I,ur)|0,M=M+Math.imul(A,fr)|0,v=v+Math.imul(A,Xt)|0,v=v+Math.imul(ie,fr)|0,V=V+Math.imul(ie,Xt)|0,M=M+Math.imul(J,Jt)|0,v=v+Math.imul(J,Qt)|0,v=v+Math.imul(ue,Jt)|0,V=V+Math.imul(ue,Qt)|0;var xc=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(xc>>>26)|0,xc&=67108863,M=Math.imul(St,mt),v=Math.imul(St,Ie),v=v+Math.imul(kt,mt)|0,V=Math.imul(kt,Ie),M=M+Math.imul(Ge,Ze)|0,v=v+Math.imul(Ge,Kt)|0,v=v+Math.imul(ve,Ze)|0,V=V+Math.imul(ve,Kt)|0,M=M+Math.imul(Ae,Gt)|0,v=v+Math.imul(Ae,De)|0,v=v+Math.imul(Ve,Gt)|0,V=V+Math.imul(Ve,De)|0,M=M+Math.imul(me,$t)|0,v=v+Math.imul(me,Wt)|0,v=v+Math.imul(fe,$t)|0,V=V+Math.imul(fe,Wt)|0,M=M+Math.imul(ne,Yt)|0,v=v+Math.imul(ne,yt)|0,v=v+Math.imul(te,Yt)|0,V=V+Math.imul(te,yt)|0,M=M+Math.imul(F,ar)|0,v=v+Math.imul(F,cr)|0,v=v+Math.imul(N,ar)|0,V=V+Math.imul(N,cr)|0,M=M+Math.imul(H,Ye)|0,v=v+Math.imul(H,ur)|0,v=v+Math.imul(T,Ye)|0,V=V+Math.imul(T,ur)|0,M=M+Math.imul(E,fr)|0,v=v+Math.imul(E,Xt)|0,v=v+Math.imul(I,fr)|0,V=V+Math.imul(I,Xt)|0,M=M+Math.imul(A,Jt)|0,v=v+Math.imul(A,Qt)|0,v=v+Math.imul(ie,Jt)|0,V=V+Math.imul(ie,Qt)|0,M=M+Math.imul(J,Zt)|0,v=v+Math.imul(J,Ct)|0,v=v+Math.imul(ue,Zt)|0,V=V+Math.imul(ue,Ct)|0;var k=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(k>>>26)|0,k&=67108863,M=Math.imul(St,Ze),v=Math.imul(St,Kt),v=v+Math.imul(kt,Ze)|0,V=Math.imul(kt,Kt),M=M+Math.imul(Ge,Gt)|0,v=v+Math.imul(Ge,De)|0,v=v+Math.imul(ve,Gt)|0,V=V+Math.imul(ve,De)|0,M=M+Math.imul(Ae,$t)|0,v=v+Math.imul(Ae,Wt)|0,v=v+Math.imul(Ve,$t)|0,V=V+Math.imul(Ve,Wt)|0,M=M+Math.imul(me,Yt)|0,v=v+Math.imul(me,yt)|0,v=v+Math.imul(fe,Yt)|0,V=V+Math.imul(fe,yt)|0,M=M+Math.imul(ne,ar)|0,v=v+Math.imul(ne,cr)|0,v=v+Math.imul(te,ar)|0,V=V+Math.imul(te,cr)|0,M=M+Math.imul(F,Ye)|0,v=v+Math.imul(F,ur)|0,v=v+Math.imul(N,Ye)|0,V=V+Math.imul(N,ur)|0,M=M+Math.imul(H,fr)|0,v=v+Math.imul(H,Xt)|0,v=v+Math.imul(T,fr)|0,V=V+Math.imul(T,Xt)|0,M=M+Math.imul(E,Jt)|0,v=v+Math.imul(E,Qt)|0,v=v+Math.imul(I,Jt)|0,V=V+Math.imul(I,Qt)|0,M=M+Math.imul(A,Zt)|0,v=v+Math.imul(A,Ct)|0,v=v+Math.imul(ie,Zt)|0,V=V+Math.imul(ie,Ct)|0;var qe=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(qe>>>26)|0,qe&=67108863,M=Math.imul(St,Gt),v=Math.imul(St,De),v=v+Math.imul(kt,Gt)|0,V=Math.imul(kt,De),M=M+Math.imul(Ge,$t)|0,v=v+Math.imul(Ge,Wt)|0,v=v+Math.imul(ve,$t)|0,V=V+Math.imul(ve,Wt)|0,M=M+Math.imul(Ae,Yt)|0,v=v+Math.imul(Ae,yt)|0,v=v+Math.imul(Ve,Yt)|0,V=V+Math.imul(Ve,yt)|0,M=M+Math.imul(me,ar)|0,v=v+Math.imul(me,cr)|0,v=v+Math.imul(fe,ar)|0,V=V+Math.imul(fe,cr)|0,M=M+Math.imul(ne,Ye)|0,v=v+Math.imul(ne,ur)|0,v=v+Math.imul(te,Ye)|0,V=V+Math.imul(te,ur)|0,M=M+Math.imul(F,fr)|0,v=v+Math.imul(F,Xt)|0,v=v+Math.imul(N,fr)|0,V=V+Math.imul(N,Xt)|0,M=M+Math.imul(H,Jt)|0,v=v+Math.imul(H,Qt)|0,v=v+Math.imul(T,Jt)|0,V=V+Math.imul(T,Qt)|0,M=M+Math.imul(E,Zt)|0,v=v+Math.imul(E,Ct)|0,v=v+Math.imul(I,Zt)|0,V=V+Math.imul(I,Ct)|0;var Le=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(Le>>>26)|0,Le&=67108863,M=Math.imul(St,$t),v=Math.imul(St,Wt),v=v+Math.imul(kt,$t)|0,V=Math.imul(kt,Wt),M=M+Math.imul(Ge,Yt)|0,v=v+Math.imul(Ge,yt)|0,v=v+Math.imul(ve,Yt)|0,V=V+Math.imul(ve,yt)|0,M=M+Math.imul(Ae,ar)|0,v=v+Math.imul(Ae,cr)|0,v=v+Math.imul(Ve,ar)|0,V=V+Math.imul(Ve,cr)|0,M=M+Math.imul(me,Ye)|0,v=v+Math.imul(me,ur)|0,v=v+Math.imul(fe,Ye)|0,V=V+Math.imul(fe,ur)|0,M=M+Math.imul(ne,fr)|0,v=v+Math.imul(ne,Xt)|0,v=v+Math.imul(te,fr)|0,V=V+Math.imul(te,Xt)|0,M=M+Math.imul(F,Jt)|0,v=v+Math.imul(F,Qt)|0,v=v+Math.imul(N,Jt)|0,V=V+Math.imul(N,Qt)|0,M=M+Math.imul(H,Zt)|0,v=v+Math.imul(H,Ct)|0,v=v+Math.imul(T,Zt)|0,V=V+Math.imul(T,Ct)|0;var Pe=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,M=Math.imul(St,Yt),v=Math.imul(St,yt),v=v+Math.imul(kt,Yt)|0,V=Math.imul(kt,yt),M=M+Math.imul(Ge,ar)|0,v=v+Math.imul(Ge,cr)|0,v=v+Math.imul(ve,ar)|0,V=V+Math.imul(ve,cr)|0,M=M+Math.imul(Ae,Ye)|0,v=v+Math.imul(Ae,ur)|0,v=v+Math.imul(Ve,Ye)|0,V=V+Math.imul(Ve,ur)|0,M=M+Math.imul(me,fr)|0,v=v+Math.imul(me,Xt)|0,v=v+Math.imul(fe,fr)|0,V=V+Math.imul(fe,Xt)|0,M=M+Math.imul(ne,Jt)|0,v=v+Math.imul(ne,Qt)|0,v=v+Math.imul(te,Jt)|0,V=V+Math.imul(te,Qt)|0,M=M+Math.imul(F,Zt)|0,v=v+Math.imul(F,Ct)|0,v=v+Math.imul(N,Zt)|0,V=V+Math.imul(N,Ct)|0;var An=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(An>>>26)|0,An&=67108863,M=Math.imul(St,ar),v=Math.imul(St,cr),v=v+Math.imul(kt,ar)|0,V=Math.imul(kt,cr),M=M+Math.imul(Ge,Ye)|0,v=v+Math.imul(Ge,ur)|0,v=v+Math.imul(ve,Ye)|0,V=V+Math.imul(ve,ur)|0,M=M+Math.imul(Ae,fr)|0,v=v+Math.imul(Ae,Xt)|0,v=v+Math.imul(Ve,fr)|0,V=V+Math.imul(Ve,Xt)|0,M=M+Math.imul(me,Jt)|0,v=v+Math.imul(me,Qt)|0,v=v+Math.imul(fe,Jt)|0,V=V+Math.imul(fe,Qt)|0,M=M+Math.imul(ne,Zt)|0,v=v+Math.imul(ne,Ct)|0,v=v+Math.imul(te,Zt)|0,V=V+Math.imul(te,Ct)|0;var Qi=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(Qi>>>26)|0,Qi&=67108863,M=Math.imul(St,Ye),v=Math.imul(St,ur),v=v+Math.imul(kt,Ye)|0,V=Math.imul(kt,ur),M=M+Math.imul(Ge,fr)|0,v=v+Math.imul(Ge,Xt)|0,v=v+Math.imul(ve,fr)|0,V=V+Math.imul(ve,Xt)|0,M=M+Math.imul(Ae,Jt)|0,v=v+Math.imul(Ae,Qt)|0,v=v+Math.imul(Ve,Jt)|0,V=V+Math.imul(Ve,Qt)|0,M=M+Math.imul(me,Zt)|0,v=v+Math.imul(me,Ct)|0,v=v+Math.imul(fe,Zt)|0,V=V+Math.imul(fe,Ct)|0;var Mf=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(Mf>>>26)|0,Mf&=67108863,M=Math.imul(St,fr),v=Math.imul(St,Xt),v=v+Math.imul(kt,fr)|0,V=Math.imul(kt,Xt),M=M+Math.imul(Ge,Jt)|0,v=v+Math.imul(Ge,Qt)|0,v=v+Math.imul(ve,Jt)|0,V=V+Math.imul(ve,Qt)|0,M=M+Math.imul(Ae,Zt)|0,v=v+Math.imul(Ae,Ct)|0,v=v+Math.imul(Ve,Zt)|0,V=V+Math.imul(Ve,Ct)|0;var mi=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(mi>>>26)|0,mi&=67108863,M=Math.imul(St,Jt),v=Math.imul(St,Qt),v=v+Math.imul(kt,Jt)|0,V=Math.imul(kt,Qt),M=M+Math.imul(Ge,Zt)|0,v=v+Math.imul(Ge,Ct)|0,v=v+Math.imul(ve,Zt)|0,V=V+Math.imul(ve,Ct)|0;var H0=(G+M|0)+((v&8191)<<13)|0;G=(V+(v>>>13)|0)+(H0>>>26)|0,H0&=67108863,M=Math.imul(St,Zt),v=Math.imul(St,Ct),v=v+Math.imul(kt,Zt)|0,V=Math.imul(kt,Ct);var G0=(G+M|0)+((v&8191)<<13)|0;return G=(V+(v>>>13)|0)+(G0>>>26)|0,G0&=67108863,Q[0]=xn,Q[1]=Fn,Q[2]=Un,Q[3]=Kn,Q[4]=jn,Q[5]=Vn,Q[6]=ze,Q[7]=zn,Q[8]=xc,Q[9]=k,Q[10]=qe,Q[11]=Le,Q[12]=Pe,Q[13]=An,Q[14]=Qi,Q[15]=Mf,Q[16]=mi,Q[17]=H0,Q[18]=G0,G!==0&&(Q[19]=G,R.length++),R};Math.imul||(g=y);function m(L,b,w){w.negative=b.negative^L.negative,w.length=L.length+b.length;for(var R=0,B=0,U=0;U<w.length-1;U++){var Q=B;B=0;for(var G=R&67108863,M=Math.min(U,b.length-1),v=Math.max(0,U-L.length+1);v<=M;v++){var V=U-v,de=L.words[V]|0,J=b.words[v]|0,ue=de*J,S=ue&67108863;Q=Q+(ue/67108864|0)|0,S=S+G|0,G=S&67108863,Q=Q+(S>>>26)|0,B+=Q>>>26,Q&=67108863}w.words[U]=G,R=Q,Q=B}return R!==0?w.words[U]=R:w.length--,w.strip()}function x(L,b,w){var R=new _;return R.mulp(L,b,w)}n.prototype.mulTo=function(b,w){var R,B=this.length+b.length;return this.length===10&&b.length===10?R=g(this,b,w):B<63?R=y(this,b,w):B<1024?R=m(this,b,w):R=x(this,b,w),R};function _(L,b){this.x=L,this.y=b}_.prototype.makeRBT=function(b){for(var w=new Array(b),R=n.prototype._countBits(b)-1,B=0;B<b;B++)w[B]=this.revBin(B,R,b);return w},_.prototype.revBin=function(b,w,R){if(b===0||b===R-1)return b;for(var B=0,U=0;U<w;U++)B|=(b&1)<<w-U-1,b>>=1;return B},_.prototype.permute=function(b,w,R,B,U,Q){for(var G=0;G<Q;G++)B[G]=w[b[G]],U[G]=R[b[G]]},_.prototype.transform=function(b,w,R,B,U,Q){this.permute(Q,b,w,R,B,U);for(var G=1;G<U;G<<=1)for(var M=G<<1,v=Math.cos(2*Math.PI/M),V=Math.sin(2*Math.PI/M),de=0;de<U;de+=M)for(var J=v,ue=V,S=0;S<G;S++){var A=R[de+S],ie=B[de+S],ae=R[de+S+G],E=B[de+S+G],I=J*ae-ue*E;E=J*E+ue*ae,ae=I,R[de+S]=A+ae,B[de+S]=ie+E,R[de+S+G]=A-ae,B[de+S+G]=ie-E,S!==M&&(I=v*J-V*ue,ue=v*ue+V*J,J=I)}},_.prototype.guessLen13b=function(b,w){var R=Math.max(w,b)|1,B=R&1,U=0;for(R=R/2|0;R;R=R>>>1)U++;return 1<<U+1+B},_.prototype.conjugate=function(b,w,R){if(!(R<=1))for(var B=0;B<R/2;B++){var U=b[B];b[B]=b[R-B-1],b[R-B-1]=U,U=w[B],w[B]=-w[R-B-1],w[R-B-1]=-U}},_.prototype.normalize13b=function(b,w){for(var R=0,B=0;B<w/2;B++){var U=Math.round(b[2*B+1]/w)*8192+Math.round(b[2*B]/w)+R;b[B]=U&67108863,U<67108864?R=0:R=U/67108864|0}return b},_.prototype.convert13b=function(b,w,R,B){for(var U=0,Q=0;Q<w;Q++)U=U+(b[Q]|0),R[2*Q]=U&8191,U=U>>>13,R[2*Q+1]=U&8191,U=U>>>13;for(Q=2*w;Q<B;++Q)R[Q]=0;t(U===0),t((U&~8191)==0)},_.prototype.stub=function(b){for(var w=new Array(b),R=0;R<b;R++)w[R]=0;return w},_.prototype.mulp=function(b,w,R){var B=2*this.guessLen13b(b.length,w.length),U=this.makeRBT(B),Q=this.stub(B),G=new Array(B),M=new Array(B),v=new Array(B),V=new Array(B),de=new Array(B),J=new Array(B),ue=R.words;ue.length=B,this.convert13b(b.words,b.length,G,B),this.convert13b(w.words,w.length,V,B),this.transform(G,Q,M,v,B,U),this.transform(V,Q,de,J,B,U);for(var S=0;S<B;S++){var A=M[S]*de[S]-v[S]*J[S];v[S]=M[S]*J[S]+v[S]*de[S],M[S]=A}return this.conjugate(M,v,B),this.transform(M,v,ue,Q,B,U),this.conjugate(ue,Q,B),this.normalize13b(ue,B),R.negative=b.negative^w.negative,R.length=b.length+w.length,R.strip()},n.prototype.mul=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),this.mulTo(b,w)},n.prototype.mulf=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),x(this,b,w)},n.prototype.imul=function(b){return this.clone().mulTo(b,this)},n.prototype.imuln=function(b){t(typeof b=="number"),t(b<67108864);for(var w=0,R=0;R<this.length;R++){var B=(this.words[R]|0)*b,U=(B&67108863)+(w&67108863);w>>=26,w+=B/67108864|0,w+=U>>>26,this.words[R]=U&67108863}return w!==0&&(this.words[R]=w,this.length++),this},n.prototype.muln=function(b){return this.clone().imuln(b)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(b){var w=d(b);if(w.length===0)return new n(1);for(var R=this,B=0;B<w.length&&w[B]===0;B++,R=R.sqr());if(++B<w.length)for(var U=R.sqr();B<w.length;B++,U=U.sqr())w[B]!==0&&(R=R.mul(U));return R},n.prototype.iushln=function(b){t(typeof b=="number"&&b>=0);var w=b%26,R=(b-w)/26,B=67108863>>>26-w<<26-w,U;if(w!==0){var Q=0;for(U=0;U<this.length;U++){var G=this.words[U]&B,M=(this.words[U]|0)-G<<w;this.words[U]=M|Q,Q=G>>>26-w}Q&&(this.words[U]=Q,this.length++)}if(R!==0){for(U=this.length-1;U>=0;U--)this.words[U+R]=this.words[U];for(U=0;U<R;U++)this.words[U]=0;this.length+=R}return this.strip()},n.prototype.ishln=function(b){return t(this.negative===0),this.iushln(b)},n.prototype.iushrn=function(b,w,R){t(typeof b=="number"&&b>=0);var B;w?B=(w-w%26)/26:B=0;var U=b%26,Q=Math.min((b-U)/26,this.length),G=67108863^67108863>>>U<<U,M=R;if(B-=Q,B=Math.max(0,B),M){for(var v=0;v<Q;v++)M.words[v]=this.words[v];M.length=Q}if(Q!==0)if(this.length>Q)for(this.length-=Q,v=0;v<this.length;v++)this.words[v]=this.words[v+Q];else this.words[0]=0,this.length=1;var V=0;for(v=this.length-1;v>=0&&(V!==0||v>=B);v--){var de=this.words[v]|0;this.words[v]=V<<26-U|de>>>U,V=de&G}return M&&V!==0&&(M.words[M.length++]=V),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(b,w,R){return t(this.negative===0),this.iushrn(b,w,R)},n.prototype.shln=function(b){return this.clone().ishln(b)},n.prototype.ushln=function(b){return this.clone().iushln(b)},n.prototype.shrn=function(b){return this.clone().ishrn(b)},n.prototype.ushrn=function(b){return this.clone().iushrn(b)},n.prototype.testn=function(b){t(typeof b=="number"&&b>=0);var w=b%26,R=(b-w)/26,B=1<<w;if(this.length<=R)return!1;var U=this.words[R];return!!(U&B)},n.prototype.imaskn=function(b){t(typeof b=="number"&&b>=0);var w=b%26,R=(b-w)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=R)return this;if(w!==0&&R++,this.length=Math.min(R,this.length),w!==0){var B=67108863^67108863>>>w<<w;this.words[this.length-1]&=B}return this.strip()},n.prototype.maskn=function(b){return this.clone().imaskn(b)},n.prototype.iaddn=function(b){return t(typeof b=="number"),t(b<67108864),b<0?this.isubn(-b):this.negative!==0?this.length===1&&(this.words[0]|0)<b?(this.words[0]=b-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},n.prototype._iaddn=function(b){this.words[0]+=b;for(var w=0;w<this.length&&this.words[w]>=67108864;w++)this.words[w]-=67108864,w===this.length-1?this.words[w+1]=1:this.words[w+1]++;return this.length=Math.max(this.length,w+1),this},n.prototype.isubn=function(b){if(t(typeof b=="number"),t(b<67108864),b<0)return this.iaddn(-b);if(this.negative!==0)return this.negative=0,this.iaddn(b),this.negative=1,this;if(this.words[0]-=b,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var w=0;w<this.length&&this.words[w]<0;w++)this.words[w]+=67108864,this.words[w+1]-=1;return this.strip()},n.prototype.addn=function(b){return this.clone().iaddn(b)},n.prototype.subn=function(b){return this.clone().isubn(b)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(b,w,R){var B=b.length+R,U;this._expand(B);var Q,G=0;for(U=0;U<b.length;U++){Q=(this.words[U+R]|0)+G;var M=(b.words[U]|0)*w;Q-=M&67108863,G=(Q>>26)-(M/67108864|0),this.words[U+R]=Q&67108863}for(;U<this.length-R;U++)Q=(this.words[U+R]|0)+G,G=Q>>26,this.words[U+R]=Q&67108863;if(G===0)return this.strip();for(t(G===-1),G=0,U=0;U<this.length;U++)Q=-(this.words[U]|0)+G,G=Q>>26,this.words[U]=Q&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(b,w){var R=this.length-b.length,B=this.clone(),U=b,Q=U.words[U.length-1]|0,G=this._countBits(Q);R=26-G,R!==0&&(U=U.ushln(R),B.iushln(R),Q=U.words[U.length-1]|0);var M=B.length-U.length,v;if(w!=="mod"){v=new n(null),v.length=M+1,v.words=new Array(v.length);for(var V=0;V<v.length;V++)v.words[V]=0}var de=B.clone()._ishlnsubmul(U,1,M);de.negative===0&&(B=de,v&&(v.words[M]=1));for(var J=M-1;J>=0;J--){var ue=(B.words[U.length+J]|0)*67108864+(B.words[U.length+J-1]|0);for(ue=Math.min(ue/Q|0,67108863),B._ishlnsubmul(U,ue,J);B.negative!==0;)ue--,B.negative=0,B._ishlnsubmul(U,1,J),B.isZero()||(B.negative^=1);v&&(v.words[J]=ue)}return v&&v.strip(),B.strip(),w!=="div"&&R!==0&&B.iushrn(R),{div:v||null,mod:B}},n.prototype.divmod=function(b,w,R){if(t(!b.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var B,U,Q;return this.negative!==0&&b.negative===0?(Q=this.neg().divmod(b,w),w!=="mod"&&(B=Q.div.neg()),w!=="div"&&(U=Q.mod.neg(),R&&U.negative!==0&&U.iadd(b)),{div:B,mod:U}):this.negative===0&&b.negative!==0?(Q=this.divmod(b.neg(),w),w!=="mod"&&(B=Q.div.neg()),{div:B,mod:Q.mod}):(this.negative&b.negative)!=0?(Q=this.neg().divmod(b.neg(),w),w!=="div"&&(U=Q.mod.neg(),R&&U.negative!==0&&U.isub(b)),{div:Q.div,mod:U}):b.length>this.length||this.cmp(b)<0?{div:new n(0),mod:this}:b.length===1?w==="div"?{div:this.divn(b.words[0]),mod:null}:w==="mod"?{div:null,mod:new n(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new n(this.modn(b.words[0]))}:this._wordDiv(b,w)},n.prototype.div=function(b){return this.divmod(b,"div",!1).div},n.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},n.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},n.prototype.divRound=function(b){var w=this.divmod(b);if(w.mod.isZero())return w.div;var R=w.div.negative!==0?w.mod.isub(b):w.mod,B=b.ushrn(1),U=b.andln(1),Q=R.cmp(B);return Q<0||U===1&&Q===0?w.div:w.div.negative!==0?w.div.isubn(1):w.div.iaddn(1)},n.prototype.modn=function(b){t(b<=67108863);for(var w=(1<<26)%b,R=0,B=this.length-1;B>=0;B--)R=(w*R+(this.words[B]|0))%b;return R},n.prototype.idivn=function(b){t(b<=67108863);for(var w=0,R=this.length-1;R>=0;R--){var B=(this.words[R]|0)+w*67108864;this.words[R]=B/b|0,w=B%b}return this.strip()},n.prototype.divn=function(b){return this.clone().idivn(b)},n.prototype.egcd=function(b){t(b.negative===0),t(!b.isZero());var w=this,R=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var B=new n(1),U=new n(0),Q=new n(0),G=new n(1),M=0;w.isEven()&&R.isEven();)w.iushrn(1),R.iushrn(1),++M;for(var v=R.clone(),V=w.clone();!w.isZero();){for(var de=0,J=1;(w.words[0]&J)==0&&de<26;++de,J<<=1);if(de>0)for(w.iushrn(de);de-- >0;)(B.isOdd()||U.isOdd())&&(B.iadd(v),U.isub(V)),B.iushrn(1),U.iushrn(1);for(var ue=0,S=1;(R.words[0]&S)==0&&ue<26;++ue,S<<=1);if(ue>0)for(R.iushrn(ue);ue-- >0;)(Q.isOdd()||G.isOdd())&&(Q.iadd(v),G.isub(V)),Q.iushrn(1),G.iushrn(1);w.cmp(R)>=0?(w.isub(R),B.isub(Q),U.isub(G)):(R.isub(w),Q.isub(B),G.isub(U))}return{a:Q,b:G,gcd:R.iushln(M)}},n.prototype._invmp=function(b){t(b.negative===0),t(!b.isZero());var w=this,R=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var B=new n(1),U=new n(0),Q=R.clone();w.cmpn(1)>0&&R.cmpn(1)>0;){for(var G=0,M=1;(w.words[0]&M)==0&&G<26;++G,M<<=1);if(G>0)for(w.iushrn(G);G-- >0;)B.isOdd()&&B.iadd(Q),B.iushrn(1);for(var v=0,V=1;(R.words[0]&V)==0&&v<26;++v,V<<=1);if(v>0)for(R.iushrn(v);v-- >0;)U.isOdd()&&U.iadd(Q),U.iushrn(1);w.cmp(R)>=0?(w.isub(R),B.isub(U)):(R.isub(w),U.isub(B))}var de;return w.cmpn(1)===0?de=B:de=U,de.cmpn(0)<0&&de.iadd(b),de},n.prototype.gcd=function(b){if(this.isZero())return b.abs();if(b.isZero())return this.abs();var w=this.clone(),R=b.clone();w.negative=0,R.negative=0;for(var B=0;w.isEven()&&R.isEven();B++)w.iushrn(1),R.iushrn(1);do{for(;w.isEven();)w.iushrn(1);for(;R.isEven();)R.iushrn(1);var U=w.cmp(R);if(U<0){var Q=w;w=R,R=Q}else if(U===0||R.cmpn(1)===0)break;w.isub(R)}while(!0);return R.iushln(B)},n.prototype.invm=function(b){return this.egcd(b).a.umod(b)},n.prototype.isEven=function(){return(this.words[0]&1)==0},n.prototype.isOdd=function(){return(this.words[0]&1)==1},n.prototype.andln=function(b){return this.words[0]&b},n.prototype.bincn=function(b){t(typeof b=="number");var w=b%26,R=(b-w)/26,B=1<<w;if(this.length<=R)return this._expand(R+1),this.words[R]|=B,this;for(var U=B,Q=R;U!==0&&Q<this.length;Q++){var G=this.words[Q]|0;G+=U,U=G>>>26,G&=67108863,this.words[Q]=G}return U!==0&&(this.words[Q]=U,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(b){var w=b<0;if(this.negative!==0&&!w)return-1;if(this.negative===0&&w)return 1;this.strip();var R;if(this.length>1)R=1;else{w&&(b=-b),t(b<=67108863,"Number is too big");var B=this.words[0]|0;R=B===b?0:B<b?-1:1}return this.negative!==0?-R|0:R},n.prototype.cmp=function(b){if(this.negative!==0&&b.negative===0)return-1;if(this.negative===0&&b.negative!==0)return 1;var w=this.ucmp(b);return this.negative!==0?-w|0:w},n.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var w=0,R=this.length-1;R>=0;R--){var B=this.words[R]|0,U=b.words[R]|0;if(B!==U){B<U?w=-1:B>U&&(w=1);break}}return w},n.prototype.gtn=function(b){return this.cmpn(b)===1},n.prototype.gt=function(b){return this.cmp(b)===1},n.prototype.gten=function(b){return this.cmpn(b)>=0},n.prototype.gte=function(b){return this.cmp(b)>=0},n.prototype.ltn=function(b){return this.cmpn(b)===-1},n.prototype.lt=function(b){return this.cmp(b)===-1},n.prototype.lten=function(b){return this.cmpn(b)<=0},n.prototype.lte=function(b){return this.cmp(b)<=0},n.prototype.eqn=function(b){return this.cmpn(b)===0},n.prototype.eq=function(b){return this.cmp(b)===0},n.red=function(b){return new ee(b)},n.prototype.toRed=function(b){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),b.convertTo(this)._forceRed(b)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(b){return this.red=b,this},n.prototype.forceRed=function(b){return t(!this.red,"Already a number in reduction context"),this._forceRed(b)},n.prototype.redAdd=function(b){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},n.prototype.redIAdd=function(b){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},n.prototype.redSub=function(b){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},n.prototype.redISub=function(b){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},n.prototype.redShl=function(b){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,b)},n.prototype.redMul=function(b){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},n.prototype.redIMul=function(b){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(b){return t(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var P={k256:null,p224:null,p192:null,p25519:null};function q(L,b){this.name=L,this.p=new n(b,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}q.prototype._tmp=function(){var b=new n(null);return b.words=new Array(Math.ceil(this.n/13)),b},q.prototype.ireduce=function(b){var w=b,R;do this.split(w,this.tmp),w=this.imulK(w),w=w.iadd(this.tmp),R=w.bitLength();while(R>this.n);var B=R<this.n?-1:w.ucmp(this.p);return B===0?(w.words[0]=0,w.length=1):B>0?w.isub(this.p):w.strip!==void 0?w.strip():w._strip(),w},q.prototype.split=function(b,w){b.iushrn(this.n,0,w)},q.prototype.imulK=function(b){return b.imul(this.k)};function X(){q.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(X,q),X.prototype.split=function(b,w){for(var R=4194303,B=Math.min(b.length,9),U=0;U<B;U++)w.words[U]=b.words[U];if(w.length=B,b.length<=9){b.words[0]=0,b.length=1;return}var Q=b.words[9];for(w.words[w.length++]=Q&R,U=10;U<b.length;U++){var G=b.words[U]|0;b.words[U-10]=(G&R)<<4|Q>>>22,Q=G}Q>>>=22,b.words[U-10]=Q,Q===0&&b.length>10?b.length-=10:b.length-=9},X.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var w=0,R=0;R<b.length;R++){var B=b.words[R]|0;w+=B*977,b.words[R]=w&67108863,w=B*64+(w/67108864|0)}return b.words[b.length-1]===0&&(b.length--,b.words[b.length-1]===0&&b.length--),b};function W(){q.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(W,q);function z(){q.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(z,q);function Z(){q.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(Z,q),Z.prototype.imulK=function(b){for(var w=0,R=0;R<b.length;R++){var B=(b.words[R]|0)*19+w,U=B&67108863;B>>>=26,b.words[R]=U,w=B}return w!==0&&(b.words[b.length++]=w),b},n._prime=function(b){if(P[b])return P[b];var w;if(b==="k256")w=new X;else if(b==="p224")w=new W;else if(b==="p192")w=new z;else if(b==="p25519")w=new Z;else throw new Error("Unknown prime "+b);return P[b]=w,w};function ee(L){if(typeof L=="string"){var b=n._prime(L);this.m=b.p,this.prime=b}else t(L.gtn(1),"modulus must be greater than 1"),this.m=L,this.prime=null}ee.prototype._verify1=function(b){t(b.negative===0,"red works only with positives"),t(b.red,"red works only with red numbers")},ee.prototype._verify2=function(b,w){t((b.negative|w.negative)==0,"red works only with positives"),t(b.red&&b.red===w.red,"red works only with red numbers")},ee.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},ee.prototype.neg=function(b){return b.isZero()?b.clone():this.m.sub(b)._forceRed(this)},ee.prototype.add=function(b,w){this._verify2(b,w);var R=b.add(w);return R.cmp(this.m)>=0&&R.isub(this.m),R._forceRed(this)},ee.prototype.iadd=function(b,w){this._verify2(b,w);var R=b.iadd(w);return R.cmp(this.m)>=0&&R.isub(this.m),R},ee.prototype.sub=function(b,w){this._verify2(b,w);var R=b.sub(w);return R.cmpn(0)<0&&R.iadd(this.m),R._forceRed(this)},ee.prototype.isub=function(b,w){this._verify2(b,w);var R=b.isub(w);return R.cmpn(0)<0&&R.iadd(this.m),R},ee.prototype.shl=function(b,w){return this._verify1(b),this.imod(b.ushln(w))},ee.prototype.imul=function(b,w){return this._verify2(b,w),this.imod(b.imul(w))},ee.prototype.mul=function(b,w){return this._verify2(b,w),this.imod(b.mul(w))},ee.prototype.isqr=function(b){return this.imul(b,b.clone())},ee.prototype.sqr=function(b){return this.mul(b,b)},ee.prototype.sqrt=function(b){if(b.isZero())return b.clone();var w=this.m.andln(3);if(t(w%2==1),w===3){var R=this.m.add(new n(1)).iushrn(2);return this.pow(b,R)}for(var B=this.m.subn(1),U=0;!B.isZero()&&B.andln(1)===0;)U++,B.iushrn(1);t(!B.isZero());var Q=new n(1).toRed(this),G=Q.redNeg(),M=this.m.subn(1).iushrn(1),v=this.m.bitLength();for(v=new n(2*v*v).toRed(this);this.pow(v,M).cmp(G)!==0;)v.redIAdd(G);for(var V=this.pow(v,B),de=this.pow(b,B.addn(1).iushrn(1)),J=this.pow(b,B),ue=U;J.cmp(Q)!==0;){for(var S=J,A=0;S.cmp(Q)!==0;A++)S=S.redSqr();t(A<ue);var ie=this.pow(V,new n(1).iushln(ue-A-1));de=de.redMul(ie),V=ie.redSqr(),J=J.redMul(V),ue=A}return de},ee.prototype.invm=function(b){var w=b._invmp(this.m);return w.negative!==0?(w.negative=0,this.imod(w).redNeg()):this.imod(w)},ee.prototype.pow=function(b,w){if(w.isZero())return new n(1).toRed(this);if(w.cmpn(1)===0)return b.clone();var R=4,B=new Array(1<<R);B[0]=new n(1).toRed(this),B[1]=b;for(var U=2;U<B.length;U++)B[U]=this.mul(B[U-1],b);var Q=B[0],G=0,M=0,v=w.bitLength()%26;for(v===0&&(v=26),U=w.length-1;U>=0;U--){for(var V=w.words[U],de=v-1;de>=0;de--){var J=V>>de&1;if(Q!==B[0]&&(Q=this.sqr(Q)),J===0&&G===0){M=0;continue}G<<=1,G|=J,M++,!(M!==R&&(U!==0||de!==0))&&(Q=this.mul(Q,B[G]),M=0,G=0)}v=26}return Q},ee.prototype.convertTo=function(b){var w=b.umod(this.m);return w===b?w.clone():w},ee.prototype.convertFrom=function(b){var w=b.clone();return w.red=null,w},n.mont=function(b){return new re(b)};function re(L){ee.call(this,L),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(re,ee),re.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},re.prototype.convertFrom=function(b){var w=this.imod(b.mul(this.rinv));return w.red=null,w},re.prototype.imul=function(b,w){if(b.isZero()||w.isZero())return b.words[0]=0,b.length=1,b;var R=b.imul(w),B=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),U=R.isub(B).iushrn(this.shift),Q=U;return U.cmp(this.m)>=0?Q=U.isub(this.m):U.cmpn(0)<0&&(Q=U.iadd(this.m)),Q._forceRed(this)},re.prototype.mul=function(b,w){if(b.isZero()||w.isZero())return new n(0)._forceRed(this);var R=b.mul(w),B=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),U=R.isub(B).iushrn(this.shift),Q=U;return U.cmp(this.m)>=0?Q=U.isub(this.m):U.cmpn(0)<0&&(Q=U.iadd(this.m)),Q._forceRed(this)},re.prototype.invm=function(b){var w=this.imod(b._invmp(this.m).mul(this.r2));return w._forceRed(this)}})(typeof bx=="undefined"||bx,Cq)});var Du=p((tgt,Pq)=>{l();Pq.exports=Oq;function Oq(r,e){if(!r)throw new Error(e||"Assertion failed")}Oq.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)}});var mx=p(Bq=>{l();"use strict";var Om=Bq;function uAe(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r!="string"){for(var i=0;i<r.length;i++)t[i]=r[i]|0;return t}if(e==="hex"){r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!=0&&(r="0"+r);for(var i=0;i<r.length;i+=2)t.push(parseInt(r[i]+r[i+1],16))}else for(var i=0;i<r.length;i++){var n=r.charCodeAt(i),s=n>>8,o=n&255;s?t.push(s,o):t.push(o)}return t}Om.toArray=uAe;function Nq(r){return r.length===1?"0"+r:r}Om.zero2=Nq;function Dq(r){for(var e="",t=0;t<r.length;t++)e+=Nq(r[t].toString(16));return e}Om.toHex=Dq;Om.encode=function(e,t){return t==="hex"?Dq(e):e}});var ps=p(qq=>{l();"use strict";var Do=qq,fAe=Oa(),lAe=Du(),Bm=mx();Do.assert=lAe;Do.toArray=Bm.toArray;Do.zero2=Bm.zero2;Do.toHex=Bm.toHex;Do.encode=Bm.encode;function hAe(r,e,t){var i=new Array(Math.max(r.bitLength(),t)+1);i.fill(0);for(var n=1<<e+1,s=r.clone(),o=0;o<i.length;o++){var a,c=s.andln(n-1);s.isOdd()?(c>(n>>1)-1?a=(n>>1)-c:a=c,s.isubn(a)):a=0,i[o]=a,s.iushrn(1)}return i}Do.getNAF=hAe;function dAe(r,e){var t=[[],[]];r=r.clone(),e=e.clone();for(var i=0,n=0,s;r.cmpn(-i)>0||e.cmpn(-n)>0;){var o=r.andln(3)+i&3,a=e.andln(3)+n&3;o===3&&(o=-1),a===3&&(a=-1);var c;(o&1)==0?c=0:(s=r.andln(7)+i&7,(s===3||s===5)&&a===2?c=-o:c=o),t[0].push(c);var u;(a&1)==0?u=0:(s=e.andln(7)+n&7,(s===3||s===5)&&o===2?u=-a:u=a),t[1].push(u),2*i===c+1&&(i=1-i),2*n===u+1&&(n=1-n),r.iushrn(1),e.iushrn(1)}return t}Do.getJSF=dAe;function pAe(r,e,t){var i="_"+e;r.prototype[e]=function(){return this[i]!==void 0?this[i]:this[i]=t.call(this)}}Do.cachedProperty=pAe;function yAe(r){return typeof r=="string"?Do.toArray(r,"hex"):r}Do.parseBytes=yAe;function gAe(r){return new fAe(r,"hex","le")}Do.intFromLE=gAe});var Ex=p((ngt,vx)=>{l();var wx;vx.exports=function(e){return wx||(wx=new qu(null)),wx.generate(e)};function qu(r){this.rand=r}vx.exports.Rand=qu;qu.prototype.generate=function(e){return this._rand(e)};qu.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?qu.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?qu.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:typeof window=="object"&&(qu.prototype._rand=function(){throw new Error("Not implemented yet")});else try{if(_x=jh(),typeof _x.randomBytes!="function")throw new Error("Not supported");qu.prototype._rand=function(e){return _x.randomBytes(e)}}catch(r){}var _x});var vy=p((sgt,Mq)=>{l();"use strict";var el=Oa(),my=ps(),Nm=my.getNAF,bAe=my.getJSF,Dm=my.assert;function Mu(r,e){this.type=r,this.p=new el(e.p,16),this.red=e.prime?el.red(e.prime):el.mont(this.p),this.zero=new el(0).toRed(this.red),this.one=new el(1).toRed(this.red),this.two=new el(2).toRed(this.red),this.n=e.n&&new el(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}Mq.exports=Mu;Mu.prototype.point=function(){throw new Error("Not implemented")};Mu.prototype.validate=function(){throw new Error("Not implemented")};Mu.prototype._fixedNafMul=function(e,t){Dm(e.precomputed);var i=e._getDoubles(),n=Nm(t,1,this._bitLength),s=(1<<i.step+1)-(i.step%2==0?2:1);s/=3;var o=[],a,c;for(a=0;a<n.length;a+=i.step){c=0;for(var u=a+i.step-1;u>=a;u--)c=(c<<1)+n[u];o.push(c)}for(var f=this.jpoint(null,null,null),h=this.jpoint(null,null,null),d=s;d>0;d--){for(a=0;a<o.length;a++)c=o[a],c===d?h=h.mixedAdd(i.points[a]):c===-d&&(h=h.mixedAdd(i.points[a].neg()));f=f.add(h)}return f.toP()};Mu.prototype._wnafMul=function(e,t){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=Nm(t,i,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&o[c]===0;c--)u++;if(c>=0&&u++,a=a.dblp(u),c<0)break;var f=o[c];Dm(f!==0),e.type==="affine"?f>0?a=a.mixedAdd(s[f-1>>1]):a=a.mixedAdd(s[-f-1>>1].neg()):f>0?a=a.add(s[f-1>>1]):a=a.add(s[-f-1>>1].neg())}return e.type==="affine"?a.toP():a};Mu.prototype._wnafMulAdd=function(e,t,i,n,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,u=0,f,h,d;for(f=0;f<n;f++){d=t[f];var y=d._getNAFPoints(e);o[f]=y.wnd,a[f]=y.points}for(f=n-1;f>=1;f-=2){var g=f-1,m=f;if(o[g]!==1||o[m]!==1){c[g]=Nm(i[g],o[g],this._bitLength),c[m]=Nm(i[m],o[m],this._bitLength),u=Math.max(c[g].length,u),u=Math.max(c[m].length,u);continue}var x=[t[g],null,null,t[m]];t[g].y.cmp(t[m].y)===0?(x[1]=t[g].add(t[m]),x[2]=t[g].toJ().mixedAdd(t[m].neg())):t[g].y.cmp(t[m].y.redNeg())===0?(x[1]=t[g].toJ().mixedAdd(t[m]),x[2]=t[g].add(t[m].neg())):(x[1]=t[g].toJ().mixedAdd(t[m]),x[2]=t[g].toJ().mixedAdd(t[m].neg()));var _=[-3,-1,-5,-7,0,7,5,1,3],P=bAe(i[g],i[m]);for(u=Math.max(P[0].length,u),c[g]=new Array(u),c[m]=new Array(u),h=0;h<u;h++){var q=P[0][h]|0,X=P[1][h]|0;c[g][h]=_[(q+1)*3+(X+1)],c[m][h]=0,a[g]=x}}var W=this.jpoint(null,null,null),z=this._wnafT4;for(f=u;f>=0;f--){for(var Z=0;f>=0;){var ee=!0;for(h=0;h<n;h++)z[h]=c[h][f]|0,z[h]!==0&&(ee=!1);if(!ee)break;Z++,f--}if(f>=0&&Z++,W=W.dblp(Z),f<0)break;for(h=0;h<n;h++){var re=z[h];re!==0&&(re>0?d=a[h][re-1>>1]:re<0&&(d=a[h][-re-1>>1].neg()),d.type==="affine"?W=W.mixedAdd(d):W=W.add(d))}}for(f=0;f<n;f++)a[f]=null;return s?W:W.toP()};function Vs(r,e){this.curve=r,this.type=e,this.precomputed=null}Mu.BasePoint=Vs;Vs.prototype.eq=function(){throw new Error("Not implemented")};Vs.prototype.validate=function(){return this.curve.validate(this)};Mu.prototype.decodePoint=function(e,t){e=my.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1==2*i){e[0]===6?Dm(e[e.length-1]%2==0):e[0]===7&&Dm(e[e.length-1]%2==1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};Vs.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Vs.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};Vs.prototype.encode=function(e,t){return my.encode(this._encode(t),e)};Vs.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};Vs.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};Vs.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<t;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}};Vs.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)t[s]=t[s-1].add(n);return{wnd:e,points:t}};Vs.prototype._getBeta=function(){return null};Vs.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t}});var rn=p((ogt,Sx)=>{l();typeof Object.create=="function"?Sx.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Sx.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}});var Fq=p((agt,Lq)=>{l();"use strict";var mAe=ps(),Wr=Oa(),xx=rn(),Zh=vy(),vAe=mAe.assert;function zs(r){Zh.call(this,"short",r),this.a=new Wr(r.a,16).toRed(this.red),this.b=new Wr(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}xx(zs,Zh);Lq.exports=zs;zs.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new Wr(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=n[0].cmp(n[1])<0?n[0]:n[1],t=t.toRed(this.red)}if(e.lambda)i=new Wr(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?i=s[0]:(i=s[1],vAe(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new Wr(a.a,16),b:new Wr(a.b,16)}}):o=this._getEndoBasis(i),{beta:t,lambda:i,basis:o}}};zs.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:Wr.mont(e),i=new Wr(2).toRed(t).redInvm(),n=i.redNeg(),s=new Wr(3).toRed(t).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]};zs.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new Wr(1),o=new Wr(0),a=new Wr(0),c=new Wr(1),u,f,h,d,y,g,m,x=0,_,P;i.cmpn(0)!==0;){var q=n.div(i);_=n.sub(q.mul(i)),P=a.sub(q.mul(s));var X=c.sub(q.mul(o));if(!h&&_.cmp(t)<0)u=m.neg(),f=s,h=_.neg(),d=P;else if(h&&++x==2)break;m=_,n=i,i=_,a=s,s=P,c=o,o=X}y=_.neg(),g=P;var W=h.sqr().add(d.sqr()),z=y.sqr().add(g.sqr());return z.cmp(W)>=0&&(y=u,g=f),h.negative&&(h=h.neg(),d=d.neg()),y.negative&&(y=y.neg(),g=g.neg()),[{a:h,b:d},{a:y,b:g}]};zs.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],n=t[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),c=o.mul(n.a),u=s.mul(i.b),f=o.mul(n.b),h=e.sub(a).sub(c),d=u.add(f).neg();return{k1:h,k2:d}};zs.prototype.pointFromX=function(e,t){e=new Wr(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(e,n)};zs.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,n=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};zs.prototype._endoWnafMulAdd=function(e,t,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(t[o]),c=e[o],u=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),n[o*2]=c,n[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var f=this._wnafMulAdd(1,n,s,o*2,i),h=0;h<o*2;h++)n[h]=null,s[h]=null;return f};function Ui(r,e,t,i){Zh.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Wr(e,16),this.y=new Wr(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}xx(Ui,Zh.BasePoint);zs.prototype.point=function(e,t,i){return new Ui(this,e,t,i)};zs.prototype.pointFromJSON=function(e,t){return Ui.fromJSON(this,e,t)};Ui.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}};Ui.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Ui.fromJSON=function(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var n=e.point(t[0],t[1],i);if(!t[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=t[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n};Ui.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Ui.prototype.isInfinity=function(){return this.inf};Ui.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};Ui.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};Ui.prototype.getX=function(){return this.x.fromRed()};Ui.prototype.getY=function(){return this.y.fromRed()};Ui.prototype.mul=function(e){return e=new Wr(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Ui.prototype.mulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};Ui.prototype.jmulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};Ui.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Ui.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return t};Ui.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function nn(r,e,t,i){Zh.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Wr(0)):(this.x=new Wr(e,16),this.y=new Wr(t,16),this.z=new Wr(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}xx(nn,Zh.BasePoint);zs.prototype.jpoint=function(e,t,i){return new nn(this,e,t,i)};nn.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(i,n)};nn.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};nn.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t),s=e.x.redMul(i),o=this.y.redMul(t.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),c=n.redSub(s),u=o.redSub(a);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var f=c.redSqr(),h=f.redMul(c),d=n.redMul(f),y=u.redSqr().redIAdd(h).redISub(d).redISub(d),g=u.redMul(d.redISub(y)).redISub(o.redMul(h)),m=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(y,g,m)};nn.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,n=e.x.redMul(t),s=this.y,o=e.y.redMul(t).redMul(this.z),a=i.redSub(n),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),f=u.redMul(a),h=i.redMul(u),d=c.redSqr().redIAdd(f).redISub(h).redISub(h),y=c.redMul(h.redISub(d)).redISub(s.redMul(f)),g=this.z.redMul(a);return this.curve.jpoint(d,y,g)};nn.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,u=c.redSqr().redSqr(),f=a.redAdd(a);for(t=0;t<e;t++){var h=o.redSqr(),d=f.redSqr(),y=d.redSqr(),g=h.redAdd(h).redIAdd(h).redIAdd(n.redMul(u)),m=o.redMul(d),x=g.redSqr().redISub(m.redAdd(m)),_=m.redISub(x),P=g.redMul(_);P=P.redIAdd(P).redISub(y);var q=f.redMul(c);t+1<e&&(u=u.redMul(y)),o=x,c=q,f=P}return this.curve.jpoint(o,f.redMul(s),c)};nn.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};nn.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n),u=c.redSqr().redISub(a).redISub(a),f=o.redIAdd(o);f=f.redIAdd(f),f=f.redIAdd(f),e=u,t=c.redMul(a.redISub(u)).redISub(f),i=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),d=this.y.redSqr(),y=d.redSqr(),g=this.x.redAdd(d).redSqr().redISub(h).redISub(y);g=g.redIAdd(g);var m=h.redAdd(h).redIAdd(h),x=m.redSqr(),_=y.redIAdd(y);_=_.redIAdd(_),_=_.redIAdd(_),e=x.redISub(g).redISub(g),t=m.redMul(g.redISub(e)).redISub(_),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};nn.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=c.redSqr().redISub(a).redISub(a);e=u;var f=o.redIAdd(o);f=f.redIAdd(f),f=f.redIAdd(f),t=c.redMul(a.redISub(u)).redISub(f),i=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),d=this.y.redSqr(),y=this.x.redMul(d),g=this.x.redSub(h).redMul(this.x.redAdd(h));g=g.redAdd(g).redIAdd(g);var m=y.redIAdd(y);m=m.redIAdd(m);var x=m.redAdd(m);e=g.redSqr().redISub(x),i=this.y.redAdd(this.z).redSqr().redISub(d).redISub(h);var _=d.redSqr();_=_.redIAdd(_),_=_.redIAdd(_),_=_.redIAdd(_),t=g.redMul(m.redISub(e)).redISub(_)}return this.curve.jpoint(e,t,i)};nn.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=t.redSqr(),a=i.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),u=t.redAdd(t);u=u.redIAdd(u);var f=u.redMul(a),h=c.redSqr().redISub(f.redAdd(f)),d=f.redISub(h),y=a.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=c.redMul(d).redISub(y),m=i.redAdd(i).redMul(n);return this.curve.jpoint(h,g,m)};nn.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=t.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(t).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),u=n.redIAdd(n);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var f=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(u),h=t.redMul(f);h=h.redIAdd(h),h=h.redIAdd(h);var d=this.x.redMul(c).redISub(h);d=d.redIAdd(d),d=d.redIAdd(d);var y=this.y.redMul(f.redMul(u.redISub(f)).redISub(a.redMul(c)));y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=this.z.redAdd(a).redSqr().redISub(i).redISub(c);return this.curve.jpoint(d,y,g)};nn.prototype.mul=function(e,t){return e=new Wr(e,t),this.curve._wnafMul(this,e)};nn.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var n=t.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};nn.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};nn.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};nn.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var jq=p((cgt,Uq)=>{l();"use strict";var ed=Oa(),Kq=rn(),qm=vy(),wAe=ps();function td(r){qm.call(this,"mont",r),this.a=new ed(r.a,16).toRed(this.red),this.b=new ed(r.b,16).toRed(this.red),this.i4=new ed(4).toRed(this.red).redInvm(),this.two=new ed(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Kq(td,qm);Uq.exports=td;td.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),n=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t),s=n.redSqrt();return s.redSqr().cmp(n)===0};function Ki(r,e,t){qm.BasePoint.call(this,r,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new ed(e,16),this.z=new ed(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}Kq(Ki,qm.BasePoint);td.prototype.decodePoint=function(e,t){return this.point(wAe.toArray(e,t),1)};td.prototype.point=function(e,t){return new Ki(this,e,t)};td.prototype.pointFromJSON=function(e){return Ki.fromJSON(this,e)};Ki.prototype.precompute=function(){};Ki.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Ki.fromJSON=function(e,t){return new Ki(e,t[0],t[1]||e.one)};Ki.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Ki.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Ki.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=t.redSub(n),o=t.redMul(n),a=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};Ki.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Ki.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(i),c=s.redMul(n),u=t.z.redMul(a.redAdd(c).redSqr()),f=t.x.redMul(a.redISub(c).redSqr());return this.curve.point(u,f)};Ki.prototype.mul=function(e){for(var t=e.clone(),i=this,n=this.curve.point(null,null),s=this,o=[];t.cmpn(0)!==0;t.iushrn(1))o.push(t.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};Ki.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Ki.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Ki.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Ki.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Ki.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var Hq=p((ugt,Vq)=>{l();"use strict";var _Ae=ps(),Lc=Oa(),zq=rn(),Mm=vy(),EAe=_Ae.assert;function Ba(r){this.twisted=(r.a|0)!=1,this.mOneA=this.twisted&&(r.a|0)==-1,this.extended=this.mOneA,Mm.call(this,"edwards",r),this.a=new Lc(r.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Lc(r.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Lc(r.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),EAe(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(r.c|0)==1}zq(Ba,Mm);Vq.exports=Ba;Ba.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Ba.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Ba.prototype.jpoint=function(e,t,i,n){return this.point(e,t,i,n)};Ba.prototype.pointFromX=function(e,t){e=new Lc(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(t&&!c||!t&&c)&&(a=a.redNeg()),this.point(e,a)};Ba.prototype.pointFromY=function(e,t){e=new Lc(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)};Ba.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),n=t.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return n.cmp(s)===0};function Er(r,e,t,i,n){Mm.BasePoint.call(this,r,"projective"),e===null&&t===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Lc(e,16),this.y=new Lc(t,16),this.z=i?new Lc(i,16):this.curve.one,this.t=n&&new Lc(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}zq(Er,Mm.BasePoint);Ba.prototype.pointFromJSON=function(e){return Er.fromJSON(this,e)};Ba.prototype.point=function(e,t,i,n){return new Er(this,e,t,i,n)};Er.fromJSON=function(e,t){return new Er(e,t[0],t[1],t[2])};Er.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Er.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Er.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),o=n.redAdd(t),a=o.redSub(i),c=n.redSub(t),u=s.redMul(a),f=o.redMul(c),h=s.redMul(c),d=a.redMul(o);return this.curve.point(u,f,d,h)};Er.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),i=this.y.redSqr(),n,s,o,a,c,u;if(this.curve.twisted){a=this.curve._mulA(t);var f=a.redAdd(i);this.zOne?(n=e.redSub(t).redSub(i).redMul(f.redSub(this.curve.two)),s=f.redMul(a.redSub(i)),o=f.redSqr().redSub(f).redSub(f)):(c=this.z.redSqr(),u=f.redSub(c).redISub(c),n=e.redSub(t).redISub(i).redMul(u),s=f.redMul(a.redSub(i)),o=f.redMul(u))}else a=t.redAdd(i),c=this.curve._mulC(this.z).redSqr(),u=a.redSub(c).redSub(c),n=this.curve._mulC(e.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(t.redISub(i)),o=a.redMul(u);return this.curve.point(n,s,o)};Er.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Er.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(t),a=s.redSub(n),c=s.redAdd(n),u=i.redAdd(t),f=o.redMul(a),h=c.redMul(u),d=o.redMul(u),y=a.redMul(c);return this.curve.point(f,h,y,d)};Er.prototype._projAdd=function(e){var t=this.z.redMul(e.z),i=t.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(n).redMul(s),a=i.redSub(o),c=i.redAdd(o),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),f=t.redMul(a).redMul(u),h,d;return this.curve.twisted?(h=t.redMul(c).redMul(s.redSub(this.curve._mulA(n))),d=a.redMul(c)):(h=t.redMul(c).redMul(s.redSub(n)),d=this.curve._mulC(a).redMul(c)),this.curve.point(f,h,d)};Er.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};Er.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};Er.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)};Er.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)};Er.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};Er.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Er.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Er.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Er.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};Er.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),this.x.cmp(t)===0)return!0}};Er.prototype.toP=Er.prototype.normalize;Er.prototype.mixedAdd=Er.prototype.add});var Ax=p(Gq=>{l();"use strict";var Lm=Gq;Lm.base=vy();Lm.short=Fq();Lm.mont=jq();Lm.edwards=Hq()});var qo=p(br=>{l();"use strict";var SAe=Du(),xAe=rn();br.inherits=xAe;function AAe(r,e){return(r.charCodeAt(e)&64512)!=55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)==56320}function IAe(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!=0&&(r="0"+r),n=0;n<r.length;n+=2)t.push(parseInt(r[n]+r[n+1],16))}else for(var i=0,n=0;n<r.length;n++){var s=r.charCodeAt(n);s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):AAe(r,n)?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128)}else for(n=0;n<r.length;n++)t[n]=r[n]|0;return t}br.toArray=IAe;function TAe(r){for(var e="",t=0;t<r.length;t++)e+=$q(r[t].toString(16));return e}br.toHex=TAe;function Wq(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}br.htonl=Wq;function RAe(r,e){for(var t="",i=0;i<r.length;i++){var n=r[i];e==="little"&&(n=Wq(n)),t+=Yq(n.toString(16))}return t}br.toHex32=RAe;function $q(r){return r.length===1?"0"+r:r}br.zero2=$q;function Yq(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}br.zero8=Yq;function kAe(r,e,t,i){var n=t-e;SAe(n%4==0);for(var s=new Array(n/4),o=0,a=e;o<s.length;o++,a+=4){var c;i==="big"?c=r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3]:c=r[a+3]<<24|r[a+2]<<16|r[a+1]<<8|r[a],s[o]=c>>>0}return s}br.join32=kAe;function CAe(r,e){for(var t=new Array(r.length*4),i=0,n=0;i<r.length;i++,n+=4){var s=r[i];e==="big"?(t[n]=s>>>24,t[n+1]=s>>>16&255,t[n+2]=s>>>8&255,t[n+3]=s&255):(t[n+3]=s>>>24,t[n+2]=s>>>16&255,t[n+1]=s>>>8&255,t[n]=s&255)}return t}br.split32=CAe;function PAe(r,e){return r>>>e|r<<32-e}br.rotr32=PAe;function OAe(r,e){return r<<e|r>>>32-e}br.rotl32=OAe;function BAe(r,e){return r+e>>>0}br.sum32=BAe;function NAe(r,e,t){return r+e+t>>>0}br.sum32_3=NAe;function DAe(r,e,t,i){return r+e+t+i>>>0}br.sum32_4=DAe;function qAe(r,e,t,i,n){return r+e+t+i+n>>>0}br.sum32_5=qAe;function MAe(r,e,t,i){var n=r[e],s=r[e+1],o=i+s>>>0,a=(o<i?1:0)+t+n;r[e]=a>>>0,r[e+1]=o}br.sum64=MAe;function LAe(r,e,t,i){var n=e+i>>>0,s=(n<e?1:0)+r+t;return s>>>0}br.sum64_hi=LAe;function FAe(r,e,t,i){var n=e+i;return n>>>0}br.sum64_lo=FAe;function UAe(r,e,t,i,n,s,o,a){var c=0,u=e;u=u+i>>>0,c+=u<e?1:0,u=u+s>>>0,c+=u<s?1:0,u=u+a>>>0,c+=u<a?1:0;var f=r+t+n+o+c;return f>>>0}br.sum64_4_hi=UAe;function KAe(r,e,t,i,n,s,o,a){var c=e+i+s+a;return c>>>0}br.sum64_4_lo=KAe;function jAe(r,e,t,i,n,s,o,a,c,u){var f=0,h=e;h=h+i>>>0,f+=h<e?1:0,h=h+s>>>0,f+=h<s?1:0,h=h+a>>>0,f+=h<a?1:0,h=h+u>>>0,f+=h<u?1:0;var d=r+t+n+o+c+f;return d>>>0}br.sum64_5_hi=jAe;function VAe(r,e,t,i,n,s,o,a,c,u){var f=e+i+s+a+u;return f>>>0}br.sum64_5_lo=VAe;function zAe(r,e,t){var i=e<<32-t|r>>>t;return i>>>0}br.rotr64_hi=zAe;function HAe(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}br.rotr64_lo=HAe;function GAe(r,e,t){return r>>>t}br.shr64_hi=GAe;function $Ae(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}br.shr64_lo=$Ae});var rd=p(Xq=>{l();"use strict";var Jq=qo(),WAe=Du();function Fm(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Xq.BlockHash=Fm;Fm.prototype.update=function(e,t){if(e=Jq.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=Jq.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};Fm.prototype.digest=function(e){return this.update(this._pad()),WAe(this.pending===null),this._digest(e)};Fm.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,o=8;o<this.padLength;o++)n[s++]=0;return n}});var Ix=p(Fc=>{l();"use strict";var YAe=qo(),Na=YAe.rotr32;function XAe(r,e,t,i){if(r===0)return Qq(e,t,i);if(r===1||r===3)return e7(e,t,i);if(r===2)return Zq(e,t,i)}Fc.ft_1=XAe;function Qq(r,e,t){return r&e^~r&t}Fc.ch32=Qq;function Zq(r,e,t){return r&e^r&t^e&t}Fc.maj32=Zq;function e7(r,e,t){return r^e^t}Fc.p32=e7;function JAe(r){return Na(r,2)^Na(r,13)^Na(r,22)}Fc.s0_256=JAe;function QAe(r){return Na(r,6)^Na(r,11)^Na(r,25)}Fc.s1_256=QAe;function ZAe(r){return Na(r,7)^Na(r,18)^r>>>3}Fc.g0_256=ZAe;function e5e(r){return Na(r,17)^Na(r,19)^r>>>10}Fc.g1_256=e5e});var i7=p((pgt,t7)=>{l();"use strict";var id=qo(),t5e=rd(),r5e=Ix(),Tx=id.rotl32,wy=id.sum32,i5e=id.sum32_5,n5e=r5e.ft_1,r7=t5e.BlockHash,s5e=[1518500249,1859775393,2400959708,3395469782];function Da(){if(!(this instanceof Da))return new Da;r7.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}id.inherits(Da,r7);t7.exports=Da;Da.blockSize=512;Da.outSize=160;Da.hmacStrength=80;Da.padLength=64;Da.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=Tx(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4];for(n=0;n<i.length;n++){var f=~~(n/20),h=i5e(Tx(s,5),n5e(f,o,a,c),u,i[n],s5e[f]);u=c,c=a,a=Tx(o,30),o=s,s=h}this.h[0]=wy(this.h[0],s),this.h[1]=wy(this.h[1],o),this.h[2]=wy(this.h[2],a),this.h[3]=wy(this.h[3],c),this.h[4]=wy(this.h[4],u)};Da.prototype._digest=function(e){return e==="hex"?id.toHex32(this.h,"big"):id.split32(this.h,"big")}});var Rx=p((ygt,n7)=>{l();"use strict";var nd=qo(),o5e=rd(),sd=Ix(),a5e=Du(),Mo=nd.sum32,c5e=nd.sum32_4,u5e=nd.sum32_5,f5e=sd.ch32,l5e=sd.maj32,h5e=sd.s0_256,d5e=sd.s1_256,p5e=sd.g0_256,y5e=sd.g1_256,s7=o5e.BlockHash,g5e=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function qa(){if(!(this instanceof qa))return new qa;s7.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=g5e,this.W=new Array(64)}nd.inherits(qa,s7);n7.exports=qa;qa.blockSize=512;qa.outSize=256;qa.hmacStrength=192;qa.padLength=64;qa.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=c5e(y5e(i[n-2]),i[n-7],p5e(i[n-15]),i[n-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4],f=this.h[5],h=this.h[6],d=this.h[7];for(a5e(this.k.length===i.length),n=0;n<i.length;n++){var y=u5e(d,d5e(u),f5e(u,f,h),this.k[n],i[n]),g=Mo(h5e(s),l5e(s,o,a));d=h,h=f,f=u,u=Mo(c,y),c=a,a=o,o=s,s=Mo(y,g)}this.h[0]=Mo(this.h[0],s),this.h[1]=Mo(this.h[1],o),this.h[2]=Mo(this.h[2],a),this.h[3]=Mo(this.h[3],c),this.h[4]=Mo(this.h[4],u),this.h[5]=Mo(this.h[5],f),this.h[6]=Mo(this.h[6],h),this.h[7]=Mo(this.h[7],d)};qa.prototype._digest=function(e){return e==="hex"?nd.toHex32(this.h,"big"):nd.split32(this.h,"big")}});var c7=p((ggt,o7)=>{l();"use strict";var kx=qo(),a7=Rx();function Uc(){if(!(this instanceof Uc))return new Uc;a7.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}kx.inherits(Uc,a7);o7.exports=Uc;Uc.blockSize=512;Uc.outSize=224;Uc.hmacStrength=192;Uc.padLength=64;Uc.prototype._digest=function(e){return e==="hex"?kx.toHex32(this.h.slice(0,7),"big"):kx.split32(this.h.slice(0,7),"big")}});var Ox=p((bgt,u7)=>{l();"use strict";var Yn=qo(),b5e=rd(),m5e=Du(),Ma=Yn.rotr64_hi,La=Yn.rotr64_lo,f7=Yn.shr64_hi,l7=Yn.shr64_lo,Lu=Yn.sum64,Cx=Yn.sum64_hi,Px=Yn.sum64_lo,v5e=Yn.sum64_4_hi,w5e=Yn.sum64_4_lo,_5e=Yn.sum64_5_hi,E5e=Yn.sum64_5_lo,h7=b5e.BlockHash,S5e=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Lo(){if(!(this instanceof Lo))return new Lo;h7.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=S5e,this.W=new Array(160)}Yn.inherits(Lo,h7);u7.exports=Lo;Lo.blockSize=1024;Lo.outSize=512;Lo.hmacStrength=192;Lo.padLength=128;Lo.prototype._prepareBlock=function(e,t){for(var i=this.W,n=0;n<32;n++)i[n]=e[t+n];for(;n<i.length;n+=2){var s=I5e(i[n-4],i[n-3]),o=T5e(i[n-4],i[n-3]),a=i[n-14],c=i[n-13],u=x5e(i[n-30],i[n-29]),f=A5e(i[n-30],i[n-29]),h=i[n-32],d=i[n-31];i[n]=v5e(s,o,a,c,u,f,h,d),i[n+1]=w5e(s,o,a,c,u,f,h,d)}};Lo.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,n=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],u=this.h[5],f=this.h[6],h=this.h[7],d=this.h[8],y=this.h[9],g=this.h[10],m=this.h[11],x=this.h[12],_=this.h[13],P=this.h[14],q=this.h[15];m5e(this.k.length===i.length);for(var X=0;X<i.length;X+=2){var W=P,z=q,Z=N5e(d,y),ee=D5e(d,y),re=R5e(d,y,g,m,x,_),L=k5e(d,y,g,m,x,_),b=this.k[X],w=this.k[X+1],R=i[X],B=i[X+1],U=_5e(W,z,Z,ee,re,L,b,w,R,B),Q=E5e(W,z,Z,ee,re,L,b,w,R,B);W=O5e(n,s),z=B5e(n,s),Z=C5e(n,s,o,a,c,u),ee=P5e(n,s,o,a,c,u);var G=Cx(W,z,Z,ee),M=Px(W,z,Z,ee);P=x,q=_,x=g,_=m,g=d,m=y,d=Cx(f,h,U,Q),y=Px(h,h,U,Q),f=c,h=u,c=o,u=a,o=n,a=s,n=Cx(U,Q,G,M),s=Px(U,Q,G,M)}Lu(this.h,0,n,s),Lu(this.h,2,o,a),Lu(this.h,4,c,u),Lu(this.h,6,f,h),Lu(this.h,8,d,y),Lu(this.h,10,g,m),Lu(this.h,12,x,_),Lu(this.h,14,P,q)};Lo.prototype._digest=function(e){return e==="hex"?Yn.toHex32(this.h,"big"):Yn.split32(this.h,"big")};function R5e(r,e,t,i,n){var s=r&t^~r&n;return s<0&&(s+=4294967296),s}function k5e(r,e,t,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function C5e(r,e,t,i,n){var s=r&t^r&n^t&n;return s<0&&(s+=4294967296),s}function P5e(r,e,t,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function O5e(r,e){var t=Ma(r,e,28),i=Ma(e,r,2),n=Ma(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function B5e(r,e){var t=La(r,e,28),i=La(e,r,2),n=La(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function N5e(r,e){var t=Ma(r,e,14),i=Ma(r,e,18),n=Ma(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function D5e(r,e){var t=La(r,e,14),i=La(r,e,18),n=La(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function x5e(r,e){var t=Ma(r,e,1),i=Ma(r,e,8),n=f7(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function A5e(r,e){var t=La(r,e,1),i=La(r,e,8),n=l7(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function I5e(r,e){var t=Ma(r,e,19),i=Ma(e,r,29),n=f7(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}function T5e(r,e){var t=La(r,e,19),i=La(e,r,29),n=l7(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}});var y7=p((mgt,d7)=>{l();"use strict";var Bx=qo(),p7=Ox();function Kc(){if(!(this instanceof Kc))return new Kc;p7.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}Bx.inherits(Kc,p7);d7.exports=Kc;Kc.blockSize=1024;Kc.outSize=384;Kc.hmacStrength=192;Kc.padLength=128;Kc.prototype._digest=function(e){return e==="hex"?Bx.toHex32(this.h.slice(0,12),"big"):Bx.split32(this.h.slice(0,12),"big")}});var g7=p(od=>{l();"use strict";od.sha1=i7();od.sha224=c7();od.sha256=Rx();od.sha384=y7();od.sha512=Ox()});var E7=p(b7=>{l();"use strict";var tl=qo(),q5e=rd(),Um=tl.rotl32,m7=tl.sum32,_y=tl.sum32_3,v7=tl.sum32_4,w7=q5e.BlockHash;function Fa(){if(!(this instanceof Fa))return new Fa;w7.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}tl.inherits(Fa,w7);b7.ripemd160=Fa;Fa.blockSize=512;Fa.outSize=160;Fa.hmacStrength=192;Fa.padLength=64;Fa.prototype._update=function(e,t){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=i,u=n,f=s,h=o,d=a,y=0;y<80;y++){var g=m7(Um(v7(i,_7(y,n,s,o),e[F5e[y]+t],M5e(y)),K5e[y]),a);i=a,a=o,o=Um(s,10),s=n,n=g,g=m7(Um(v7(c,_7(79-y,u,f,h),e[U5e[y]+t],L5e(y)),j5e[y]),d),c=d,d=h,h=Um(f,10),f=u,u=g}g=_y(this.h[1],s,h),this.h[1]=_y(this.h[2],o,d),this.h[2]=_y(this.h[3],a,c),this.h[3]=_y(this.h[4],i,u),this.h[4]=_y(this.h[0],n,f),this.h[0]=g};Fa.prototype._digest=function(e){return e==="hex"?tl.toHex32(this.h,"little"):tl.split32(this.h,"little")};function _7(r,e,t,i){return r<=15?e^t^i:r<=31?e&t|~e&i:r<=47?(e|~t)^i:r<=63?e&i|t&~i:e^(t|~i)}function M5e(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function L5e(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var F5e=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],U5e=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],K5e=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],j5e=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]});var x7=p((_gt,S7)=>{l();"use strict";var V5e=qo(),z5e=Du();function ad(r,e,t){if(!(this instanceof ad))return new ad(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(V5e.toArray(e,t))}S7.exports=ad;ad.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),z5e(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)};ad.prototype.update=function(e,t){return this.inner.update(e,t),this};ad.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}});var Km=p(A7=>{l();var sn=A7;sn.utils=qo();sn.common=rd();sn.sha=g7();sn.ripemd=E7();sn.hmac=x7();sn.sha1=sn.sha.sha1;sn.sha256=sn.sha.sha256;sn.sha224=sn.sha.sha224;sn.sha384=sn.sha.sha384;sn.sha512=sn.sha.sha512;sn.ripemd160=sn.ripemd.ripemd160});var T7=p((Sgt,I7)=>{l();I7.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var jm=p(R7=>{l();"use strict";var Nx=R7,Fu=Km(),Dx=Ax(),H5e=ps(),k7=H5e.assert;function C7(r){r.type==="short"?this.curve=new Dx.short(r):r.type==="edwards"?this.curve=new Dx.edwards(r):this.curve=new Dx.mont(r),this.g=this.curve.g,this.n=this.curve.n,this.hash=r.hash,k7(this.g.validate(),"Invalid curve"),k7(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}Nx.PresetCurve=C7;function Uu(r,e){Object.defineProperty(Nx,r,{configurable:!0,enumerable:!0,get:function(){var t=new C7(e);return Object.defineProperty(Nx,r,{configurable:!0,enumerable:!0,value:t}),t}})}Uu("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Fu.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Uu("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Fu.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Uu("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Fu.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Uu("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Fu.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Uu("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Fu.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Uu("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Fu.sha256,gRed:!1,g:["9"]});Uu("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Fu.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var qx;try{qx=T7()}catch(r){qx=void 0}Uu("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Fu.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",qx]})});var B7=p((Agt,P7)=>{l();"use strict";var G5e=Km(),rl=mx(),O7=Du();function Ku(r){if(!(this instanceof Ku))return new Ku(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=rl.toArray(r.entropy,r.entropyEnc||"hex"),t=rl.toArray(r.nonce,r.nonceEnc||"hex"),i=rl.toArray(r.pers,r.persEnc||"hex");O7(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}P7.exports=Ku;Ku.prototype._init=function(e,t,i){var n=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};Ku.prototype._hmac=function(){return new G5e.hmac(this.hash,this.K)};Ku.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),!!e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};Ku.prototype.reseed=function(e,t,i,n){typeof t!="string"&&(n=i,i=t,t=null),e=rl.toArray(e,t),i=rl.toArray(i,n),O7(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};Ku.prototype.generate=function(e,t,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(n=i,i=t,t=null),i&&(i=rl.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,rl.encode(o,t)}});var D7=p((Igt,N7)=>{l();"use strict";var $5e=Oa(),W5e=ps(),Mx=W5e.assert;function dn(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}N7.exports=dn;dn.fromPublic=function(e,t,i){return t instanceof dn?t:new dn(e,{pub:t,pubEnc:i})};dn.fromPrivate=function(e,t,i){return t instanceof dn?t:new dn(e,{priv:t,privEnc:i})};dn.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};dn.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};dn.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};dn.prototype._importPrivate=function(e,t){this.priv=new $5e(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};dn.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?Mx(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Mx(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};dn.prototype.derive=function(e){return e.validate()||Mx(e.validate(),"public point not validated"),e.mul(this.priv).getX()};dn.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)};dn.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};dn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var L7=p((Tgt,q7)=>{l();"use strict";var Vm=Oa(),Lx=ps(),Y5e=Lx.assert;function zm(r,e){if(r instanceof zm)return r;this._importDER(r,e)||(Y5e(r.r&&r.s,"Signature without r or s"),this.r=new Vm(r.r,16),this.s=new Vm(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}q7.exports=zm;function X5e(){this.place=0}function Fx(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=r[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function M7(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}zm.prototype._importDER=function(e,t){e=Lx.toArray(e,t);var i=new X5e;if(e[i.place++]!==48)return!1;var n=Fx(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=Fx(e,i);if(s===!1)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=Fx(e,i);if(a===!1||e.length!==a+i.place)return!1;var c=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new Vm(o),this.s=new Vm(c),this.recoveryParam=null,!0};function Ux(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}zm.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=M7(t),i=M7(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];Ux(n,t.length),n=n.concat(t),n.push(2),Ux(n,i.length);var s=n.concat(i),o=[48];return Ux(o,s.length),o=o.concat(s),Lx.encode(o,e)}});var j7=p((Rgt,F7)=>{l();"use strict";var il=Oa(),U7=B7(),J5e=ps(),Kx=jm(),Q5e=Ex(),K7=J5e.assert,jx=D7(),Hm=L7();function Hs(r){if(!(this instanceof Hs))return new Hs(r);typeof r=="string"&&(K7(Object.prototype.hasOwnProperty.call(Kx,r),"Unknown curve "+r),r=Kx[r]),r instanceof Kx.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}F7.exports=Hs;Hs.prototype.keyPair=function(e){return new jx(this,e)};Hs.prototype.keyFromPrivate=function(e,t){return jx.fromPrivate(this,e,t)};Hs.prototype.keyFromPublic=function(e,t){return jx.fromPublic(this,e,t)};Hs.prototype.genKeyPair=function(e){e||(e={});for(var t=new U7({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Q5e(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new il(2));;){var s=new il(t.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Hs.prototype._truncateToN=function(e,t){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};Hs.prototype.sign=function(e,t,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new il(e,16));for(var s=this.n.byteLength(),o=t.getPrivate().toArray("be",s),a=e.toArray("be",s),c=new U7({hash:this.hash,entropy:o,nonce:a,pers:n.pers,persEnc:n.persEnc||"utf8"}),u=this.n.sub(new il(1)),f=0;;f++){var h=n.k?n.k(f):new il(c.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),!(h.cmpn(1)<=0||h.cmp(u)>=0)){var d=this.g.mul(h);if(!d.isInfinity()){var y=d.getX(),g=y.umod(this.n);if(g.cmpn(0)!==0){var m=h.invm(this.n).mul(g.mul(t.getPrivate()).iadd(e));if(m=m.umod(this.n),m.cmpn(0)!==0){var x=(d.getY().isOdd()?1:0)|(y.cmp(g)!==0?2:0);return n.canonical&&m.cmp(this.nh)>0&&(m=this.n.sub(m),x^=1),new Hm({r:g,s:m,recoveryParam:x})}}}}}};Hs.prototype.verify=function(e,t,i,n){e=this._truncateToN(new il(e,16)),i=this.keyFromPublic(i,n),t=new Hm(t,"hex");var s=t.r,o=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(e).umod(this.n),u=a.mul(s).umod(this.n),f;return this.curve._maxwellTrick?(f=this.g.jmulAdd(c,i.getPublic(),u),f.isInfinity()?!1:f.eqXToP(s)):(f=this.g.mulAdd(c,i.getPublic(),u),f.isInfinity()?!1:f.getX().umod(this.n).cmp(s)===0)};Hs.prototype.recoverPubKey=function(r,e,t,i){K7((3&t)===t,"The recovery param is more than two bits"),e=new Hm(e,i);var n=this.n,s=new il(r),o=e.r,a=e.s,c=t&1,u=t>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var f=e.r.invm(n),h=n.sub(s).mul(f).umod(n),d=a.mul(f).umod(n);return this.g.mulAdd(h,o,d)};Hs.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new Hm(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(r,e,n)}catch(o){continue}if(s.eq(t))return n}throw new Error("Unable to find valid recovery factor")}});var G7=p((kgt,V7)=>{l();"use strict";var Ey=ps(),z7=Ey.assert,H7=Ey.parseBytes,cd=Ey.cachedProperty;function ji(r,e){this.eddsa=r,this._secret=H7(e.secret),r.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=H7(e.pub)}ji.fromPublic=function(e,t){return t instanceof ji?t:new ji(e,{pub:t})};ji.fromSecret=function(e,t){return t instanceof ji?t:new ji(e,{secret:t})};ji.prototype.secret=function(){return this._secret};cd(ji,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});cd(ji,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});cd(ji,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});cd(ji,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});cd(ji,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});cd(ji,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});ji.prototype.sign=function(e){return z7(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};ji.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)};ji.prototype.getSecret=function(e){return z7(this._secret,"KeyPair is public only"),Ey.encode(this.secret(),e)};ji.prototype.getPublic=function(e){return Ey.encode(this.pubBytes(),e)};V7.exports=ji});var W7=p((Cgt,$7)=>{l();"use strict";var Z5e=Oa(),Gm=ps(),eIe=Gm.assert,$m=Gm.cachedProperty,tIe=Gm.parseBytes;function nl(r,e){this.eddsa=r,typeof e!="object"&&(e=tIe(e)),Array.isArray(e)&&(e={R:e.slice(0,r.encodingLength),S:e.slice(r.encodingLength)}),eIe(e.R&&e.S,"Signature without R or S"),r.isPoint(e.R)&&(this._R=e.R),e.S instanceof Z5e&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}$m(nl,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});$m(nl,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});$m(nl,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});$m(nl,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});nl.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};nl.prototype.toHex=function(){return Gm.encode(this.toBytes(),"hex").toUpperCase()};$7.exports=nl});var Z7=p((Pgt,Y7)=>{l();"use strict";var rIe=Km(),iIe=jm(),ud=ps(),nIe=ud.assert,X7=ud.parseBytes,J7=G7(),Q7=W7();function Xn(r){if(nIe(r==="ed25519","only tested with ed25519 so far"),!(this instanceof Xn))return new Xn(r);r=iIe[r].curve,this.curve=r,this.g=r.g,this.g.precompute(r.n.bitLength()+1),this.pointClass=r.point().constructor,this.encodingLength=Math.ceil(r.n.bitLength()/8),this.hash=rIe.sha512}Y7.exports=Xn;Xn.prototype.sign=function(e,t){e=X7(e);var i=this.keyFromSecret(t),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),o=this.encodePoint(s),a=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),c=n.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})};Xn.prototype.verify=function(e,t,i){e=X7(e),t=this.makeSignature(t);var n=this.keyFromPublic(i),s=this.hashInt(t.Rencoded(),n.pubBytes(),e),o=this.g.mul(t.S()),a=t.R().add(n.pub().mul(s));return a.eq(o)};Xn.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return ud.intFromLE(e.digest()).umod(this.curve.n)};Xn.prototype.keyFromPublic=function(e){return J7.fromPublic(this,e)};Xn.prototype.keyFromSecret=function(e){return J7.fromSecret(this,e)};Xn.prototype.makeSignature=function(e){return e instanceof Q7?e:new Q7(this,e)};Xn.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};Xn.prototype.decodePoint=function(e){e=ud.parseBytes(e);var t=e.length-1,i=e.slice(0,t).concat(e[t]&~128),n=(e[t]&128)!=0,s=ud.intFromLE(i);return this.curve.pointFromY(s,n)};Xn.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Xn.prototype.decodeInt=function(e){return ud.intFromLE(e)};Xn.prototype.isPoint=function(e){return e instanceof this.pointClass}});var tM=p(eM=>{l();"use strict";var sl=eM;sl.version=Rq().version;sl.utils=ps();sl.rand=Ex();sl.curve=Ax();sl.curves=jm();sl.ec=j7();sl.eddsa=Z7()});var iM=p((Bgt,rM)=>{l();var sIe=tM().ec,Ua=new sIe("secp256k1"),Pt=Ua.curve,mr=Pt.n.constructor;function oIe(r,e){let t=new mr(e);if(t.cmp(Pt.p)>=0)return null;t=t.toRed(Pt.red);let i=t.redSqr().redIMul(t).redIAdd(Pt.b).redSqrt();return r===3!==i.isOdd()&&(i=i.redNeg()),Ua.keyPair({pub:{x:t,y:i}})}function aIe(r,e,t){let i=new mr(e),n=new mr(t);if(i.cmp(Pt.p)>=0||n.cmp(Pt.p)>=0||(i=i.toRed(Pt.red),n=n.toRed(Pt.red),(r===6||r===7)&&n.isOdd()!==(r===7)))return null;let s=i.redSqr().redIMul(i);return n.redSqr().redISub(s.redIAdd(Pt.b)).isZero()?Ua.keyPair({pub:{x:i,y:n}}):null}function ju(r){let e=r[0];switch(e){case 2:case 3:return r.length!==33?null:oIe(e,r.subarray(1,33));case 4:case 6:case 7:return r.length!==65?null:aIe(e,r.subarray(1,33),r.subarray(33,65));default:return null}}function ol(r,e){let t=e.encode(null,r.length===33);for(let i=0;i<r.length;++i)r[i]=t[i]}rM.exports={contextRandomize(){return 0},privateKeyVerify(r){let e=new mr(r);return e.cmp(Pt.n)<0&&!e.isZero()?0:1},privateKeyNegate(r){let e=new mr(r),t=Pt.n.sub(e).umod(Pt.n).toArrayLike(Uint8Array,"be",32);return r.set(t),0},privateKeyTweakAdd(r,e){let t=new mr(e);if(t.cmp(Pt.n)>=0||(t.iadd(new mr(r)),t.cmp(Pt.n)>=0&&t.isub(Pt.n),t.isZero()))return 1;let i=t.toArrayLike(Uint8Array,"be",32);return r.set(i),0},privateKeyTweakMul(r,e){let t=new mr(e);if(t.cmp(Pt.n)>=0||t.isZero())return 1;t.imul(new mr(r)),t.cmp(Pt.n)>=0&&(t=t.umod(Pt.n));let i=t.toArrayLike(Uint8Array,"be",32);return r.set(i),0},publicKeyVerify(r){return ju(r)===null?1:0},publicKeyCreate(r,e){let t=new mr(e);if(t.cmp(Pt.n)>=0||t.isZero())return 1;let i=Ua.keyFromPrivate(e).getPublic();return ol(r,i),0},publicKeyConvert(r,e){let t=ju(e);if(t===null)return 1;let i=t.getPublic();return ol(r,i),0},publicKeyNegate(r,e){let t=ju(e);if(t===null)return 1;let i=t.getPublic();return i.y=i.y.redNeg(),ol(r,i),0},publicKeyCombine(r,e){let t=new Array(e.length);for(let n=0;n<e.length;++n)if(t[n]=ju(e[n]),t[n]===null)return 1;let i=t[0].getPublic();for(let n=1;n<t.length;++n)i=i.add(t[n].pub);return i.isInfinity()?2:(ol(r,i),0)},publicKeyTweakAdd(r,e,t){let i=ju(e);if(i===null)return 1;if(t=new mr(t),t.cmp(Pt.n)>=0)return 2;let n=i.getPublic().add(Pt.g.mul(t));return n.isInfinity()?2:(ol(r,n),0)},publicKeyTweakMul(r,e,t){let i=ju(e);if(i===null)return 1;if(t=new mr(t),t.cmp(Pt.n)>=0||t.isZero())return 2;let n=i.getPublic().mul(t);return ol(r,n),0},signatureNormalize(r){let e=new mr(r.subarray(0,32)),t=new mr(r.subarray(32,64));return e.cmp(Pt.n)>=0||t.cmp(Pt.n)>=0?1:(t.cmp(Ua.nh)===1&&r.set(Pt.n.sub(t).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(r,e){let t=e.subarray(0,32),i=e.subarray(32,64);if(new mr(t).cmp(Pt.n)>=0||new mr(i).cmp(Pt.n)>=0)return 1;let{output:n}=r,s=n.subarray(4,4+33);s[0]=0,s.set(t,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let c=n.subarray(6+33,6+33+33);c[0]=0,c.set(i,1);let u=33,f=0;for(;u>1&&c[f]===0&&!(c[f+1]&128);--u,++f);return c=c.subarray(f),c[0]&128||u>1&&c[0]===0&&!(c[1]&128)?1:(r.outputlen=6+o+u,n[0]=48,n[1]=r.outputlen-2,n[2]=2,n[3]=s.length,n.set(s,4),n[4+o]=2,n[5+o]=c.length,n.set(c,6+o),0)},signatureImport(r,e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return 1;let t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return 1;let i=e[5+t];if(i===0||6+t+i!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||i>1&&e[t+6]===0&&!(e[t+7]&128))return 1;let n=e.subarray(4,4+t);if(n.length===33&&n[0]===0&&(n=n.subarray(1)),n.length>32)return 1;let s=e.subarray(6+t);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new mr(n);o.cmp(Pt.n)>=0&&(o=new mr(0));let a=new mr(e.subarray(6+t));return a.cmp(Pt.n)>=0&&(a=new mr(0)),r.set(o.toArrayLike(Uint8Array,"be",32),0),r.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(r,e,t,i,n){if(n){let a=n;n=c=>{let u=a(e,t,null,i,c);if(!(u instanceof Uint8Array&&u.length===32))throw new Error("This is the way");return new mr(u)}}let s=new mr(t);if(s.cmp(Pt.n)>=0||s.isZero())return 1;let o;try{o=Ua.sign(e,t,{canonical:!0,k:n,pers:i})}catch(a){return 1}return r.signature.set(o.r.toArrayLike(Uint8Array,"be",32),0),r.signature.set(o.s.toArrayLike(Uint8Array,"be",32),32),r.recid=o.recoveryParam,0},ecdsaVerify(r,e,t){let i={r:r.subarray(0,32),s:r.subarray(32,64)},n=new mr(i.r),s=new mr(i.s);if(n.cmp(Pt.n)>=0||s.cmp(Pt.n)>=0)return 1;if(s.cmp(Ua.nh)===1||n.isZero()||s.isZero())return 3;let o=ju(t);if(o===null)return 2;let a=o.getPublic();return Ua.verify(e,i,a)?0:3},ecdsaRecover(r,e,t,i){let n={r:e.slice(0,32),s:e.slice(32,64)},s=new mr(n.r),o=new mr(n.s);if(s.cmp(Pt.n)>=0||o.cmp(Pt.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=Ua.recoverPubKey(i,n,t)}catch(c){return 2}return ol(r,a),0},ecdh(r,e,t,i,n,s,o){let a=ju(e);if(a===null)return 1;let c=new mr(t);if(c.cmp(Pt.n)>=0||c.isZero())return 2;let u=a.getPublic().mul(c);if(n===void 0){let f=u.encode(null,!0),h=Ua.hash().update(f).digest();for(let d=0;d<32;++d)r[d]=h[d]}else{s||(s=new Uint8Array(32));let f=u.getX().toArray("be",32);for(let g=0;g<32;++g)s[g]=f[g];o||(o=new Uint8Array(32));let h=u.getY().toArray("be",32);for(let g=0;g<32;++g)o[g]=h[g];let d=n(s,o,i);if(!(d instanceof Uint8Array&&d.length===r.length))return 2;r.set(d)}return 0}}});var sM=p((Ngt,nM)=>{l();nM.exports=Iq()(iM())});var uM=p((Dgt,oM)=>{l();"use strict";var Fo=sM(),aM=Gh(),cM="sha2-256";oM.exports=r=>{let e=32;function t(){let f;do f=r(32);while(!Fo.privateKeyVerify(f));return f}async function i(f,h){let d=await aM.digest(h,cM),y=Fo.ecdsaSign(d,f);return Fo.signatureExport(y.signature)}async function n(f,h,d){let y=await aM.digest(d,cM);return h=Fo.signatureImport(h),Fo.ecdsaVerify(h,y,f)}function s(f){if(!Fo.publicKeyVerify(f))throw new Error("Invalid public key");return Fo.publicKeyConvert(f,!0)}function o(f){return Fo.publicKeyConvert(f,!1)}function a(f){if(!Fo.privateKeyVerify(f))throw new Error("Invalid private key")}function c(f){if(!Fo.publicKeyVerify(f))throw new Error("Invalid public key")}function u(f){return a(f),Fo.publicKeyCreate(f)}return{generateKey:t,privateKeyLength:e,hashAndSign:i,hashAndVerify:n,compressPublicKey:s,decompressPublicKey:o,validatePrivateKey:a,validatePublicKey:c,computePublicKey:u}}});var dM=p((qgt,fM)=>{l();"use strict";var lM=Gh(),cIe=ge(),hM=Dr(),uIe=tt(),fIe=Im();fM.exports=(r,e,t)=>{t=t||uM()(e);class i{constructor(u){t.validatePublicKey(u),this._key=u}verify(u,f){return t.hashAndVerify(this._key,f,u)}marshal(){return t.compressPublicKey(this._key)}get bytes(){return r.PublicKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return hM(this.bytes,u.bytes)}hash(){return lM.multihashing(this.bytes,"sha2-256")}}class n{constructor(u,f){this._key=u,this._publicKey=f||t.computePublicKey(u),t.validatePrivateKey(this._key),t.validatePublicKey(this._publicKey)}sign(u){return t.hashAndSign(this._key,u)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return r.PrivateKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return hM(this.bytes,u.bytes)}hash(){return lM.multihashing(this.bytes,"sha2-256")}async id(){let u=await this.public.hash();return uIe(u,"base58btc")}async export(u,f="libp2p-key"){if(f==="libp2p-key")return fIe.export(this.bytes,u);throw cIe(new Error(`export format '${f}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new n(c)}function o(c){return new i(c)}async function a(){let c=await t.generateKey();return new n(c)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var yM=p((Mgt,pM)=>{l();"use strict";pM.exports={SHA1:20,SHA256:32,SHA512:64}});var Vx=p(gM=>{l();"use strict";var bM=ly(),lIe=yM(),hIe={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},dIe=async(r,e)=>{let t=await bM.get().subtle.sign({name:"HMAC"},r,e);return new Uint8Array(t,t.byteOffset,t.byteLength)};gM.create=async function(r,e){let t=hIe[r],i=await bM.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,["sign"]);return{async digest(n){return dIe(i,n)},length:lIe[r]}}});var EM=p((Fgt,mM)=>{l();"use strict";var vM=ge(),wM=vi(),pIe=ct(),yIe=Vx(),_M={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};mM.exports=async(r,e,t)=>{let i=_M[r];if(!i){let P=Object.keys(_M).join(" / ");throw vM(new Error(`unknown cipher type '${r}'. Must be ${P}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw vM(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,a=pIe("key expansion"),c=2*(s+n+o),u=await yIe.create(e,t),f=await u.digest(a),h=[],d=0;for(;d<c;){let P=await u.digest(wM([f,a])),q=P.length;d+q>c&&(q=c-d),h.push(P),d+=q,f=await u.digest(f)}let y=c/2,g=wM(h),m=g.slice(0,y),x=g.slice(y,c),_=P=>({iv:P.slice(0,s),cipherKey:P.slice(s,s+n),macKey:P.slice(s+n)});return{k1:_(m),k2:_(x)}}});var xM=p((Ugt,SM)=>{l();"use strict";var gIe=ge();SM.exports=function(r,e){if(!r.includes(e)){let t=r.join(" / ");throw gIe(new Error(`Unknown curve: ${e}. Must be ${t}`),"ERR_INVALID_CURVE")}}});var CM=p(AM=>{l();"use strict";var bIe=ge(),Sy=ly(),{base64urlToBuffer:IM}=Am(),mIe=xM(),zx=tt(),vIe=vi(),wIe=Dr(),TM={"P-256":256,"P-384":384,"P-521":521};AM.generateEphmeralKeyPair=async function(r){mIe(Object.keys(TM),r);let e=await Sy.get().subtle.generateKey({name:"ECDH",namedCurve:r},!0,["deriveBits"]),t=async(n,s)=>{let o;s?o=await Sy.get().subtle.importKey("jwk",EIe(r,s),{name:"ECDH",namedCurve:r},!1,["deriveBits"]):o=e.privateKey;let a=[await Sy.get().subtle.importKey("jwk",RM(r,n),{name:"ECDH",namedCurve:r},!1,[]),o],c=await Sy.get().subtle.deriveBits({name:"ECDH",namedCurve:r,public:a[0]},a[1],TM[r]);return new Uint8Array(c,c.byteOffset,c.byteLength)},i=await Sy.get().subtle.exportKey("jwk",e.publicKey);return{key:_Ie(i),genSharedKey:t}};var kM={"P-256":32,"P-384":48,"P-521":66};function _Ie(r){let e=kM[r.crv];return vIe([Uint8Array.from([4]),IM(r.x,e),IM(r.y,e)],1+e*2)}function RM(r,e){let t=kM[r];if(wIe(!e.slice(0,1),Uint8Array.from([4])))throw bIe(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:r,x:zx(e.slice(1,t+1),"base64url"),y:zx(e.slice(1+t),"base64url"),ext:!0}}var EIe=(r,e)=>({...RM(r,e.public),d:zx(e.private,"base64url")})});var OM=p((jgt,PM)=>{l();"use strict";var SIe=CM();PM.exports=async r=>SIe.generateEphmeralKeyPair(r)});var Ym=p((Vgt,BM)=>{l();"use strict";var Ka=im();Pc();rx();var Hx=bt(),xy=ge(),xIe=ct(),AIe=OD(),Gs={rsa:bq(),ed25519:xq(),secp256k1:dM()(Ka,py())},Wm={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function fd(r){let e=Gs[r.toLowerCase()];if(!e){let t=Object.keys(Gs).join(" / ");throw xy(new Error(`invalid or unsupported key type ${r}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var IIe=async(r,e)=>fd(r).generateKeyPair(e),TIe=async(r,e,t)=>{let i=fd(r);if(r.toLowerCase()!=="ed25519")throw xy(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,t)},RIe=r=>{let e=Ka.PublicKey.decode(r),t=e.Data;switch(e.Type){case Ka.KeyType.RSA:return Gs.rsa.unmarshalRsaPublicKey(t);case Ka.KeyType.Ed25519:return Gs.ed25519.unmarshalEd25519PublicKey(t);case Ka.KeyType.Secp256k1:if(Gs.secp256k1)return Gs.secp256k1.unmarshalSecp256k1PublicKey(t);throw xy(new Error(Wm.message),Wm.code);default:fd(e.Type)}},kIe=(r,e)=>(e=(e||"rsa").toLowerCase(),fd(e),r.bytes),NM=async r=>{let e=Ka.PrivateKey.decode(r),t=e.Data;switch(e.Type){case Ka.KeyType.RSA:return Gs.rsa.unmarshalRsaPrivateKey(t);case Ka.KeyType.Ed25519:return Gs.ed25519.unmarshalEd25519PrivateKey(t);case Ka.KeyType.Secp256k1:if(Gs.secp256k1)return Gs.secp256k1.unmarshalSecp256k1PrivateKey(t);throw xy(new Error(Wm.message),Wm.code);default:fd(e.Type)}},CIe=(r,e)=>(e=(e||"rsa").toLowerCase(),fd(e),r.bytes),PIe=async(r,e)=>{try{let n=await AIe.import(r,e);return NM(n)}catch(n){}let t=Hx.pki.decryptRsaPrivateKey(r,e);if(t===null)throw xy(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=Hx.asn1.toDer(Hx.pki.privateKeyToAsn1(t));return i=xIe(i.getBytes(),"ascii"),Gs.rsa.unmarshalRsaPrivateKey(i)};BM.exports={supportedKeys:Gs,keysPBM:Ka,keyStretcher:EM(),generateEphemeralKeyPair:OM(),generateKeyPair:IIe,generateKeyPairFromSeed:TIe,unmarshalPublicKey:RIe,marshalPublicKey:kIe,unmarshalPrivateKey:NM,marshalPrivateKey:CIe,import:PIe}});var Xm=p((zgt,Gx)=>{l();"use strict";function OIe(r,{className:e,symbolName:t}){let i=Symbol.for(t),n={[e]:class extends r{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function BIe(r,{className:e,symbolName:t,withoutNew:i}){let n=Symbol.for(t),s={[e]:function(...o){if(i&&!(this instanceof s))return new s(...o);let a=r.call(this,...o)||this;return a&&!a[n]&&Object.defineProperty(a,n,{value:!0}),a}}[e];return s.prototype=Object.create(r.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[n]),s}Gx.exports=OIe;Gx.exports.proto=BIe});var MM=p((Hgt,DM)=>{l();"use strict";var ld=hi(),qM=ld.Reader,NIe=ld.Writer,wi=ld.util,Ay=ld.roots["libp2p-peer-id"]||(ld.roots["libp2p-peer-id"]={});Ay.PeerIdProto=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.id=wi.newBuffer([]),r.prototype.pubKey=wi.newBuffer([]),r.prototype.privKey=wi.newBuffer([]),r.encode=function(t,i){return i||(i=NIe.create()),i.uint32(10).bytes(t.id),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(18).bytes(t.pubKey),t.privKey!=null&&Object.hasOwnProperty.call(t,"privKey")&&i.uint32(26).bytes(t.privKey),i},r.decode=function(t,i){t instanceof qM||(t=qM.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ay.PeerIdProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.id=t.bytes();break;case 2:s.pubKey=t.bytes();break;case 3:s.privKey=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw wi.ProtocolError("missing required 'id'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Ay.PeerIdProto)return t;var i=new Ay.PeerIdProto;return t.id!=null&&(typeof t.id=="string"?wi.base64.decode(t.id,i.id=wi.newBuffer(wi.base64.length(t.id)),0):t.id.length&&(i.id=t.id)),t.pubKey!=null&&(typeof t.pubKey=="string"?wi.base64.decode(t.pubKey,i.pubKey=wi.newBuffer(wi.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.privKey!=null&&(typeof t.privKey=="string"?wi.base64.decode(t.privKey,i.privKey=wi.newBuffer(wi.base64.length(t.privKey)),0):t.privKey.length&&(i.privKey=t.privKey)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=wi.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=wi.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=wi.newBuffer(n.privKey)))),t.id!=null&&t.hasOwnProperty("id")&&(n.id=i.bytes===String?wi.base64.encode(t.id,0,t.id.length):i.bytes===Array?Array.prototype.slice.call(t.id):t.id),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?wi.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.privKey!=null&&t.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?wi.base64.encode(t.privKey,0,t.privKey.length):i.bytes===Array?Array.prototype.slice.call(t.privKey):t.privKey),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,ld.util.toJSONOptions)},r}();DM.exports=Ay});var dt=p((ys,LM)=>{l();"use strict";var al=ko(),$x=Qe(),ja=Ym(),DIe=Xm(),{PeerIdProto:FM}=MM(),cl=Dr(),Iy=ct(),qIe=tt(),UM=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(t&&i&&!cl(t.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=al.toB58String(this.id),this._privKey=t,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=al.decode(this.id);e.name==="identity"&&(this._pubKey=ja.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return ja.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return ja.marshalPrivateKey(this.privKey)}marshal(e){return FM.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let t=6;return e.length<t&&(t=e.length),"<peer.ID "+e.substr(0,t)+">"}toJSON(){return{id:this.toB58String(),privKey:KM(this.marshalPrivKey()),pubKey:KM(this.marshalPubKey())}}toHexString(){return al.toHexString(this.id)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=new $x(1,"libp2p-key",this.id,"base32");Object.defineProperty(this,"_idCIDString",{value:e.toBaseEncodedString("base32"),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return cl(this.id,e);if(e.id)return cl(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&cl(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(al.decode(this.id).name==="identity")return!0}catch(e){}return!1}},Va=DIe(UM,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});ys=LM.exports=Va;var Ty=r=>r.bytes.length<=42?al.encode(r.bytes,"identity"):r.hash(),Wx=async(r,e)=>{let t=await Ty(e);return new Va(t,r,e)};ys.create=async r=>{r=r||{},r.bits=r.bits||2048,r.keyType=r.keyType||"RSA";let e=await ja.generateKeyPair(r.keyType,r.bits);return Wx(e,e.public)};ys.createFromHexString=r=>new Va(al.fromHexString(r));ys.createFromBytes=r=>new Va(r);ys.createFromB58String=r=>ys.createFromCID(r);var MIe=r=>r.codec==="libp2p-key"||r.codec==="dag-pb";ys.createFromCID=r=>{if(r=$x.isCID(r)?r:new $x(r),!MIe(r))throw new Error("Supplied PeerID CID has invalid multicodec: "+r.codec);return new Va(r.multihash)};ys.createFromPubKey=async r=>{let e=r;if(typeof e=="string"&&(e=Iy(r,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let t=await ja.unmarshalPublicKey(e);return Wx(null,t)};ys.createFromPrivKey=async r=>{if(typeof r=="string"&&(r=Iy(r,"base64pad")),!(r instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await ja.unmarshalPrivateKey(r);return Wx(e,e.public)};ys.createFromJSON=async r=>{let e=al.fromB58String(r.id),t=r.privKey&&Iy(r.privKey,"base64pad"),i=r.pubKey&&Iy(r.pubKey,"base64pad"),n=i&&await ja.unmarshalPublicKey(i);if(!t)return new Va(e,null,n);let s=await ja.unmarshalPrivateKey(t),o=await Ty(s.public),a;if(n&&(a=await Ty(n)),n&&!cl(o,a))throw new Error("Public and private key do not match");if(e&&!cl(o,e))throw new Error("Id and private key do not match");return new Va(e,s,n)};ys.createFromProtobuf=async r=>{typeof r=="string"&&(r=Iy(r,"base16"));let{id:e,privKey:t,pubKey:i}=FM.decode(r);t=t?await ja.unmarshalPrivateKey(t):!1,i=i?await ja.unmarshalPublicKey(i):!1;let n,s;if(t&&(s=await Ty(t.public)),i&&(n=await Ty(i)),t){if(i&&!cl(s,n))throw new Error("Public and private key do not match");return new Va(s,t,t.public)}if(i)return new Va(n,null,i);if(e)return new Va(e);throw new Error("Protobuf did not contain any usable key material")};ys.isPeerId=r=>Boolean(typeof r=="object"&&r._id&&r._idB58String);function KM(r){if(r)return qIe(r,"base64pad")}});var zM=p((Ggt,jM)=>{l();"use strict";Kh();var Jm=bt(),hd=tt(),VM=ct();jM.exports={createCipheriv:(r,e,t)=>{let i=Jm.cipher.createCipher("AES-CTR",hd(e,"ascii"));return i.start({iv:hd(t,"ascii")}),{update:n=>(i.update(Jm.util.createBuffer(hd(n,"ascii"))),VM(i.output.getBytes(),"ascii"))}},createDecipheriv:(r,e,t)=>{let i=Jm.cipher.createDecipher("AES-CTR",hd(e,"ascii"));return i.start({iv:hd(t,"ascii")}),{update:n=>(i.update(Jm.util.createBuffer(hd(n,"ascii"))),VM(i.output.getBytes(),"ascii"))}}}});var $M=p(($gt,HM)=>{l();"use strict";var LIe=ge(),GM={16:"aes-128-ctr",32:"aes-256-ctr"};HM.exports=function(r){let e=GM[r.length];if(!e){let t=Object.entries(GM).map(([i,n])=>`${i} (${n})`).join(" / ");throw LIe(new Error(`Invalid key length ${r.length} bytes. Must be ${t}`),"ERR_INVALID_KEY_LENGTH")}return e}});var XM=p(WM=>{l();"use strict";var YM=zM(),FIe=$M();WM.create=async function(r,e){let t=FIe(r),i=YM.createCipheriv(t,r,e),n=YM.createDecipheriv(t,r,e);return{async encrypt(o){return i.update(o)},async decrypt(o){return n.update(o)}}}});var ZM=p((Ygt,JM)=>{l();"use strict";var UIe=GS(),KIe=yr(),jIe=ge(),QM={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function VIe(r,e,t,i,n){let s=QM[n];if(!s){let a=Object.keys(QM).join(" / ");throw jIe(new Error(`Hash '${n}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=UIe(r,e,t,i,s);return KIe.encode64(o)}JM.exports=VIe});var za=p(dd=>{l();"use strict";var zIe=Vx(),HIe=XM(),GIe=Ym();dd.aes=HIe;dd.hmac=zIe;dd.keys=GIe;dd.randomBytes=py();dd.pbkdf2=ZM()});var Xx=p((Jgt,e9)=>{l();"use strict";var t9="[a-fA-F\\d:]",Vu=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${t9})|(?<=${t9})(?=\\s|$))`:"",Uo="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",di="[a-fA-F\\d]{1,4}",Qm=`
(?:
(?:${di}:){7}(?:${di}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${di}:){6}(?:${Uo}|:${di}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${di}:){5}(?::${Uo}|(?::${di}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${di}:){4}(?:(?::${di}){0,1}:${Uo}|(?::${di}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${di}:){3}(?:(?::${di}){0,2}:${Uo}|(?::${di}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${di}:){2}(?:(?::${di}){0,3}:${Uo}|(?::${di}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${di}:){1}(?:(?::${di}){0,4}:${Uo}|(?::${di}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${di}){0,5}:${Uo}|(?::${di}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),$Ie=new RegExp(`(?:^${Uo}$)|(?:^${Qm}$)`),WIe=new RegExp(`^${Uo}$`),YIe=new RegExp(`^${Qm}$`),Yx=r=>r&&r.exact?$Ie:new RegExp(`(?:${Vu(r)}${Uo}${Vu(r)})|(?:${Vu(r)}${Qm}${Vu(r)})`,"g");Yx.v4=r=>r&&r.exact?WIe:new RegExp(`${Vu(r)}${Uo}${Vu(r)}`,"g");Yx.v6=r=>r&&r.exact?YIe:new RegExp(`${Vu(r)}${Qm}${Vu(r)}`,"g");e9.exports=Yx});var i9=p((Qgt,r9)=>{l();"use strict";var Jx=Xx(),pd=r=>Jx({exact:!0}).test(r);pd.v4=r=>Jx.v4({exact:!0}).test(r);pd.v6=r=>Jx.v6({exact:!0}).test(r);pd.version=r=>pd(r)?pd.v4(r)?4:6:void 0;r9.exports=pd});var c9=p((Zgt,n9)=>{l();"use strict";var Qx=i9(),s9=tt(),XIe=Qx,Zx=Qx.v4,o9=Qx.v6,a9=function(r,e,t){t=~~t;let i;if(Zx(r))i=e||new Uint8Array(t+4),r.split(/\./g).map(function(s){i[t++]=parseInt(s,10)&255});else if(o9(r)){let s=r.split(":",8),o;for(o=0;o<s.length;o++){let a=Zx(s[o]);var n;a&&(n=a9(s[o]),s[o]=s9(n.slice(0,2),"base16")),n&&++o<8&&s.splice(o,0,s9(n.slice(2,4),"base16"))}if(s[0]==="")for(;s.length<8;)s.unshift("0");else if(s[s.length-1]==="")for(;s.length<8;)s.push("0");else if(s.length<8){for(o=0;o<s.length&&s[o]!=="";o++);let a=[o,"1"];for(o=9-s.length;o>0;o--)a.push("0");s.splice.apply(s,a)}for(i=e||new Uint8Array(t+16),o=0;o<s.length;o++){let a=parseInt(s[o],16);i[t++]=a>>8&255,i[t++]=a&255}}if(!i)throw Error("Invalid ip address: "+r);return i},JIe=function(r,e,t){e=~~e,t=t||r.length-e;let i=[],n,s=new DataView(r.buffer);if(t===4){for(let o=0;o<t;o++)i.push(r[e+o]);n=i.join(".")}else if(t===16){for(let o=0;o<t;o+=2)i.push(s.getUint16(e+o).toString(16));n=i.join(":"),n=n.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),n=n.replace(/:{3,4}/,"::")}return n};n9.exports={isIP:XIe,isV4:Zx,isV6:o9,toBytes:a9,toString:JIe}});var Ry=p((e1t,u9)=>{l();"use strict";function Jn(r){if(typeof r=="number"){if(Jn.codes[r])return Jn.codes[r];throw new Error("no protocol with code: "+r)}else if(typeof r=="string"){if(Jn.names[r])return Jn.names[r];throw new Error("no protocol with name: "+r)}throw new Error("invalid protocol id type: "+r)}var $s=-1;Jn.lengthPrefixedVarSize=$s;Jn.V=$s;Jn.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,$s,"ip6zone"],[53,$s,"dns","resolvable"],[54,$s,"dns4","resolvable"],[55,$s,"dns6","resolvable"],[56,$s,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,$s,"unix",!1,"path"],[421,$s,"ipfs"],[421,$s,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,$s,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,$s,"memory"]];Jn.names={};Jn.codes={};Jn.table.map(r=>{let e=f9.apply(null,r);return Jn.codes[e.code]=e,Jn.names[e.name]=e,null});Jn.object=f9;function f9(r,e,t,i,n){return{code:r,size:e,name:t,resolvable:Boolean(i),path:Boolean(n)}}u9.exports=Jn});var d9=p((t1t,l9)=>{l();l9.exports=e6;var h9=128,QIe=127,ZIe=~QIe,e8e=Math.pow(2,31);function e6(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw e6.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=e8e;)e[t++]=r&255|h9,r/=128;for(;r&ZIe;)e[t++]=r&255|h9,r>>>=7;return e[t]=r|0,e6.bytes=t-i+1,e}});var g9=p((r1t,p9)=>{l();p9.exports=t6;var t8e=128,y9=127;function t6(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw t6.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&y9)<<i:(s&y9)*Math.pow(2,i),i+=7}while(s>=t8e);return t6.bytes=n-e,t}});var m9=p((i1t,b9)=>{l();var r8e=Math.pow(2,7),i8e=Math.pow(2,14),n8e=Math.pow(2,21),s8e=Math.pow(2,28),o8e=Math.pow(2,35),a8e=Math.pow(2,42),c8e=Math.pow(2,49),u8e=Math.pow(2,56),f8e=Math.pow(2,63);b9.exports=function(r){return r<r8e?1:r<i8e?2:r<n8e?3:r<s8e?4:r<o8e?5:r<a8e?6:r<c8e?7:r<u8e?8:r<f8e?9:10}});var Zm=p((n1t,v9)=>{l();v9.exports={encode:d9(),decode:g9(),encodingLength:m9()}});var T9=p((s1t,w9)=>{l();"use strict";var e2=c9(),_9=Ry(),l8e=Qe(),E9=en(),yd=Zm(),t2=tt(),S9=ct(),r2=vi();w9.exports=ky;function ky(r,e){return e instanceof Uint8Array?ky.toString(r,e):ky.toBytes(r,e)}ky.toString=function(e,t){switch(_9(e).code){case 4:case 41:return h8e(t);case 6:case 273:case 33:case 132:return x9(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return d8e(t);case 421:return p8e(t);case 444:return A9(t);case 445:return A9(t);default:return t2(t,"base16")}};ky.toBytes=function(e,t){switch(_9(e).code){case 4:return I9(t);case 41:return I9(t);case 6:case 273:case 33:case 132:return r6(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return y8e(t);case 421:return g8e(t);case 444:return b8e(t);case 445:return m8e(t);default:return S9(t,"base16")}};function I9(r){if(!e2.isIP(r))throw new Error("invalid ip address");return e2.toBytes(r)}function h8e(r){let e=e2.toString(r);if(!e||!e2.isIP(e))throw new Error("invalid ip address");return e}function r6(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function x9(r){return new DataView(r.buffer).getUint16(0)}function y8e(r){let e=S9(r),t=Uint8Array.from(yd.encode(e.length));return r2([t,e],t.length+e.length)}function d8e(r){let e=yd.decode(r);if(r=r.slice(yd.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return t2(r)}function g8e(r){let e=new l8e(r).multihash,t=Uint8Array.from(yd.encode(e.length));return r2([t,e],t.length+e.length)}function p8e(r){let e=yd.decode(r),t=r.slice(yd.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return t2(t,"base58btc")}function b8e(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let t=E9.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=r6(i);return r2([t,n],t.length+n.length)}function m8e(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let t=E9.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=r6(i);return r2([t,n],t.length+n.length)}function A9(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),i=t2(e,"base32"),n=x9(t);return i+":"+n}});var F9=p((o1t,R9)=>{l();"use strict";var k9=T9(),i6=Ry(),Cy=Zm(),C9=vi(),v8e=tt();R9.exports={stringToStringTuples:P9,stringTuplesToString:O9,tuplesToStringTuples:N9,stringTuplesToTuples:B9,bytesToTuples:n6,tuplesToBytes:D9,bytesToString:w8e,stringToBytes:M9,fromString:_8e,fromBytes:L9,validateBytes:s6,isValidBytes:E8e,cleanPath:i2,ParseError:o6,protoFromTuple:Py,sizeForAddr:q9};function P9(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let i=0;i<t.length;i++){let n=t[i],s=i6(n);if(s.size===0){e.push([n]);continue}if(i++,i>=t.length)throw o6("invalid address: "+r);if(s.path){e.push([n,i2(t.slice(i).join("/"))]);break}e.push([n,t[i]])}return e}function O9(r){let e=[];return r.map(t=>{let i=Py(t);return e.push(i.name),t.length>1&&e.push(t[1]),null}),i2(e.join("/"))}function B9(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=Py(e);return e.length>1?[t.code,k9.toBytes(t.code,e[1])]:[t.code]})}function N9(r){return r.map(e=>{let t=Py(e);return e[1]?[t.code,k9.toString(t.code,e[1])]:[t.code]})}function D9(r){return L9(C9(r.map(e=>{let t=Py(e),i=Uint8Array.from(Cy.encode(t.code));return e.length>1&&(i=C9([i,e[1]])),i})))}function q9(r,e){return r.size>0?r.size/8:r.size===0?0:Cy.decode(e)+Cy.decode.bytes}function n6(r){let e=[],t=0;for(;t<r.length;){let i=Cy.decode(r,t),n=Cy.decode.bytes,s=i6(i),o=q9(s,r.slice(t+n));if(o===0){e.push([i]),t+=n;continue}let a=r.slice(t+n,t+n+o);if(t+=o+n,t>r.length)throw o6("Invalid address Uint8Array: "+v8e(r,"base16"));e.push([i,a])}return e}function w8e(r){let e=n6(r),t=N9(e);return O9(t)}function M9(r){r=i2(r);let e=P9(r),t=B9(e);return D9(t)}function _8e(r){return M9(r)}function L9(r){let e=s6(r);if(e)throw e;return Uint8Array.from(r)}function s6(r){try{n6(r)}catch(e){return e}}function E8e(r){return s6(r)===void 0}function i2(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function o6(r){return new Error("Error parsing address: "+r)}function Py(r){return i6(r[0])}});var lr=p((a1t,U9)=>{l();"use strict";var Ko=F9(),gd=Ry(),K9=Zm(),S8e=Qe(),x8e=ge(),A8e=Symbol.for("nodejs.util.inspect.custom"),a6=tt(),I8e=Dr(),c6=new Map,j9=Symbol.for("@multiformats/js-multiaddr/multiaddr"),kn=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,j9,{value:!0}),e instanceof Uint8Array)this.bytes=Ko.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Ko.fromString(e)}else if(kn.isMultiaddr(e))this.bytes=Ko.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Ko.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},t=this.toString().split("/");return e.family=t[1]==="ip4"?4:6,e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},gd(e)))}protoCodes(){let e=[],t=this.bytes,i=0;for(;i<t.length;){let n=K9.decode(t,i),s=K9.decode.bytes,o=gd(n);i+=Ko.sizeForAddr(o,t.slice(i+s))+s,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Ko.bytesToTuples(this.bytes)}stringTuples(){let e=Ko.bytesToTuples(this.bytes);return Ko.tuplesToStringTuples(e)}encapsulate(e){return e=new kn(e),new kn(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),i=this.toString(),n=i.lastIndexOf(t);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new kn(i.slice(0,n))}decapsulateCode(e){let t=this.tuples();for(let i=t.length-1;i>=0;i--)if(t[i][0]===e)return new kn(Ko.tuplesToBytes(t.slice(0,i)));return this}getPeerId(){try{let t=this.stringTuples().filter(i=>i[0]===gd.names.ipfs.code).pop();return t&&t[1]?a6(new S8e(t[1]).multihash,"base58btc"):null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>!!gd(t[0]).path)[0][1],e||(e=null)}catch(t){e=null}return e}equals(e){return I8e(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(n=>n.resolvable);if(!e)return[this];let t=c6.get(e.name);if(!t)throw x8e(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map(n=>new kn(n))}nodeAddress(){let e=this.protoCodes(),t=this.protoNames(),i=this.toString().split("/").slice(1);if(i.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(i[2]!=="tcp"&&i[2]!=="udp")throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:i[1],port:parseInt(i[3])}}isThinWaistAddress(e){let t=(e||this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}static fromNodeAddress(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");let i;switch(e.family){case 4:i="ip4";break;case 6:i="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new kn("/"+[i,e.address,t,e.port].join("/"))}static isName(e){return kn.isMultiaddr(e)?e.protos().some(t=>t.resolvable):!1}static isMultiaddr(e){return e instanceof kn||Boolean(e&&e[j9])}[A8e](){return"<Multiaddr "+a6(this.bytes,"base16")+" - "+Ko.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+a6(this.bytes,"base16")+" - "+Ko.bytesToString(this.bytes)+">"}};kn.protocols=gd;kn.resolvers=c6;function T8e(r){return new kn(r)}U9.exports={Multiaddr:kn,multiaddr:T8e,protocols:gd,resolvers:c6}});var fl=p((c1t,V9)=>{l();"use strict";var{Multiaddr:u6}=lr(),z9=nt("dns4"),H9=nt("dns6"),G9=nt("dnsaddr"),ul=pn(nt("dns"),G9,z9,H9),Oy=pn(nt("ip4"),nt("ip6")),bd=pn(vt(Oy,nt("tcp")),vt(ul,nt("tcp"))),f6=vt(Oy,nt("udp")),$9=vt(f6,nt("utp")),W9=vt(f6,nt("quic")),md=pn(vt(bd,nt("ws")),vt(ul,nt("ws"))),vd=pn(vt(bd,nt("wss")),vt(ul,nt("wss"))),n2=pn(vt(bd,nt("http")),vt(Oy,nt("http")),vt(ul,nt("http"))),s2=pn(vt(bd,nt("https")),vt(Oy,nt("https")),vt(ul,nt("https"))),l6=pn(vt(md,nt("p2p-webrtc-star"),nt("p2p")),vt(vd,nt("p2p-webrtc-star"),nt("p2p")),vt(md,nt("p2p-webrtc-star")),vt(vd,nt("p2p-webrtc-star"))),R8e=pn(vt(md,nt("p2p-websocket-star"),nt("p2p")),vt(vd,nt("p2p-websocket-star"),nt("p2p")),vt(md,nt("p2p-websocket-star")),vt(vd,nt("p2p-websocket-star"))),h6=pn(vt(n2,nt("p2p-webrtc-direct"),nt("p2p")),vt(s2,nt("p2p-webrtc-direct"),nt("p2p")),vt(n2,nt("p2p-webrtc-direct")),vt(s2,nt("p2p-webrtc-direct"))),wd=pn(md,vd,n2,s2,l6,h6,bd,$9,W9,ul),k8e=pn(vt(wd,nt("p2p-stardust"),nt("p2p")),vt(wd,nt("p2p-stardust"))),zu=pn(vt(wd,nt("p2p")),l6,h6,nt("p2p")),Y9=pn(vt(zu,nt("p2p-circuit"),zu),vt(zu,nt("p2p-circuit")),vt(nt("p2p-circuit"),zu),vt(wd,nt("p2p-circuit")),vt(nt("p2p-circuit"),wd),nt("p2p-circuit")),X9=()=>pn(vt(Y9,X9),Y9),_d=X9(),J9=pn(vt(_d,zu,_d),vt(zu,_d),vt(_d,zu),_d,zu);V9.exports={DNS:ul,DNS4:z9,DNS6:H9,DNSADDR:G9,IP:Oy,TCP:bd,UDP:f6,QUIC:W9,UTP:$9,HTTP:n2,HTTPS:s2,WebSockets:md,WebSocketsSecure:vd,WebSocketStar:R8e,WebRTCStar:l6,WebRTCDirect:h6,Reliable:wd,Stardust:k8e,Circuit:_d,P2P:J9,IPFS:J9};function Q9(r){function e(t){if(!u6.isMultiaddr(t))try{t=new u6(t)}catch(n){return!1}let i=r(t.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function vt(...r){function e(t){if(t.length<r.length)return null;let i=t;return r.some(n=>(i=typeof n=="function"?n().partialMatch(t):n.partialMatch(t),Array.isArray(i)&&(t=i),i===null)),i}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:Q9(e),partialMatch:e}}function pn(...r){function e(i){let n=null;return r.some(s=>{let o=typeof s=="function"?s().partialMatch(i):s.partialMatch(i);return o?(n=o,!0):!1}),n}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:Q9(e),partialMatch:e}}function nt(r){let e=r;function t(n){if(typeof n=="string")try{n=new u6(n)}catch(o){return!1}let s=n.protoNames();return s.length===1&&s[0]===e}function i(n){return n.length===0?null:n[0]===e?n.slice(1):null}return{toString:function(){return e},matches:t,partialMatch:i}}});var ll=p((u1t,Z9)=>{l();"use strict";var C8e=ko(),eL=en(),{Multiaddr:tL}=lr(),P8e=fl(),O8e=Qe(),{URL:B8e}=Oh(),N8e=tt(),d6=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,Ed=/^\/(ip[fn]s)\/([^/?#]+)/,rL=1,iL=2,By=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,nL=1,sL=2,D8e=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function q8e(r){let e=p6(r);try{return C8e.decode(eL.decode("z"+e)),!0}catch(t){return!1}}function M8e(r){try{return eL.isEncoded(r)}catch(e){return!1}}function Ny(r){try{return new O8e(r),!0}catch(e){return!1}}function oL(r){if(!r)return!1;if(tL.isMultiaddr(r))return!0;try{return new tL(r),!0}catch(e){return!1}}function L8e(r){return oL(r)&&P8e.P2P.matches(r)}function Dy(r,e,t=rL,i=iL){let n=p6(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipfs")return!1;let o=s[i];return o&&e===By&&(o=o.toLowerCase()),Ny(o)}function o2(r,e,t=rL,i=iL){let n=p6(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipns")return!1;let o=s[i];if(o&&e===By){if(o=o.toLowerCase(),Ny(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new B8e(`http://${o}`);return D8e.test(a)}catch(a){return!1}}return!0}function aL(r){return typeof r=="string"}function p6(r){return r instanceof Uint8Array?N8e(r,"base58btc"):aL(r)?r:!1}var y6=r=>Dy(r,By,sL,nL),g6=r=>o2(r,By,sL,nL),cL=r=>y6(r)||g6(r),uL=r=>Dy(r,d6)||y6(r),fL=r=>o2(r,d6)||g6(r),lL=r=>uL(r)||fL(r)||cL(r),hL=r=>Dy(r,Ed)||o2(r,Ed);Z9.exports={multihash:q8e,multiaddr:oL,peerMultiaddr:L8e,cid:Ny,base32cid:r=>M8e(r)==="base32"&&Ny(r),ipfsSubdomain:y6,ipnsSubdomain:g6,subdomain:cL,subdomainGatewayPattern:By,ipfsUrl:uL,ipnsUrl:fL,url:lL,pathGatewayPattern:d6,ipfsPath:r=>Dy(r,Ed),ipnsPath:r=>o2(r,Ed),path:hL,pathPattern:Ed,urlOrPath:r=>lL(r)||hL(r),cidPath:r=>aL(r)&&!Ny(r)&&Dy(`/ipfs/${r}`,Ed)}});var dL=p((f1t,a2)=>{l();(function(){"use strict";var r="input is invalid type",e="finalize already called",t=typeof window=="object",i=t?window:{};i.JS_SHA3_NO_WINDOW&&(t=!1);var n=!t&&typeof self=="object",s=!i.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;s?i=globalThis:n&&(i=self);var o=!i.JS_SHA3_NO_COMMON_JS&&typeof a2=="object"&&a2.exports,a=typeof define=="function"&&define.amd,c=!i.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",u="0123456789abcdef".split(""),f=[31,7936,2031616,520093696],h=[4,1024,262144,67108864],d=[1,256,65536,16777216],y=[6,1536,393216,100663296],g=[0,8,16,24],m=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],x=[224,256,384,512],_=[128,256],P=["hex","buffer","arrayBuffer","array","digest"],q={"128":168,"256":136};(i.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(A){return Object.prototype.toString.call(A)==="[object Array]"}),c&&(i.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(A){return typeof A=="object"&&A.buffer&&A.buffer.constructor===ArrayBuffer});for(var X=function(A,ie,ae){return function(E){return new J(A,ie,A).update(E)[ae]()}},W=function(A,ie,ae){return function(E,I){return new J(A,ie,I).update(E)[ae]()}},z=function(A,ie,ae){return function(E,I,j,H){return B["cshake"+A].update(E,I,j,H)[ae]()}},Z=function(A,ie,ae){return function(E,I,j,H){return B["kmac"+A].update(E,I,j,H)[ae]()}},ee=function(A,ie,ae,E){for(var I=0;I<P.length;++I){var j=P[I];A[j]=ie(ae,E,j)}return A},re=function(A,ie){var ae=X(A,ie,"hex");return ae.create=function(){return new J(A,ie,A)},ae.update=function(E){return ae.create().update(E)},ee(ae,X,A,ie)},L=function(A,ie){var ae=W(A,ie,"hex");return ae.create=function(E){return new J(A,ie,E)},ae.update=function(E,I){return ae.create(I).update(E)},ee(ae,W,A,ie)},b=function(A,ie){var ae=q[A],E=z(A,ie,"hex");return E.create=function(I,j,H){return!j&&!H?B["shake"+A].create(I):new J(A,ie,I).bytepad([j,H],ae)},E.update=function(I,j,H,T){return E.create(j,H,T).update(I)},ee(E,z,A,ie)},w=function(A,ie){var ae=q[A],E=Z(A,ie,"hex");return E.create=function(I,j,H){return new ue(A,ie,j).bytepad(["KMAC",H],ae).bytepad([I],ae)},E.update=function(I,j,H,T){return E.create(I,H,T).update(j)},ee(E,Z,A,ie)},R=[{name:"keccak",padding:d,bits:x,createMethod:re},{name:"sha3",padding:y,bits:x,createMethod:re},{name:"shake",padding:f,bits:_,createMethod:L},{name:"cshake",padding:h,bits:_,createMethod:b},{name:"kmac",padding:h,bits:_,createMethod:w}],B={},U=[],Q=0;Q<R.length;++Q)for(var G=R[Q],M=G.bits,v=0;v<M.length;++v){var V=G.name+"_"+M[v];if(U.push(V),B[V]=G.createMethod(M[v],G.padding),G.name!=="sha3"){var de=G.name+M[v];U.push(de),B[de]=B[V]}}function J(A,ie,ae){this.blocks=[],this.s=[],this.padding=ie,this.outputBits=ae,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(A<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=ae>>5,this.extraBytes=(ae&31)>>3;for(var E=0;E<50;++E)this.s[E]=0}J.prototype.update=function(A){if(this.finalized)throw new Error(e);var ie,ae=typeof A;if(ae!=="string"){if(ae==="object"){if(A===null)throw new Error(r);if(c&&A.constructor===ArrayBuffer)A=new Uint8Array(A);else if(!Array.isArray(A)&&(!c||!ArrayBuffer.isView(A)))throw new Error(r)}else throw new Error(r);ie=!0}for(var E=this.blocks,I=this.byteCount,j=A.length,H=this.blockCount,T=0,K=this.s,F,N;T<j;){if(this.reset)for(this.reset=!1,E[0]=this.block,F=1;F<H+1;++F)E[F]=0;if(ie)for(F=this.start;T<j&&F<I;++T)E[F>>2]|=A[T]<<g[F++&3];else for(F=this.start;T<j&&F<I;++T)N=A.charCodeAt(T),N<128?E[F>>2]|=N<<g[F++&3]:N<2048?(E[F>>2]|=(192|N>>6)<<g[F++&3],E[F>>2]|=(128|N&63)<<g[F++&3]):N<55296||N>=57344?(E[F>>2]|=(224|N>>12)<<g[F++&3],E[F>>2]|=(128|N>>6&63)<<g[F++&3],E[F>>2]|=(128|N&63)<<g[F++&3]):(N=65536+((N&1023)<<10|A.charCodeAt(++T)&1023),E[F>>2]|=(240|N>>18)<<g[F++&3],E[F>>2]|=(128|N>>12&63)<<g[F++&3],E[F>>2]|=(128|N>>6&63)<<g[F++&3],E[F>>2]|=(128|N&63)<<g[F++&3]);if(this.lastByteIndex=F,F>=I){for(this.start=F-I,this.block=E[H],F=0;F<H;++F)K[F]^=E[F];S(K),this.reset=!0}else this.start=F}return this},J.prototype.encode=function(A,ie){var ae=A&255,E=1,I=[ae];for(A=A>>8,ae=A&255;ae>0;)I.unshift(ae),A=A>>8,ae=A&255,++E;return ie?I.push(E):I.unshift(E),this.update(I),I.length},J.prototype.encodeString=function(A){var ie,ae=typeof A;if(ae!=="string"){if(ae==="object"){if(A===null)throw new Error(r);if(c&&A.constructor===ArrayBuffer)A=new Uint8Array(A);else if(!Array.isArray(A)&&(!c||!ArrayBuffer.isView(A)))throw new Error(r)}else throw new Error(r);ie=!0}var E=0,I=A.length;if(ie)E=I;else for(var j=0;j<A.length;++j){var H=A.charCodeAt(j);H<128?E+=1:H<2048?E+=2:H<55296||H>=57344?E+=3:(H=65536+((H&1023)<<10|A.charCodeAt(++j)&1023),E+=4)}return E+=this.encode(E*8),this.update(A),E},J.prototype.bytepad=function(A,ie){for(var ae=this.encode(ie),E=0;E<A.length;++E)ae+=this.encodeString(A[E]);var I=ie-ae%ie,j=[];return j.length=I,this.update(j),this},J.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var A=this.blocks,ie=this.lastByteIndex,ae=this.blockCount,E=this.s;if(A[ie>>2]|=this.padding[ie&3],this.lastByteIndex===this.byteCount)for(A[0]=A[ae],ie=1;ie<ae+1;++ie)A[ie]=0;for(A[ae-1]|=2147483648,ie=0;ie<ae;++ie)E[ie]^=A[ie];S(E)}},J.prototype.toString=J.prototype.hex=function(){this.finalize();for(var A=this.blockCount,ie=this.s,ae=this.outputBlocks,E=this.extraBytes,I=0,j=0,H="",T;j<ae;){for(I=0;I<A&&j<ae;++I,++j)T=ie[I],H+=u[T>>4&15]+u[T&15]+u[T>>12&15]+u[T>>8&15]+u[T>>20&15]+u[T>>16&15]+u[T>>28&15]+u[T>>24&15];j%A==0&&(S(ie),I=0)}return E&&(T=ie[I],H+=u[T>>4&15]+u[T&15],E>1&&(H+=u[T>>12&15]+u[T>>8&15]),E>2&&(H+=u[T>>20&15]+u[T>>16&15])),H},J.prototype.arrayBuffer=function(){this.finalize();var A=this.blockCount,ie=this.s,ae=this.outputBlocks,E=this.extraBytes,I=0,j=0,H=this.outputBits>>3,T;E?T=new ArrayBuffer(ae+1<<2):T=new ArrayBuffer(H);for(var K=new Uint32Array(T);j<ae;){for(I=0;I<A&&j<ae;++I,++j)K[j]=ie[I];j%A==0&&S(ie)}return E&&(K[I]=ie[I],T=T.slice(0,H)),T},J.prototype.buffer=J.prototype.arrayBuffer,J.prototype.digest=J.prototype.array=function(){this.finalize();for(var A=this.blockCount,ie=this.s,ae=this.outputBlocks,E=this.extraBytes,I=0,j=0,H=[],T,K;j<ae;){for(I=0;I<A&&j<ae;++I,++j)T=j<<2,K=ie[I],H[T]=K&255,H[T+1]=K>>8&255,H[T+2]=K>>16&255,H[T+3]=K>>24&255;j%A==0&&S(ie)}return E&&(T=j<<2,K=ie[I],H[T]=K&255,E>1&&(H[T+1]=K>>8&255),E>2&&(H[T+2]=K>>16&255)),H};function ue(A,ie,ae){J.call(this,A,ie,ae)}ue.prototype=new J,ue.prototype.finalize=function(){return this.encode(this.outputBits,!0),J.prototype.finalize.call(this)};var S=function(A){var ie,ae,E,I,j,H,T,K,F,N,Y,ne,te,he,me,fe,je,Ae,Ve,Xe,Ge,ve,at,St,kt,Fr,mt,Ie,tr,Ze,Kt,cs,Gt,De,us,$t,Wt,fs,Yt,yt,So,ar,cr,xo,Ye,ur,Ao,fr,Xt,ls,Jt,Qt,rt,Zt,Ct,xn,Fn,Un,Kn,jn,Vn,ze,zn;for(E=0;E<48;E+=2)I=A[0]^A[10]^A[20]^A[30]^A[40],j=A[1]^A[11]^A[21]^A[31]^A[41],H=A[2]^A[12]^A[22]^A[32]^A[42],T=A[3]^A[13]^A[23]^A[33]^A[43],K=A[4]^A[14]^A[24]^A[34]^A[44],F=A[5]^A[15]^A[25]^A[35]^A[45],N=A[6]^A[16]^A[26]^A[36]^A[46],Y=A[7]^A[17]^A[27]^A[37]^A[47],ne=A[8]^A[18]^A[28]^A[38]^A[48],te=A[9]^A[19]^A[29]^A[39]^A[49],ie=ne^(H<<1|T>>>31),ae=te^(T<<1|H>>>31),A[0]^=ie,A[1]^=ae,A[10]^=ie,A[11]^=ae,A[20]^=ie,A[21]^=ae,A[30]^=ie,A[31]^=ae,A[40]^=ie,A[41]^=ae,ie=I^(K<<1|F>>>31),ae=j^(F<<1|K>>>31),A[2]^=ie,A[3]^=ae,A[12]^=ie,A[13]^=ae,A[22]^=ie,A[23]^=ae,A[32]^=ie,A[33]^=ae,A[42]^=ie,A[43]^=ae,ie=H^(N<<1|Y>>>31),ae=T^(Y<<1|N>>>31),A[4]^=ie,A[5]^=ae,A[14]^=ie,A[15]^=ae,A[24]^=ie,A[25]^=ae,A[34]^=ie,A[35]^=ae,A[44]^=ie,A[45]^=ae,ie=K^(ne<<1|te>>>31),ae=F^(te<<1|ne>>>31),A[6]^=ie,A[7]^=ae,A[16]^=ie,A[17]^=ae,A[26]^=ie,A[27]^=ae,A[36]^=ie,A[37]^=ae,A[46]^=ie,A[47]^=ae,ie=N^(I<<1|j>>>31),ae=Y^(j<<1|I>>>31),A[8]^=ie,A[9]^=ae,A[18]^=ie,A[19]^=ae,A[28]^=ie,A[29]^=ae,A[38]^=ie,A[39]^=ae,A[48]^=ie,A[49]^=ae,he=A[0],me=A[1],ur=A[11]<<4|A[10]>>>28,Ao=A[10]<<4|A[11]>>>28,Ie=A[20]<<3|A[21]>>>29,tr=A[21]<<3|A[20]>>>29,jn=A[31]<<9|A[30]>>>23,Vn=A[30]<<9|A[31]>>>23,ar=A[40]<<18|A[41]>>>14,cr=A[41]<<18|A[40]>>>14,De=A[2]<<1|A[3]>>>31,us=A[3]<<1|A[2]>>>31,fe=A[13]<<12|A[12]>>>20,je=A[12]<<12|A[13]>>>20,fr=A[22]<<10|A[23]>>>22,Xt=A[23]<<10|A[22]>>>22,Ze=A[33]<<13|A[32]>>>19,Kt=A[32]<<13|A[33]>>>19,ze=A[42]<<2|A[43]>>>30,zn=A[43]<<2|A[42]>>>30,Zt=A[5]<<30|A[4]>>>2,Ct=A[4]<<30|A[5]>>>2,$t=A[14]<<6|A[15]>>>26,Wt=A[15]<<6|A[14]>>>26,Ae=A[25]<<11|A[24]>>>21,Ve=A[24]<<11|A[25]>>>21,ls=A[34]<<15|A[35]>>>17,Jt=A[35]<<15|A[34]>>>17,cs=A[45]<<29|A[44]>>>3,Gt=A[44]<<29|A[45]>>>3,St=A[6]<<28|A[7]>>>4,kt=A[7]<<28|A[6]>>>4,xn=A[17]<<23|A[16]>>>9,Fn=A[16]<<23|A[17]>>>9,fs=A[26]<<25|A[27]>>>7,Yt=A[27]<<25|A[26]>>>7,Xe=A[36]<<21|A[37]>>>11,Ge=A[37]<<21|A[36]>>>11,Qt=A[47]<<24|A[46]>>>8,rt=A[46]<<24|A[47]>>>8,xo=A[8]<<27|A[9]>>>5,Ye=A[9]<<27|A[8]>>>5,Fr=A[18]<<20|A[19]>>>12,mt=A[19]<<20|A[18]>>>12,Un=A[29]<<7|A[28]>>>25,Kn=A[28]<<7|A[29]>>>25,yt=A[38]<<8|A[39]>>>24,So=A[39]<<8|A[38]>>>24,ve=A[48]<<14|A[49]>>>18,at=A[49]<<14|A[48]>>>18,A[0]=he^~fe&Ae,A[1]=me^~je&Ve,A[10]=St^~Fr&Ie,A[11]=kt^~mt&tr,A[20]=De^~$t&fs,A[21]=us^~Wt&Yt,A[30]=xo^~ur&fr,A[31]=Ye^~Ao&Xt,A[40]=Zt^~xn&Un,A[41]=Ct^~Fn&Kn,A[2]=fe^~Ae&Xe,A[3]=je^~Ve&Ge,A[12]=Fr^~Ie&Ze,A[13]=mt^~tr&Kt,A[22]=$t^~fs&yt,A[23]=Wt^~Yt&So,A[32]=ur^~fr&ls,A[33]=Ao^~Xt&Jt,A[42]=xn^~Un&jn,A[43]=Fn^~Kn&Vn,A[4]=Ae^~Xe&ve,A[5]=Ve^~Ge&at,A[14]=Ie^~Ze&cs,A[15]=tr^~Kt&Gt,A[24]=fs^~yt&ar,A[25]=Yt^~So&cr,A[34]=fr^~ls&Qt,A[35]=Xt^~Jt&rt,A[44]=Un^~jn&ze,A[45]=Kn^~Vn&zn,A[6]=Xe^~ve&he,A[7]=Ge^~at&me,A[16]=Ze^~cs&St,A[17]=Kt^~Gt&kt,A[26]=yt^~ar&De,A[27]=So^~cr&us,A[36]=ls^~Qt&xo,A[37]=Jt^~rt&Ye,A[46]=jn^~ze&Zt,A[47]=Vn^~zn&Ct,A[8]=ve^~he&fe,A[9]=at^~me&je,A[18]=cs^~St&Fr,A[19]=Gt^~kt&mt,A[28]=ar^~De&$t,A[29]=cr^~us&Wt,A[38]=Qt^~xo&ur,A[39]=rt^~Ye&Ao,A[48]=ze^~Zt&xn,A[49]=zn^~Ct&Fn,A[0]^=m[E],A[1]^=m[E+1]};if(o)a2.exports=B;else{for(Q=0;Q<U.length;++Q)i[U[Q]]=B[U[Q]];a&&define(function(){return B})}})()});var pL=p((qy,c2)=>{l();(function(r,e){"use strict";var t={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(y){if(!Array.isArray(y)&&!ArrayBuffer.isView(y))return!1;for(var g=0;g<y.length;g++)if(!Number.isInteger(y[g])||y[g]<0||y[g]>255)return!1;return!0}function n(y,g){return(y&65535)*g+(((y>>>16)*g&65535)<<16)}function s(y,g){return y<<g|y>>>32-g}function o(y){return y^=y>>>16,y=n(y,2246822507),y^=y>>>13,y=n(y,3266489909),y^=y>>>16,y}function a(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=y[3]+g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=y[2]+g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=y[1]+g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=y[0]+g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function c(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=y[3]*g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=y[2]*g[3],m[1]+=m[2]>>>16,m[2]&=65535,m[2]+=y[3]*g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=y[1]*g[3],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=y[2]*g[2],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=y[3]*g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=y[0]*g[3]+y[1]*g[2]+y[2]*g[1]+y[3]*g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function u(y,g){return g%=64,g===32?[y[1],y[0]]:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g|y[0]>>>32-g]:(g-=32,[y[1]<<g|y[0]>>>32-g,y[0]<<g|y[1]>>>32-g])}function f(y,g){return g%=64,g===0?y:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g]:[y[1]<<g-32,0]}function h(y,g){return[y[0]^g[0],y[1]^g[1]]}function d(y){return y=h(y,[0,y[0]>>>1]),y=c(y,[4283543511,3981806797]),y=h(y,[0,y[0]>>>1]),y=c(y,[3301882366,444984403]),y=h(y,[0,y[0]>>>1]),y}t.x86.hash32=function(y,g){if(t.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%4,x=y.length-m,_=g,P=0,q=3432918353,X=461845907,W=0;W<x;W=W+4)P=y[W]|y[W+1]<<8|y[W+2]<<16|y[W+3]<<24,P=n(P,q),P=s(P,15),P=n(P,X),_^=P,_=s(_,13),_=n(_,5)+3864292196;switch(P=0,m){case 3:P^=y[W+2]<<16;case 2:P^=y[W+1]<<8;case 1:P^=y[W],P=n(P,q),P=s(P,15),P=n(P,X),_^=P}return _^=y.length,_=o(_),_>>>0},t.x86.hash128=function(y,g){if(t.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%16,x=y.length-m,_=g,P=g,q=g,X=g,W=0,z=0,Z=0,ee=0,re=597399067,L=2869860233,b=951274213,w=2716044179,R=0;R<x;R=R+16)W=y[R]|y[R+1]<<8|y[R+2]<<16|y[R+3]<<24,z=y[R+4]|y[R+5]<<8|y[R+6]<<16|y[R+7]<<24,Z=y[R+8]|y[R+9]<<8|y[R+10]<<16|y[R+11]<<24,ee=y[R+12]|y[R+13]<<8|y[R+14]<<16|y[R+15]<<24,W=n(W,re),W=s(W,15),W=n(W,L),_^=W,_=s(_,19),_+=P,_=n(_,5)+1444728091,z=n(z,L),z=s(z,16),z=n(z,b),P^=z,P=s(P,17),P+=q,P=n(P,5)+197830471,Z=n(Z,b),Z=s(Z,17),Z=n(Z,w),q^=Z,q=s(q,15),q+=X,q=n(q,5)+2530024501,ee=n(ee,w),ee=s(ee,18),ee=n(ee,re),X^=ee,X=s(X,13),X+=_,X=n(X,5)+850148119;switch(W=0,z=0,Z=0,ee=0,m){case 15:ee^=y[R+14]<<16;case 14:ee^=y[R+13]<<8;case 13:ee^=y[R+12],ee=n(ee,w),ee=s(ee,18),ee=n(ee,re),X^=ee;case 12:Z^=y[R+11]<<24;case 11:Z^=y[R+10]<<16;case 10:Z^=y[R+9]<<8;case 9:Z^=y[R+8],Z=n(Z,b),Z=s(Z,17),Z=n(Z,w),q^=Z;case 8:z^=y[R+7]<<24;case 7:z^=y[R+6]<<16;case 6:z^=y[R+5]<<8;case 5:z^=y[R+4],z=n(z,L),z=s(z,16),z=n(z,b),P^=z;case 4:W^=y[R+3]<<24;case 3:W^=y[R+2]<<16;case 2:W^=y[R+1]<<8;case 1:W^=y[R],W=n(W,re),W=s(W,15),W=n(W,L),_^=W}return _^=y.length,P^=y.length,q^=y.length,X^=y.length,_+=P,_+=q,_+=X,P+=_,q+=_,X+=_,_=o(_),P=o(P),q=o(q),X=o(X),_+=P,_+=q,_+=X,P+=_,q+=_,X+=_,("00000000"+(_>>>0).toString(16)).slice(-8)+("00000000"+(P>>>0).toString(16)).slice(-8)+("00000000"+(q>>>0).toString(16)).slice(-8)+("00000000"+(X>>>0).toString(16)).slice(-8)},t.x64.hash128=function(y,g){if(t.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%16,x=y.length-m,_=[0,g],P=[0,g],q=[0,0],X=[0,0],W=[2277735313,289559509],z=[1291169091,658871167],Z=0;Z<x;Z=Z+16)q=[y[Z+4]|y[Z+5]<<8|y[Z+6]<<16|y[Z+7]<<24,y[Z]|y[Z+1]<<8|y[Z+2]<<16|y[Z+3]<<24],X=[y[Z+12]|y[Z+13]<<8|y[Z+14]<<16|y[Z+15]<<24,y[Z+8]|y[Z+9]<<8|y[Z+10]<<16|y[Z+11]<<24],q=c(q,W),q=u(q,31),q=c(q,z),_=h(_,q),_=u(_,27),_=a(_,P),_=a(c(_,[0,5]),[0,1390208809]),X=c(X,z),X=u(X,33),X=c(X,W),P=h(P,X),P=u(P,31),P=a(P,_),P=a(c(P,[0,5]),[0,944331445]);switch(q=[0,0],X=[0,0],m){case 15:X=h(X,f([0,y[Z+14]],48));case 14:X=h(X,f([0,y[Z+13]],40));case 13:X=h(X,f([0,y[Z+12]],32));case 12:X=h(X,f([0,y[Z+11]],24));case 11:X=h(X,f([0,y[Z+10]],16));case 10:X=h(X,f([0,y[Z+9]],8));case 9:X=h(X,[0,y[Z+8]]),X=c(X,z),X=u(X,33),X=c(X,W),P=h(P,X);case 8:q=h(q,f([0,y[Z+7]],56));case 7:q=h(q,f([0,y[Z+6]],48));case 6:q=h(q,f([0,y[Z+5]],40));case 5:q=h(q,f([0,y[Z+4]],32));case 4:q=h(q,f([0,y[Z+3]],24));case 3:q=h(q,f([0,y[Z+2]],16));case 2:q=h(q,f([0,y[Z+1]],8));case 1:q=h(q,[0,y[Z]]),q=c(q,W),q=u(q,31),q=c(q,z),_=h(_,q)}return _=h(_,[0,y.length]),P=h(P,[0,y.length]),_=a(_,P),P=a(P,_),_=d(_),P=d(P),_=a(_,P),P=a(P,_),("00000000"+(_[0]>>>0).toString(16)).slice(-8)+("00000000"+(_[1]>>>0).toString(16)).slice(-8)+("00000000"+(P[0]>>>0).toString(16)).slice(-8)+("00000000"+(P[1]>>>0).toString(16)).slice(-8)},typeof qy!="undefined"?(typeof c2!="undefined"&&c2.exports&&(qy=c2.exports=t),qy.murmurHash3=t):typeof define=="function"&&define.amd?define([],function(){return t}):(t._murmurHash3=r.murmurHash3,t.noConflict=function(){return r.murmurHash3=t._murmurHash3,t._murmurHash3=e,t.noConflict=e,t},r.murmurHash3=t)})(qy)});var gL=p((l1t,yL)=>{l();yL.exports=pL()});var mL=p((h1t,bL)=>{l();"use strict";var F8e=r=>{let e=new Uint8Array(4);for(let t=0;t<4;t++)e[t]=r&255,r=r>>8;return e};bL.exports={fromNumberTo32BitBuf:F8e}});var b6=p((d1t,vL)=>{l();var U8e="Input must be an string, Buffer or Uint8Array";function K8e(r){var e;if(r instanceof Uint8Array)e=r;else if(r instanceof Buffer)e=new Uint8Array(r);else if(typeof r=="string")e=new Uint8Array(Buffer.from(r,"utf8"));else throw new Error(U8e);return e}function j8e(r){return Array.prototype.map.call(r,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function u2(r){return(4294967296+r).toString(16).substring(1)}function V8e(r,e,t){for(var i=`
`+r+" = ",n=0;n<e.length;n+=2){if(t===32)i+=u2(e[n]).toUpperCase(),i+=" ",i+=u2(e[n+1]).toUpperCase();else if(t===64)i+=u2(e[n+1]).toUpperCase(),i+=u2(e[n]).toUpperCase();else throw new Error("Invalid size "+t);n%6==4?i+=`
`+new Array(r.length+4).join(" "):n<e.length-2&&(i+=" ")}console.log(i)}function z8e(r,e,t){for(var i=new Date().getTime(),n=new Uint8Array(e),s=0;s<e;s++)n[s]=s%256;var o=new Date().getTime();for(console.log("Generated random input in "+(o-i)+"ms"),i=o,s=0;s<t;s++){var a=r(n),c=new Date().getTime(),u=c-i;i=c,console.log("Hashed in "+u+"ms: "+a.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(u/1e3)*100)/100+" MB PER SECOND")}}vL.exports={normalizeInput:K8e,toHex:j8e,debugPrint:V8e,testSpeed:z8e}});var RL=p((p1t,wL)=>{l();var _L=b6();function f2(r,e,t){var i=r[e]+r[t],n=r[e+1]+r[t+1];i>=4294967296&&n++,r[e]=i,r[e+1]=n}function EL(r,e,t,i){var n=r[e]+t;t<0&&(n+=4294967296);var s=r[e+1]+i;n>=4294967296&&s++,r[e]=n,r[e+1]=s}function H8e(r,e){return r[e]^r[e+1]<<8^r[e+2]<<16^r[e+3]<<24}function Hu(r,e,t,i,n,s){var o=My[n],a=My[n+1],c=My[s],u=My[s+1];f2(pt,r,e),EL(pt,r,o,a);var f=pt[i]^pt[r],h=pt[i+1]^pt[r+1];pt[i]=h,pt[i+1]=f,f2(pt,t,i),f=pt[e]^pt[t],h=pt[e+1]^pt[t+1],pt[e]=f>>>24^h<<8,pt[e+1]=h>>>24^f<<8,f2(pt,r,e),EL(pt,r,c,u),f=pt[i]^pt[r],h=pt[i+1]^pt[r+1],pt[i]=f>>>16^h<<16,pt[i+1]=h>>>16^f<<16,f2(pt,t,i),f=pt[e]^pt[t],h=pt[e+1]^pt[t+1],pt[e]=h>>>31^f<<1,pt[e+1]=f>>>31^h<<1}var SL=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),G8e=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],yn=new Uint8Array(G8e.map(function(r){return r*2})),pt=new Uint32Array(32),My=new Uint32Array(32);function xL(r,e){var t=0;for(t=0;t<16;t++)pt[t]=r.h[t],pt[t+16]=SL[t];for(pt[24]=pt[24]^r.t,pt[25]=pt[25]^r.t/4294967296,e&&(pt[28]=~pt[28],pt[29]=~pt[29]),t=0;t<32;t++)My[t]=H8e(r.b,4*t);for(t=0;t<12;t++)Hu(0,8,16,24,yn[t*16+0],yn[t*16+1]),Hu(2,10,18,26,yn[t*16+2],yn[t*16+3]),Hu(4,12,20,28,yn[t*16+4],yn[t*16+5]),Hu(6,14,22,30,yn[t*16+6],yn[t*16+7]),Hu(0,10,20,30,yn[t*16+8],yn[t*16+9]),Hu(2,12,22,24,yn[t*16+10],yn[t*16+11]),Hu(4,14,16,26,yn[t*16+12],yn[t*16+13]),Hu(6,8,18,28,yn[t*16+14],yn[t*16+15]);for(t=0;t<16;t++)r.h[t]=r.h[t]^pt[t]^pt[t+16]}function AL(r,e){if(r===0||r>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");for(var t={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:r},i=0;i<16;i++)t.h[i]=SL[i];var n=e?e.length:0;return t.h[0]^=16842752^n<<8^r,e&&(m6(t,e),t.c=128),t}function m6(r,e){for(var t=0;t<e.length;t++)r.c===128&&(r.t+=r.c,xL(r,!1),r.c=0),r.b[r.c++]=e[t]}function IL(r){for(r.t+=r.c;r.c<128;)r.b[r.c++]=0;xL(r,!0);for(var e=new Uint8Array(r.outlen),t=0;t<r.outlen;t++)e[t]=r.h[t>>2]>>8*(t&3);return e}function TL(r,e,t){t=t||64,r=_L.normalizeInput(r);var i=AL(t,e);return m6(i,r),IL(i)}function $8e(r,e,t){var i=TL(r,e,t);return _L.toHex(i)}wL.exports={blake2b:TL,blake2bHex:$8e,blake2bInit:AL,blake2bUpdate:m6,blake2bFinal:IL}});var qL=p((y1t,kL)=>{l();var CL=b6();function W8e(r,e){return r[e]^r[e+1]<<8^r[e+2]<<16^r[e+3]<<24}function Gu(r,e,t,i,n,s){Vt[r]=Vt[r]+Vt[e]+n,Vt[i]=l2(Vt[i]^Vt[r],16),Vt[t]=Vt[t]+Vt[i],Vt[e]=l2(Vt[e]^Vt[t],12),Vt[r]=Vt[r]+Vt[e]+s,Vt[i]=l2(Vt[i]^Vt[r],8),Vt[t]=Vt[t]+Vt[i],Vt[e]=l2(Vt[e]^Vt[t],7)}function l2(r,e){return r>>>e^r<<32-e}var PL=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),gn=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),Vt=new Uint32Array(16),on=new Uint32Array(16);function OL(r,e){var t=0;for(t=0;t<8;t++)Vt[t]=r.h[t],Vt[t+8]=PL[t];for(Vt[12]^=r.t,Vt[13]^=r.t/4294967296,e&&(Vt[14]=~Vt[14]),t=0;t<16;t++)on[t]=W8e(r.b,4*t);for(t=0;t<10;t++)Gu(0,4,8,12,on[gn[t*16+0]],on[gn[t*16+1]]),Gu(1,5,9,13,on[gn[t*16+2]],on[gn[t*16+3]]),Gu(2,6,10,14,on[gn[t*16+4]],on[gn[t*16+5]]),Gu(3,7,11,15,on[gn[t*16+6]],on[gn[t*16+7]]),Gu(0,5,10,15,on[gn[t*16+8]],on[gn[t*16+9]]),Gu(1,6,11,12,on[gn[t*16+10]],on[gn[t*16+11]]),Gu(2,7,8,13,on[gn[t*16+12]],on[gn[t*16+13]]),Gu(3,4,9,14,on[gn[t*16+14]],on[gn[t*16+15]]);for(t=0;t<8;t++)r.h[t]^=Vt[t]^Vt[t+8]}function BL(r,e){if(!(r>0&&r<=32))throw new Error("Incorrect output length, should be in [1, 32]");var t=e?e.length:0;if(e&&!(t>0&&t<=32))throw new Error("Incorrect key length, should be in [1, 32]");var i={h:new Uint32Array(PL),b:new Uint32Array(64),c:0,t:0,outlen:r};return i.h[0]^=16842752^t<<8^r,t>0&&(v6(i,e),i.c=64),i}function v6(r,e){for(var t=0;t<e.length;t++)r.c===64&&(r.t+=r.c,OL(r,!1),r.c=0),r.b[r.c++]=e[t]}function NL(r){for(r.t+=r.c;r.c<64;)r.b[r.c++]=0;OL(r,!0);for(var e=new Uint8Array(r.outlen),t=0;t<r.outlen;t++)e[t]=r.h[t>>2]>>8*(t&3)&255;return e}function DL(r,e,t){t=t||32,r=CL.normalizeInput(r);var i=BL(t,e);return v6(i,r),NL(i)}function Y8e(r,e,t){var i=DL(r,e,t);return CL.toHex(i)}kL.exports={blake2s:DL,blake2sHex:Y8e,blake2sInit:BL,blake2sUpdate:v6,blake2sFinal:NL}});var LL=p((g1t,ML)=>{l();var Ly=RL(),Fy=qL();ML.exports={blake2b:Ly.blake2b,blake2bHex:Ly.blake2bHex,blake2bInit:Ly.blake2bInit,blake2bUpdate:Ly.blake2bUpdate,blake2bFinal:Ly.blake2bFinal,blake2s:Fy.blake2s,blake2sHex:Fy.blake2sHex,blake2sInit:Fy.blake2sInit,blake2sUpdate:Fy.blake2sUpdate,blake2sFinal:Fy.blake2sFinal}});var KL=p((b1t,FL)=>{l();"use strict";var Sd=LL(),X8e=45569,J8e=45633,Q8e={init:Sd.blake2bInit,update:Sd.blake2bUpdate,digest:Sd.blake2bFinal},Z8e={init:Sd.blake2sInit,update:Sd.blake2sUpdate,digest:Sd.blake2sFinal},UL=(r,e)=>async t=>{let i=e.init(r,null);return e.update(i,t),e.digest(i)};FL.exports=r=>{for(let e=0;e<64;e++)r[X8e+e]=UL(e+1,Q8e);for(let e=0;e<32;e++)r[J8e+e]=UL(e+1,Z8e)}});var zL=p((m1t,jL)=>{l();"use strict";var Ha=dL(),VL=gL(),{factory:h2}=Gh(),{fromNumberTo32BitBuf:eTe}=mL(),tTe=ct(),Ws=r=>async e=>{switch(r){case"sha3-224":return new Uint8Array(Ha.sha3_224.arrayBuffer(e));case"sha3-256":return new Uint8Array(Ha.sha3_256.arrayBuffer(e));case"sha3-384":return new Uint8Array(Ha.sha3_384.arrayBuffer(e));case"sha3-512":return new Uint8Array(Ha.sha3_512.arrayBuffer(e));case"shake-128":return new Uint8Array(Ha.shake128.create(128).update(e).arrayBuffer());case"shake-256":return new Uint8Array(Ha.shake256.create(256).update(e).arrayBuffer());case"keccak-224":return new Uint8Array(Ha.keccak224.arrayBuffer(e));case"keccak-256":return new Uint8Array(Ha.keccak256.arrayBuffer(e));case"keccak-384":return new Uint8Array(Ha.keccak384.arrayBuffer(e));case"keccak-512":return new Uint8Array(Ha.keccak512.arrayBuffer(e));case"murmur3-128":return tTe(VL.x64.hash128(e),"base16");case"murmur3-32":return eTe(VL.x86.hash32(e));default:throw new TypeError(`${r} is not a supported algorithm`)}},rTe=r=>r;jL.exports={identity:rTe,sha1:h2("sha1"),sha2256:h2("sha2-256"),sha2512:h2("sha2-512"),dblSha2256:h2("dbl-sha2-256"),sha3224:Ws("sha3-224"),sha3256:Ws("sha3-256"),sha3384:Ws("sha3-384"),sha3512:Ws("sha3-512"),shake128:Ws("shake-128"),shake256:Ws("shake-256"),keccak224:Ws("keccak-224"),keccak256:Ws("keccak-256"),keccak384:Ws("keccak-384"),keccak512:Ws("keccak-512"),murmur3128:Ws("murmur3-128"),murmur332:Ws("murmur3-32"),addBlake:KL()}});var er=p((v1t,HL)=>{l();"use strict";var GL=ge(),d2=ko(),Vi=zL(),iTe=Dr();async function Ys(r,e,t){let i=await Ys.digest(r,e,t);return d2.encode(i,e,t)}Ys.multihash=d2;Ys.digest=async(r,e,t)=>{let n=await Ys.createHash(e)(r);return t?n.slice(0,t):n};Ys.createHash=function(r){if(!r)throw GL(new Error("hash algorithm must be specified"),"ERR_HASH_ALGORITHM_NOT_SPECIFIED");let e=d2.coerceCode(r);if(!Ys.functions[e])throw GL(new Error(`multihash function '${r}' not yet supported`),"ERR_HASH_ALGORITHM_NOT_SUPPORTED");return Ys.functions[e]};Ys.functions={0:Vi.identity,17:Vi.sha1,18:Vi.sha2256,19:Vi.sha2512,20:Vi.sha3512,21:Vi.sha3384,22:Vi.sha3256,23:Vi.sha3224,24:Vi.shake128,25:Vi.shake256,26:Vi.keccak224,27:Vi.keccak256,28:Vi.keccak384,29:Vi.keccak512,34:Vi.murmur3128,35:Vi.murmur332,86:Vi.dblSha2256};Vi.addBlake(Ys.functions);Ys.validate=async(r,e)=>{let t=await Ys(r,d2.decode(e).name);return iTe(e,t)};HL.exports=Ys});var $L,WL=li(()=>{l();$L="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"});var Uy={};oP(Uy,{customAlphabet:()=>nTe,customRandom:()=>XL,nanoid:()=>sTe,random:()=>YL,urlAlphabet:()=>$L});var YL,XL,nTe,sTe,Ky=li(()=>{l();WL();YL=r=>crypto.getRandomValues(new Uint8Array(r)),XL=(r,e,t)=>{let i=(2<<Math.log(r.length-1)/Math.LN2)-1,n=-~(1.6*i*e/r.length);return()=>{let s="";for(;;){let o=t(n),a=n;for(;a--;)if(s+=r[o[a]&i]||"",s.length===e)return s}}},nTe=(r,e)=>XL(r,e,YL),sTe=(r=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(r));for(;r--;){let i=t[r]&63;i<36?e+=i.toString(36):i<62?e+=(i-26).toString(36).toUpperCase():i<63?e+="_":e+="-"}return e}});var w6=p((E1t,JL)=>{l();"use strict";var{nanoid:oTe}=(Ky(),Uy),aTe=tt(),cTe=ct(),QL=Symbol.for("@ipfs/interface-datastore/key"),jc="/",ZL=new TextEncoder().encode(jc),p2=ZL[0],gs=class{constructor(e,t){if(typeof e=="string")this._buf=cTe(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==p2)throw new Error("Invalid key")}toString(e="utf8"){return aTe(this._buf,e)}uint8Array(){return this._buf}get[QL](){return!0}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new gs(e.join(jc))}static random(){return new gs(oTe().replace(/-/g,""))}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=ZL),this._buf[0]!==p2){let e=new Uint8Array(this._buf.byteLength+1);e.fill(p2,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===p2;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),i=e.list();for(let n=0;n<t.length;n++){if(i.length<n+1)return!1;let s=t[n],o=i[n];if(s<o)return!0;if(s>o)return!1}return t.length<i.length}reverse(){return gs.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(jc).slice(1)}type(){return uTe(this.baseNamespace())}name(){return fTe(this.baseNamespace())}instance(e){return new gs(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(jc)||(e+=jc),e+=this.type(),new gs(e)}parent(){let e=this.list();return e.length===1?new gs(jc):new gs(e.slice(0,-1).join(jc))}child(e){return this.toString()===jc?e:e.toString()===jc?this:new gs(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return gs.withNamespaces([...this.namespaces(),...lTe(e.map(t=>t.namespaces()))])}static isKey(e){return e instanceof gs||Boolean(e&&e[QL])}};function uTe(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function fTe(r){let e=r.split(":");return e[e.length-1]}function lTe(r){return[].concat(...r)}JL.exports=gs});var tF=p((S1t,eF)=>{l();"use strict";var{nanoid:hTe}=(Ky(),Uy),dTe=(r=e=>e)=>r(hTe());eF.exports=dTe});var jy=p((x1t,rF)=>{l();"use strict";var pTe=async r=>{let e=[];for await(let t of r)e.push(t);return e};rF.exports=pTe});var _6=p((A1t,iF)=>{l();"use strict";var yTe=tF(),gTe=jy(),bTe=(r,e)=>async function*(){yield*(await gTe(r)).sort(e)}(),mTe=(r,e)=>{let t=new RegExp("^"+e);return r.replace(t,"")};iF.exports={sortAll:bTe,tmpdir:yTe,replaceStartWith:mTe}});var xd=p((I1t,nF)=>{l();"use strict";var vTe=async r=>{for await(let e of r);};nF.exports=vTe});var hl=p((T1t,sF)=>{l();"use strict";var wTe=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};sF.exports=wTe});var y2=p((R1t,oF)=>{l();"use strict";var _Te=async function*(r,e){let t=0;if(!(e<1)){for await(let i of r)if(yield i,t++,t===e)return}};oF.exports=_Te});var E6=p((k1t,aF)=>{l();"use strict";var{sortAll:cF}=_6(),uF=xd(),Ad=hl(),fF=y2(),lF=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:i,value:n}of e)await this.put(i,n,t),yield{key:i,value:n}}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(let i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,n){e.push({key:i,value:n})},delete(i){t.push(i)},commit:async i=>{await uF(this.putMany(e,i)),e=[],await uF(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=Ad(i,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>Ad(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>cF(n,s),i)),e.offset!=null){let n=0;i=Ad(i,()=>n++>=e.offset)}return e.limit!=null&&(i=fF(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=Ad(i,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>Ad(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>cF(n,s),i)),e.offset!=null){let n=0;i=Ad(i,()=>n++>=e.offset)}return e.limit!=null&&(i=fF(i,e.limit)),i}};aF.exports=lF});var S6=p((C1t,hF)=>{l();"use strict";var Vy=ge();function ETe(r){return r=r||new Error("Cannot open database"),Vy(r,"ERR_DB_OPEN_FAILED")}function STe(r){return r=r||new Error("Delete failed"),Vy(r,"ERR_DB_DELETE_FAILED")}function xTe(r){return r=r||new Error("Write failed"),Vy(r,"ERR_DB_WRITE_FAILED")}function ATe(r){return r=r||new Error("Not Found"),Vy(r,"ERR_NOT_FOUND")}function ITe(r){return r=r||new Error("Aborted"),Vy(r,"ERR_ABORTED")}hF.exports={dbOpenFailedError:ETe,dbDeleteFailedError:STe,dbWriteFailedError:xTe,notFoundError:ATe,abortedError:ITe}});var gF=p((P1t,dF)=>{l();"use strict";var pF=w6(),TTe=E6(),RTe=S6(),yF=class extends TTe{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw RTe.notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new pF(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new pF(e))}};dF.exports=yF});var ir=p((O1t,bF)=>{l();"use strict";var kTe=w6(),CTe=gF(),PTe=_6(),OTe=S6(),BTe=E6();bF.exports={Key:kTe,MemoryDatastore:CTe,utils:PTe,Errors:OTe,Adapter:BTe}});var vF=p((B1t,mF)=>{l();"use strict";mF.exports=function(){return Date.now()}});var _F=p((N1t,wF)=>{l();"use strict";var x6=vF();function A6(r,e,t){var i=this;this._started=x6(),this._rescheduled=0,this._scheduled=e,this._args=t,this._timer=setTimeout(n,e);function n(){i._rescheduled>0?(i._scheduled=i._rescheduled-(x6()-i._started),i._timer=setTimeout(n,i._scheduled),i._rescheduled=0):r.apply(null,i._args)}}A6.prototype.reschedule=function(r){var e=x6();return e+r-(this._started+this._scheduled)<0?!1:(this._started=e,this._rescheduled=r,!0)};A6.prototype.clear=function(){clearTimeout(this._timer)};function NTe(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");var r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new A6(arguments[0],arguments[1],r)}wF.exports=NTe});var T6=p((D1t,I6)=>{l();"use strict";var{AbortController:DTe}=typeof self!="undefined"?self:typeof window!="undefined"?window:Uf(),EF=_F(),zy=class extends DTe{constructor(e){super();this._ms=e,this._timer=EF(()=>this.abort(),e),Object.setPrototypeOf(this,zy.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=EF(()=>this.abort(),this._ms)}};I6.exports=zy;I6.exports.TimeoutController=zy});var g2=p((q1t,R6)=>{l();"use strict";var qTe=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;R6.exports=wt;R6.exports.default=wt;wt.nanosecond=wt.ns=1/1e6;wt.\u00B5s=wt.\u03BCs=wt.us=wt.microsecond=1/1e3;wt.millisecond=wt.ms=wt[""]=1;wt.second=wt.sec=wt.s=wt.ms*1e3;wt.minute=wt.min=wt.m=wt.s*60;wt.hour=wt.hr=wt.h=wt.m*60;wt.day=wt.d=wt.h*24;wt.week=wt.wk=wt.w=wt.d*7;wt.month=wt.b=wt.d*(365.25/12);wt.year=wt.yr=wt.y=wt.d*365.25;function wt(r="",e="ms"){var t=null;return r=(r+"").replace(/(\d)[,_](\d)/g,"$1$2"),r.replace(qTe,function(i,n,s){s=SF(s),s&&(t=(t||0)+parseFloat(n,10)*s)}),t&&t/(SF(e)||1)}function SF(r){return wt[r]||wt[r.toLowerCase().replace(/s$/,"")]}});var AF=p(xF=>{l();"use strict";var Hy=class extends Error{constructor(e="request timed out"){super(e);this.name="TimeoutError",this.code=Hy.code}};Hy.code="ERR_TIMEOUT";xF.TimeoutError=Hy});var Be=p((L1t,IF)=>{l();"use strict";var MTe=T6(),{anySignal:LTe}=Bh(),{default:FTe}=g2(),{TimeoutError:k6}=AF();function UTe(r,e){return(...t)=>{let i=t[e??t.length-1];if(!i||!i.timeout)return r(...t);let n=typeof i.timeout=="string"?FTe(i.timeout):i.timeout,s=new MTe(n);i.signal=LTe([i.signal,s.signal]);let o=r(...t),a=new Promise((f,h)=>{s.signal.addEventListener("abort",()=>{h(new k6)})}),c=Date.now(),u=()=>{if(s.signal.aborted)throw new k6;if(Date.now()-c>n)throw s.abort(),new k6};return o[Symbol.asyncIterator]?async function*(){let f=o[Symbol.asyncIterator]();try{for(;;){let{value:h,done:d}=await Promise.race([f.next(),a]);if(d)break;u(),yield h}}catch(h){throw u(),h}finally{s.clear(),f.return&&f.return()}}():(async()=>{try{let f=await Promise.race([o,a]);return u(),f}catch(f){throw u(),f}finally{s.clear()}})()}}IF.exports=UTe});var Gy=p((F1t,TF)=>{l();"use strict";var C6=Qe(),RF=ge(),kF="/ipfs/",KTe=r=>{if(r instanceof Uint8Array)try{r=new C6(r)}catch(n){throw RF(n,"ERR_INVALID_CID")}if(C6.isCID(r))return{cid:r,path:void 0};r.startsWith(kF)&&(r=r.substring(kF.length));let e=r.split("/"),t,i;try{t=new C6(e.shift())}catch(n){throw RF(n,"ERR_INVALID_CID")}return e.length&&(i=`/${e.join("/")}`),{cid:t,path:i}};TF.exports=KTe});var P6=p((U1t,CF)=>{l();"use strict";var jTe=Qe(),VTe=Be(),zTe=Gy();CF.exports=({ipld:r,preload:e})=>{async function t(i,n={}){let{cid:s,path:o}=zTe(i);n.preload!==!1&&e(s),o&&(n.path=o);let a=s,c=n.path||"";if(c.startsWith("/")&&(c=c.substring(1)),n.path)try{for await(let{value:u,remainderPath:f}of r.resolve(s,n.path,{signal:n.signal})){if(!jTe.isCID(u))break;c=f,a=u}}catch(u){throw u.message.startsWith("Object has no property")&&(u.message=`no link named "${c.split("/")[0]}" under ${a}`,u.code="ERR_NO_LINK"),u}return{cid:a,remainderPath:c||""}}return VTe(t)}});var zi=p(Xs=>{l();"use strict";var PF=ll(),b2=Qe(),HTe=ir().Key,GTe=ge(),OF=Be(),$Te=Gr(),WTe=P6();Xs.mergeOptions=$Te;var YTe="ERR_BAD_PATH";Xs.OFFLINE_ERROR="This command must be run in online mode. Try running 'ipfs daemon' first.";Xs.MFS_ROOT_KEY=new HTe("/local/filesroot");Xs.MFS_MAX_CHUNK_SIZE=262144;Xs.MFS_MAX_LINKS=174;var XTe=r=>{if(PF.cid(r)||b2.isCID(r))return`/ipfs/${new b2(r)}`;if(PF.path(r))return r;throw GTe(new Error(`invalid path: ${r}`),YTe)},JTe=r=>r instanceof Uint8Array?new b2(r).toString():b2.isCID(r)?r.toString():(r.indexOf("/ipfs/")===0&&(r=r.substring("/ipfs/".length)),r.charAt(r.length-1)==="/"&&(r=r.substring(0,r.length-1)),r),QTe=async function(r,e,t={}){let i=()=>{};i.stop=()=>{},i.start=()=>{};let{cid:n}=await WTe({ipld:r,preload:i})(e,{preload:!1});return n},ZTe=(r,e={})=>{if(r.type!=="file"&&r.type!=="directory"&&r.type!=="raw")throw new Error(`Unknown node type '${r.type}'`);let t={cid:r.cid,path:r.path,name:r.name,depth:r.path.split("/").length,size:r.size,type:"file"};return r.type==="directory"&&(t.type="dir"),r.type==="file"&&(t.size=r.unixfs.fileSize()),(r.type==="file"||r.type==="directory")&&(t.mode=r.unixfs.mode,r.unixfs.mtime!==void 0&&(t.mtime=r.unixfs.mtime)),e.includeContent&&(r.type==="file"||r.type==="raw")&&(t.content=r.content()),t},eRe=OF(async(r,e)=>await r);Xs.normalizePath=XTe;Xs.normalizeCidPath=JTe;Xs.resolvePath=QTe;Xs.mapFile=ZTe;Xs.withTimeoutOption=OF;Xs.withTimeout=eRe});var NF=p((j1t,BF)=>{l();var Id=1e3,Td=Id*60,Rd=Td*60,dl=Rd*24,tRe=dl*7,rRe=dl*365.25;BF.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return iRe(r);if(t==="number"&&isFinite(r))return e.long?sRe(r):nRe(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function iRe(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*rRe;case"weeks":case"week":case"w":return t*tRe;case"days":case"day":case"d":return t*dl;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Rd;case"minutes":case"minute":case"mins":case"min":case"m":return t*Td;case"seconds":case"second":case"secs":case"sec":case"s":return t*Id;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function nRe(r){var e=Math.abs(r);return e>=dl?Math.round(r/dl)+"d":e>=Rd?Math.round(r/Rd)+"h":e>=Td?Math.round(r/Td)+"m":e>=Id?Math.round(r/Id)+"s":r+"ms"}function sRe(r){var e=Math.abs(r);return e>=dl?m2(r,e,dl,"day"):e>=Rd?m2(r,e,Rd,"hour"):e>=Td?m2(r,e,Td,"minute"):e>=Id?m2(r,e,Id,"second"):r+" ms"}function m2(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var qF=p((V1t,DF)=>{l();function oRe(r){t.debug=t,t.default=t,t.coerce=c,t.disable=s,t.enable=n,t.enabled=o,t.humanize=NF(),t.destroy=u,Object.keys(r).forEach(f=>{t[f]=r[f]}),t.names=[],t.skips=[],t.formatters={};function e(f){let h=0;for(let d=0;d<f.length;d++)h=(h<<5)-h+f.charCodeAt(d),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(f){let h,d=null;function y(...g){if(!y.enabled)return;let m=y,x=Number(new Date),_=x-(h||x);m.diff=_,m.prev=h,m.curr=x,h=x,g[0]=t.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let P=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(X,W)=>{if(X==="%%")return"%";P++;let z=t.formatters[W];if(typeof z=="function"){let Z=g[P];X=z.call(m,Z),g.splice(P,1),P--}return X}),t.formatArgs.call(m,g),(m.log||t.log).apply(m,g)}return y.namespace=f,y.useColors=t.useColors(),y.color=t.selectColor(f),y.extend=i,y.destroy=t.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>d===null?t.enabled(f):d,set:g=>{d=g}}),typeof t.init=="function"&&t.init(y),y}function i(f,h){let d=t(this.namespace+(typeof h=="undefined"?":":h)+f);return d.log=this.log,d}function n(f){t.save(f),t.names=[],t.skips=[];let h,d=(typeof f=="string"?f:"").split(/[\s,]+/),y=d.length;for(h=0;h<y;h++)!d[h]||(f=d[h].replace(/\*/g,".*?"),f[0]==="-"?t.skips.push(new RegExp("^"+f.substr(1)+"$")):t.names.push(new RegExp("^"+f+"$")))}function s(){let f=[...t.names.map(a),...t.skips.map(a).map(h=>"-"+h)].join(",");return t.enable(""),f}function o(f){if(f[f.length-1]==="*")return!0;let h,d;for(h=0,d=t.skips.length;h<d;h++)if(t.skips[h].test(f))return!1;for(h=0,d=t.names.length;h<d;h++)if(t.names[h].test(f))return!0;return!1}function a(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function c(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}DF.exports=oRe});var xe=p((bs,v2)=>{l();bs.formatArgs=aRe;bs.save=cRe;bs.load=uRe;bs.useColors=fRe;bs.storage=lRe();bs.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();bs.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function fRe(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function aRe(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+v2.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,i=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(i=t))}),r.splice(i,0,e)}bs.log=console.debug||console.log||(()=>{});function cRe(r){try{r?bs.storage.setItem("debug",r):bs.storage.removeItem("debug")}catch(e){}}function uRe(){let r;try{r=bs.storage.getItem("debug")}catch(e){}return!r&&typeof process!="undefined"&&"env"in process&&(r=process.env.DEBUG),r}function lRe(){try{return localStorage}catch(r){}}v2.exports=qF()(bs);var{formatters:hRe}=v2.exports;hRe.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var O6=p((z1t,MF)=>{l();"use strict";var pl=hi(),w2=pl.Reader,LF=pl.Writer,Yr=pl.util,ms=pl.roots.default||(pl.roots.default={});ms.PBLink=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Hash=Yr.newBuffer([]),r.prototype.Name="",r.prototype.Tsize=Yr.Long?Yr.Long.fromBits(0,0,!0):0,r.encode=function(t,i){return i||(i=LF.create()),t.Hash!=null&&Object.hasOwnProperty.call(t,"Hash")&&i.uint32(10).bytes(t.Hash),t.Name!=null&&Object.hasOwnProperty.call(t,"Name")&&i.uint32(18).string(t.Name),t.Tsize!=null&&Object.hasOwnProperty.call(t,"Tsize")&&i.uint32(24).uint64(t.Tsize),i},r.decode=function(t,i){t instanceof w2||(t=w2.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new ms.PBLink;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Hash=t.bytes();break;case 2:s.Name=t.string();break;case 3:s.Tsize=t.uint64();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof ms.PBLink)return t;var i=new ms.PBLink;return t.Hash!=null&&(typeof t.Hash=="string"?Yr.base64.decode(t.Hash,i.Hash=Yr.newBuffer(Yr.base64.length(t.Hash)),0):t.Hash.length&&(i.Hash=t.Hash)),t.Name!=null&&(i.Name=String(t.Name)),t.Tsize!=null&&(Yr.Long?(i.Tsize=Yr.Long.fromValue(t.Tsize)).unsigned=!0:typeof t.Tsize=="string"?i.Tsize=parseInt(t.Tsize,10):typeof t.Tsize=="number"?i.Tsize=t.Tsize:typeof t.Tsize=="object"&&(i.Tsize=new Yr.LongBits(t.Tsize.low>>>0,t.Tsize.high>>>0).toNumber(!0))),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults)if(i.bytes===String?n.Hash="":(n.Hash=[],i.bytes!==Array&&(n.Hash=Yr.newBuffer(n.Hash))),n.Name="",Yr.Long){var s=new Yr.Long(0,0,!0);n.Tsize=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.Tsize=i.longs===String?"0":0;return t.Hash!=null&&t.hasOwnProperty("Hash")&&(n.Hash=i.bytes===String?Yr.base64.encode(t.Hash,0,t.Hash.length):i.bytes===Array?Array.prototype.slice.call(t.Hash):t.Hash),t.Name!=null&&t.hasOwnProperty("Name")&&(n.Name=t.Name),t.Tsize!=null&&t.hasOwnProperty("Tsize")&&(typeof t.Tsize=="number"?n.Tsize=i.longs===String?String(t.Tsize):t.Tsize:n.Tsize=i.longs===String?Yr.Long.prototype.toString.call(t.Tsize):i.longs===Number?new Yr.LongBits(t.Tsize.low>>>0,t.Tsize.high>>>0).toNumber(!0):t.Tsize),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,pl.util.toJSONOptions)},r}();ms.PBNode=function(){function r(e){if(this.Links=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Links=Yr.emptyArray,r.prototype.Data=Yr.newBuffer([]),r.encode=function(t,i){if(i||(i=LF.create()),t.Data!=null&&Object.hasOwnProperty.call(t,"Data")&&i.uint32(10).bytes(t.Data),t.Links!=null&&t.Links.length)for(var n=0;n<t.Links.length;++n)ms.PBLink.encode(t.Links[n],i.uint32(18).fork()).ldelim();return i},r.decode=function(t,i){t instanceof w2||(t=w2.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new ms.PBNode;t.pos<n;){var o=t.uint32();switch(o>>>3){case 2:s.Links&&s.Links.length||(s.Links=[]),s.Links.push(ms.PBLink.decode(t,t.uint32()));break;case 1:s.Data=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof ms.PBNode)return t;var i=new ms.PBNode;if(t.Links){if(!Array.isArray(t.Links))throw TypeError(".PBNode.Links: array expected");i.Links=[];for(var n=0;n<t.Links.length;++n){if(typeof t.Links[n]!="object")throw TypeError(".PBNode.Links: object expected");i.Links[n]=ms.PBLink.fromObject(t.Links[n])}}return t.Data!=null&&(typeof t.Data=="string"?Yr.base64.decode(t.Data,i.Data=Yr.newBuffer(Yr.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.Links=[]),i.defaults&&(i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Yr.newBuffer(n.Data)))),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Yr.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),t.Links&&t.Links.length){n.Links=[];for(var s=0;s<t.Links.length;++s)n.Links[s]=ms.PBLink.toObject(t.Links[s],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,pl.util.toJSONOptions)},r}();MF.exports=ms});var $u=p((H1t,FF)=>{l();"use strict";var dRe=Qe(),pRe=ct(),UF=class{constructor(e,t,i){if(!i)throw new Error("A link requires a cid to point to");this.Name=e||"",this.Tsize=t,this.Hash=new dRe(i),Object.defineProperties(this,{_nameBuf:{value:null,writable:!0,enumerable:!1}})}toString(){return`DAGLink <${this.Hash.toBaseEncodedString()} - name: "${this.Name}", size: ${this.Tsize}>`}toJSON(){return this._json||(this._json=Object.freeze({name:this.Name,size:this.Tsize,cid:this.Hash.toBaseEncodedString()})),Object.assign({},this._json)}get nameAsBuffer(){return this._nameBuf!=null?this._nameBuf:(this._nameBuf=pRe(this.Name),this._nameBuf)}};FF.exports=UF});var KF=p((B6,N6)=>{l();(function(r,e){typeof B6=="object"&&typeof N6!="undefined"?N6.exports=e():typeof define=="function"&&define.amd?define(e):r.stable=e()})(B6,function(){"use strict";var r=function(i,n){return e(i.slice(),n)};r.inplace=function(i,n){var s=e(i,n);return s!==i&&t(s,null,i.length,i),i};function e(i,n){typeof n!="function"&&(n=function(u,f){return String(u).localeCompare(f)});var s=i.length;if(s<=1)return i;for(var o=new Array(s),a=1;a<s;a*=2){t(i,n,a,o);var c=i;i=o,o=c}return i}var t=function(i,n,s,o){var a=i.length,c=0,u=s*2,f,h,d,y,g;for(f=0;f<a;f+=u)for(h=f+s,d=h+s,h>a&&(h=a),d>a&&(d=a),y=f,g=h;;)if(y<h&&g<d)n(i[y],i[g])<=0?o[c++]=i[y++]:o[c++]=i[g++];else if(y<h)o[c++]=i[y++];else if(g<d)o[c++]=i[g++];else break};return r})});var D6=p((G1t,jF)=>{l();"use strict";function yRe(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}jF.exports=yRe});var q6=p(($1t,VF)=>{l();"use strict";var gRe=KF(),bRe=D6(),mRe=(r,e)=>{let t=r.nameAsBuffer,i=e.nameAsBuffer;return bRe(t,i)},vRe=r=>{gRe.inplace(r,mRe)};VF.exports=vRe});var M6=p((W1t,zF)=>{l();"use strict";var wRe=$u();function _Re(r){return new wRe(r.Name||r.name||"",r.Tsize||r.Size||r.size||0,r.Hash||r.hash||r.multihash||r.cid)}zF.exports={createDagLinkFromB58EncodedHash:_Re}});var L6=p((Y1t,HF)=>{l();"use strict";var ERe=hi(),{PBLink:SRe}=O6(),{createDagLinkFromB58EncodedHash:xRe}=M6(),GF=r=>{let e={};return r.Data&&r.Data.byteLength>0?e.Data=r.Data:e.Data=null,r.Links&&r.Links.length>0?e.Links=r.Links.map(t=>({Hash:t.Hash.bytes,Name:t.Name,Tsize:t.Tsize})):e.Links=null,e},ARe=r=>$F(GF(r)),IRe=(r,e=[])=>{let t={Data:r,Links:e.map(i=>xRe(i))};return $F(GF(t))};HF.exports={serializeDAGNode:ARe,serializeDAGNodeLike:IRe};function $F(r){let e=ERe.Writer.create();if(r.Links!=null)for(let t=0;t<r.Links.length;t++)SRe.encode(r.Links[t],e.uint32(18).fork()).ldelim();return r.Data!=null&&e.uint32(10).bytes(r.Data),e.finish()}});var F6=p((X1t,WF)=>{l();"use strict";var TRe=Qe(),YF=$r(),XF=er(),{multihash:JF}=XF,QF=YF.DAG_PB,ZF=JF.names["sha2-256"],RRe=async(r,e={})=>{let t={cidVersion:e.cidVersion==null?1:e.cidVersion,hashAlg:e.hashAlg==null?ZF:e.hashAlg},i=JF.codes[t.hashAlg],n=await XF(r,i),s=YF.getNameFromCode(QF);return new TRe(t.cidVersion,s,n)};WF.exports={codec:QF,defaultHashAlg:ZF,cid:RRe}});var tU=p((J1t,eU)=>{l();"use strict";var kRe=$u(),CRe=F6(),PRe=async(r,e={})=>{let t=r.serialize(),i=await CRe.cid(t,e);return new kRe(e.name||"",r.size,i)};eU.exports=PRe});var nU=p((Q1t,rU)=>{l();"use strict";var ORe=q6(),iU=$u(),BRe=r=>{if(r instanceof iU)return r;if(!("cid"in r||"hash"in r||"Hash"in r||"multihash"in r))throw new Error("Link must be a DAGLink or DAGLink-like. Convert the DAGNode into a DAGLink via `node.toDAGLink()`.");return new iU(r.Name||r.name,r.Tsize||r.size,r.Hash||r.multihash||r.hash||r.cid)},NRe=(r,e)=>{let t=BRe(e);r.Links.push(t),ORe(r.Links)};rU.exports=NRe});var aU=p((Z1t,sU)=>{l();"use strict";var DRe=Qe(),oU=Dr(),qRe=(r,e)=>{let t=null;if(typeof e=="string"?t=i=>i.Name===e:e instanceof Uint8Array?t=i=>oU(i.Hash.bytes,e):DRe.isCID(e)&&(t=i=>oU(i.Hash.bytes,e.bytes)),t){let i=r.Links,n=0;for(;n<i.length;){let s=i[n];t(s)?i.splice(n,1):n++}}else throw new Error("second arg needs to be a name or CID")};sU.exports=qRe});var _2=p((ebt,cU)=>{l();"use strict";var MRe=q6(),LRe=$u(),{createDagLinkFromB58EncodedHash:FRe}=M6(),{serializeDAGNode:URe}=L6(),KRe=tU(),jRe=nU(),VRe=aU(),zRe=ct(),HRe=tt(),uU=class{constructor(e,t=[],i=null){if(e||(e=new Uint8Array(0)),typeof e=="string"&&(e=zRe(e)),!(e instanceof Uint8Array))throw new Error("Passed 'data' is not a Uint8Array or a String!");if(i!==null&&typeof i!="number")throw new Error("Passed 'serializedSize' must be a number!");let n=t.map(s=>s instanceof LRe?s:FRe(s));MRe(n),this.Data=e,this.Links=n,Object.defineProperties(this,{_serializedSize:{value:i,writable:!0,enumerable:!1},_size:{value:null,writable:!0,enumerable:!1}})}toJSON(){return this._json||(this._json=Object.freeze({data:this.Data,links:this.Links.map(e=>e.toJSON()),size:this.size})),Object.assign({},this._json)}toString(){return`DAGNode <data: "${HRe(this.Data,"base64urlpad")}", links: ${this.Links.length}, size: ${this.size}>`}_invalidateCached(){this._serializedSize=null,this._size=null}addLink(e){return this._invalidateCached(),jRe(this,e)}rmLink(e){return this._invalidateCached(),VRe(this,e)}toDAGLink(e){return KRe(this,e)}serialize(){let e=URe(this);return this._serializedSize=e.length,e}get size(){if(this._size==null){let e;e==null&&(this._serializedSize=this.serialize().length,e=this._serializedSize),this._size=this.Links.reduce((t,i)=>t+i.Tsize,e)}return this._size}set size(e){throw new Error("Can't set property: 'size' is immutable")}};cU.exports=uU});var K6=p((tbt,fU)=>{l();"use strict";var{PBNode:lU}=O6(),GRe=$u(),hU=_2(),{serializeDAGNode:$Re,serializeDAGNodeLike:WRe}=L6(),U6=F6(),YRe=(r,e)=>U6.cid(r,e),XRe=r=>r instanceof hU?$Re(r):WRe(r.Data,r.Links),JRe=r=>{let e=lU.decode(r),t=lU.toObject(e,{defaults:!1,arrays:!0,longs:Number,objects:!1}),i=t.Links.map(s=>new GRe(s.Name,s.Tsize,s.Hash)),n=t.Data==null?new Uint8Array(0):t.Data;return new hU(n,i,r.byteLength)};fU.exports={codec:U6.codec,defaultHashAlg:U6.defaultHashAlg,serialize:XRe,deserialize:JRe,cid:YRe}});var pU=p(j6=>{l();"use strict";var QRe=Qe(),dU=K6();j6.resolve=(r,e="/")=>{let t=dU.deserialize(r),i=e.split("/").filter(Boolean);for(;i.length;){let n=i.shift();if(t[n]===void 0){for(let s of t.Links)if(s.Name===n)return{value:s.Hash,remainderPath:i.join("/")};throw new Error(`Object has no property '${n}'`)}if(t=t[n],QRe.isCID(t))return{value:t,remainderPath:i.join("/")}}return{value:t,remainderPath:""}};j6.tree=function*(r){let e=dU.deserialize(r);yield"Data",yield"Links";for(let t=0;t<e.Links.length;t++)yield`Links/${t}`,yield`Links/${t}/Name`,yield`Links/${t}/Tsize`,yield`Links/${t}/Hash`}});var Mr=p((ibt,yU)=>{l();"use strict";var ZRe=pU(),V6=K6(),eke=_2(),tke=$u(),rke={DAGNode:eke,DAGLink:tke,resolver:ZRe,util:V6,codec:V6.codec,defaultHashAlg:V6.defaultHashAlg};yU.exports=rke});var bU=p((nbt,gU)=>{l();"use strict";var Wu=hi(),kd=Wu.Reader,z6=Wu.Writer,st=Wu.util,Hi=Wu.roots["ipfs-unixfs"]||(Wu.roots["ipfs-unixfs"]={});Hi.Data=function(){function r(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=st.newBuffer([]),r.prototype.filesize=st.Long?st.Long.fromBits(0,0,!0):0,r.prototype.blocksizes=st.emptyArray,r.prototype.hashType=st.Long?st.Long.fromBits(0,0,!0):0,r.prototype.fanout=st.Long?st.Long.fromBits(0,0,!0):0,r.prototype.mode=0,r.prototype.mtime=null,r.encode=function(t,i){if(i||(i=z6.create()),i.uint32(8).int32(t.Type),t.Data!=null&&Object.hasOwnProperty.call(t,"Data")&&i.uint32(18).bytes(t.Data),t.filesize!=null&&Object.hasOwnProperty.call(t,"filesize")&&i.uint32(24).uint64(t.filesize),t.blocksizes!=null&&t.blocksizes.length)for(var n=0;n<t.blocksizes.length;++n)i.uint32(32).uint64(t.blocksizes[n]);return t.hashType!=null&&Object.hasOwnProperty.call(t,"hashType")&&i.uint32(40).uint64(t.hashType),t.fanout!=null&&Object.hasOwnProperty.call(t,"fanout")&&i.uint32(48).uint64(t.fanout),t.mode!=null&&Object.hasOwnProperty.call(t,"mode")&&i.uint32(56).uint32(t.mode),t.mtime!=null&&Object.hasOwnProperty.call(t,"mtime")&&Hi.UnixTime.encode(t.mtime,i.uint32(66).fork()).ldelim(),i},r.decode=function(t,i){t instanceof kd||(t=kd.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Hi.Data;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;case 3:s.filesize=t.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)==2)for(var a=t.uint32()+t.pos;t.pos<a;)s.blocksizes.push(t.uint64());else s.blocksizes.push(t.uint64());break;case 5:s.hashType=t.uint64();break;case 6:s.fanout=t.uint64();break;case 7:s.mode=t.uint32();break;case 8:s.mtime=Hi.UnixTime.decode(t,t.uint32());break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw st.ProtocolError("missing required 'Type'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Hi.Data)return t;var i=new Hi.Data;switch(t.Type){case"Raw":case 0:i.Type=0;break;case"Directory":case 1:i.Type=1;break;case"File":case 2:i.Type=2;break;case"Metadata":case 3:i.Type=3;break;case"Symlink":case 4:i.Type=4;break;case"HAMTShard":case 5:i.Type=5;break}if(t.Data!=null&&(typeof t.Data=="string"?st.base64.decode(t.Data,i.Data=st.newBuffer(st.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),t.filesize!=null&&(st.Long?(i.filesize=st.Long.fromValue(t.filesize)).unsigned=!0:typeof t.filesize=="string"?i.filesize=parseInt(t.filesize,10):typeof t.filesize=="number"?i.filesize=t.filesize:typeof t.filesize=="object"&&(i.filesize=new st.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");i.blocksizes=[];for(var n=0;n<t.blocksizes.length;++n)st.Long?(i.blocksizes[n]=st.Long.fromValue(t.blocksizes[n])).unsigned=!0:typeof t.blocksizes[n]=="string"?i.blocksizes[n]=parseInt(t.blocksizes[n],10):typeof t.blocksizes[n]=="number"?i.blocksizes[n]=t.blocksizes[n]:typeof t.blocksizes[n]=="object"&&(i.blocksizes[n]=new st.LongBits(t.blocksizes[n].low>>>0,t.blocksizes[n].high>>>0).toNumber(!0))}if(t.hashType!=null&&(st.Long?(i.hashType=st.Long.fromValue(t.hashType)).unsigned=!0:typeof t.hashType=="string"?i.hashType=parseInt(t.hashType,10):typeof t.hashType=="number"?i.hashType=t.hashType:typeof t.hashType=="object"&&(i.hashType=new st.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),t.fanout!=null&&(st.Long?(i.fanout=st.Long.fromValue(t.fanout)).unsigned=!0:typeof t.fanout=="string"?i.fanout=parseInt(t.fanout,10):typeof t.fanout=="number"?i.fanout=t.fanout:typeof t.fanout=="object"&&(i.fanout=new st.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),t.mode!=null&&(i.mode=t.mode>>>0),t.mtime!=null){if(typeof t.mtime!="object")throw TypeError(".Data.mtime: object expected");i.mtime=Hi.UnixTime.fromObject(t.mtime)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocksizes=[]),i.defaults){if(n.Type=i.enums===String?"Raw":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=st.newBuffer(n.Data))),st.Long){var s=new st.Long(0,0,!0);n.filesize=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.filesize=i.longs===String?"0":0;if(st.Long){var s=new st.Long(0,0,!0);n.hashType=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.hashType=i.longs===String?"0":0;if(st.Long){var s=new st.Long(0,0,!0);n.fanout=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.fanout=i.longs===String?"0":0;n.mode=0,n.mtime=null}if(t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?Hi.Data.DataType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?st.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),t.filesize!=null&&t.hasOwnProperty("filesize")&&(typeof t.filesize=="number"?n.filesize=i.longs===String?String(t.filesize):t.filesize:n.filesize=i.longs===String?st.Long.prototype.toString.call(t.filesize):i.longs===Number?new st.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){n.blocksizes=[];for(var o=0;o<t.blocksizes.length;++o)typeof t.blocksizes[o]=="number"?n.blocksizes[o]=i.longs===String?String(t.blocksizes[o]):t.blocksizes[o]:n.blocksizes[o]=i.longs===String?st.Long.prototype.toString.call(t.blocksizes[o]):i.longs===Number?new st.LongBits(t.blocksizes[o].low>>>0,t.blocksizes[o].high>>>0).toNumber(!0):t.blocksizes[o]}return t.hashType!=null&&t.hasOwnProperty("hashType")&&(typeof t.hashType=="number"?n.hashType=i.longs===String?String(t.hashType):t.hashType:n.hashType=i.longs===String?st.Long.prototype.toString.call(t.hashType):i.longs===Number?new st.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),t.fanout!=null&&t.hasOwnProperty("fanout")&&(typeof t.fanout=="number"?n.fanout=i.longs===String?String(t.fanout):t.fanout:n.fanout=i.longs===String?st.Long.prototype.toString.call(t.fanout):i.longs===Number?new st.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),t.mode!=null&&t.hasOwnProperty("mode")&&(n.mode=t.mode),t.mtime!=null&&t.hasOwnProperty("mtime")&&(n.mtime=Hi.UnixTime.toObject(t.mtime,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Wu.util.toJSONOptions)},r.DataType=function(){var e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),r}();Hi.UnixTime=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Seconds=st.Long?st.Long.fromBits(0,0,!1):0,r.prototype.FractionalNanoseconds=0,r.encode=function(t,i){return i||(i=z6.create()),i.uint32(8).int64(t.Seconds),t.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&i.uint32(21).fixed32(t.FractionalNanoseconds),i},r.decode=function(t,i){t instanceof kd||(t=kd.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Hi.UnixTime;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Seconds=t.int64();break;case 2:s.FractionalNanoseconds=t.fixed32();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw st.ProtocolError("missing required 'Seconds'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Hi.UnixTime)return t;var i=new Hi.UnixTime;return t.Seconds!=null&&(st.Long?(i.Seconds=st.Long.fromValue(t.Seconds)).unsigned=!1:typeof t.Seconds=="string"?i.Seconds=parseInt(t.Seconds,10):typeof t.Seconds=="number"?i.Seconds=t.Seconds:typeof t.Seconds=="object"&&(i.Seconds=new st.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),t.FractionalNanoseconds!=null&&(i.FractionalNanoseconds=t.FractionalNanoseconds>>>0),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(st.Long){var s=new st.Long(0,0,!1);n.Seconds=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.Seconds=i.longs===String?"0":0;n.FractionalNanoseconds=0}return t.Seconds!=null&&t.hasOwnProperty("Seconds")&&(typeof t.Seconds=="number"?n.Seconds=i.longs===String?String(t.Seconds):t.Seconds:n.Seconds=i.longs===String?st.Long.prototype.toString.call(t.Seconds):i.longs===Number?new st.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),t.FractionalNanoseconds!=null&&t.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=t.FractionalNanoseconds),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Wu.util.toJSONOptions)},r}();Hi.Metadata=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.MimeType="",r.encode=function(t,i){return i||(i=z6.create()),t.MimeType!=null&&Object.hasOwnProperty.call(t,"MimeType")&&i.uint32(10).string(t.MimeType),i},r.decode=function(t,i){t instanceof kd||(t=kd.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Hi.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.MimeType=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Hi.Metadata)return t;var i=new Hi.Metadata;return t.MimeType!=null&&(i.MimeType=String(t.MimeType)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.MimeType=""),t.MimeType!=null&&t.hasOwnProperty("MimeType")&&(n.MimeType=t.MimeType),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Wu.util.toJSONOptions)},r}();gU.exports=Hi});var _i=p((sbt,mU)=>{l();"use strict";var{Data:Vc}=bU(),H6=ge(),vU=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],ike=["directory","hamt-sharded-directory"],wU=parseInt("0644",8),_U=parseInt("0755",8);function E2(r){if(r!=null)return typeof r=="number"?r&4095:(r=r.toString(),r.substring(0,1)==="0"?parseInt(r,8)&4095:parseInt(r,10)&4095)}function G6(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){let t=r.getTime(),i=Math.floor(t/1e3);e={secs:i,nsecs:(t-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw H6(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var S2=class{static unmarshal(e){let t=Vc.decode(e),i=Vc.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new S2({type:vU[i.Type],data:i.Data,blockSizes:i.blocksizes,mode:i.mode,mtime:i.mtime?{secs:i.mtime.Seconds,nsecs:i.mtime.FractionalNanoseconds}:void 0});return n._originalMode=i.mode||0,n}constructor(e={type:"file"}){let{type:t,data:i,blockSizes:n,hashType:s,fanout:o,mtime:a,mode:c}=e;if(t&&!vU.includes(t))throw H6(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=i,this.hashType=s,this.fanout=o,this.blockSizes=n||[],this._originalMode=0,this.mode=E2(c),a&&(this.mtime=G6(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?_U:wU;let t=E2(e);t!==void 0&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&ike.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(t=>{e+=t}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=Vc.DataType.Raw;break;case"directory":e=Vc.DataType.Directory;break;case"file":e=Vc.DataType.File;break;case"metadata":e=Vc.DataType.Metadata;break;case"symlink":e=Vc.DataType.Symlink;break;case"hamt-sharded-directory":e=Vc.DataType.HAMTShard;break;default:throw H6(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t=this.data;(!this.data||!this.data.length)&&(t=void 0);let i;this.mode!=null&&(i=this._originalMode&4294963200|(E2(this.mode)||0),i===wU&&!this.isDirectory()&&(i=void 0),i===_U&&this.isDirectory()&&(i=void 0));let n;if(this.mtime!=null){let o=G6(this.mtime);o&&(n={Seconds:o.secs,FractionalNanoseconds:o.nsecs},n.FractionalNanoseconds===0&&delete n.FractionalNanoseconds)}let s={Type:e,Data:t,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:i,mtime:n};return Vc.encode(s).finish()}};mU.exports={UnixFS:S2,parseMode:E2,parseMtime:G6}});var SU=p((obt,EU)=>{l();"use strict";EU.exports=()=>{}});var Xu=p(Yu=>{l();"use strict";var $y=class extends Error{constructor(e="not initialized"){super(e);this.name="NotInitializedError",this.code=$y.code}};$y.code="ERR_NOT_INITIALIZED";Yu.NotInitializedError=$y;var $6=class extends Error{constructor(e="cannot initialize an initializing node"){super(e);this.name="AlreadyInitializingError",this.code=Cd.code}};$6.code="ERR_ALREADY_INITIALIZING";Yu.AlreadyInitializingError=$6;var Cd=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e);this.name="AlreadyInitializedError",this.code=Cd.code}};Cd.code="ERR_ALREADY_INITIALIZED";Yu.AlreadyInitializedError=Cd;var Wy=class extends Error{constructor(e="not started"){super(e);this.name="NotStartedError",this.code=Wy.code}};Wy.code="ERR_NOT_STARTED";Yu.NotStartedError=Wy;var Yy=class extends Error{constructor(e="cannot start, already startin"){super(e);this.name="AlreadyStartingError",this.code=Yy.code}};Yy.code="ERR_ALREADY_STARTING";Yu.AlreadyStartingError=Yy;var Xy=class extends Error{constructor(e="cannot start, already started"){super(e);this.name="AlreadyStartedError",this.code=Xy.code}};Xy.code="ERR_ALREADY_STARTED";Yu.AlreadyStartedError=Xy;var Jy=class extends Error{constructor(e="not enabled"){super(e);this.name="NotEnabledError",this.code=Jy.code}};Jy.code="ERR_NOT_ENABLED";Yu.NotEnabledError=Jy});var x2=p((cbt,xU)=>{l();"use strict";var{NotStartedError:nke,AlreadyStartingError:ske,AlreadyStartedError:oke}=Xu(),{withTimeout:ake}=zi(),Ga=class{static create({start:e,stop:t}){return new Ga(e,t)}static async start(e,t){let{state:i,activate:n}=e;switch(i.status){case"stopped":try{let s=n(t);e.state={status:"starting",ready:s};let o=await s;return e.state={status:"started",value:o},o}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new ske;case"started":throw new oke;case"stopping":return await i.ready,await Ga.start(e,t);default:return Ga.panic(e)}}static async stop(e){let{state:t,deactivate:i}=e;switch(t.status){case"stopped":break;case"starting":{try{await t.ready}catch(n){}return await Ga.stop(e)}case"stopping":return await t.ready;case"started":{i&&await i(t.value),e.state={status:"stopped"};break}default:Ga.panic(t)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await ake(e.ready,t);default:throw new nke}}static panic({state:e}){let t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await Ga.use(this,e)}try(){return Ga.try(this)}};xU.exports=Ga});var IU=p((ubt,AU)=>{l();"use strict";var cke=x2();AU.exports=({network:r,preload:e,peerId:t,keychain:i,repo:n,ipns:s,blockService:o,mfsPreload:a,print:c,options:u})=>async()=>{let{bitswap:h,libp2p:d}=await cke.start(r,{peerId:t,repo:n,print:c,options:u});o.setExchange(h),await Promise.all([s.startOnline({keychain:i,libp2p:d,peerId:t,repo:n}),e.start(),a.start()])}});var RU=p((fbt,TU)=>{l();"use strict";var uke=x2();TU.exports=({network:r,preload:e,blockService:t,ipns:i,repo:n,mfsPreload:s})=>async()=>{t.unsetExchange(),await Promise.all([e.stop(),i.stop(),s.stop(),uke.stop(r),n.close()])}});var Qy=p((lbt,kU)=>{l();kU.exports=function(r){if(!r)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,t=Object.create(null),i=Object.create(null);function n(s,o){t[s]=o,e++,e>=r&&(e=0,i=t,t=Object.create(null))}return{has:function(s){return t[s]!==void 0||i[s]!==void 0},remove:function(s){t[s]!==void 0&&(t[s]=void 0),i[s]!==void 0&&(i[s]=void 0)},get:function(s){var o=t[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return n(s,o),o},set:function(s,o){t[s]!==void 0?t[s]=o:n(s,o)},clear:function(){t=Object.create(null),i=Object.create(null)}}}});var W6=p((hbt,CU)=>{l();"use strict";var fke=Qy(),PU=class{constructor(e){this.lru=fke(e)}get(e){let t=this.lru.get(e);if(t){if(t.expire&&t.expire<Date.now()){this.lru.remove(e);return}return t.value}}set(e,t,i){this.lru.set(e,{value:t,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};CU.exports=PU});var BU=p((dbt,Y6)=>{l();"use strict";var lke=Object.prototype.hasOwnProperty,Cn="~";function Zy(){}Object.create&&(Zy.prototype=Object.create(null),new Zy().__proto__||(Cn=!1));function hke(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function OU(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new hke(t,i||r,n),o=Cn?Cn+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function A2(r,e){--r._eventsCount==0?r._events=new Zy:delete r._events[e]}function bn(){this._events=new Zy,this._eventsCount=0}bn.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)lke.call(t,i)&&e.push(Cn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};bn.prototype.listeners=function(e){var t=Cn?Cn+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};bn.prototype.listenerCount=function(e){var t=Cn?Cn+e:e,i=this._events[t];return i?i.fn?1:i.length:0};bn.prototype.emit=function(e,t,i,n,s,o){var a=Cn?Cn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,f,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(h=1,f=new Array(u-1);h<u;h++)f[h-1]=arguments[h];c.fn.apply(c.context,f)}else{var d=c.length,y;for(h=0;h<d;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),u){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,i);break;case 4:c[h].fn.call(c[h].context,t,i,n);break;default:if(!f)for(y=1,f=new Array(u-1);y<u;y++)f[y-1]=arguments[y];c[h].fn.apply(c[h].context,f)}}return!0};bn.prototype.on=function(e,t,i){return OU(this,e,t,i,!1)};bn.prototype.once=function(e,t,i){return OU(this,e,t,i,!0)};bn.prototype.removeListener=function(e,t,i,n){var s=Cn?Cn+e:e;if(!this._events[s])return this;if(!t)return A2(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&A2(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:A2(this,s)}return this};bn.prototype.removeAllListeners=function(e){var t;return e?(t=Cn?Cn+e:e,this._events[t]&&A2(this,t)):(this._events=new Zy,this._eventsCount=0),this};bn.prototype.off=bn.prototype.removeListener;bn.prototype.addListener=bn.prototype.on;bn.prefixed=Cn;bn.EventEmitter=bn;typeof Y6!="undefined"&&(Y6.exports=bn)});var DU=p((pbt,NU)=>{l();"use strict";NU.exports=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(i=>{i(e())}).then(()=>t),t=>new Promise(i=>{i(e())}).then(()=>{throw t})))});var MU=p((ybt,I2)=>{l();"use strict";var dke=DU(),X6=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},qU=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===Infinity){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new X6(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);dke(r.then(i,n),()=>{clearTimeout(s)})});I2.exports=qU;I2.exports.default=qU;I2.exports.TimeoutError=X6});var LU=p(J6=>{l();"use strict";Object.defineProperty(J6,"__esModule",{value:!0});function pke(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}J6.default=pke});var UU=p(Q6=>{l();"use strict";Object.defineProperty(Q6,"__esModule",{value:!0});var yke=LU(),FU=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=yke.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};Q6.default=FU});var yl=p(Z6=>{l();"use strict";Object.defineProperty(Z6,"__esModule",{value:!0});var gke=BU(),KU=MU(),bke=UU(),T2=()=>{},mke=new KU.TimeoutError,jU=class extends gke{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=T2,this._resolveIdle=T2,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:Infinity,interval:0,concurrency:Infinity,autoStart:!0,queueClass:bke.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===Infinity||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=T2,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=T2,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():KU.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(mke)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};Z6.default=jU});var HU=p((vbt,VU)=>{l();"use strict";var vke=W6(),{default:wke}=yl(),_ke=Vb(),e4=new vke(1e3),Eke=60*1e3,Ske=new wke({concurrency:4}),zU=r=>{if(r.Path)return r.Path;throw new Error(r.Message)};VU.exports=async(r,e)=>(async(i,n={})=>{let s=new URLSearchParams(n);s.set("arg",i);let o=s.toString();if(!n.nocache&&e4.has(o)){let c=e4.get(o);return zU(c)}let a=await Ske.add(async()=>{let c=await _ke.get("https://ipfs.io/api/v0/dns",{searchParams:s}),u=new URL(c.url).search.slice(1),f=await c.json();return e4.set(u,f,Eke),f});return zU(a)})(r,e)});var $U=p((wbt,GU)=>{l();"use strict";var xke=HU(),Ake=Be();function Ike(r){return r.endsWith(".eth")&&(r=r.replace(/.eth$/,".eth.link")),r}GU.exports=()=>Ake(async(e,t={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=Ike(e),xke(e,t)})});var YU=p((_bt,WU)=>{l();"use strict";WU.exports=({network:r})=>()=>{let e=r.try();return e!=null&&Boolean(e.libp2p.isStarted())}});var t4=p(XU=>{l();"use strict";var JU=Qe();XU.cidToString=(r,e={})=>{let t=e.upgrade!==!1,i=JU.isCID(r)?r:new JU(r);if(i.version===0&&e.base&&e.base!=="base58btc"){if(!t)return i.toString();i=i.toV1()}return i.toBaseEncodedString(e.base)}});var rK=p((Sbt,QU)=>{l();"use strict";var ZU=ll(),eK=Qe(),{cidToString:tK}=t4(),Tke=Be();QU.exports=({ipld:r,name:e})=>{async function t(i,n={}){if(!ZU.path(i))throw new Error("invalid argument "+i);if(ZU.ipnsPath(i)){if(!e)throw new Error("failed to resolve IPNS path: name API unavailable");for await(let h of e.resolve(i,n))i=h}let[,,s,...o]=i.split("/"),a=new eK(s);if(o.length===0)return`/ipfs/${tK(a,{base:n.cidBase})}`;i=o.join("/");let c=r.resolve(a,i),u=a,f=i;for await(let h of c)eK.isCID(h.value)&&(u=h.value,f=h.remainderPath);return`/ipfs/${tK(u,{base:n.cidBase})}${f?"/"+f:""}`}return Tke(t)}});var $a=p((xbt,iK)=>{l();"use strict";var Rke=async r=>{let e;for await(let t of r)e=t;return e};iK.exports=Rke});var sK=p((Abt,nK)=>{l();"use strict";var kke=$a(),Cke=Qe();nK.exports=({addAll:r})=>(e,t={})=>{let i;return Cke.isCID(e)?i=r([{cid:e,...t}],t):i=r([{path:e.toString(),...t}],t),kke(i)}});var eg=p(Pd=>{l();"use strict";var r4=H3(),Od=$0(),oK=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Pd.Buffer=we;Pd.SlowBuffer=Pke;Pd.INSPECT_MAX_BYTES=50;var R2=2147483647;Pd.kMaxLength=R2;we.TYPED_ARRAY_SUPPORT=Oke();!we.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Oke(){try{var r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch(t){return!1}}Object.defineProperty(we.prototype,"parent",{enumerable:!0,get:function(){if(!!we.isBuffer(this))return this.buffer}});Object.defineProperty(we.prototype,"offset",{enumerable:!0,get:function(){if(!!we.isBuffer(this))return this.byteOffset}});function zc(r){if(r>R2)throw new RangeError('The value "'+r+'" is invalid for option "size"');var e=new Uint8Array(r);return Object.setPrototypeOf(e,we.prototype),e}function we(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return i4(r)}return aK(r,e,t)}we.poolSize=8192;function aK(r,e,t){if(typeof r=="string")return Bke(r,e);if(ArrayBuffer.isView(r))return Nke(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(Wa(r,ArrayBuffer)||r&&Wa(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Wa(r,SharedArrayBuffer)||r&&Wa(r.buffer,SharedArrayBuffer)))return n4(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return we.from(i,e,t);var n=Dke(r);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return we.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}we.from=function(r,e,t){return aK(r,e,t)};Object.setPrototypeOf(we.prototype,Uint8Array.prototype);Object.setPrototypeOf(we,Uint8Array);function cK(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function qke(r,e,t){return cK(r),r<=0?zc(r):e!==void 0?typeof t=="string"?zc(r).fill(e,t):zc(r).fill(e):zc(r)}we.alloc=function(r,e,t){return qke(r,e,t)};function i4(r){return cK(r),zc(r<0?0:s4(r)|0)}we.allocUnsafe=function(r){return i4(r)};we.allocUnsafeSlow=function(r){return i4(r)};function Bke(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!we.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var t=uK(r,e)|0,i=zc(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function o4(r){for(var e=r.length<0?0:s4(r.length)|0,t=zc(e),i=0;i<e;i+=1)t[i]=r[i]&255;return t}function Nke(r){if(Wa(r,Uint8Array)){var e=new Uint8Array(r);return n4(e.buffer,e.byteOffset,e.byteLength)}return o4(r)}function n4(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');var i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,we.prototype),i}function Dke(r){if(we.isBuffer(r)){var e=s4(r.length)|0,t=zc(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||a4(r.length)?zc(0):o4(r);if(r.type==="Buffer"&&Array.isArray(r.data))return o4(r.data)}function s4(r){if(r>=R2)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+R2.toString(16)+" bytes");return r|0}function Pke(r){return+r!=r&&(r=0),we.alloc(+r)}we.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==we.prototype};we.compare=function(e,t){if(Wa(e,Uint8Array)&&(e=we.from(e,e.offset,e.byteLength)),Wa(t,Uint8Array)&&(t=we.from(t,t.offset,t.byteLength)),!we.isBuffer(e)||!we.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,n=t.length,s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0};we.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};we.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return we.alloc(0);var i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=we.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){var o=e[i];if(Wa(o,Uint8Array))s+o.length>n.length?we.from(o).copy(n,s):Uint8Array.prototype.set.call(n,o,s);else if(we.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function uK(r,e){if(we.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||Wa(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);var t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return c4(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return fK(r).length;default:if(n)return i?-1:c4(r).length;e=(""+e).toLowerCase(),n=!0}}we.byteLength=uK;function jke(r,e,t){var i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return Uke(this,e,t);case"utf8":case"utf-8":return lK(this,e,t);case"ascii":return Lke(this,e,t);case"latin1":case"binary":return Fke(this,e,t);case"base64":return Mke(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Kke(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}we.prototype._isBuffer=!0;function gl(r,e,t){var i=r[e];r[e]=r[t],r[t]=i}we.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)gl(this,t,t+1);return this};we.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)gl(this,t,t+3),gl(this,t+1,t+2);return this};we.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)gl(this,t,t+7),gl(this,t+1,t+6),gl(this,t+2,t+5),gl(this,t+3,t+4);return this};we.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?lK(this,0,e):jke.apply(this,arguments)};we.prototype.toLocaleString=we.prototype.toString;we.prototype.equals=function(e){if(!we.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:we.compare(this,e)===0};we.prototype.inspect=function(){var e="",t=Pd.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};oK&&(we.prototype[oK]=we.prototype.inspect);we.prototype.compare=function(e,t,i,n,s){if(Wa(e,Uint8Array)&&(e=we.from(e,e.offset,e.byteLength)),!we.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;for(var o=s-n,a=i-t,c=Math.min(o,a),u=this.slice(n,s),f=e.slice(t,i),h=0;h<c;++h)if(u[h]!==f[h]){o=u[h],a=f[h];break}return o<a?-1:a<o?1:0};function dK(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,a4(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=we.from(e,i)),we.isBuffer(e))return e.length===0?-1:hK(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):hK(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function hK(r,e,t,i,n){var s=1,o=r.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,o/=2,a/=2,t/=2}function c(y,g){return s===1?y[g]:y.readUInt16BE(g*s)}var u;if(n){var f=-1;for(u=t;u<o;u++)if(c(r,u)===c(e,f===-1?0:u-f)){if(f===-1&&(f=u),u-f+1===a)return f*s}else f!==-1&&(u-=u-f),f=-1}else for(t+a>o&&(t=o-a),u=t;u>=0;u--){for(var h=!0,d=0;d<a;d++)if(c(r,u+d)!==c(e,d)){h=!1;break}if(h)return u}return-1}we.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};we.prototype.indexOf=function(e,t,i){return dK(this,e,t,i,!0)};we.prototype.lastIndexOf=function(e,t,i){return dK(this,e,t,i,!1)};function Vke(r,e,t,i){t=Number(t)||0;var n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;var s=e.length;i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(o*2,2),16);if(a4(a))return o;r[t+o]=a}return o}function zke(r,e,t,i){return k2(c4(e,r.length-t),r,t,i)}function Gke(r,e,t,i){return k2(Hke(e),r,t,i)}function $ke(r,e,t,i){return k2(fK(e),r,t,i)}function Yke(r,e,t,i){return k2(Wke(e,r.length-t),r,t,i)}we.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return Vke(this,e,t,i);case"utf8":case"utf-8":return zke(this,e,t,i);case"ascii":case"latin1":case"binary":return Gke(this,e,t,i);case"base64":return $ke(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Yke(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};we.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Mke(r,e,t){return e===0&&t===r.length?r4.fromByteArray(r):r4.fromByteArray(r.slice(e,t))}function lK(r,e,t){t=Math.min(r.length,t);for(var i=[],n=e;n<t;){var s=r[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=t){var c,u,f,h;switch(a){case 1:s<128&&(o=s);break;case 2:c=r[n+1],(c&192)==128&&(h=(s&31)<<6|c&63,h>127&&(o=h));break;case 3:c=r[n+1],u=r[n+2],(c&192)==128&&(u&192)==128&&(h=(s&15)<<12|(c&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:c=r[n+1],u=r[n+2],f=r[n+3],(c&192)==128&&(u&192)==128&&(f&192)==128&&(h=(s&15)<<18|(c&63)<<12|(u&63)<<6|f&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return Xke(i)}var pK=4096;function Xke(r){var e=r.length;if(e<=pK)return String.fromCharCode.apply(String,r);for(var t="",i=0;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=pK));return t}function Lke(r,e,t){var i="";t=Math.min(r.length,t);for(var n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function Fke(r,e,t){var i="";t=Math.min(r.length,t);for(var n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function Uke(r,e,t){var i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);for(var n="",s=e;s<t;++s)n+=Jke[r[s]];return n}function Kke(r,e,t){for(var i=r.slice(e,t),n="",s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}we.prototype.slice=function(e,t){var i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,we.prototype),n};function Gi(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}we.prototype.readUintLE=we.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Gi(e,t,this.length);for(var n=this[e],s=1,o=0;++o<t&&(s*=256);)n+=this[e+o]*s;return n};we.prototype.readUintBE=we.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Gi(e,t,this.length);for(var n=this[e+--t],s=1;t>0&&(s*=256);)n+=this[e+--t]*s;return n};we.prototype.readUint8=we.prototype.readUInt8=function(e,t){return e=e>>>0,t||Gi(e,1,this.length),this[e]};we.prototype.readUint16LE=we.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||Gi(e,2,this.length),this[e]|this[e+1]<<8};we.prototype.readUint16BE=we.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||Gi(e,2,this.length),this[e]<<8|this[e+1]};we.prototype.readUint32LE=we.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||Gi(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};we.prototype.readUint32BE=we.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||Gi(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};we.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Gi(e,t,this.length);for(var n=this[e],s=1,o=0;++o<t&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n};we.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Gi(e,t,this.length);for(var n=t,s=1,o=this[e+--n];n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};we.prototype.readInt8=function(e,t){return e=e>>>0,t||Gi(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};we.prototype.readInt16LE=function(e,t){e=e>>>0,t||Gi(e,2,this.length);var i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};we.prototype.readInt16BE=function(e,t){e=e>>>0,t||Gi(e,2,this.length);var i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};we.prototype.readInt32LE=function(e,t){return e=e>>>0,t||Gi(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};we.prototype.readInt32BE=function(e,t){return e=e>>>0,t||Gi(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};we.prototype.readFloatLE=function(e,t){return e=e>>>0,t||Gi(e,4,this.length),Od.read(this,e,!0,23,4)};we.prototype.readFloatBE=function(e,t){return e=e>>>0,t||Gi(e,4,this.length),Od.read(this,e,!1,23,4)};we.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||Gi(e,8,this.length),Od.read(this,e,!0,52,8)};we.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||Gi(e,8,this.length),Od.read(this,e,!1,52,8)};function Qn(r,e,t,i,n,s){if(!we.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}we.prototype.writeUintLE=we.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){var s=Math.pow(2,8*i)-1;Qn(this,e,t,i,s,0)}var o=1,a=0;for(this[t]=e&255;++a<i&&(o*=256);)this[t+a]=e/o&255;return t+i};we.prototype.writeUintBE=we.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){var s=Math.pow(2,8*i)-1;Qn(this,e,t,i,s,0)}var o=i-1,a=1;for(this[t+o]=e&255;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+i};we.prototype.writeUint8=we.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,1,255,0),this[t]=e&255,t+1};we.prototype.writeUint16LE=we.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};we.prototype.writeUint16BE=we.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};we.prototype.writeUint32LE=we.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};we.prototype.writeUint32BE=we.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};we.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){var s=Math.pow(2,8*i-1);Qn(this,e,t,i,s-1,-s)}var o=0,a=1,c=0;for(this[t]=e&255;++o<i&&(a*=256);)e<0&&c===0&&this[t+o-1]!==0&&(c=1),this[t+o]=(e/a>>0)-c&255;return t+i};we.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){var s=Math.pow(2,8*i-1);Qn(this,e,t,i,s-1,-s)}var o=i-1,a=1,c=0;for(this[t+o]=e&255;--o>=0&&(a*=256);)e<0&&c===0&&this[t+o+1]!==0&&(c=1),this[t+o]=(e/a>>0)-c&255;return t+i};we.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};we.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};we.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};we.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};we.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Qn(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function yK(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function gK(r,e,t,i,n){return e=+e,t=t>>>0,n||yK(r,e,t,4,34028234663852886e22,-34028234663852886e22),Od.write(r,e,t,i,23,4),t+4}we.prototype.writeFloatLE=function(e,t,i){return gK(this,e,t,!0,i)};we.prototype.writeFloatBE=function(e,t,i){return gK(this,e,t,!1,i)};function bK(r,e,t,i,n){return e=+e,t=t>>>0,n||yK(r,e,t,8,17976931348623157e292,-17976931348623157e292),Od.write(r,e,t,i,52,8),t+8}we.prototype.writeDoubleLE=function(e,t,i){return bK(this,e,t,!0,i)};we.prototype.writeDoubleBE=function(e,t,i){return bK(this,e,t,!1,i)};we.prototype.copy=function(e,t,i,n){if(!we.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s};we.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!we.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){var s=e.charCodeAt(0);(n==="utf8"&&s<128||n==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);var o;if(typeof e=="number")for(o=t;o<i;++o)this[o]=e;else{var a=we.isBuffer(e)?e:we.from(e,n),c=a.length;if(c===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<i-t;++o)this[o+t]=a[o%c]}return this};var Qke=/[^+/0-9A-Za-z-_]/g;function Zke(r){if(r=r.split("=")[0],r=r.trim().replace(Qke,""),r.length<2)return"";for(;r.length%4!=0;)r=r+"=";return r}function c4(r,e){e=e||Infinity;for(var t,i=r.length,n=null,s=[],o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function Hke(r){for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Wke(r,e){for(var t,i,n,s=[],o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function fK(r){return r4.toByteArray(Zke(r))}function k2(r,e,t,i){for(var n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function Wa(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function a4(r){return r!==r}var Jke=function(){for(var r="0123456789abcdef",e=new Array(256),t=0;t<16;++t)for(var i=t*16,n=0;n<16;++n)e[i+n]=r[t]+r[n];return e}()});var Ya=p((mK,C2)=>{l();(function(r){"use strict";var e,t=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,n=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,d=1e9;function y(W){var z,Z,ee,re=J.prototype={constructor:J,toString:null,valueOf:null},L=new J(1),b=20,w=4,R=-7,B=21,U=-1e7,Q=1e7,G=!1,M=1,v=0,V={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},de="0123456789abcdefghijklmnopqrstuvwxyz";function J(E,I){var j,H,T,K,F,N,Y,ne,te=this;if(!(te instanceof J))return new J(E,I);if(I==null){if(E&&E._isBigNumber===!0){te.s=E.s,!E.c||E.e>Q?te.c=te.e=null:E.e<U?te.c=[te.e=0]:(te.e=E.e,te.c=E.c.slice());return}if((N=typeof E=="number")&&E*0==0){if(te.s=1/E<0?(E=-E,-1):1,E===~~E){for(K=0,F=E;F>=10;F/=10,K++);K>Q?te.c=te.e=null:(te.e=K,te.c=[E]);return}ne=String(E)}else{if(!t.test(ne=String(E)))return ee(te,ne,N);te.s=ne.charCodeAt(0)==45?(ne=ne.slice(1),-1):1}(K=ne.indexOf("."))>-1&&(ne=ne.replace(".","")),(F=ne.search(/e/i))>0?(K<0&&(K=F),K+=+ne.slice(F+1),ne=ne.substring(0,F)):K<0&&(K=ne.length)}else{if(_(I,2,de.length,"Base"),I==10)return te=new J(E),ie(te,b+te.e+1,w);if(ne=String(E),N=typeof E=="number"){if(E*0!=0)return ee(te,ne,N,I);if(te.s=1/E<0?(ne=ne.slice(1),-1):1,J.DEBUG&&ne.replace(/^0\.0*|\./,"").length>15)throw Error(o+E)}else te.s=ne.charCodeAt(0)===45?(ne=ne.slice(1),-1):1;for(j=de.slice(0,I),K=F=0,Y=ne.length;F<Y;F++)if(j.indexOf(H=ne.charAt(F))<0){if(H=="."){if(F>K){K=Y;continue}}else if(!T&&(ne==ne.toUpperCase()&&(ne=ne.toLowerCase())||ne==ne.toLowerCase()&&(ne=ne.toUpperCase()))){T=!0,F=-1,K=0;continue}return ee(te,String(E),N,I)}N=!1,ne=Z(ne,I,10,te.s),(K=ne.indexOf("."))>-1?ne=ne.replace(".",""):K=ne.length}for(F=0;ne.charCodeAt(F)===48;F++);for(Y=ne.length;ne.charCodeAt(--Y)===48;);if(ne=ne.slice(F,++Y)){if(Y-=F,N&&J.DEBUG&&Y>15&&(E>u||E!==n(E)))throw Error(o+te.s*E);if((K=K-F-1)>Q)te.c=te.e=null;else if(K<U)te.c=[te.e=0];else{if(te.e=K,te.c=[],F=(K+1)%c,K<0&&(F+=c),F<Y){for(F&&te.c.push(+ne.slice(0,F)),Y-=c;F<Y;)te.c.push(+ne.slice(F,F+=c));F=c-(ne=ne.slice(F)).length}else F-=Y;for(;F--;ne+="0");te.c.push(+ne)}}else te.c=[te.e=0]}J.clone=y,J.ROUND_UP=0,J.ROUND_DOWN=1,J.ROUND_CEIL=2,J.ROUND_FLOOR=3,J.ROUND_HALF_UP=4,J.ROUND_HALF_DOWN=5,J.ROUND_HALF_EVEN=6,J.ROUND_HALF_CEIL=7,J.ROUND_HALF_FLOOR=8,J.EUCLID=9,J.config=J.set=function(E){var I,j;if(E!=null)if(typeof E=="object"){if(E.hasOwnProperty(I="DECIMAL_PLACES")&&(j=E[I],_(j,0,d,I),b=j),E.hasOwnProperty(I="ROUNDING_MODE")&&(j=E[I],_(j,0,8,I),w=j),E.hasOwnProperty(I="EXPONENTIAL_AT")&&(j=E[I],j&&j.pop?(_(j[0],-d,0,I),_(j[1],0,d,I),R=j[0],B=j[1]):(_(j,-d,d,I),R=-(B=j<0?-j:j))),E.hasOwnProperty(I="RANGE"))if(j=E[I],j&&j.pop)_(j[0],-d,-1,I),_(j[1],1,d,I),U=j[0],Q=j[1];else if(_(j,-d,d,I),j)U=-(Q=j<0?-j:j);else throw Error(s+I+" cannot be zero: "+j);if(E.hasOwnProperty(I="CRYPTO"))if(j=E[I],j===!!j)if(j)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))G=j;else throw G=!j,Error(s+"crypto unavailable");else G=j;else throw Error(s+I+" not true or false: "+j);if(E.hasOwnProperty(I="MODULO_MODE")&&(j=E[I],_(j,0,9,I),M=j),E.hasOwnProperty(I="POW_PRECISION")&&(j=E[I],_(j,0,d,I),v=j),E.hasOwnProperty(I="FORMAT"))if(j=E[I],typeof j=="object")V=j;else throw Error(s+I+" not an object: "+j);if(E.hasOwnProperty(I="ALPHABET"))if(j=E[I],typeof j=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(j))de=j;else throw Error(s+I+" invalid: "+j)}else throw Error(s+"Object expected: "+E);return{DECIMAL_PLACES:b,ROUNDING_MODE:w,EXPONENTIAL_AT:[R,B],RANGE:[U,Q],CRYPTO:G,MODULO_MODE:M,POW_PRECISION:v,FORMAT:V,ALPHABET:de}},J.isBigNumber=function(E){if(!E||E._isBigNumber!==!0)return!1;if(!J.DEBUG)return!0;var I,j,H=E.c,T=E.e,K=E.s;e:if({}.toString.call(H)=="[object Array]"){if((K===1||K===-1)&&T>=-d&&T<=d&&T===n(T)){if(H[0]===0){if(T===0&&H.length===1)return!0;break e}if(I=(T+1)%c,I<1&&(I+=c),String(H[0]).length==I){for(I=0;I<H.length;I++)if(j=H[I],j<0||j>=a||j!==n(j))break e;if(j!==0)return!0}}}else if(H===null&&T===null&&(K===null||K===1||K===-1))return!0;throw Error(s+"Invalid BigNumber: "+E)},J.maximum=J.max=function(){return S(arguments,re.lt)},J.minimum=J.min=function(){return S(arguments,re.gt)},J.random=function(){var E=9007199254740992,I=Math.random()*E&2097151?function(){return n(Math.random()*E)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(j){var H,T,K,F,N,Y=0,ne=[],te=new J(L);if(j==null?j=b:_(j,0,d),F=i(j/c),G)if(crypto.getRandomValues){for(H=crypto.getRandomValues(new Uint32Array(F*=2));Y<F;)N=H[Y]*131072+(H[Y+1]>>>11),N>=9e15?(T=crypto.getRandomValues(new Uint32Array(2)),H[Y]=T[0],H[Y+1]=T[1]):(ne.push(N%1e14),Y+=2);Y=F/2}else if(crypto.randomBytes){for(H=crypto.randomBytes(F*=7);Y<F;)N=(H[Y]&31)*281474976710656+H[Y+1]*1099511627776+H[Y+2]*4294967296+H[Y+3]*16777216+(H[Y+4]<<16)+(H[Y+5]<<8)+H[Y+6],N>=9e15?crypto.randomBytes(7).copy(H,Y):(ne.push(N%1e14),Y+=7);Y=F/7}else throw G=!1,Error(s+"crypto unavailable");if(!G)for(;Y<F;)N=I(),N<9e15&&(ne[Y++]=N%1e14);for(F=ne[--Y],j%=c,F&&j&&(N=f[c-j],ne[Y]=n(F/N)*N);ne[Y]===0;ne.pop(),Y--);if(Y<0)ne=[K=0];else{for(K=-1;ne[0]===0;ne.splice(0,1),K-=c);for(Y=1,N=ne[0];N>=10;N/=10,Y++);Y<c&&(K-=c-Y)}return te.e=K,te.c=ne,te}}(),J.sum=function(){for(var E=1,I=arguments,j=new J(I[0]);E<I.length;)j=j.plus(I[E++]);return j},Z=function(){var E="0123456789";function I(j,H,T,K){for(var F,N=[0],Y,ne=0,te=j.length;ne<te;){for(Y=N.length;Y--;N[Y]*=H);for(N[0]+=K.indexOf(j.charAt(ne++)),F=0;F<N.length;F++)N[F]>T-1&&(N[F+1]==null&&(N[F+1]=0),N[F+1]+=N[F]/T|0,N[F]%=T)}return N.reverse()}return function(j,H,T,K,F){var N,Y,ne,te,he,me,fe,je,Ae=j.indexOf("."),Ve=b,Xe=w;for(Ae>=0&&(te=v,v=0,j=j.replace(".",""),je=new J(H),me=je.pow(j.length-Ae),v=te,je.c=I(X(m(me.c),me.e,"0"),10,T,E),je.e=je.c.length),fe=I(j,H,T,F?(N=de,E):(N=E,de)),ne=te=fe.length;fe[--te]==0;fe.pop());if(!fe[0])return N.charAt(0);if(Ae<0?--ne:(me.c=fe,me.e=ne,me.s=K,me=z(me,je,Ve,Xe,T),fe=me.c,he=me.r,ne=me.e),Y=ne+Ve+1,Ae=fe[Y],te=T/2,he=he||Y<0||fe[Y+1]!=null,he=Xe<4?(Ae!=null||he)&&(Xe==0||Xe==(me.s<0?3:2)):Ae>te||Ae==te&&(Xe==4||he||Xe==6&&fe[Y-1]&1||Xe==(me.s<0?8:7)),Y<1||!fe[0])j=he?X(N.charAt(1),-Ve,N.charAt(0)):N.charAt(0);else{if(fe.length=Y,he)for(--T;++fe[--Y]>T;)fe[Y]=0,Y||(++ne,fe=[1].concat(fe));for(te=fe.length;!fe[--te];);for(Ae=0,j="";Ae<=te;j+=N.charAt(fe[Ae++]));j=X(j,ne,N.charAt(0))}return j}}(),z=function(){function E(H,T,K){var F,N,Y,ne,te=0,he=H.length,me=T%h,fe=T/h|0;for(H=H.slice();he--;)Y=H[he]%h,ne=H[he]/h|0,F=fe*Y+ne*me,N=me*Y+F%h*h+te,te=(N/K|0)+(F/h|0)+fe*ne,H[he]=N%K;return te&&(H=[te].concat(H)),H}function I(H,T,K,F){var N,Y;if(K!=F)Y=K>F?1:-1;else for(N=Y=0;N<K;N++)if(H[N]!=T[N]){Y=H[N]>T[N]?1:-1;break}return Y}function j(H,T,K,F){for(var N=0;K--;)H[K]-=N,N=H[K]<T[K]?1:0,H[K]=N*F+H[K]-T[K];for(;!H[0]&&H.length>1;H.splice(0,1));}return function(H,T,K,F,N){var Y,ne,te,he,me,fe,je,Ae,Ve,Xe,Ge,ve,at,St,kt,Fr,mt,Ie=H.s==T.s?1:-1,tr=H.c,Ze=T.c;if(!tr||!tr[0]||!Ze||!Ze[0])return new J(!H.s||!T.s||(tr?Ze&&tr[0]==Ze[0]:!Ze)?NaN:tr&&tr[0]==0||!Ze?Ie*0:Ie/0);for(Ae=new J(Ie),Ve=Ae.c=[],ne=H.e-T.e,Ie=K+ne+1,N||(N=a,ne=g(H.e/c)-g(T.e/c),Ie=Ie/c|0),te=0;Ze[te]==(tr[te]||0);te++);if(Ze[te]>(tr[te]||0)&&ne--,Ie<0)Ve.push(1),he=!0;else{for(St=tr.length,Fr=Ze.length,te=0,Ie+=2,me=n(N/(Ze[0]+1)),me>1&&(Ze=E(Ze,me,N),tr=E(tr,me,N),Fr=Ze.length,St=tr.length),at=Fr,Xe=tr.slice(0,Fr),Ge=Xe.length;Ge<Fr;Xe[Ge++]=0);mt=Ze.slice(),mt=[0].concat(mt),kt=Ze[0],Ze[1]>=N/2&&kt++;do{if(me=0,Y=I(Ze,Xe,Fr,Ge),Y<0){if(ve=Xe[0],Fr!=Ge&&(ve=ve*N+(Xe[1]||0)),me=n(ve/kt),me>1)for(me>=N&&(me=N-1),fe=E(Ze,me,N),je=fe.length,Ge=Xe.length;I(fe,Xe,je,Ge)==1;)me--,j(fe,Fr<je?mt:Ze,je,N),je=fe.length,Y=1;else me==0&&(Y=me=1),fe=Ze.slice(),je=fe.length;if(je<Ge&&(fe=[0].concat(fe)),j(Xe,fe,Ge,N),Ge=Xe.length,Y==-1)for(;I(Ze,Xe,Fr,Ge)<1;)me++,j(Xe,Fr<Ge?mt:Ze,Ge,N),Ge=Xe.length}else Y===0&&(me++,Xe=[0]);Ve[te++]=me,Xe[0]?Xe[Ge++]=tr[at]||0:(Xe=[tr[at]],Ge=1)}while((at++<St||Xe[0]!=null)&&Ie--);he=Xe[0]!=null,Ve[0]||Ve.splice(0,1)}if(N==a){for(te=1,Ie=Ve[0];Ie>=10;Ie/=10,te++);ie(Ae,K+(Ae.e=te+ne*c-1)+1,F,he)}else Ae.e=ne,Ae.r=+he;return Ae}}();function ue(E,I,j,H){var T,K,F,N,Y;if(j==null?j=w:_(j,0,8),!E.c)return E.toString();if(T=E.c[0],F=E.e,I==null)Y=m(E.c),Y=H==1||H==2&&(F<=R||F>=B)?q(Y,F):X(Y,F,"0");else if(E=ie(new J(E),I,j),K=E.e,Y=m(E.c),N=Y.length,H==1||H==2&&(I<=K||K<=R)){for(;N<I;Y+="0",N++);Y=q(Y,K)}else if(I-=F,Y=X(Y,K,"0"),K+1>N){if(--I>0)for(Y+=".";I--;Y+="0");}else if(I+=K-N,I>0)for(K+1==N&&(Y+=".");I--;Y+="0");return E.s<0&&T?"-"+Y:Y}function S(E,I){for(var j,H=1,T=new J(E[0]);H<E.length;H++)if(j=new J(E[H]),j.s)I.call(T,j)&&(T=j);else{T=j;break}return T}function A(E,I,j){for(var H=1,T=I.length;!I[--T];I.pop());for(T=I[0];T>=10;T/=10,H++);return(j=H+j*c-1)>Q?E.c=E.e=null:j<U?E.c=[E.e=0]:(E.e=j,E.c=I),E}ee=function(){var E=/^(-?)0([xbo])(?=\w[\w.]*$)/i,I=/^([^.]+)\.$/,j=/^\.([^.]+)$/,H=/^-?(Infinity|NaN)$/,T=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(K,F,N,Y){var ne,te=N?F:F.replace(T,"");if(H.test(te))K.s=isNaN(te)?null:te<0?-1:1;else{if(!N&&(te=te.replace(E,function(he,me,fe){return ne=(fe=fe.toLowerCase())=="x"?16:fe=="b"?2:8,!Y||Y==ne?me:he}),Y&&(ne=Y,te=te.replace(I,"$1").replace(j,"0.$1")),F!=te))return new J(te,ne);if(J.DEBUG)throw Error(s+"Not a"+(Y?" base "+Y:"")+" number: "+F);K.s=null}K.c=K.e=null}}();function ie(E,I,j,H){var T,K,F,N,Y,ne,te,he=E.c,me=f;if(he){e:{for(T=1,N=he[0];N>=10;N/=10,T++);if(K=I-T,K<0)K+=c,F=I,Y=he[ne=0],te=Y/me[T-F-1]%10|0;else if(ne=i((K+1)/c),ne>=he.length)if(H){for(;he.length<=ne;he.push(0));Y=te=0,T=1,K%=c,F=K-c+1}else break e;else{for(Y=N=he[ne],T=1;N>=10;N/=10,T++);K%=c,F=K-c+T,te=F<0?0:Y/me[T-F-1]%10|0}if(H=H||I<0||he[ne+1]!=null||(F<0?Y:Y%me[T-F-1]),H=j<4?(te||H)&&(j==0||j==(E.s<0?3:2)):te>5||te==5&&(j==4||H||j==6&&(K>0?F>0?Y/me[T-F]:0:he[ne-1])%10&1||j==(E.s<0?8:7)),I<1||!he[0])return he.length=0,H?(I-=E.e+1,he[0]=me[(c-I%c)%c],E.e=-I||0):he[0]=E.e=0,E;if(K==0?(he.length=ne,N=1,ne--):(he.length=ne+1,N=me[c-K],he[ne]=F>0?n(Y/me[T-F]%me[F])*N:0),H)for(;;)if(ne==0){for(K=1,F=he[0];F>=10;F/=10,K++);for(F=he[0]+=N,N=1;F>=10;F/=10,N++);K!=N&&(E.e++,he[0]==a&&(he[0]=1));break}else{if(he[ne]+=N,he[ne]!=a)break;he[ne--]=0,N=1}for(K=he.length;he[--K]===0;he.pop());}E.e>Q?E.c=E.e=null:E.e<U&&(E.c=[E.e=0])}return E}function ae(E){var I,j=E.e;return j===null?E.toString():(I=m(E.c),I=j<=R||j>=B?q(I,j):X(I,j,"0"),E.s<0?"-"+I:I)}return re.absoluteValue=re.abs=function(){var E=new J(this);return E.s<0&&(E.s=1),E},re.comparedTo=function(E,I){return x(this,new J(E,I))},re.decimalPlaces=re.dp=function(E,I){var j,H,T,K=this;if(E!=null)return _(E,0,d),I==null?I=w:_(I,0,8),ie(new J(K),E+K.e+1,I);if(!(j=K.c))return null;if(H=((T=j.length-1)-g(this.e/c))*c,T=j[T])for(;T%10==0;T/=10,H--);return H<0&&(H=0),H},re.dividedBy=re.div=function(E,I){return z(this,new J(E,I),b,w)},re.dividedToIntegerBy=re.idiv=function(E,I){return z(this,new J(E,I),0,1)},re.exponentiatedBy=re.pow=function(E,I){var j,H,T,K,F,N,Y,ne,te,he=this;if(E=new J(E),E.c&&!E.isInteger())throw Error(s+"Exponent not an integer: "+ae(E));if(I!=null&&(I=new J(I)),N=E.e>14,!he.c||!he.c[0]||he.c[0]==1&&!he.e&&he.c.length==1||!E.c||!E.c[0])return te=new J(Math.pow(+ae(he),N?2-P(E):+ae(E))),I?te.mod(I):te;if(Y=E.s<0,I){if(I.c?!I.c[0]:!I.s)return new J(NaN);H=!Y&&he.isInteger()&&I.isInteger(),H&&(he=he.mod(I))}else{if(E.e>9&&(he.e>0||he.e<-1||(he.e==0?he.c[0]>1||N&&he.c[1]>=24e7:he.c[0]<8e13||N&&he.c[0]<=9999975e7)))return K=(he.s<0&&P(E),-0),he.e>-1&&(K=1/K),new J(Y?1/K:K);v&&(K=i(v/c+2))}for(N?(j=new J(.5),Y&&(E.s=1),ne=P(E)):(T=Math.abs(+ae(E)),ne=T%2),te=new J(L);;){if(ne){if(te=te.times(he),!te.c)break;K?te.c.length>K&&(te.c.length=K):H&&(te=te.mod(I))}if(T){if(T=n(T/2),T===0)break;ne=T%2}else if(E=E.times(j),ie(E,E.e+1,1),E.e>14)ne=P(E);else{if(T=+ae(E),T===0)break;ne=T%2}he=he.times(he),K?he.c&&he.c.length>K&&(he.c.length=K):H&&(he=he.mod(I))}return H?te:(Y&&(te=L.div(te)),I?te.mod(I):K?ie(te,v,w,F):te)},re.integerValue=function(E){var I=new J(this);return E==null?E=w:_(E,0,8),ie(I,I.e+1,E)},re.isEqualTo=re.eq=function(E,I){return x(this,new J(E,I))===0},re.isFinite=function(){return!!this.c},re.isGreaterThan=re.gt=function(E,I){return x(this,new J(E,I))>0},re.isGreaterThanOrEqualTo=re.gte=function(E,I){return(I=x(this,new J(E,I)))===1||I===0},re.isInteger=function(){return!!this.c&&g(this.e/c)>this.c.length-2},re.isLessThan=re.lt=function(E,I){return x(this,new J(E,I))<0},re.isLessThanOrEqualTo=re.lte=function(E,I){return(I=x(this,new J(E,I)))===-1||I===0},re.isNaN=function(){return!this.s},re.isNegative=function(){return this.s<0},re.isPositive=function(){return this.s>0},re.isZero=function(){return!!this.c&&this.c[0]==0},re.minus=function(E,I){var j,H,T,K,F=this,N=F.s;if(E=new J(E,I),I=E.s,!N||!I)return new J(NaN);if(N!=I)return E.s=-I,F.plus(E);var Y=F.e/c,ne=E.e/c,te=F.c,he=E.c;if(!Y||!ne){if(!te||!he)return te?(E.s=-I,E):new J(he?F:NaN);if(!te[0]||!he[0])return he[0]?(E.s=-I,E):new J(te[0]?F:(w==3,-0))}if(Y=g(Y),ne=g(ne),te=te.slice(),N=Y-ne){for((K=N<0)?(N=-N,T=te):(ne=Y,T=he),T.reverse(),I=N;I--;T.push(0));T.reverse()}else for(H=(K=(N=te.length)<(I=he.length))?N:I,N=I=0;I<H;I++)if(te[I]!=he[I]){K=te[I]<he[I];break}if(K&&(T=te,te=he,he=T,E.s=-E.s),I=(H=he.length)-(j=te.length),I>0)for(;I--;te[j++]=0);for(I=a-1;H>N;){if(te[--H]<he[H]){for(j=H;j&&!te[--j];te[j]=I);--te[j],te[H]+=a}te[H]-=he[H]}for(;te[0]==0;te.splice(0,1),--ne);return te[0]?A(E,te,ne):(E.s=w==3?-1:1,E.c=[E.e=0],E)},re.modulo=re.mod=function(E,I){var j,H,T=this;return E=new J(E,I),!T.c||!E.s||E.c&&!E.c[0]?new J(NaN):!E.c||T.c&&!T.c[0]?new J(T):(M==9?(H=E.s,E.s=1,j=z(T,E,0,3),E.s=H,j.s*=H):j=z(T,E,0,M),E=T.minus(j.times(E)),!E.c[0]&&M==1&&(E.s=T.s),E)},re.multipliedBy=re.times=function(E,I){var j,H,T,K,F,N,Y,ne,te,he,me,fe,je,Ae,Ve,Xe=this,Ge=Xe.c,ve=(E=new J(E,I)).c;if(!Ge||!ve||!Ge[0]||!ve[0])return!Xe.s||!E.s||Ge&&!Ge[0]&&!ve||ve&&!ve[0]&&!Ge?E.c=E.e=E.s=null:(E.s*=Xe.s,!Ge||!ve?E.c=E.e=null:(E.c=[0],E.e=0)),E;for(H=g(Xe.e/c)+g(E.e/c),E.s*=Xe.s,Y=Ge.length,he=ve.length,Y<he&&(je=Ge,Ge=ve,ve=je,T=Y,Y=he,he=T),T=Y+he,je=[];T--;je.push(0));for(Ae=a,Ve=h,T=he;--T>=0;){for(j=0,me=ve[T]%Ve,fe=ve[T]/Ve|0,F=Y,K=T+F;K>T;)ne=Ge[--F]%Ve,te=Ge[F]/Ve|0,N=fe*ne+te*me,ne=me*ne+N%Ve*Ve+je[K]+j,j=(ne/Ae|0)+(N/Ve|0)+fe*te,je[K--]=ne%Ae;je[K]=j}return j?++H:je.splice(0,1),A(E,je,H)},re.negated=function(){var E=new J(this);return E.s=-E.s||null,E},re.plus=function(E,I){var j,H=this,T=H.s;if(E=new J(E,I),I=E.s,!T||!I)return new J(NaN);if(T!=I)return E.s=-I,H.minus(E);var K=H.e/c,F=E.e/c,N=H.c,Y=E.c;if(!K||!F){if(!N||!Y)return new J(T/0);if(!N[0]||!Y[0])return Y[0]?E:new J(N[0]?H:T*0)}if(K=g(K),F=g(F),N=N.slice(),T=K-F){for(T>0?(F=K,j=Y):(T=-T,j=N),j.reverse();T--;j.push(0));j.reverse()}for(T=N.length,I=Y.length,T-I<0&&(j=Y,Y=N,N=j,I=T),T=0;I;)T=(N[--I]=N[I]+Y[I]+T)/a|0,N[I]=a===N[I]?0:N[I]%a;return T&&(N=[T].concat(N),++F),A(E,N,F)},re.precision=re.sd=function(E,I){var j,H,T,K=this;if(E!=null&&E!==!!E)return _(E,1,d),I==null?I=w:_(I,0,8),ie(new J(K),E,I);if(!(j=K.c))return null;if(T=j.length-1,H=T*c+1,T=j[T]){for(;T%10==0;T/=10,H--);for(T=j[0];T>=10;T/=10,H++);}return E&&K.e+1>H&&(H=K.e+1),H},re.shiftedBy=function(E){return _(E,-u,u),this.times("1e"+E)},re.squareRoot=re.sqrt=function(){var E,I,j,H,T,K=this,F=K.c,N=K.s,Y=K.e,ne=b+4,te=new J("0.5");if(N!==1||!F||!F[0])return new J(!N||N<0&&(!F||F[0])?NaN:F?K:1/0);if(N=Math.sqrt(+ae(K)),N==0||N==1/0?(I=m(F),(I.length+Y)%2==0&&(I+="0"),N=Math.sqrt(+I),Y=g((Y+1)/2)-(Y<0||Y%2),N==1/0?I="5e"+Y:(I=N.toExponential(),I=I.slice(0,I.indexOf("e")+1)+Y),j=new J(I)):j=new J(N+""),j.c[0]){for(Y=j.e,N=Y+ne,N<3&&(N=0);;)if(T=j,j=te.times(T.plus(z(K,T,ne,1))),m(T.c).slice(0,N)===(I=m(j.c)).slice(0,N))if(j.e<Y&&--N,I=I.slice(N-3,N+1),I=="9999"||!H&&I=="4999"){if(!H&&(ie(T,T.e+b+2,0),T.times(T).eq(K))){j=T;break}ne+=4,N+=4,H=1}else{(!+I||!+I.slice(1)&&I.charAt(0)=="5")&&(ie(j,j.e+b+2,1),E=!j.times(j).eq(K));break}}return ie(j,j.e+b+1,w,E)},re.toExponential=function(E,I){return E!=null&&(_(E,0,d),E++),ue(this,E,I,1)},re.toFixed=function(E,I){return E!=null&&(_(E,0,d),E=E+this.e+1),ue(this,E,I)},re.toFormat=function(E,I,j){var H,T=this;if(j==null)E!=null&&I&&typeof I=="object"?(j=I,I=null):E&&typeof E=="object"?(j=E,E=I=null):j=V;else if(typeof j!="object")throw Error(s+"Argument not an object: "+j);if(H=T.toFixed(E,I),T.c){var K,F=H.split("."),N=+j.groupSize,Y=+j.secondaryGroupSize,ne=j.groupSeparator||"",te=F[0],he=F[1],me=T.s<0,fe=me?te.slice(1):te,je=fe.length;if(Y&&(K=N,N=Y,Y=K,je-=K),N>0&&je>0){for(K=je%N||N,te=fe.substr(0,K);K<je;K+=N)te+=ne+fe.substr(K,N);Y>0&&(te+=ne+fe.slice(K)),me&&(te="-"+te)}H=he?te+(j.decimalSeparator||"")+((Y=+j.fractionGroupSize)?he.replace(new RegExp("\\d{"+Y+"}\\B","g"),"$&"+(j.fractionGroupSeparator||"")):he):te}return(j.prefix||"")+H+(j.suffix||"")},re.toFraction=function(E){var I,j,H,T,K,F,N,Y,ne,te,he,me,fe=this,je=fe.c;if(E!=null&&(N=new J(E),!N.isInteger()&&(N.c||N.s!==1)||N.lt(L)))throw Error(s+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+ae(N));if(!je)return new J(fe);for(I=new J(L),ne=j=new J(L),H=Y=new J(L),me=m(je),K=I.e=me.length-fe.e-1,I.c[0]=f[(F=K%c)<0?c+F:F],E=!E||N.comparedTo(I)>0?K>0?I:ne:N,F=Q,Q=1/0,N=new J(me),Y.c[0]=0;te=z(N,I,0,1),T=j.plus(te.times(H)),T.comparedTo(E)!=1;)j=H,H=T,ne=Y.plus(te.times(T=ne)),Y=T,I=N.minus(te.times(T=I)),N=T;return T=z(E.minus(j),H,0,1),Y=Y.plus(T.times(ne)),j=j.plus(T.times(H)),Y.s=ne.s=fe.s,K=K*2,he=z(ne,H,K,w).minus(fe).abs().comparedTo(z(Y,j,K,w).minus(fe).abs())<1?[ne,H]:[Y,j],Q=F,he},re.toNumber=function(){return+ae(this)},re.toPrecision=function(E,I){return E!=null&&_(E,1,d),ue(this,E,I,2)},re.toString=function(E){var I,j=this,H=j.s,T=j.e;return T===null?H?(I="Infinity",H<0&&(I="-"+I)):I="NaN":(E==null?I=T<=R||T>=B?q(m(j.c),T):X(m(j.c),T,"0"):E===10?(j=ie(new J(j),b+T+1,w),I=X(m(j.c),j.e,"0")):(_(E,2,de.length,"Base"),I=Z(X(m(j.c),T,"0"),10,E,H,!0)),H<0&&j.c[0]&&(I="-"+I)),I},re.valueOf=re.toJSON=function(){return ae(this)},re._isBigNumber=!0,W!=null&&J.set(W),J}function g(W){var z=W|0;return W>0||W===z?z:z-1}function m(W){for(var z,Z,ee=1,re=W.length,L=W[0]+"";ee<re;){for(z=W[ee++]+"",Z=c-z.length;Z--;z="0"+z);L+=z}for(re=L.length;L.charCodeAt(--re)===48;);return L.slice(0,re+1||1)}function x(W,z){var Z,ee,re=W.c,L=z.c,b=W.s,w=z.s,R=W.e,B=z.e;if(!b||!w)return null;if(Z=re&&!re[0],ee=L&&!L[0],Z||ee)return Z?ee?0:-w:b;if(b!=w)return b;if(Z=b<0,ee=R==B,!re||!L)return ee?0:!re^Z?1:-1;if(!ee)return R>B^Z?1:-1;for(w=(R=re.length)<(B=L.length)?R:B,b=0;b<w;b++)if(re[b]!=L[b])return re[b]>L[b]^Z?1:-1;return R==B?0:R>B^Z?1:-1}function _(W,z,Z,ee){if(W<z||W>Z||W!==n(W))throw Error(s+(ee||"Argument")+(typeof W=="number"?W<z||W>Z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(W))}function P(W){var z=W.c.length-1;return g(W.e/c)==z&&W.c[z]%2!=0}function q(W,z){return(W.length>1?W.charAt(0)+"."+W.slice(1):W)+(z<0?"e":"e+")+z}function X(W,z,Z){var ee,re;if(z<0){for(re=Z+".";++z;re+=Z);W=re+W}else if(ee=W.length,++z>ee){for(re=Z,z-=ee;--z;re+=Z);W+=re}else z<ee&&(W=W.slice(0,z)+"."+W.slice(z));return W}e=y(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof C2!="undefined"&&C2.exports?C2.exports=e:(r||(r=typeof self!="undefined"&&self?self:window),r.BigNumber=e)})(mK)});var wK=p((Tbt,vK)=>{l();vK.exports=function(e,t,i){var n=new e.Uint8Array(i),s=t.pushInt,o=t.pushInt32,a=t.pushInt32Neg,c=t.pushInt64,u=t.pushInt64Neg,f=t.pushFloat,h=t.pushFloatSingle,d=t.pushFloatDouble,y=t.pushTrue,g=t.pushFalse,m=t.pushUndefined,x=t.pushNull,_=t.pushInfinity,P=t.pushInfinityNeg,q=t.pushNaN,X=t.pushNaNNeg,W=t.pushArrayStart,z=t.pushArrayStartFixed,Z=t.pushArrayStartFixed32,ee=t.pushArrayStartFixed64,re=t.pushObjectStart,L=t.pushObjectStartFixed,b=t.pushObjectStartFixed32,w=t.pushObjectStartFixed64,R=t.pushByteString,B=t.pushByteStringStart,U=t.pushUtf8String,Q=t.pushUtf8StringStart,G=t.pushSimpleUnassigned,M=t.pushTagStart,v=t.pushTagStart4,V=t.pushTagStart8,de=t.pushTagUnassigned,J=t.pushBreak,ue=e.Math.pow,S=0,A=0,ie=0;function ae(k){for(k=k|0,S=0,A=k;(S|0)<(A|0)&&(ie=xc[n[S]&255](n[S]|0)|0,!((ie|0)>0)););return ie|0}function E(k){return k=k|0,((S|0)+(k|0)|0)<(A|0)?0:1}function I(k){return k=k|0,n[k|0]<<8|n[k+1|0]|0}function j(k){return k=k|0,n[k|0]<<24|n[k+1|0]<<16|n[k+2|0]<<8|n[k+3|0]|0}function H(k){return k=k|0,s(k|0),S=S+1|0,0}function T(k){return k=k|0,E(1)|0?1:(s(n[S+1|0]|0),S=S+2|0,0)}function K(k){return k=k|0,E(2)|0?1:(s(I(S+1|0)|0),S=S+3|0,0)}function F(k){return k=k|0,E(4)|0?1:(o(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function N(k){return k=k|0,E(8)|0?1:(c(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function Y(k){return k=k|0,s(-1-(k-32|0)|0),S=S+1|0,0}function ne(k){return k=k|0,E(1)|0?1:(s(-1-(n[S+1|0]|0)|0),S=S+2|0,0)}function te(k){k=k|0;var qe=0;return E(2)|0?1:(qe=I(S+1|0)|0,s(-1-(qe|0)|0),S=S+3|0,0)}function he(k){return k=k|0,E(4)|0?1:(a(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function me(k){return k=k|0,E(8)|0?1:(u(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function fe(k){k=k|0;var qe=0,Le=0,Pe=0;return Pe=k-64|0,E(Pe|0)|0?1:(qe=S+1|0,Le=(S+1|0)+(Pe|0)|0,R(qe|0,Le|0),S=Le|0,0)}function je(k){k=k|0;var qe=0,Le=0,Pe=0;return E(1)|0||(Pe=n[S+1|0]|0,qe=S+2|0,Le=(S+2|0)+(Pe|0)|0,E(Pe+1|0)|0)?1:(R(qe|0,Le|0),S=Le|0,0)}function Ae(k){k=k|0;var qe=0,Le=0,Pe=0;return E(2)|0||(Pe=I(S+1|0)|0,qe=S+3|0,Le=(S+3|0)+(Pe|0)|0,E(Pe+2|0)|0)?1:(R(qe|0,Le|0),S=Le|0,0)}function Ve(k){k=k|0;var qe=0,Le=0,Pe=0;return E(4)|0||(Pe=j(S+1|0)|0,qe=S+5|0,Le=(S+5|0)+(Pe|0)|0,E(Pe+4|0)|0)?1:(R(qe|0,Le|0),S=Le|0,0)}function Xe(k){return k=k|0,1}function Ge(k){return k=k|0,B(),S=S+1|0,0}function ve(k){k=k|0;var qe=0,Le=0,Pe=0;return Pe=k-96|0,E(Pe|0)|0?1:(qe=S+1|0,Le=(S+1|0)+(Pe|0)|0,U(qe|0,Le|0),S=Le|0,0)}function at(k){k=k|0;var qe=0,Le=0,Pe=0;return E(1)|0||(Pe=n[S+1|0]|0,qe=S+2|0,Le=(S+2|0)+(Pe|0)|0,E(Pe+1|0)|0)?1:(U(qe|0,Le|0),S=Le|0,0)}function St(k){k=k|0;var qe=0,Le=0,Pe=0;return E(2)|0||(Pe=I(S+1|0)|0,qe=S+3|0,Le=(S+3|0)+(Pe|0)|0,E(Pe+2|0)|0)?1:(U(qe|0,Le|0),S=Le|0,0)}function kt(k){k=k|0;var qe=0,Le=0,Pe=0;return E(4)|0||(Pe=j(S+1|0)|0,qe=S+5|0,Le=(S+5|0)+(Pe|0)|0,E(Pe+4|0)|0)?1:(U(qe|0,Le|0),S=Le|0,0)}function Fr(k){return k=k|0,1}function mt(k){return k=k|0,Q(),S=S+1|0,0}function Ie(k){return k=k|0,z(k-128|0),S=S+1|0,0}function tr(k){return k=k|0,E(1)|0?1:(z(n[S+1|0]|0),S=S+2|0,0)}function Ze(k){return k=k|0,E(2)|0?1:(z(I(S+1|0)|0),S=S+3|0,0)}function Kt(k){return k=k|0,E(4)|0?1:(Z(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function cs(k){return k=k|0,E(8)|0?1:(ee(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function Gt(k){return k=k|0,W(),S=S+1|0,0}function De(k){k=k|0;var qe=0;return qe=k-160|0,E(qe|0)|0?1:(L(qe|0),S=S+1|0,0)}function us(k){return k=k|0,E(1)|0?1:(L(n[S+1|0]|0),S=S+2|0,0)}function $t(k){return k=k|0,E(2)|0?1:(L(I(S+1|0)|0),S=S+3|0,0)}function Wt(k){return k=k|0,E(4)|0?1:(b(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function fs(k){return k=k|0,E(8)|0?1:(w(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function Yt(k){return k=k|0,re(),S=S+1|0,0}function yt(k){return k=k|0,M(k-192|0|0),S=S+1|0,0}function So(k){return k=k|0,M(k|0),S=S+1|0,0}function ar(k){return k=k|0,M(k|0),S=S+1|0,0}function cr(k){return k=k|0,M(k|0),S=S+1|0,0}function xo(k){return k=k|0,M(k|0),S=S+1|0,0}function Ye(k){return k=k|0,M(k-192|0|0),S=S+1|0,0}function ur(k){return k=k|0,M(k|0),S=S+1|0,0}function Ao(k){return k=k|0,M(k|0),S=S+1|0,0}function fr(k){return k=k|0,M(k|0),S=S+1|0,0}function Xt(k){return k=k|0,E(1)|0?1:(M(n[S+1|0]|0),S=S+2|0,0)}function ls(k){return k=k|0,E(2)|0?1:(M(I(S+1|0)|0),S=S+3|0,0)}function Jt(k){return k=k|0,E(4)|0?1:(v(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function Qt(k){return k=k|0,E(8)|0?1:(V(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function rt(k){return k=k|0,G((k|0)-224|0),S=S+1|0,0}function Zt(k){return k=k|0,g(),S=S+1|0,0}function Ct(k){return k=k|0,y(),S=S+1|0,0}function xn(k){return k=k|0,x(),S=S+1|0,0}function Fn(k){return k=k|0,m(),S=S+1|0,0}function Un(k){return k=k|0,E(1)|0?1:(G(n[S+1|0]|0),S=S+2|0,0)}function Kn(k){k=k|0;var qe=0,Le=0,Pe=1,An=0,Qi=0,Mf=0;return E(2)|0?1:(qe=n[S+1|0]|0,Le=n[S+2|0]|0,(qe|0)&128&&(Pe=-1),An=+(((qe|0)&124)>>2),Qi=+(((qe|0)&3)<<8|Le),+An==0?f(+(+Pe*5960464477539063e-23*+Qi)):+An==31?+Pe==1?+Qi>0?q():_():+Qi>0?X():P():f(+(+Pe*ue(2,+(+An-25))*+(1024+Qi))),S=S+3|0,0)}function jn(k){return k=k|0,E(4)|0?1:(h(n[S+1|0]|0,n[S+2|0]|0,n[S+3|0]|0,n[S+4|0]|0),S=S+5|0,0)}function Vn(k){return k=k|0,E(8)|0?1:(d(n[S+1|0]|0,n[S+2|0]|0,n[S+3|0]|0,n[S+4|0]|0,n[S+5|0]|0,n[S+6|0]|0,n[S+7|0]|0,n[S+8|0]|0),S=S+9|0,0)}function ze(k){return k=k|0,1}function zn(k){return k=k|0,J(),S=S+1|0,0}var xc=[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,T,K,F,N,ze,ze,ze,ze,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,ne,te,he,me,ze,ze,ze,ze,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,je,Ae,Ve,Xe,ze,ze,ze,Ge,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,at,St,kt,Fr,ze,ze,ze,mt,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,tr,Ze,Kt,cs,ze,ze,ze,Gt,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,us,$t,Wt,fs,ze,ze,ze,Yt,yt,yt,yt,yt,yt,yt,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Xt,ls,Jt,Qt,ze,ze,ze,ze,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,Zt,Ct,xn,Fn,Un,Kn,jn,Vn,ze,ze,ze,zn];return{parse:ae}}});var tg=p(vs=>{l();"use strict";var u4=Ya().BigNumber;vs.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};vs.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};vs.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};vs.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};vs.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};vs.SHIFT32=Math.pow(2,32);vs.SHIFT16=Math.pow(2,16);vs.MAX_SAFE_HIGH=2097151;vs.NEG_ONE=new u4(-1);vs.TEN=new u4(10);vs.TWO=new u4(2);vs.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5}});var P2=p(Js=>{l();"use strict";var{Buffer:eCe}=eg(),_K=Ya().BigNumber,EK=tg(),SK=EK.SHIFT32,tCe=EK.SHIFT16,rCe=2097151;Js.parseHalf=function(e){var t,i,n;return n=e[0]&128?-1:1,t=(e[0]&124)>>2,i=(e[0]&3)<<8|e[1],t?t===31?n*(i?0/0:Infinity):n*Math.pow(2,t-25)*(1024+i):n*5960464477539063e-23*i};function iCe(r){return r<16?"0"+r.toString(16):r.toString(16)}Js.arrayBufferToBignumber=function(r){let e=r.byteLength,t="";for(let i=0;i<e;i++)t+=iCe(r[i]);return new _K(t,16)};Js.buildMap=r=>{let e=new Map,t=Object.keys(r),i=t.length;for(let n=0;n<i;n++)e.set(t[n],r[t[n]]);return e};Js.buildInt32=(r,e)=>r*tCe+e;Js.buildInt64=(r,e,t,i)=>{let n=Js.buildInt32(r,e),s=Js.buildInt32(t,i);return n>rCe?new _K(n).times(SK).plus(s):n*SK+s};Js.writeHalf=function(e,t){let i=eCe.allocUnsafe(4);i.writeFloatBE(t,0);let n=i.readUInt32BE(0);if((n&8191)!=0)return!1;var s=n>>16&32768;let o=n>>23&255,a=n&8388607;if(o>=113&&o<=142)s+=(o-112<<10)+(a>>13);else if(o>=103&&o<113){if(a&(1<<126-o)-1)return!1;s+=a+8388608>>126-o}else return!1;return e.writeUInt16BE(s,0),!0};Js.keySorter=function(r,e){var t=r[0].byteLength,i=e[0].byteLength;return t>i?1:i>t?-1:r[0].compare(e[0])};Js.isNegativeZero=r=>r===0&&1/r<0;Js.nextPowerOf2=r=>{let e=0;if(r&&!(r&r-1))return r;for(;r!==0;)r>>=1,e+=1;return 1<<e}});var h4=p((Cbt,xK)=>{l();"use strict";var f4=tg(),nCe=f4.MT,O2=f4.SIMPLE,l4=f4.SYMS,rg=class{constructor(e){if(typeof e!="number")throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(e|0)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,nCe.SIMPLE_FLOAT)}static isSimple(e){return e instanceof rg}static decode(e,t){switch(t==null&&(t=!0),e){case O2.FALSE:return!1;case O2.TRUE:return!0;case O2.NULL:return t?null:l4.NULL;case O2.UNDEFINED:return t?void 0:l4.UNDEFINED;case-1:if(!t)throw new Error("Invalid BREAK");return l4.BREAK;default:return new rg(e)}}};xK.exports=rg});var d4=p((Pbt,AK)=>{l();"use strict";var ig=class{constructor(e,t,i){if(this.tag=e,this.value=t,this.err=i,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){var t,i;if(i=e!=null?e[this.tag]:void 0,typeof i!="function"&&(i=ig["_tag"+this.tag],typeof i!="function"))return this;try{return i.call(ig,this.value)}catch(n){return t=n,this.err=t,this}}};AK.exports=ig});var y4=p((Obt,IK)=>{l();"use strict";var TK=self.location?self.location.protocol+"//"+self.location.host:"",p4=self.URL,RK=class{constructor(e="",t=TK){this.super=new p4(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function sCe(r){if(typeof r=="string")return new p4(r).toString();if(!(r instanceof p4)){let e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",i=r.port?":"+r.port:"",n=r.protocol?r.protocol+"//":"",s=r.host||"",o=r.hostname||"",a=r.search||(r.query?"?"+r.query:""),c=r.hash||"",u=r.pathname||"",f=r.path||u+a;return`${n}${e||t}${s||o+i}${f}${c}`}}IK.exports={URLWithLegacySupport:RK,URLSearchParams:self.URLSearchParams,defaultBase:TK,format:sCe}});var PK=p((Bbt,kK)=>{l();"use strict";var{URLWithLegacySupport:CK,format:oCe}=y4();kK.exports=(r,e={},t={},i)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(t[n]||i||n)+":";let s;try{s=new CK(r)}catch(a){s={}}let o=Object.assign({},e,{protocol:n||s.protocol,host:e.host||s.host});return new CK(r,oCe(o)).toString()}});var g4=p((Nbt,OK)=>{l();"use strict";var{URLWithLegacySupport:aCe,format:cCe,URLSearchParams:uCe,defaultBase:fCe}=y4(),lCe=PK();OK.exports={URL:aCe,URLSearchParams:uCe,format:cCe,relative:lCe,defaultBase:fCe}});var b4=p((Dbt,BK)=>{l();"use strict";var{Buffer:Bd}=eg(),NK=$0(),hCe=Ya().BigNumber,dCe=wK(),Pn=P2(),hr=tg(),pCe=h4(),yCe=d4(),{URL:gCe}=g4(),bl=class{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=Pn.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=Bd.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(t*1e3),2:t=>Pn.arrayBufferToBignumber(t),3:t=>hr.NEG_ONE.minus(Pn.arrayBufferToBignumber(t)),4:t=>hr.TEN.pow(t[0]).times(t[1]),5:t=>hr.TWO.pow(t[0]).times(t[1]),32:t=>new gCe(t),35:t=>new RegExp(t)},e.tags),this.parser=dCe(globalThis,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case hr.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case hr.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case hr.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case hr.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case hr.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case hr.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break;default:break}this._currentParent&&this._currentParent.type===hr.PARENT.TAG&&this._dec()}_dec(){let e=this._currentParent;e.length<0||(e.length--,e.length===0&&this._closeParent())}_push(e,t){let i=this._currentParent;switch(i.values++,i.type){case hr.PARENT.ARRAY:case hr.PARENT.BYTE_STRING:case hr.PARENT.UTF8_STRING:i.length>-1?this._ref[this._ref.length-i.length]=e:this._ref.push(e),this._dec();break;case hr.PARENT.OBJECT:i.tmpKey!=null?(this._ref[i.tmpKey]=e,i.tmpKey=null,this._dec()):(i.tmpKey=e,typeof i.tmpKey!="string"&&(i.type=hr.PARENT.MAP,i.ref=Pn.buildMap(i.ref)));break;case hr.PARENT.MAP:i.tmpKey!=null?(this._ref.set(i.tmpKey,e),i.tmpKey=null,this._dec()):i.tmpKey=e;break;case hr.PARENT.TAG:this._ref.push(e),t||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,t,i){this._parents[this._depth]={type:t,length:i,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:hr.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,t){let i=this._knownTags[e];return i?i(t):new yCe(e,t)}createMap(e,t){return e}createObject(e,t){return e}createArray(e,t){return e}createByteString(e,t){return Bd.concat(e)}createByteStringFromHeap(e,t){return e===t?Bd.alloc(0):Bd.from(this._heap.slice(e,t))}createInt(e){return e}createInt32(e,t){return Pn.buildInt32(e,t)}createInt64(e,t,i,n){return Pn.buildInt64(e,t,i,n)}createFloat(e){return e}createFloatSingle(e,t,i,n){return NK.read([e,t,i,n],0,!1,23,4)}createFloatDouble(e,t,i,n,s,o,a,c){return NK.read([e,t,i,n,s,o,a,c],0,!1,52,8)}createInt32Neg(e,t){return-1-Pn.buildInt32(e,t)}createInt64Neg(e,t,i,n){let s=Pn.buildInt32(e,t),o=Pn.buildInt32(i,n);return s>hr.MAX_SAFE_HIGH?hr.NEG_ONE.minus(new hCe(s).times(hr.SHIFT32).plus(o)):-1-(s*hr.SHIFT32+o)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return Infinity}createInfinityNeg(){return-Infinity}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,t){return e.join("")}createUtf8StringFromHeap(e,t){return e===t?"":this._buffer.toString("utf8",e,t)}createSimpleUnassigned(e){return new pCe(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,t){this._push(this.createInt32(e,t))}pushInt64(e,t,i,n){this._push(this.createInt64(e,t,i,n))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,t,i,n){this._push(this.createFloatSingle(e,t,i,n))}pushFloatDouble(e,t,i,n,s,o,a,c){this._push(this.createFloatDouble(e,t,i,n,s,o,a,c))}pushInt32Neg(e,t){this._push(this.createInt32Neg(e,t))}pushInt64Neg(e,t,i,n){this._push(this.createInt64Neg(e,t,i,n))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],hr.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,t){let i=Pn.buildInt32(e,t);this._createArrayStartFixed(i)}pushArrayStartFixed64(e,t,i,n){let s=Pn.buildInt64(e,t,i,n);this._createArrayStartFixed(s)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,t){let i=Pn.buildInt32(e,t);this._createObjectStartFixed(i)}pushObjectStartFixed64(e,t,i,n){let s=Pn.buildInt64(e,t,i,n);this._createObjectStartFixed(s)}pushByteStringStart(){this._parents[this._depth]={type:hr.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,t){this._push(this.createByteStringFromHeap(e,t))}pushUtf8StringStart(){this._parents[this._depth]={type:hr.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,t){this._push(this.createUtf8StringFromHeap(e,t))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:hr.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,t){this.pushTagStart(Pn.buildInt32(e,t))}pushTagStart8(e,t,i,n){this.pushTagStart(Pn.buildInt64(e,t,i,n))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){if(e===0){this._push(this.createObject({}));return}this._createParent({},hr.PARENT.OBJECT,e)}_createArrayStartFixed(e){if(e===0){this._push(this.createArray([]));return}this._createParent(new Array(e),hr.PARENT.ARRAY,e)}_decode(e){if(e.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(e);let t=this.parser.parse(e.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(t>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,t){return typeof e=="string"&&(e=Bd.from(e,t||"hex")),new bl({size:e.length}).decodeFirst(e)}static decodeAll(e,t){return typeof e=="string"&&(e=Bd.from(e,t||"hex")),new bl({size:e.length}).decodeAll(e)}};bl.decodeFirst=bl.decode;BK.exports=bl});var MK=p((qbt,DK)=>{l();"use strict";var{Buffer:m4}=eg(),bCe=b4(),mCe=P2(),B2=class extends bCe{createTag(e,t){return`${e}(${t})`}createInt(e){return super.createInt(e).toString()}createInt32(e,t){return super.createInt32(e,t).toString()}createInt64(e,t,i,n){return super.createInt64(e,t,i,n).toString()}createInt32Neg(e,t){return super.createInt32Neg(e,t).toString()}createInt64Neg(e,t,i,n){return super.createInt64Neg(e,t,i,n).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){let t=super.createFloat(e);return mCe.isNegativeZero(e)?"-0_1":`${t}_1`}createFloatSingle(e,t,i,n){return`${super.createFloatSingle(e,t,i,n)}_2`}createFloatDouble(e,t,i,n,s,o,a,c){return`${super.createFloatDouble(e,t,i,n,s,o,a,c)}_3`}createByteString(e,t){let i=e.join(", ");return t===-1?`(_ ${i})`:`h'${i}`}createByteStringFromHeap(e,t){return`h'${m4.from(super.createByteStringFromHeap(e,t)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,t){let i=super.createArray(e,t);return t===-1?`[_ ${i.join(", ")}]`:`[${i.join(", ")}]`}createMap(e,t){let i=super.createMap(e),n=Array.from(i.keys()).reduce(qK(i),"");return t===-1?`{_ ${n}}`:`{${n}}`}createObject(e,t){let i=super.createObject(e),n=Object.keys(i).reduce(qK(i),"");return t===-1?`{_ ${n}}`:`{${n}}`}createUtf8String(e,t){let i=e.join(", ");return t===-1?`(_ ${i})`:`"${i}"`}createUtf8StringFromHeap(e,t){return`"${m4.from(super.createUtf8StringFromHeap(e,t)).toString("utf8")}"`}static diagnose(e,t){return typeof e=="string"&&(e=m4.from(e,t||"hex")),new B2().decodeFirst(e)}};DK.exports=B2;function qK(r){return(e,t)=>e?`${e}, ${t}: ${r[t]}`:`${t}: ${r[t]}`}});var jK=p((Mbt,LK)=>{l();"use strict";var{Buffer:Xa}=eg(),{URL:vCe}=g4(),v4=Ya().BigNumber,w4=P2(),Ei=tg(),jo=Ei.MT,N2=Ei.NUMBYTES,FK=Ei.SHIFT32,UK=Ei.SYMS,Nd=Ei.TAG,wCe=Ei.MT.SIMPLE_FLOAT<<5|Ei.NUMBYTES.TWO,_Ce=Ei.MT.SIMPLE_FLOAT<<5|Ei.NUMBYTES.FOUR,ECe=Ei.MT.SIMPLE_FLOAT<<5|Ei.NUMBYTES.EIGHT,SCe=Ei.MT.SIMPLE_FLOAT<<5|Ei.SIMPLE.TRUE,xCe=Ei.MT.SIMPLE_FLOAT<<5|Ei.SIMPLE.FALSE,ACe=Ei.MT.SIMPLE_FLOAT<<5|Ei.SIMPLE.UNDEFINED,KK=Ei.MT.SIMPLE_FLOAT<<5|Ei.SIMPLE.NULL,ICe=new v4("0x20000000000000"),TCe=Xa.from("f97e00","hex"),RCe=Xa.from("f9fc00","hex"),kCe=Xa.from("f97c00","hex");function CCe(r){return{}.toString.call(r).slice(8,-1)}var ng=class{constructor(e){e=e||{},this.streaming=typeof e.stream=="function",this.onData=e.stream,this.semanticTypes=[[vCe,this._pushUrl],[v4,this._pushBigNumber]];let t=e.genTypes||[],i=t.length;for(let n=0;n<i;n++)this.addSemanticType(t[n][0],t[n][1]);this._reset()}addSemanticType(e,t){let i=this.semanticTypes.length;for(let n=0;n<i;n++)if(this.semanticTypes[n][0]===e){let o=this.semanticTypes[n][1];return this.semanticTypes[n][1]=t,o}return this.semanticTypes.push([e,t]),null}push(e){return e&&(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(e,t,i){return this.result[this.offset]=e,this.resultMethod[this.offset]=t,this.resultLength[this.offset]=i,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(TCe)}_pushInfinity(e){let t=e<0?RCe:kCe;return this.push(t)}_pushFloat(e){let t=Xa.allocUnsafe(2);if(w4.writeHalf(t,e)&&w4.parseHalf(t)===e)return this._pushUInt8(wCe)&&this.push(t);let i=Xa.allocUnsafe(4);return i.writeFloatBE(e,0),i.readFloatBE(0)===e?this._pushUInt8(_Ce)&&this.push(i):this._pushUInt8(ECe)&&this._pushDoubleBE(e)}_pushInt(e,t,i){let n=t<<5;return e<24?this._pushUInt8(n|e):e<=255?this._pushUInt8(n|N2.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(n|N2.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(n|N2.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(n|N2.EIGHT)&&this._pushUInt32BE(Math.floor(e/FK))&&this._pushUInt32BE(e%FK):t===jo.NEG_INT?this._pushFloat(i):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,jo.NEG_INT,e):this._pushInt(e,jo.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!=0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){let t=Xa.byteLength(e,"utf8");return this._pushInt(t,jo.UTF8_STRING)&&this.pushWrite(e,5,t)}_pushBoolean(e){return this._pushUInt8(e?SCe:xCe)}_pushUndefined(e){return this._pushUInt8(ACe)}_pushArray(e,t){let i=t.length;if(!e._pushInt(i,jo.ARRAY))return!1;for(let n=0;n<i;n++)if(!e.pushAny(t[n]))return!1;return!0}_pushTag(e){return this._pushInt(e,jo.TAG)}_pushDate(e,t){return e._pushTag(Nd.DATE_EPOCH)&&e.pushAny(Math.round(t/1e3))}_pushBuffer(e,t){return e._pushInt(t.length,jo.BYTE_STRING)&&e.push(t)}_pushNoFilter(e,t){return e._pushBuffer(e,t.slice())}_pushRegexp(e,t){return e._pushTag(Nd.REGEXP)&&e.pushAny(t.source)}_pushSet(e,t){if(!e._pushInt(t.size,jo.ARRAY))return!1;for(let i of t)if(!e.pushAny(i))return!1;return!0}_pushUrl(e,t){return e._pushTag(Nd.URI)&&e.pushAny(t.format())}_pushBigint(e){let t=Nd.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),t=Nd.NEG_BIGINT);let i=e.toString(16);i.length%2&&(i="0"+i);let n=Xa.from(i,"hex");return this._pushTag(t)&&this._pushBuffer(this,n)}_pushBigNumber(e,t){if(t.isNaN())return e._pushNaN();if(!t.isFinite())return e._pushInfinity(t.isNegative()?-Infinity:Infinity);if(t.isInteger())return e._pushBigint(t);if(!(e._pushTag(Nd.DECIMAL_FRAC)&&e._pushInt(2,jo.ARRAY)))return!1;let i=t.decimalPlaces(),n=t.multipliedBy(new v4(10).pow(i));return e._pushIntNum(-i)?n.abs().isLessThan(ICe)?e._pushIntNum(n.toNumber()):e._pushBigint(n):!1}_pushMap(e,t){return e._pushInt(t.size,jo.MAP)?this._pushRawMap(t.size,Array.from(t)):!1}_pushObject(e){if(!e)return this._pushUInt8(KK);for(var t=this.semanticTypes.length,i=0;i<t;i++)if(e instanceof this.semanticTypes[i][0])return this.semanticTypes[i][1].call(e,this,e);var n=e.encodeCBOR;if(typeof n=="function")return n.call(e,this);var s=Object.keys(e),o=s.length;return this._pushInt(o,jo.MAP)?this._pushRawMap(o,s.map(a=>[a,e[a]])):!1}_pushRawMap(e,t){t=t.map(function(n){return n[0]=ng.encode(n[0]),n}).sort(w4.keySorter);for(var i=0;i<e;i++)if(!this.push(t[i][0])||!this.pushAny(t[i][1]))return!1;return!0}write(e){return this.pushAny(e)}pushAny(e){var t=CCe(e);switch(t){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,Xa.isBuffer(e)?e:Xa.from(e));case"Null":return this._pushUInt8(KK);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case UK.NULL:return this._pushObject(null);case UK.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(this.offset===0)return null;for(var e=this.result,t=this.resultLength,i=this.resultMethod,n=this.offset,s=0,o=0;o<n;o++)s+=t[o];var a=Xa.allocUnsafe(s),c=0,u=0;for(o=0;o<n;o++){switch(u=t[o],i[o]){case 0:e[o].copy(a,c);break;case 1:a.writeUInt8(e[o],c,!0);break;case 2:a.writeUInt16BE(e[o],c,!0);break;case 3:a.writeUInt32BE(e[o],c,!0);break;case 4:a.writeDoubleBE(e[o],c,!0);break;case 5:a.write(e[o],c,u,"utf8");break;default:throw new Error("unkown method")}c+=u}var f=a;return this._reset(),f}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){let t=new ng;if(!t.pushAny(e))throw new Error("Failed to encode input");return t.finalize()}};LK.exports=ng});var VK=p(Si=>{l();"use strict";Si.Diagnose=MK();Si.Decoder=b4();Si.Encoder=jK();Si.Simple=h4();Si.Tagged=d4();Si.decodeAll=Si.Decoder.decodeAll;Si.decodeFirst=Si.Decoder.decodeFirst;Si.diagnose=Si.Diagnose.diagnose;Si.encode=Si.Encoder.encode;Si.decode=Si.Decoder.decode;Si.leveldb={decode:Si.Decoder.decodeAll,encode:Si.Encoder.encode,buffer:!0,name:"cbor"}});var GK=p((Fbt,zK)=>{l();zK.exports=HK;function HK(r,e){this.value=r,this.next=e}HK.prototype.contains=function(r){for(var e=this;e;){if(e.value===r)return!0;e=e.next}return!1}});var _4=p((Ubt,$K)=>{l();var PCe=GK();$K.exports=OCe;function OCe(r){if(!(r instanceof Object))throw new TypeError('"obj" must be an object (or inherit from it)');return WK(r)}function WK(r,e){e=new PCe(r,e);for(var t in r){var i=r[t];if(i instanceof Object&&(e.contains(i)||WK(i,e)))return!0}return!1}});var I4=p((Kbt,YK)=>{l();"use strict";var E4=VK(),S4=$r(),BCe=er(),sg=Qe(),NCe=_4(),DCe=vi(),qCe=ct(),XK=42;function MCe(r){return typeof r=="string"?r=new sg(r).bytes:sg.isCID(r)&&(r=r.bytes),new E4.Tagged(XK,DCe([qCe("00","base16"),r],1+r.length))}function LCe(r){let e;try{e=NCe(r)}catch(i){e=!1}if(e)throw new Error("The object passed has circular references");function t(i){if(!i||i instanceof Uint8Array||typeof i=="string")return i;if(Array.isArray(i))return i.map(t);if(sg.isCID(i))return MCe(i);let n=Object.keys(i);if(n.length>0){let s={};return n.forEach(o=>{typeof i[o]=="object"?s[o]=t(i[o]):s[o]=i[o]}),s}else return i}return t(r)}var JK=S4.DAG_CBOR,QK=S4.SHA2_256,ZK={[XK]:r=>(r=r.slice(1),new sg(r))},ej=64*1024,Dd=ej,tj=64*1024*1024,x4=tj,rj=null;function A4(r){let e=ZK;r?(typeof r.size=="number"&&(Dd=r.size),typeof r.maxSize=="number"&&(x4=r.maxSize),r.tags&&(e=Object.assign({},ZK,r&&r.tags))):(Dd=ej,x4=tj);let t={tags:e,size:Dd};rj=new E4.Decoder(t),Dd=t.size}A4();function FCe(r){let e=LCe(r);return E4.encode(e)}function UCe(r){if(r.length>Dd&&r.length<=x4&&A4({size:r.length}),r.length>Dd)throw new Error("Data is too large to deserialize with current decoder");let e=rj.decodeAll(r);if(e.length!==1)throw new Error("Extraneous CBOR data found beyond initial top-level object");return e[0]}async function KCe(r,e){let i=Object.assign({cidVersion:1,hashAlg:QK},e),n=await BCe(r,i.hashAlg),s=S4.getNameFromCode(JK);return new sg(i.cidVersion,s,n)}YK.exports={codec:JK,defaultHashAlg:QK,configureDecoder:A4,serialize:FCe,deserialize:UCe,cid:KCe}});var oj=p(T4=>{l();"use strict";var ij=Qe(),nj=I4();T4.resolve=(r,e)=>{let t=nj.deserialize(r),i=e.split("/").filter(Boolean);for(;i.length;){let n=i.shift();if(t[n]===void 0)throw new Error(`Object has no property '${n}'`);if(t=t[n],ij.isCID(t))return{value:t,remainderPath:i.join("/")}}return{value:t,remainderPath:""}};var sj=function*(r,e){if(!(r instanceof Uint8Array||ij.isCID(r)||typeof r=="string"||r===null))for(let t of Object.keys(r)){let i=e===void 0?t:e+"/"+t;yield i,yield*sj(r[t],i)}};T4.tree=function*(r){let e=nj.deserialize(r);yield*sj(e)}});var aj=p(ml=>{l();"use strict";ml.util=I4();ml.resolver=oj();ml.codec=ml.util.codec;ml.defaultHashAlg=ml.util.defaultHashAlg});var fj=p((zbt,cj)=>{l();var jCe=aj().util,uj=Qe(),R4=(r,e=[],t=!0)=>(t&&Buffer.isBuffer(r)&&(r=jCe.deserialize(r)),function*(){for(let i of Object.keys(r)){let n=e.slice();n.push(i);let s=r[i];if(s&&typeof s=="object")if(Array.isArray(s))for(let o=0;o<s.length;o++){let a=n.slice();a.push(o);let c=s[o];uj.isCID(c)?yield[a.join("/"),c]:typeof c=="object"&&(yield*R4(c,n,!1))}else uj.isCID(s)?yield[n.join("/"),s]:yield*R4(s,n,!1)}}());cj.exports=R4});var qd=p((Hbt,lj)=>{l();"use strict";var VCe=async r=>{for await(let e of r)return e};lj.exports=VCe});function hj(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(zCe.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(GCe(r))return"Buffer";let t=$Ce(r);return t||"Object"}function GCe(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function $Ce(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(HCe.includes(e))return e}var zCe,HCe,dj=li(()=>{l();zCe=["string","number","bigint","symbol"],HCe=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var be,We,ws=li(()=>{l();be=class{constructor(e,t,i){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};be.uint=new be(0,"uint",!0);be.negint=new be(1,"negint",!0);be.bytes=new be(2,"bytes",!0);be.string=new be(3,"string",!0);be.array=new be(4,"array",!1);be.map=new be(5,"map",!1);be.tag=new be(6,"tag",!1);be.float=new be(7,"float",!0);be.false=new be(7,"false",!0);be.true=new be(7,"true",!0);be.null=new be(7,"null",!0);be.undefined=new be(7,"undefined",!0);be.break=new be(7,"break",!0);We=class{constructor(e,t,i){this.type=e,this.value=t,this.encodedLength=i,this.encodedBytes=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function D2(r){return Md&&globalThis.Buffer.isBuffer(r)}function k4(r){return r instanceof Uint8Array?D2(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}function wj(r,e){if(D2(r)&&D2(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function gj(r,e=Infinity){let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function pj(r,e,t){let i=[];for(;e<t;){let n=r[e],s=null,o=n>239?4:n>223?3:n>191?2:1;if(e+o<=t){let a,c,u,f;switch(o){case 1:n<128&&(s=n);break;case 2:a=r[e+1],(a&192)==128&&(f=(n&31)<<6|a&63,f>127&&(s=f));break;case 3:a=r[e+1],c=r[e+2],(a&192)==128&&(c&192)==128&&(f=(n&15)<<12|(a&63)<<6|c&63,f>2047&&(f<55296||f>57343)&&(s=f));break;case 4:a=r[e+1],c=r[e+2],u=r[e+3],(a&192)==128&&(c&192)==128&&(u&192)==128&&(f=(n&15)<<18|(a&63)<<12|(c&63)<<6|u&63,f>65535&&f<1114112&&(s=f))}}s===null?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),e+=o}return XCe(i)}function XCe(r){let e=r.length;if(e<=_j)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=_j));return t}var Md,WCe,YCe,yj,bj,Ja,q2,mj,vj,_j,Ld=li(()=>{l();Md=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",WCe=new TextDecoder,YCe=new TextEncoder;yj=Md?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):pj(r,e,t):(r,e,t)=>t-e>64?WCe.decode(r.subarray(e,t)):pj(r,e,t),bj=Md?r=>r.length>64?globalThis.Buffer.from(r):gj(r):r=>r.length>64?YCe.encode(r):gj(r),Ja=r=>Uint8Array.from(r),q2=Md?(r,e,t)=>D2(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),mj=Md?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),k4(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),i=0;for(let n of r)i+n.length>t.length&&(n=n.subarray(0,t.length-i)),t.set(n,i),i+=n.length;return t},vj=Md?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);_j=4096});var JCe,M2,Ej=li(()=>{l();Ld();JCe=256,M2=class{constructor(e=JCe){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.chunks=[],this.cursor=0,this.maxCursor=-1,this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){let n=t.length-(this.maxCursor-this.cursor)-1;n<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=vj(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let i=this.chunks[0];e&&this.cursor>i.length/2?(t=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=q2(i,0,this.cursor)}else t=mj(this.chunks,this.cursor);return e&&this.reset(),t}}});function Hc(r,e,t){if(r.length-e<t)throw new Error(`${ft} not enough data for type`)}var ft,C4,og,Vo=li(()=>{l();ft="CBOR decode error:",C4="CBOR encode error:",og=[];og[23]=1;og[24]=2;og[25]=3;og[26]=5;og[27]=9});function _s(r,e,t){Hc(r,e,1);let i=r[e];if(t.strict===!0&&i<$i[0])throw new Error(`${ft} integer encoded in more bytes than necessary (strict decode)`);return i}function Es(r,e,t){Hc(r,e,2);let i=r[e]<<8|r[e+1];if(t.strict===!0&&i<$i[1])throw new Error(`${ft} integer encoded in more bytes than necessary (strict decode)`);return i}function Ss(r,e,t){Hc(r,e,4);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&i<$i[2])throw new Error(`${ft} integer encoded in more bytes than necessary (strict decode)`);return i}function xs(r,e,t){Hc(r,e,8);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],n=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],s=(BigInt(i)<<BigInt(32))+BigInt(n);if(t.strict===!0&&s<$i[3])throw new Error(`${ft} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(t.allowBigInt===!0)return s;throw new Error(`${ft} integers outside of the safe integer range are not supported`)}function Sj(r,e,t,i){return new We(be.uint,_s(r,e+1,i),2)}function xj(r,e,t,i){return new We(be.uint,Es(r,e+1,i),3)}function Aj(r,e,t,i){return new We(be.uint,Ss(r,e+1,i),5)}function Ij(r,e,t,i){return new We(be.uint,xs(r,e+1,i),9)}function Qs(r,e){return Zn(r,0,e.value)}function Zn(r,e,t){if(t<$i[0]){let i=Number(t);r.push([e|i])}else if(t<$i[1]){let i=Number(t);r.push([e|24,i])}else if(t<$i[2]){let i=Number(t);r.push([e|25,i>>>8,i&255])}else if(t<$i[3]){let i=Number(t);r.push([e|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{let i=BigInt(t);if(i<$i[4]){let n=[e|27,0,0,0,0,0,0,0],s=Number(i&BigInt(4294967295)),o=Number(i>>BigInt(32)&BigInt(4294967295));n[8]=s&255,s=s>>8,n[7]=s&255,s=s>>8,n[6]=s&255,s=s>>8,n[5]=s&255,n[4]=o&255,o=o>>8,n[3]=o&255,o=o>>8,n[2]=o&255,o=o>>8,n[1]=o&255,r.push(n)}else throw new Error(`${ft} encountered BigInt larger than allowable range`)}}var $i,Qa=li(()=>{l();ws();Vo();$i=[24,256,65536,4294967296,BigInt("18446744073709551616")];Qs.encodedSize=function(e){return Zn.encodedSize(e.value)};Zn.encodedSize=function(e){return e<$i[0]?1:e<$i[1]?2:e<$i[2]?3:e<$i[3]?5:9};Qs.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}});function Tj(r,e,t,i){return new We(be.negint,-1-_s(r,e+1,i),2)}function Rj(r,e,t,i){return new We(be.negint,-1-Es(r,e+1,i),3)}function kj(r,e,t,i){return new We(be.negint,-1-Ss(r,e+1,i),5)}function Pj(r,e,t,i){let n=xs(r,e+1,i);if(typeof n!="bigint"){let s=-1-n;if(s>=Number.MIN_SAFE_INTEGER)return new We(be.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${ft} integers outside of the safe integer range are not supported`);return new We(be.negint,P4-BigInt(n),9)}function L2(r,e){let t=e.value,i=typeof t=="bigint"?t*P4-Cj:t*-1-1;Zn(r,e.type.majorEncoded,i)}var P4,Cj,O4=li(()=>{l();ws();Qa();Vo();P4=BigInt(-1),Cj=BigInt(1);L2.encodedSize=function(e){let t=e.value,i=typeof t=="bigint"?t*P4-Cj:t*-1-1;return i<$i[0]?1:i<$i[1]?2:i<$i[2]?3:i<$i[3]?5:9};L2.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}});function ag(r,e,t,i){Hc(r,e,t+i);let n=q2(r,e+t,e+t+i);return new We(be.bytes,n,t+i)}function Oj(r,e,t,i){return ag(r,e,1,t)}function Bj(r,e,t,i){return ag(r,e,2,_s(r,e+1,i))}function Nj(r,e,t,i){return ag(r,e,3,Es(r,e+1,i))}function Dj(r,e,t,i){return ag(r,e,5,Ss(r,e+1,i))}function qj(r,e,t,i){let n=xs(r,e+1,i);if(typeof n=="bigint")throw new Error(`${ft} 64-bit integer bytes lengths not supported`);return ag(r,e,9,n)}function F2(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===be.string?bj(r.value):r.value),r.encodedBytes}function Fd(r,e){let t=F2(e);Zn(r,e.type.majorEncoded,t.length),r.push(t)}function QCe(r,e){return r.length<e.length?-1:r.length>e.length?1:wj(r,e)}var U2=li(()=>{l();ws();Vo();Qa();Ld();Fd.encodedSize=function(e){let t=F2(e);return Zn.encodedSize(t.length)+t.length};Fd.compareTokens=function(e,t){return QCe(F2(e),F2(t))}});function cg(r,e,t,i){let n=t+i;return Hc(r,e,n),new We(be.string,yj(r,e+t,e+n),n)}function Mj(r,e,t,i){return cg(r,e,1,t)}function Lj(r,e,t,i){return cg(r,e,2,_s(r,e+1,i))}function Fj(r,e,t,i){return cg(r,e,3,Es(r,e+1,i))}function Uj(r,e,t,i){return cg(r,e,5,Ss(r,e+1,i))}function Kj(r,e,t,i){let n=xs(r,e+1,i);if(typeof n=="bigint")throw new Error(`${ft} 64-bit integer string lengths not supported`);return cg(r,e,9,n)}var jj,B4=li(()=>{l();ws();Vo();Qa();U2();Ld();jj=Fd});function Ud(r,e,t,i){return new We(be.array,i,t)}function Vj(r,e,t,i){return Ud(r,e,1,t)}function zj(r,e,t,i){return Ud(r,e,2,_s(r,e+1,i))}function Hj(r,e,t,i){return Ud(r,e,3,Es(r,e+1,i))}function Gj(r,e,t,i){return Ud(r,e,5,Ss(r,e+1,i))}function $j(r,e,t,i){let n=xs(r,e+1,i);if(typeof n=="bigint")throw new Error(`${ft} 64-bit integer array lengths not supported`);return Ud(r,e,9,n)}function Wj(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${ft} indefinite length items not allowed`);return Ud(r,e,1,Infinity)}function N4(r,e){Zn(r,be.array.majorEncoded,e.value)}var D4=li(()=>{l();ws();Qa();Vo();N4.compareTokens=Qs.compareTokens});function Kd(r,e,t,i){return new We(be.map,i,t)}function Yj(r,e,t,i){return Kd(r,e,1,t)}function Xj(r,e,t,i){return Kd(r,e,2,_s(r,e+1,i))}function Jj(r,e,t,i){return Kd(r,e,3,Es(r,e+1,i))}function Qj(r,e,t,i){return Kd(r,e,5,Ss(r,e+1,i))}function Zj(r,e,t,i){let n=xs(r,e+1,i);if(typeof n=="bigint")throw new Error(`${ft} 64-bit integer map lengths not supported`);return Kd(r,e,9,n)}function eV(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${ft} indefinite length items not allowed`);return Kd(r,e,1,Infinity)}function q4(r,e){Zn(r,be.map.majorEncoded,e.value)}var M4=li(()=>{l();ws();Qa();Vo();q4.compareTokens=Qs.compareTokens});function tV(r,e,t,i){return new We(be.tag,t,1)}function rV(r,e,t,i){return new We(be.tag,_s(r,e+1,i),2)}function iV(r,e,t,i){return new We(be.tag,Es(r,e+1,i),3)}function nV(r,e,t,i){return new We(be.tag,Ss(r,e+1,i),5)}function sV(r,e,t,i){return new We(be.tag,xs(r,e+1,i),9)}function L4(r,e){Zn(r,be.tag.majorEncoded,e.value)}var F4=li(()=>{l();ws();Qa();L4.compareTokens=Qs.compareTokens});function oV(r,e,t,i){if(i.allowUndefined===!1)throw new Error(`${ft} undefined values are not supported`);return new We(be.undefined,void 0,1)}function aV(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${ft} indefinite length items not allowed`);return new We(be.break,void 0,1)}function U4(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${ft} NaN values are not supported`);if(t.allowInfinity===!1&&(r===Infinity||r===-Infinity))throw new Error(`${ft} Infinity values are not supported`)}return new We(be.float,r,e)}function cV(r,e,t,i){return U4(K4(r,e+1),3,i)}function uV(r,e,t,i){return U4(j4(r,e+1),5,i)}function lV(r,e,t,i){return U4(fV(r,e+1),9,i)}function K2(r,e,t){let i=e.value;if(i===!1)r.push([be.float.majorEncoded|ZCe]);else if(i===!0)r.push([be.float.majorEncoded|ePe]);else if(i===null)r.push([be.float.majorEncoded|tPe]);else if(i===void 0)r.push([be.float.majorEncoded|rPe]);else{let n,s=!1;(!t||t.float64!==!0)&&(hV(i),n=K4(zo,1),i===n||Number.isNaN(i)?(zo[0]=249,r.push(zo.slice(0,3)),s=!0):(dV(i),n=j4(zo,1),i===n&&(zo[0]=250,r.push(zo.slice(0,5)),s=!0))),s||(iPe(i),n=fV(zo,1),zo[0]=251,r.push(zo.slice(0,9)))}}function hV(r){if(r===Infinity)Zs.setUint16(0,31744,!1);else if(r===-Infinity)Zs.setUint16(0,64512,!1);else if(Number.isNaN(r))Zs.setUint16(0,32256,!1);else{Zs.setFloat32(0,r);let e=Zs.getUint32(0),t=(e&2139095040)>>23,i=e&8388607;if(t===255)Zs.setUint16(0,31744,!1);else if(t===0)Zs.setUint16(0,(r&2147483648)>>16|i>>13,!1);else{let n=t-127;n<-24?Zs.setUint16(0,0):n<-14?Zs.setUint16(0,(e&2147483648)>>16|1<<24+n,!1):Zs.setUint16(0,(e&2147483648)>>16|n+15<<10|i>>13,!1)}}}function K4(r,e){if(r.length-e<2)throw new Error(`${ft} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return Infinity;if(t===64512)return-Infinity;if(t===32256)return NaN;let i=t>>10&31,n=t&1023,s;return i===0?s=n*2**-24:i!==31?s=(n+1024)*2**(i-25):s=n===0?Infinity:NaN,t&32768?-s:s}function dV(r){Zs.setFloat32(0,r,!1)}function j4(r,e){if(r.length-e<4)throw new Error(`${ft} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function iPe(r){Zs.setFloat64(0,r,!1)}function fV(r,e){if(r.length-e<8)throw new Error(`${ft} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}var ZCe,ePe,tPe,rPe,pV,Zs,zo,V4=li(()=>{l();ws();Vo();Qa();ZCe=20,ePe=21,tPe=22,rPe=23;K2.encodedSize=function(e,t){let i=e.value;if(i===!1||i===!0||i===null||i===void 0)return 1;let n;if(!t||t.float64!==!0){if(hV(i),n=K4(zo,1),i===n||Number.isNaN(i))return 3;if(dV(i),n=j4(zo,1),i===n)return 5}return 9};pV=new ArrayBuffer(9),Zs=new DataView(pV,1),zo=new Uint8Array(pV,0);K2.compareTokens=Qs.compareTokens});function zt(r,e,t){throw new Error(`${ft} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function j2(r){return()=>{throw new Error(`${ft} ${r}`)}}function yV(r){switch(r.type){case be.false:return Ja([244]);case be.true:return Ja([245]);case be.null:return Ja([246]);case be.bytes:return r.value.length?void 0:Ja([64]);case be.string:return r.value===""?Ja([96]):void 0;case be.array:return r.value===0?Ja([128]):void 0;case be.map:return r.value===0?Ja([160]):void 0;case be.uint:return r.value<24?Ja([Number(r.value)]):void 0;case be.negint:if(r.value>=-24)return Ja([31-Number(r.value)])}}var Ne,Ho,z4=li(()=>{l();ws();Qa();O4();U2();B4();D4();M4();F4();V4();Vo();Ld();Ne=[];for(let r=0;r<=23;r++)Ne[r]=zt;Ne[24]=Sj;Ne[25]=xj;Ne[26]=Aj;Ne[27]=Ij;Ne[28]=zt;Ne[29]=zt;Ne[30]=zt;Ne[31]=zt;for(let r=32;r<=55;r++)Ne[r]=zt;Ne[56]=Tj;Ne[57]=Rj;Ne[58]=kj;Ne[59]=Pj;Ne[60]=zt;Ne[61]=zt;Ne[62]=zt;Ne[63]=zt;for(let r=64;r<=87;r++)Ne[r]=Oj;Ne[88]=Bj;Ne[89]=Nj;Ne[90]=Dj;Ne[91]=qj;Ne[92]=zt;Ne[93]=zt;Ne[94]=zt;Ne[95]=j2("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)Ne[r]=Mj;Ne[120]=Lj;Ne[121]=Fj;Ne[122]=Uj;Ne[123]=Kj;Ne[124]=zt;Ne[125]=zt;Ne[126]=zt;Ne[127]=j2("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)Ne[r]=Vj;Ne[152]=zj;Ne[153]=Hj;Ne[154]=Gj;Ne[155]=$j;Ne[156]=zt;Ne[157]=zt;Ne[158]=zt;Ne[159]=Wj;for(let r=160;r<=183;r++)Ne[r]=Yj;Ne[184]=Xj;Ne[185]=Jj;Ne[186]=Qj;Ne[187]=Zj;Ne[188]=zt;Ne[189]=zt;Ne[190]=zt;Ne[191]=eV;for(let r=192;r<=215;r++)Ne[r]=tV;Ne[216]=rV;Ne[217]=iV;Ne[218]=nV;Ne[219]=sV;Ne[220]=zt;Ne[221]=zt;Ne[222]=zt;Ne[223]=zt;for(let r=224;r<=243;r++)Ne[r]=j2("simple values are not supported");Ne[244]=zt;Ne[245]=zt;Ne[246]=zt;Ne[247]=oV;Ne[248]=j2("simple values are not supported");Ne[249]=cV;Ne[250]=uV;Ne[251]=lV;Ne[252]=zt;Ne[253]=zt;Ne[254]=zt;Ne[255]=aV;Ho=[];for(let r=0;r<24;r++)Ho[r]=new We(be.uint,r,1);for(let r=-1;r>=-24;r--)Ho[31-r]=new We(be.negint,r,1);Ho[64]=new We(be.bytes,new Uint8Array(0),1);Ho[96]=new We(be.string,"",1);Ho[128]=new We(be.array,0,1);Ho[160]=new We(be.map,0,1);Ho[244]=new We(be.false,!1,1);Ho[245]=new We(be.true,!0,1);Ho[246]=new We(be.null,null,1)});function V2(r,e={},t){let i=hj(r),n=e&&e.typeEncoders&&e.typeEncoders[i]||Qu[i];if(typeof n=="function"){let o=n(r,i,e,t);if(o!=null)return o}let s=Qu[i];if(!s)throw new Error(`${C4} unsupported type: ${i}`);return s(r,i,e,t)}function oPe(r,e){e.mapSorter&&r.sort(e.mapSorter)}function nPe(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],i=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==i.type)return t.type.compare(i.type);let n=t.type.major,s=Za[n].compareTokens(t,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function bV(r,e,t,i){if(Array.isArray(e))for(let n of e)bV(r,n,t,i);else t[e.type.major](r,e,i)}function aPe(r,e,t){let i=V2(r,t);if(!Array.isArray(i)&&t.quickEncodeToken){let n=t.quickEncodeToken(i);if(n)return n;let s=e[i.type.major];if(s.encodedSize){let o=s.encodedSize(i,t),a=new M2(o);if(s(a,i,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return k4(a.chunks[0])}}return bV(gV,i,e,t),gV.toBytes(!0)}function mV(r,e){return e=Object.assign({},sPe,e),aPe(r,Za,e)}var sPe,Za,gV,ug,Ju,Qu,vV=li(()=>{l();dj();ws();Ej();Vo();z4();Ld();Qa();O4();U2();B4();D4();M4();F4();V4();sPe={float64:!1,mapSorter:nPe,quickEncodeToken:yV},Za=[];Za[be.uint.major]=Qs;Za[be.negint.major]=L2;Za[be.bytes.major]=Fd;Za[be.string.major]=jj;Za[be.array.major]=N4;Za[be.map.major]=q4;Za[be.tag.major]=L4;Za[be.float.major]=K2;gV=new M2,ug=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${C4} object contains circular references`);return new ug(t,e)}},Ju={null:new We(be.null,null),undefined:new We(be.undefined,void 0),true:new We(be.true,!0),false:new We(be.false,!1),emptyArray:new We(be.array,0),emptyMap:new We(be.map,0)},Qu={number(r,e,t,i){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new We(be.float,r):r>=0?new We(be.uint,r):new We(be.negint,r)},bigint(r,e,t,i){return r>=BigInt(0)?new We(be.uint,r):new We(be.negint,r)},Uint8Array(r,e,t,i){return new We(be.bytes,r)},string(r,e,t,i){return new We(be.string,r)},boolean(r,e,t,i){return r?Ju.true:Ju.false},null(r,e,t,i){return Ju.null},undefined(r,e,t,i){return Ju.undefined},ArrayBuffer(r,e,t,i){return new We(be.bytes,new Uint8Array(r))},DataView(r,e,t,i){return new We(be.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,i){if(!r.length)return t.addBreakTokens===!0?[Ju.emptyArray,new We(be.break)]:Ju.emptyArray;i=ug.createCheck(i,r);let n=[],s=0;for(let o of r)n[s++]=V2(o,t,i);return t.addBreakTokens?[new We(be.array,r.length),n,new We(be.break)]:[new We(be.array,r.length),n]},Object(r,e,t,i){let n=e!=="Object",s=n?r.keys():Object.keys(r),o=n?r.size:s.length;if(!o)return t.addBreakTokens===!0?[Ju.emptyMap,new We(be.break)]:Ju.emptyMap;i=ug.createCheck(i,r);let a=[],c=0;for(let u of s)a[c++]=[V2(u,t,i),V2(n?r.get(u):r[u],t,i)];return oPe(a,t),t.addBreakTokens?[new We(be.map,o),a,new We(be.break)]:[new We(be.map,o),a]}};Qu.Map=Qu.Object;Qu.Buffer=Qu.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Qu[`${r}Array`]=Qu.DataView});function uPe(r,e,t){let i=[];for(let n=0;n<r.value;n++){let s=lg(e,t);if(s===z2){if(r.value===Infinity)break;throw new Error(`${ft} got unexpected break to lengthed array`)}if(s===fg)throw new Error(`${ft} found array but not enough entries (got ${n}, expected ${r.value})`);i[n]=s}return i}function fPe(r,e,t){let i=t.useMaps===!0,n=i?void 0:{},s=i?new Map:void 0;for(let o=0;o<r.value;o++){let a=lg(e,t);if(a===z2){if(r.value===Infinity)break;throw new Error(`${ft} got unexpected break to lengthed map`)}if(a===fg)throw new Error(`${ft} found map but not enough entries (got ${o} [no key], expected ${r.value})`);if(i!==!0&&typeof a!="string")throw new Error(`${ft} non-string keys not supported (got ${typeof a})`);let c=lg(e,t);if(c===fg)throw new Error(`${ft} found map but not enough entries (got ${o} [no value], expected ${r.value})`);i?s.set(a,c):n[a]=c}return i?s:n}function lg(r,e){if(r.done())return fg;let t=r.next();if(t.type===be.break)return z2;if(t.type.terminal)return t.value;if(t.type===be.array)return uPe(t,r,e);if(t.type===be.map)return fPe(t,r,e);if(t.type===be.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let i=lg(r,e);return e.tags[t.value](i)}throw new Error(`${ft} tag not supported (${t.value})`)}throw new Error("unsupported")}function _V(r,e){if(!(r instanceof Uint8Array))throw new Error(`${ft} data to decode must be a Uint8Array`);e=Object.assign({},cPe,e);let t=e.tokenizer||new wV(r,e),i=lg(t,e);if(i===fg)throw new Error(`${ft} did not find any content to decode`);if(i===z2)throw new Error(`${ft} got unexpected break`);if(!t.done())throw new Error(`${ft} too many terminals, data makes no sense`);return i}var cPe,wV,fg,z2,EV=li(()=>{l();Vo();ws();z4();cPe={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},wV=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=Ho[e];if(t===void 0){let i=Ne[e];if(!i)throw new Error(`${ft} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;t=i(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}},fg=Symbol.for("DONE"),z2=Symbol.for("BREAK")});var H2={};oP(H2,{Token:()=>We,Type:()=>be,decode:()=>_V,encode:()=>mV});var G2=li(()=>{l();vV();EV();ws()});var jd=p((l2t,SV)=>{l();"use strict";var xV=Qe(),lPe=ge(),hPe=fj(),dPe=xe(),AV=qd(),pPe=jy(),Zu=(G2(),H2),yPe=en(),$2=$r(),{Key:gPe}=ir();function bPe(r){let e=`Invalid type '${r}', must be one of {direct, indirect, recursive, all}`;return lPe(new Error(e),"ERR_INVALID_PIN_TYPE")}var IV=yPe.encoding("base32upper");function W2(r){return new gPe(`/${IV.encode(r.multihash)}`)}function TV(r){return IV.decode(r.toString().slice(1))}var eo={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"},H4=class{constructor({repo:e,ipld:t}){this.repo=e,this.ipld=t,this.log=dPe("ipfs:pin"),this.directPins=new Set,this.recursivePins=new Set}async*_walkDag(e,t){let i=await this.ipld.get(e,t);if(e.codec==="dag-pb")for(let n of i.Links)yield n.Hash,yield*this._walkDag(n.Hash,t);else if(e.codec==="dag-cbor")for(let[,n]of hPe(i))yield n,yield*this._walkDag(n,t)}async pinDirectly(e,t={}){await this.ipld.get(e,t);let i={depth:0};return e.version!==0&&(i.version=e.version),e.codec!=="dag-pb"&&(i.codec=$2.getNumber(e.codec)),t.metadata&&(i.metadata=t.metadata),this.repo.pins.put(W2(e),Zu.encode(i))}async unpin(e,t){return this.repo.pins.delete(W2(e))}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let i={depth:Infinity};e.version!==0&&(i.version=e.version),e.codec!=="dag-pb"&&(i.codec=$2.getNumber(e.codec)),t.metadata&&(i.metadata=t.metadata),await this.repo.pins.put(W2(e),Zu.encode(i))}async*directKeys(e){for await(let t of this.repo.pins.query({filters:[i=>Zu.decode(i.value).depth===0]})){let i=Zu.decode(t.value),n=i.version||0,s=i.codec?$2.getName(i.codec):"dag-pb",o=TV(t.key);yield{cid:new xV(n,s,o),metadata:i.metadata}}}async*recursiveKeys(e){for await(let t of this.repo.pins.query({filters:[i=>Zu.decode(i.value).depth===Infinity]})){let i=Zu.decode(t.value),n=i.version||0,s=i.codec?$2.getName(i.codec):"dag-pb",o=TV(t.key);yield{cid:new xV(n,s,o),metadata:i.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let i of this._walkDag(t,e)){let n=[eo.recursive];(await this.isPinnedWithType(i,n)).pinned||(yield i)}}async isPinnedWithType(e,t,i){Array.isArray(t)||(t=[t]);let n=t.includes(eo.all),s=t.includes(eo.direct),o=t.includes(eo.recursive),a=t.includes(eo.indirect);if(o||s||n){let f=await AV(this.repo.pins.query({prefix:W2(e).toString(),filters:[h=>{if(n)return!0;let d=Zu.decode(h.value);return t.includes(d.depth===0?eo.direct:eo.recursive)}],limit:1}));if(f){let h=Zu.decode(f.value);return{cid:e,pinned:!0,reason:h.depth===0?eo.direct:eo.recursive,metadata:h.metadata}}}let c=this;async function*u(f,h){for await(let{cid:d}of h)for await(let y of c._walkDag(d))if(y.equals(f)){yield d;return}}if(n||a){let f=await AV(u(e,this.recursiveKeys()));if(f)return{cid:e,pinned:!0,reason:eo.indirect,parent:f}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t){await pPe(this._walkDag(e,t))}static checkPinType(e){if(typeof e!="string"||!Object.keys(eo).includes(e))throw bPe(e);return!0}};H4.PinTypes=eo;SV.exports=H4});var Y2=p((h2t,RV)=>{l();"use strict";var hg=ge(),G4=Qe();RV.exports=async function*(e){if(e==null)throw hg(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(G4.isCID(e)){yield Go({cid:e});return}if(e instanceof String||typeof e=="string"){yield Go({path:e});return}if(e.cid!=null||e.path!=null)return yield Go(e);if(Symbol.iterator in e){let t=e[Symbol.iterator](),i=t.next();if(i.done)return t;if(G4.isCID(i.value)||i.value instanceof String||typeof i.value=="string"){yield Go({cid:i.value});for(let n of t)yield Go({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield Go(i.value);for(let n of t)yield Go(n);return}throw hg(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in e){let t=e[Symbol.asyncIterator](),i=await t.next();if(i.done)return t;if(G4.isCID(i.value)||i.value instanceof String||typeof i.value=="string"){yield Go({cid:i.value});for await(let n of t)yield Go({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield Go(i.value);for await(let n of t)yield Go(n);return}throw hg(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw hg(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")};function Go(r){let e=r.cid||`${r.path}`;if(!e)throw hg(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let t={path:e,recursive:r.recursive!==!1};return r.metadata!=null&&(t.metadata=r.metadata),t}});var PV=p((d2t,kV)=>{l();"use strict";var{resolvePath:mPe}=zi(),vPe=jd(),{PinTypes:CV}=vPe,wPe=Be(),_Pe=Y2();kV.exports=({pinManager:r,gcLock:e,ipld:t})=>{async function*i(n,s={}){let o=async function*(){for await(let{path:u,recursive:f,metadata:h}of _Pe(n)){let d=await mPe(t,u),{reason:y}=await r.isPinnedWithType(d,[CV.recursive,CV.direct]);if(y==="recursive"&&!f)throw new Error(`${d} already pinned recursively`);f?await r.pinRecursively(d,{metadata:h}):await r.pinDirectly(d,{metadata:h}),yield d}};if(!Boolean(s.lock)){yield*o();return}let c=await e.readLock();try{yield*o()}finally{c()}}return wPe(i)}});var NV=p((p2t,OV)=>{l();"use strict";var BV=jd(),{PinTypes:As}=BV,EPe=Y2(),{resolvePath:SPe}=zi(),xPe=Be();function dg(r,e,t){let i={type:r,cid:e};return t&&(i.metadata=t),i}OV.exports=({pinManager:r,ipld:e})=>{async function*t(i={}){let n=As.all;if(i.type&&(n=i.type,BV.checkPinType(n)),i.paths){let s=!1;for await(let{path:o}of EPe(i.paths)){let a=await SPe(e,o),{reason:c,pinned:u,parent:f,metadata:h}=await r.isPinnedWithType(a,n);if(!u)throw new Error(`path '${o}' is not pinned`);switch(c){case As.direct:case As.recursive:s=!0,yield dg(c,a,h);break;default:s=!0,yield dg(`${As.indirect} through ${f}`,a,h)}}if(!s)throw new Error("No match found");return}if(n===As.recursive||n===As.all)for await(let{cid:s,metadata:o}of r.recursiveKeys())yield dg(As.recursive,s,o);if(n===As.indirect||n===As.all)for await(let s of r.indirectKeys(i))yield dg(As.indirect,s);if(n===As.direct||n===As.all)for await(let{cid:s,metadata:o}of r.directKeys())yield dg(As.direct,s,o)}return xPe(t)}});var qV=p((y2t,DV)=>{l();"use strict";var APe=$a();DV.exports=({rmAll:r})=>(e,t={})=>APe(r([{path:e,...t}],t))});var LV=p((g2t,MV)=>{l();"use strict";var IPe=Y2(),{resolvePath:TPe}=zi(),RPe=Be(),{PinTypes:$4}=jd();MV.exports=({pinManager:r,gcLock:e,ipld:t})=>{async function*i(n,s={}){let o=await e.readLock();try{for await(let{path:a,recursive:c}of IPe(n)){let u=await TPe(t,a),{pinned:f,reason:h}=await r.isPinnedWithType(u,$4.all);if(!f)throw new Error(`${u} is not pinned`);switch(h){case $4.recursive:if(!c)throw new Error(`${u} is pinned recursively`);await r.unpin(u),yield u;break;case $4.direct:await r.unpin(u),yield u;break;default:throw new Error(`${u} is pinned indirectly under ${h}`)}}}finally{o()}}return RPe(i)}});var KV=p((b2t,FV)=>{l();"use strict";var kPe=sK(),CPe=PV(),PPe=NV(),OPe=qV(),BPe=LV(),UV=class{constructor({gcLock:e,ipld:t,pinManager:i}){let n=CPe({gcLock:e,ipld:t,pinManager:i});this.addAll=n,this.add=kPe({addAll:n});let s=BPe({gcLock:e,ipld:t,pinManager:i});this.rmAll=s,this.rm=OPe({rmAll:s}),this.ls=PPe({ipld:t,pinManager:i}),this.remote={add:(o,a={})=>Promise.reject(new Error("Not implemented")),ls:async function*(o,a={}){return Promise.reject(new Error("Not implemented"))},rm:(o,a={})=>Promise.reject(new Error("Not implemented")),rmAll:(o,a={})=>Promise.reject(new Error("Not implemented")),service:{add:(o,a)=>Promise.reject(new Error("Not implemented")),rm:(o,a={})=>Promise.reject(new Error("Not implemented")),ls:(o={})=>Promise.reject(new Error("Not implemented"))}}}};FV.exports=UV});var jV=p((v2t,W4)=>{l();var m2t=function(){typeof W4!="undefined"&&(W4.exports=_);var r=24*3600,e=3200,t=(365*400+97)*e/400,i=r*t,n=i*1e3,s=1e3*1e4*1e4*r,o=16777216,a=65536*65536,c=1e3*1e3,u=1e3*1e3*1e3,f="000000000",h=Math.trunc||M,d=_.prototype;_.fromDate=re,_.fromInt64BE=Q(0,1,2,3,0,4),_.fromInt64LE=Q(3,2,1,0,4,0),_.fromString=ee,_.fromTimeT=L,d.year=0,d.time=0,d.nano=0,d.addNano=z,d.getNano=Z,d.getTimeT=w,d.getYear=P,d.toDate=X,d.toJSON=R,d.toString=B,d.writeInt64BE=U(0,1,2,3,0,4),d.writeInt64LE=U(3,2,1,0,4,0);var y="%Y-%m-%dT%H:%M:%S.%NZ",g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],x={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return _;function _(J,ue,S){var A=this;if(!(A instanceof _))return new _(J,ue,S);A.time=+J||0,A.nano=+ue||0,A.year=+S||0,q(A)}function P(){var J=this.toDate().getUTCFullYear();return J+this.year}function q(J){var ue=J.year,S=J.time,A=J.nano,ie,ae;if(A<0||c<=A){var E=Math.floor(A/c);A-=E*c,S+=E,ie=1}var I=ue%e;if(S<-s||s<S||I){ae=h(S/n),ae&&(ue+=ae*e,S-=ae*n);var j=W(S);j.setUTCFullYear(I+j.getUTCFullYear()),ue-=I,S=+j,ae=h(ue/e);var H=S+ae*n;ae&&-s<=H&&H<=s&&(ue-=ae*e,S=H),ie=1}return ie&&(J.year=ue,J.time=S,J.nano=A),J}function X(){var J=q(this);return W(J.time)}function W(J){var ue=new Date(0);return ue.setTime(J),ue}function z(J){return this.nano+=+J||0,this}function Z(){var J=q(this);return(J.time%1e3*c+ +J.nano+u)%u}function ee(J){var ue,S=new _;J+="";var A=J.replace(/^\s*[+\-]?\d+/,function(ie){var ae=+ie,E=1970+(ae-1970)%400;return S.year=ae-E,E}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(ie,ae,E){return ae<0&&(E*=-1),ue=(+ae*60+ +E)*6e4,""}).replace(/\.\d+$/,function(ie){return S.nano=+(ie+f).substr(1,9),""}).split(/\D+/);if(A.length>1?A[1]--:A[1]=0,S.time=ue=Date.UTC.apply(Date,A)-(ue||0),isNaN(ue))throw new TypeError("Invalid Date");return q(S)}function re(J){return new _(+J)}function L(J){return b(J,0)}function b(J,ue){ue|=0,ue*=a,J=+J||0;var S=h(ue/i)+h(J/i),A=ue%i+J%i,ie=h(A/i);return ie&&(S+=ie,A-=ie*i),new _(A*1e3,0,S*e)}function w(){var J=q(this),ue=Math.floor(J.time/1e3),S=J.year;return S&&(ue+=S*t*r/e),ue}function R(){return this.toString().replace(/0{1,6}Z$/,"Z")}function B(J){var ue=this,S=ue.toDate(),A={H,L:F,M:T,N,S:K,Y:ae,a:Y,b:ne,d:I,e:j,m:E};return ie(J||y);function ie(te){return te.replace(/%./g,function(he){var me=he[1],fe=x[me],je=A[me];return fe?ie(fe):je?je():he})}function ae(){var te=ue.getYear();return te>999999?"+"+te:te>9999?"+"+de(te,6):te>=0?de(te,4):te>=-999999?"-"+de(-te,6):te}function E(){return V(S.getUTCMonth()+1)}function I(){return V(S.getUTCDate())}function j(){return v(S.getUTCDate())}function H(){return V(S.getUTCHours())}function T(){return V(S.getUTCMinutes())}function K(){return V(S.getUTCSeconds())}function F(){return de(S.getUTCMilliseconds(),3)}function N(){return de(ue.getNano(),9)}function Y(){return m[S.getUTCDay()]}function ne(){return g[S.getUTCMonth()]}}function U(J,ue,S,A,ie,ae){return E;function E(j,H){var T=q(this);j||(j=new Array(8)),G(j,H|=0);var K=Math.floor(T.time/1e3),F=T.year*(t*r/e),N=h(F/a)+h(K/a),Y=F%a+K%a,ne=Math.floor(Y/a);return ne&&(N+=ne,Y-=ne*a),I(j,H+ie,N),I(j,H+ae,Y),j}function I(j,H,T){j[H+J]=T>>24&255,j[H+ue]=T>>16&255,j[H+S]=T>>8&255,j[H+A]=T&255}}function Q(J,ue,S,A,ie,ae){return E;function E(j,H){G(j,H|=0);var T=I(j,H+ie),K=I(j,H+ae);return b(K,T)}function I(j,H){return j[H+J]*o+(j[H+ue]<<16|j[H+S]<<8|j[H+A])}}function G(J,ue){var S=J&&J.length;if(S==null)throw new TypeError("Invalid Buffer");if(S<ue+8)throw new RangeError("Out of range")}function M(J){var ue=J-J%1;return ue===0&&(J<0||J===0&&1/J!=1/0)?-0:ue}function v(J){return(J>9?"":" ")+(J|0)}function V(J){return(J>9?"":"0")+(J|0)}function de(J,ue){return(f+(J|0)).substr(-ue)}}()});var ZV=p((w2t,VV)=>{l();VV.exports=Sr;var to=null;try{to=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}function Sr(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Sr.prototype.__isLong__;Object.defineProperty(Sr.prototype,"__isLong__",{value:!0});function es(r){return(r&&r.__isLong__)===!0}Sr.isLong=es;var zV={},HV={};function vl(r,e){var t,i,n;return e?(r>>>=0,(n=0<=r&&r<256)&&(i=HV[r],i)?i:(t=xr(r,(r|0)<0?-1:0,!0),n&&(HV[r]=t),t)):(r|=0,(n=-128<=r&&r<128)&&(i=zV[r],i)?i:(t=xr(r,r<0?-1:0,!1),n&&(zV[r]=t),t))}Sr.fromInt=vl;function ro(r,e){if(isNaN(r))return e?wl:io;if(e){if(r<0)return wl;if(r>=GV)return YV}else{if(r<=-$V)return ts;if(r+1>=$V)return WV}return r<0?ro(-r,e).neg():xr(r%Vd|0,r/Vd|0,e)}Sr.fromNumber=ro;function xr(r,e,t){return new Sr(r,e,t)}Sr.fromBits=xr;var X2=Math.pow;function Y4(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return io;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=r.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return Y4(r.substring(1),e,t).neg();for(var n=ro(X2(t,8)),s=io,o=0;o<r.length;o+=8){var a=Math.min(8,r.length-o),c=parseInt(r.substring(o,o+a),t);if(a<8){var u=ro(X2(t,a));s=s.mul(u).add(ro(c))}else s=s.mul(n),s=s.add(ro(c))}return s.unsigned=e,s}Sr.fromString=Y4;function $o(r,e){return typeof r=="number"?ro(r,e):typeof r=="string"?Y4(r,e):xr(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Sr.fromValue=$o;var XV=1<<16,NPe=1<<24,Vd=XV*XV,GV=Vd*Vd,$V=GV/2,JV=vl(NPe),io=vl(0);Sr.ZERO=io;var wl=vl(0,!0);Sr.UZERO=wl;var zd=vl(1);Sr.ONE=zd;var QV=vl(1,!0);Sr.UONE=QV;var X4=vl(-1);Sr.NEG_ONE=X4;var WV=xr(4294967295|0,2147483647|0,!1);Sr.MAX_VALUE=WV;var YV=xr(4294967295|0,4294967295|0,!0);Sr.MAX_UNSIGNED_VALUE=YV;var ts=xr(0,2147483648|0,!1);Sr.MIN_VALUE=ts;var ke=Sr.prototype;ke.toInt=function(){return this.unsigned?this.low>>>0:this.low};ke.toNumber=function(){return this.unsigned?(this.high>>>0)*Vd+(this.low>>>0):this.high*Vd+(this.low>>>0)};ke.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ts)){var t=ro(e),i=this.div(t),n=i.mul(t).sub(this);return i.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=ro(X2(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),u=o.sub(c.mul(s)).toInt()>>>0,f=u.toString(e);if(o=c,o.isZero())return f+a;for(;f.length<6;)f="0"+f;a=""+f+a}};ke.getHighBits=function(){return this.high};ke.getHighBitsUnsigned=function(){return this.high>>>0};ke.getLowBits=function(){return this.low};ke.getLowBitsUnsigned=function(){return this.low>>>0};ke.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ts)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};ke.isZero=function(){return this.high===0&&this.low===0};ke.eqz=ke.isZero;ke.isNegative=function(){return!this.unsigned&&this.high<0};ke.isPositive=function(){return this.unsigned||this.high>=0};ke.isOdd=function(){return(this.low&1)==1};ke.isEven=function(){return(this.low&1)==0};ke.equals=function(e){return es(e)||(e=$o(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};ke.eq=ke.equals;ke.notEquals=function(e){return!this.eq(e)};ke.neq=ke.notEquals;ke.ne=ke.notEquals;ke.lessThan=function(e){return this.comp(e)<0};ke.lt=ke.lessThan;ke.lessThanOrEqual=function(e){return this.comp(e)<=0};ke.lte=ke.lessThanOrEqual;ke.le=ke.lessThanOrEqual;ke.greaterThan=function(e){return this.comp(e)>0};ke.gt=ke.greaterThan;ke.greaterThanOrEqual=function(e){return this.comp(e)>=0};ke.gte=ke.greaterThanOrEqual;ke.ge=ke.greaterThanOrEqual;ke.compare=function(e){if(es(e)||(e=$o(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ke.comp=ke.compare;ke.negate=function(){return!this.unsigned&&this.eq(ts)?ts:this.not().add(zd)};ke.neg=ke.negate;ke.add=function(e){es(e)||(e=$o(e));var t=this.high>>>16,i=this.high&65535,n=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,u=e.low&65535,f=0,h=0,d=0,y=0;return y+=s+u,d+=y>>>16,y&=65535,d+=n+c,h+=d>>>16,d&=65535,h+=i+a,f+=h>>>16,h&=65535,f+=t+o,f&=65535,xr(d<<16|y,f<<16|h,this.unsigned)};ke.subtract=function(e){return es(e)||(e=$o(e)),this.add(e.neg())};ke.sub=ke.subtract;ke.multiply=function(e){if(this.isZero())return io;if(es(e)||(e=$o(e)),to){var t=to.mul(this.low,this.high,e.low,e.high);return xr(t,to.get_high(),this.unsigned)}if(e.isZero())return io;if(this.eq(ts))return e.isOdd()?ts:io;if(e.eq(ts))return this.isOdd()?ts:io;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(JV)&&e.lt(JV))return ro(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,u=e.low>>>16,f=e.low&65535,h=0,d=0,y=0,g=0;return g+=o*f,y+=g>>>16,g&=65535,y+=s*f,d+=y>>>16,y&=65535,y+=o*u,d+=y>>>16,y&=65535,d+=n*f,h+=d>>>16,d&=65535,d+=s*u,h+=d>>>16,d&=65535,d+=o*c,h+=d>>>16,d&=65535,h+=i*f+n*u+s*c+o*a,h&=65535,xr(y<<16|g,h<<16|d,this.unsigned)};ke.mul=ke.multiply;ke.divide=function(e){if(es(e)||(e=$o(e)),e.isZero())throw Error("division by zero");if(to){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?to.div_u:to.div_s)(this.low,this.high,e.low,e.high);return xr(t,to.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?wl:io;var i,n,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return wl;if(e.gt(this.shru(1)))return QV;s=wl}else{if(this.eq(ts)){if(e.eq(zd)||e.eq(X4))return ts;if(e.eq(ts))return zd;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(io)?e.isNegative()?zd:X4:(n=this.sub(e.mul(i)),s=i.add(n.div(e)),s)}else if(e.eq(ts))return this.unsigned?wl:io;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=io}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),c=a<=48?1:X2(2,a-48),u=ro(i),f=u.mul(e);f.isNegative()||f.gt(n);)i-=c,u=ro(i,this.unsigned),f=u.mul(e);u.isZero()&&(u=zd),s=s.add(u),n=n.sub(f)}return s};ke.div=ke.divide;ke.modulo=function(e){if(es(e)||(e=$o(e)),to){var t=(this.unsigned?to.rem_u:to.rem_s)(this.low,this.high,e.low,e.high);return xr(t,to.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ke.mod=ke.modulo;ke.rem=ke.modulo;ke.not=function(){return xr(~this.low,~this.high,this.unsigned)};ke.and=function(e){return es(e)||(e=$o(e)),xr(this.low&e.low,this.high&e.high,this.unsigned)};ke.or=function(e){return es(e)||(e=$o(e)),xr(this.low|e.low,this.high|e.high,this.unsigned)};ke.xor=function(e){return es(e)||(e=$o(e)),xr(this.low^e.low,this.high^e.high,this.unsigned)};ke.shiftLeft=function(e){return es(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?xr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):xr(0,this.low<<e-32,this.unsigned)};ke.shl=ke.shiftLeft;ke.shiftRight=function(e){return es(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?xr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):xr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ke.shr=ke.shiftRight;ke.shiftRightUnsigned=function(e){if(es(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var i=this.low;return xr(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?xr(t,0,this.unsigned):xr(t>>>e-32,0,this.unsigned)};ke.shru=ke.shiftRightUnsigned;ke.shr_u=ke.shiftRightUnsigned;ke.toSigned=function(){return this.unsigned?xr(this.low,this.high,!1):this};ke.toUnsigned=function(){return this.unsigned?this:xr(this.low,this.high,!0)};ke.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ke.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ke.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Sr.fromBytes=function(e,t,i){return i?Sr.fromBytesLE(e,t):Sr.fromBytesBE(e,t)};Sr.fromBytesLE=function(e,t){return new Sr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Sr.fromBytesBE=function(e,t){return new Sr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}});var rz=p((_2t,ez)=>{l();"use strict";var Hd=hi(),tz=Hd.Reader,DPe=Hd.Writer,et=Hd.util,Gd=Hd.roots["ipfs-ipns"]||(Hd.roots["ipfs-ipns"]={});Gd.IpnsEntry=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.value=et.newBuffer([]),r.prototype.signature=et.newBuffer([]),r.prototype.validityType=0,r.prototype.validity=et.newBuffer([]),r.prototype.sequence=et.Long?et.Long.fromBits(0,0,!0):0,r.prototype.ttl=et.Long?et.Long.fromBits(0,0,!0):0,r.prototype.pubKey=et.newBuffer([]),r.prototype.signatureV2=et.newBuffer([]),r.prototype.data=et.newBuffer([]),r.encode=function(t,i){return i||(i=DPe.create()),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(10).bytes(t.value),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(18).bytes(t.signature),t.validityType!=null&&Object.hasOwnProperty.call(t,"validityType")&&i.uint32(24).int32(t.validityType),t.validity!=null&&Object.hasOwnProperty.call(t,"validity")&&i.uint32(34).bytes(t.validity),t.sequence!=null&&Object.hasOwnProperty.call(t,"sequence")&&i.uint32(40).uint64(t.sequence),t.ttl!=null&&Object.hasOwnProperty.call(t,"ttl")&&i.uint32(48).uint64(t.ttl),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(58).bytes(t.pubKey),t.signatureV2!=null&&Object.hasOwnProperty.call(t,"signatureV2")&&i.uint32(66).bytes(t.signatureV2),t.data!=null&&Object.hasOwnProperty.call(t,"data")&&i.uint32(74).bytes(t.data),i},r.decode=function(t,i){t instanceof tz||(t=tz.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Gd.IpnsEntry;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.value=t.bytes();break;case 2:s.signature=t.bytes();break;case 3:s.validityType=t.int32();break;case 4:s.validity=t.bytes();break;case 5:s.sequence=t.uint64();break;case 6:s.ttl=t.uint64();break;case 7:s.pubKey=t.bytes();break;case 8:s.signatureV2=t.bytes();break;case 9:s.data=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Gd.IpnsEntry)return t;var i=new Gd.IpnsEntry;switch(t.value!=null&&(typeof t.value=="string"?et.base64.decode(t.value,i.value=et.newBuffer(et.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.signature!=null&&(typeof t.signature=="string"?et.base64.decode(t.signature,i.signature=et.newBuffer(et.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),t.validityType){case"EOL":case 0:i.validityType=0;break}return t.validity!=null&&(typeof t.validity=="string"?et.base64.decode(t.validity,i.validity=et.newBuffer(et.base64.length(t.validity)),0):t.validity.length&&(i.validity=t.validity)),t.sequence!=null&&(et.Long?(i.sequence=et.Long.fromValue(t.sequence)).unsigned=!0:typeof t.sequence=="string"?i.sequence=parseInt(t.sequence,10):typeof t.sequence=="number"?i.sequence=t.sequence:typeof t.sequence=="object"&&(i.sequence=new et.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0))),t.ttl!=null&&(et.Long?(i.ttl=et.Long.fromValue(t.ttl)).unsigned=!0:typeof t.ttl=="string"?i.ttl=parseInt(t.ttl,10):typeof t.ttl=="number"?i.ttl=t.ttl:typeof t.ttl=="object"&&(i.ttl=new et.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0))),t.pubKey!=null&&(typeof t.pubKey=="string"?et.base64.decode(t.pubKey,i.pubKey=et.newBuffer(et.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.signatureV2!=null&&(typeof t.signatureV2=="string"?et.base64.decode(t.signatureV2,i.signatureV2=et.newBuffer(et.base64.length(t.signatureV2)),0):t.signatureV2.length&&(i.signatureV2=t.signatureV2)),t.data!=null&&(typeof t.data=="string"?et.base64.decode(t.data,i.data=et.newBuffer(et.base64.length(t.data)),0):t.data.length&&(i.data=t.data)),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=et.newBuffer(n.value))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=et.newBuffer(n.signature))),n.validityType=i.enums===String?"EOL":0,i.bytes===String?n.validity="":(n.validity=[],i.bytes!==Array&&(n.validity=et.newBuffer(n.validity))),et.Long){var s=new et.Long(0,0,!0);n.sequence=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.sequence=i.longs===String?"0":0;if(et.Long){var s=new et.Long(0,0,!0);n.ttl=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.ttl=i.longs===String?"0":0;i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=et.newBuffer(n.pubKey))),i.bytes===String?n.signatureV2="":(n.signatureV2=[],i.bytes!==Array&&(n.signatureV2=et.newBuffer(n.signatureV2))),i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=et.newBuffer(n.data)))}return t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?et.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?et.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),t.validityType!=null&&t.hasOwnProperty("validityType")&&(n.validityType=i.enums===String?Gd.IpnsEntry.ValidityType[t.validityType]:t.validityType),t.validity!=null&&t.hasOwnProperty("validity")&&(n.validity=i.bytes===String?et.base64.encode(t.validity,0,t.validity.length):i.bytes===Array?Array.prototype.slice.call(t.validity):t.validity),t.sequence!=null&&t.hasOwnProperty("sequence")&&(typeof t.sequence=="number"?n.sequence=i.longs===String?String(t.sequence):t.sequence:n.sequence=i.longs===String?et.Long.prototype.toString.call(t.sequence):i.longs===Number?new et.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0):t.sequence),t.ttl!=null&&t.hasOwnProperty("ttl")&&(typeof t.ttl=="number"?n.ttl=i.longs===String?String(t.ttl):t.ttl:n.ttl=i.longs===String?et.Long.prototype.toString.call(t.ttl):i.longs===Number?new et.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0):t.ttl),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?et.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.signatureV2!=null&&t.hasOwnProperty("signatureV2")&&(n.signatureV2=i.bytes===String?et.base64.encode(t.signatureV2,0,t.signatureV2.length):i.bytes===Array?Array.prototype.slice.call(t.signatureV2):t.signatureV2),t.data!=null&&t.hasOwnProperty("data")&&(n.data=i.bytes===String?et.base64.encode(t.data,0,t.data.length):i.bytes===Array?Array.prototype.slice.call(t.data):t.data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Hd.util.toJSONOptions)},r.ValidityType=function(){var e={},t=Object.create(e);return t[e[0]="EOL"]=0,t}(),r}();ez.exports=Gd});var iz=p((E2t,J4)=>{l();"use strict";J4.exports.toRFC3339=r=>{let e=r.getUTCFullYear(),t=String(r.getUTCMonth()+1).padStart(2,"0"),i=String(r.getUTCDate()).padStart(2,"0"),n=String(r.getUTCHours()).padStart(2,"0"),s=String(r.getUTCMinutes()).padStart(2,"0"),o=String(r.getUTCSeconds()).padStart(2,"0"),c=r.getUTCMilliseconds()*1e3*1e3;return`${e}-${t}-${i}T${n}:${s}:${o}.${c}Z`};J4.exports.parseRFC3339=r=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var nz=p(ec=>{l();"use strict";ec.ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD";ec.ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY";ec.ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION";ec.ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION";ec.ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT";ec.ERR_PEER_ID_FROM_PUBLIC_KEY="ERR_PEER_ID_FROM_PUBLIC_KEY";ec.ERR_PUBLIC_KEY_FROM_ID="ERR_PUBLIC_KEY_FROM_ID";ec.ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER";ec.ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA"});var Yd=p((x2t,sz)=>{l();"use strict";var oz=jV(),{Key:pg}=ir(),Q4=za(),az=dt(),cz=ko(),mn=ge(),qPe=en(),yg=ct(),uz=tt(),$d=vi(),fz=Dr(),lz=(G2(),H2),hz=ZV(),dz=xe(),Is=Object.assign(dz("jsipns"),{error:dz("jsipns:error")}),{IpnsEntry:Wd}=rz(),{parseRFC3339:MPe}=iz(),an=nz(),LPe=cz.names.identity,pz="/ipns/",FPe=(r,e,t,i)=>{let n=new oz(Date.now()+Number(i)),s=Wd.ValidityType.EOL,[o,a]=i.toString().split("."),c=BigInt(o)*100000n+BigInt(a||0);return yz(r,e,t,s,n,c)},UPe=(r,e,t,i)=>{let n=oz.fromString(i),s=Wd.ValidityType.EOL,o=n.toDate().getTime()-Date.now(),a=BigInt(o)*100000n+BigInt(n.getNano());return yz(r,e,t,s,n,a)},yz=async(r,e,t,i,n,s)=>{t=BigInt(t);let o=yg(n.toString()),a=await jPe(r,e,i,o),c=KPe(e,o,i,t,s),u=gz(c),f=await r.sign(u),h={value:e,signature:a,validityType:i,validity:o,sequence:t,ttl:s,signatureV2:f,data:c};return Is(`ipns entry for ${e} created`),h},KPe=(r,e,t,i,n)=>{let s={value:r,validity:e,validityType:t,sequence:i,ttl:n};return lz.encode(s)},mz=async(r,e)=>{let{value:t,validityType:i,validity:n}=e,s,o;e.signatureV2&&e.data?(o=e.signatureV2,s=gz(e.data),VPe(e)):(o=e.signature,s=bz(t,i,n));let a;try{a=await r.verify(s,o)}catch(c){a=!1}if(!a)throw Is.error("record signature verification failed"),mn(new Error("record signature verification failed"),an.ERR_SIGNATURE_VERIFICATION);if(i===Wd.ValidityType.EOL){let c;try{c=MPe(uz(n))}catch(u){throw Is.error("unrecognized validity format (not an rfc3339 format)"),mn(new Error("unrecognized validity format (not an rfc3339 format)"),an.ERR_UNRECOGNIZED_FORMAT)}if(c.getTime()<Date.now())throw Is.error("record has expired"),mn(new Error("record has expired"),an.ERR_IPNS_EXPIRED_RECORD)}else if(i)throw Is.error("unrecognized validity type"),mn(new Error("unrecognized validity type"),an.ERR_UNRECOGNIZED_VALIDITY);Is(`ipns entry for ${t} is valid`)},VPe=r=>{if(!r.data)throw mn(new Error("Record data is missing"),an.ERR_INVALID_RECORD_DATA);let e=lz.decode(r.data);if(Number.isInteger(e.sequence)&&(e.sequence=BigInt(e.sequence)),Number.isInteger(e.ttl)&&(e.ttl=BigInt(e.ttl)),!fz(e.value,r.value))throw mn(new Error('Field "value" did not match between protobuf and CBOR'),an.ERR_SIGNATURE_VERIFICATION);if(!fz(e.validity,r.validity))throw mn(new Error('Field "validity" did not match between protobuf and CBOR'),an.ERR_SIGNATURE_VERIFICATION);if(e.validityType!==r.validityType)throw mn(new Error('Field "validityType" did not match between protobuf and CBOR'),an.ERR_SIGNATURE_VERIFICATION);if(e.sequence!==r.sequence)throw mn(new Error('Field "sequence" did not match between protobuf and CBOR'),an.ERR_SIGNATURE_VERIFICATION);if(e.ttl!==r.ttl)throw mn(new Error('Field "ttl" did not match between protobuf and CBOR'),an.ERR_SIGNATURE_VERIFICATION)},HPe=async(r,e)=>{if(!r||!r.bytes||!e){let n=new Error("one or more of the provided parameters are not defined");throw Is.error(n),mn(n,an.ERR_UNDEFINED_PARAMETER)}let t;try{t=await az.createFromPubKey(r.bytes)}catch(n){throw mn(n,an.ERR_PEER_ID_FROM_PUBLIC_KEY)}let i;try{i=zPe(t)}catch(n){throw Is.error(n),mn(n,an.ERR_PUBLIC_KEY_FROM_ID)}if(i)return null;try{e.pubKey=Q4.keys.marshalPublicKey(r)}catch(n){throw Is.error(n),n}return e},vz=(r,e)=>{if(!e||!r){let t=new Error("one or more of the provided parameters are not defined");throw Is.error(t),mn(t,an.ERR_UNDEFINED_PARAMETER)}if(e.pubKey){let t;try{t=Q4.keys.unmarshalPublicKey(e.pubKey)}catch(i){throw Is.error(i),i}return t}if(r.pubKey)return r.pubKey;throw Object.assign(new Error("no public key is available"),{code:an.ERR_UNDEFINED_PARAMETER})},Z4=r=>uz(qPe.encode("base32",r)).slice(1).toUpperCase(),GPe=r=>new pg(`/ipns/${Z4(r)}`),$Pe=r=>{let e=yg("/pk/"),t=yg("/ipns/");return{routingPubKey:new pg($d([e,r]),!1),pkKey:new pg(Z4($d([e,r]))),routingKey:new pg($d([t,r]),!1),ipnsKey:new pg(Z4($d([t,r])))}},jPe=(r,e,t,i)=>{try{let n=bz(e,t,i);return r.sign(n)}catch(n){throw Is.error("record signature creation failed"),mn(new Error("record signature creation failed: "+n.message),an.ERR_SIGNATURE_CREATION)}},WPe=r=>{if(r.toString()==="0")return"EOL";let e=new Error(`unrecognized validity type ${r.toString()}`);throw Is.error(e),mn(e,an.ERR_UNRECOGNIZED_VALIDITY)},bz=(r,e,t)=>{let i=yg(WPe(e));return $d([r,t,i])},gz=r=>{let e=yg("ipns-signature:");return $d([e,r])},zPe=r=>{let e=cz.decode(r.id);return e.code!==LPe?null:Q4.keys.unmarshalPublicKey(e.digest)},YPe=r=>Wd.encode({...r,sequence:hz.fromString(r.sequence.toString()),ttl:r.ttl==null?void 0:hz.fromString(r.ttl.toString())}).finish(),J2=r=>{let e=Wd.decode(r),t=Wd.toObject(e,{defaults:!1,arrays:!0,objects:!1});return{value:t.value,signature:t.signature,validityType:t.validityType,validity:t.validity,sequence:Object.hasOwnProperty.call(t,"sequence")?BigInt(`${t.sequence}`):0n,pubKey:t.pubKey,ttl:Object.hasOwnProperty.call(t,"ttl")?BigInt(`${t.ttl}`):void 0}},XPe={validate:async(r,e)=>{let t=J2(r),i=e.slice("/ipns/".length),n=az.createFromBytes(i),s=vz(n,t);await mz(s,t)},select:(r,e)=>{let t=J2(r),i=J2(e);return t.sequence>i.sequence?0:1}};sz.exports={create:FPe,createWithExpiration:UPe,validate:mz,embedPublicKey:HPe,extractPublicKey:vz,getLocalKey:GPe,getIdKeys:$Pe,marshal:YPe,unmarshal:J2,validator:XPe,namespace:pz,namespaceLength:pz.length}});var Iz=p((wz,_z)=>{l();"use strict";var Q2=dt(),{Key:Ez,Errors:JPe}=ir(),On=ge(),Sz=xe(),xi=Object.assign(Sz("ipfs:ipns:publisher"),{error:Sz("ipfs:ipns:publisher:error")}),gg=tt(),QPe=Dr(),Gc=Yd(),xz=JPe.notFoundError().code,Az=60*60*1e3,eA=class{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,i){if(!e||!e.bytes)throw On(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");let n=await Q2.createFromPrivKey(e.bytes),s=await this._updateOrCreateRecord(e,t,i,n);return this._putRecordToRouting(s,n)}publish(e,t){return this.publishWithEOL(e,t,Az)}async _putRecordToRouting(e,t){if(!Q2.isPeerId(t)){let o="peerId received is not valid";throw xi.error(o),On(new Error(o),"ERR_INVALID_PEER_ID")}let i=t._pubKey,n=await Gc.embedPublicKey(i,e),s=Gc.getIdKeys(t.toBytes());return await this._publishEntry(s.routingKey,n||e),await this._publishPublicKey(s.routingPubKey,i),n||e}async _publishEntry(e,t){if(!Ez.isKey(e)){let n="datastore key does not have a valid format";throw xi.error(n),On(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let i;try{i=Gc.marshal(t)}catch(n){throw xi.error(n),n}try{let n=await this._routing.put(e.uint8Array(),i);return xi(`ipns record for ${gg(e.uint8Array(),"base64")} was stored in the routing`),n}catch(n){let s=`ipns record for ${gg(e.uint8Array(),"base64")} could not be stored in the routing`;throw xi.error(s),xi.error(n),On(new Error(s),"ERR_PUTTING_TO_ROUTING")}}async _publishPublicKey(e,t){if(!Ez.isKey(e)){let i="datastore key does not have a valid format";throw xi.error(i),On(new Error(i),"ERR_INVALID_DATASTORE_KEY")}if(!t||!t.bytes){let i="one or more of the provided parameters are not defined";throw xi.error(i),On(new Error(i),"ERR_UNDEFINED_PARAMETER")}try{let i=await this._routing.put(e.uint8Array(),t.bytes);return xi(`public key for ${gg(e.uint8Array(),"base64")} was stored in the routing`),i}catch(i){let n=`public key for ${gg(e.uint8Array(),"base64")} could not be stored in the routing`;throw xi.error(n),xi.error(i),On(new Error(n),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!Q2.isPeerId(e)){let n="peerId received is not valid";throw xi.error(n),On(new Error(n),"ERR_INVALID_PEER_ID")}let i=t.checkRouting!==!1;try{let n=await this._datastore.get(Gc.getLocalKey(e.id));return this._unmarshalData(n)}catch(n){if(n.code!==xz){let s=`unexpected error getting the ipns record ${e.id} from datastore`;throw xi.error(s),On(new Error(s),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!i)throw On(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let s=Gc.getIdKeys(e.toBytes()),o=await this._routing.get(s.routingKey.uint8Array());return this._unmarshalData(o)}catch(s){throw xi.error(s),s}}}_unmarshalData(e){try{return Gc.unmarshal(e)}catch(t){throw On(t,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,i,n){if(!Q2.isPeerId(n)){let u="peerId received is not valid";throw xi.error(u),On(new Error(u),"ERR_INVALID_PEER_ID")}let s={checkRouting:!0},o;try{o=await this._getPublished(n,s)}catch(u){if(u.code!==xz){let f=`unexpected error when determining the last published IPNS record for ${n.id} ${u.stack}`;throw xi.error(f),On(new Error(f),"ERR_DETERMINING_PUBLISHED_RECORD")}}let a=0n;o&&o.sequence!==void 0&&(a=QPe(o.value,t)?BigInt(o.sequence):BigInt(o.sequence)+1n);let c;try{c=await Gc.create(e,t,a,i)}catch(u){let f=`ipns record for ${t} could not be created`;throw xi.error(u),On(new Error(f),"ERR_CREATING_IPNS_RECORD")}try{let u=Gc.marshal(c);return await this._datastore.put(Gc.getLocalKey(n.id),u),xi(`ipns record for ${gg(t,"base32")} was stored in the datastore`),c}catch(u){let f=`ipns record for ${t} could not be stored in the datastore`;throw xi.error(f),On(new Error(f),"ERR_STORING_IN_DATASTORE")}}};eA.defaultRecordLifetime=Az;wz=_z.exports=eA});var Dz=p((Tz,Rz)=>{l();"use strict";var kz=Yd(),ZPe=za(),Cz=dt(),_l=ge(),Pz=xe(),Z2=Object.assign(Pz("ipfs:ipns:republisher"),{error:Pz("ipfs:ipns:republisher:error")}),Oz=60*1e3,Bz=60*Oz,eOe=4*Bz,tOe=24*Bz,Nz=class{constructor(e,t,i,n,s={pass:""}){this._publisher=e,this._datastore=t,this._peerId=i,this._keychain=n,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw _l(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:s=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(s)}catch(o){Z2.error(o)}},s())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:t}=this._peerId,{pass:i}=this._options,n=!0;e._task=()=>this._republishEntries(t,i),e.runPeriodically(()=>n?(n=!1,this._options.initialBroadcastInterval||Oz):this._options.broadcastInterval||eOe),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw _l(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t){try{await this._republishEntry(e)}catch(i){let n="cannot republish entry for the node's private key";Z2.error(n);return}if(t)try{let i=await this._keychain.listKeys();for(let n of i){if(n.name==="self")continue;let s=await this._keychain.exportKey(n.name,t),o=await ZPe.keys.import(s,t);await this._republishEntry(o)}}catch(i){Z2.error(i)}}async _republishEntry(e){if(!e||!e.bytes)throw _l(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{let t=await Cz.createFromPrivKey(e.bytes),i=await this._getPreviousValue(t);await this._publisher.publishWithEOL(e,i,tOe)}catch(t){if(t.code==="ERR_NO_ENTRY_FOUND")return;throw t}}async _getPreviousValue(e){if(!Cz.isPeerId(e))throw _l(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let t=await this._datastore.get(kz.getLocalKey(e.id));if(!(t instanceof Uint8Array))throw _l(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return kz.unmarshal(t).value}catch(i){throw Z2.error(i),_l(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(t){throw t&&t.notFound?_l(new Error(`no previous entry for record with id: ${e.id}`),"ERR_NO_ENTRY_FOUND"):t}}};Tz=Rz.exports=Nz});var Kz=p((qz,Mz)=>{l();"use strict";var ev=Yd(),rOe=dt(),Xd=ge(),Lz=xe(),tv=Object.assign(Lz("ipfs:ipns:resolver"),{error:Lz("ipfs:ipns:resolver:error")}),iOe=tt(),{Errors:nOe}=ir(),sOe=nOe.notFoundError().code,Fz=32,Uz=class{constructor(e){this._routing=e}async resolve(e,t={}){if(typeof e!="string")throw Xd(new Error("invalid name"),"ERR_INVALID_NAME");let i=t.recursive&&t.recursive.toString()==="true",n=e.split("/");if(n.length!==3||n[0]!=="")throw Xd(new Error("invalid name"),"ERR_INVALID_NAME");let s=n[2],o=Infinity;i&&(o=Fz);let a=await this.resolver(s,o);return tv(`${e} was locally resolved correctly`),a}async resolver(e,t){if(t===0){let s=`could not resolve name (recursion limit of ${Fz} exceeded)`;throw tv.error(s),Xd(new Error(s),"ERR_RESOLVE_RECURSION_LIMIT")}let i=await this._resolveName(e),n=i.split("/");return n[1]==="ipfs"||!t?i:this.resolver(n[2],t-1)}async _resolveName(e){let t=rOe.createFromCID(e),{routingKey:i}=ev.getIdKeys(t.toBytes()),n;try{n=await this._routing.get(i.uint8Array())}catch(o){throw tv.error("could not get record from routing",o),o.code===sOe?Xd(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):Xd(new Error(`unexpected error getting the ipns record ${t.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s;try{s=ev.unmarshal(n)}catch(o){throw tv.error("could not unmarshal record",o),Xd(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(t,s)}async _validateRecord(e,t){let i=await ev.extractPublicKey(e,t);return await ev.validate(i,t),iOe(t.value)}};qz=Mz.exports=Uz});var $z=p((A2t,jz)=>{l();"use strict";var{createFromPrivKey:oOe}=dt(),aOe=ge(),Vz=xe(),bg=Object.assign(Vz("ipfs:ipns"),{error:Vz("ipfs:ipns:error")}),tA=Iz(),cOe=Dz(),uOe=Kz(),fOe=W6(),zz=60*1e3,Hz=tt(),Gz=class{constructor(e,t,i,n,s){this.publisher=new tA(e,t),this.republisher=new cOe(this.publisher,t,i,n,s),this.resolver=new uOe(e),this.cache=new fOe(1e3),this.routing=e}async publish(e,t,i=tA.defaultRecordLifetime){try{let n=await oOe(e.bytes);await this.publisher.publishWithEOL(e,t,i),bg(`IPNS value ${Hz(t,"base32")} was published correctly`);let s=n.toB58String(),o=parseFloat(i),a=o<zz?o:zz;return this.cache.set(s,t,a),bg(`IPNS value ${Hz(t,"base32")} was cached correctly`),{name:s,value:t}}catch(n){throw bg.error(n),n}}async resolve(e,t={}){if(typeof e!="string")throw aOe(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){let i=e.split("/")[2],n=this.cache.get(i);if(n)return n}try{let i=await this.resolver.resolve(e,t);return bg(`IPNS record from ${e} was resolved correctly`),i}catch(i){throw bg.error(i),i}}async initializeKeyspace(e,t){return this.publish(e,t,tA.defaultRecordLifetime)}};jz.exports=Gz});var $c=p((I2t,Wz)=>{l();"use strict";var lOe=async function*(r,e){for await(let t of r)yield e(t)};Wz.exports=lOe});var mg=p((T2t,Yz)=>{l();"use strict";var{Adapter:hOe}=ir(),Xz=$c(),Jz=class extends hOe{constructor(e,t){super();this.child=e,this.transform=t}open(){return this.child.open()}put(e,t,i){return this.child.put(this.transform.convert(e),t,i)}get(e,t){return this.child.get(this.transform.convert(e),t)}has(e,t){return this.child.has(this.transform.convert(e),t)}delete(e,t){return this.child.delete(this.transform.convert(e),t)}batch(){let e=this.child.batch();return{put:(t,i)=>{e.put(this.transform.convert(t),i)},delete:t=>{e.delete(this.transform.convert(t))},commit:t=>e.commit(t)}}query(e,t){return Xz(this.child.query(e,t),({key:i,value:n})=>({key:this.transform.invert(i),value:n}))}queryKeys(e,t){return Xz(this.child.queryKeys(e,t),i=>this.transform.invert(i))}close(){return this.child.close()}};Yz.exports=Jz});var Zz=p((R2t,Qz)=>{l();"use strict";Qz.exports=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`});var sA=p((k2t,eH)=>{l();"use strict";var{Key:tH}=ir(),dOe=Zz(),rv="/repo/flatfs/shard/",rH="SHARDING",pOe="_README",iv=class{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${rv}v1/${this.name}/${this.param}`}},rA=class extends iv{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},iA=class extends iv{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let t=this._padding+e;return t.slice(t.length-this.param)}},nA=class extends iv{constructor(e){super(e);this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let t=this._padding+e,i=t.length-this.param-1;return t.slice(i,i+this.param)}};function iH(r){if(r=r.trim(),r.length===0)throw new Error("empty shard string");if(!r.startsWith(rv))throw new Error(`invalid or no path prefix: ${r}`);let e=r.slice(rv.length).split("/"),t=e[0];if(t!=="v1")throw new Error(`expect 'v1' version, got '${t}'`);let i=e[1];if(!e[2])throw new Error("missing param");let n=parseInt(e[2],10);switch(i){case"prefix":return new rA(n);case"suffix":return new iA(n);case"next-to-last":return new nA(n);default:throw new Error(`unkown sharding function: ${i}`)}}var yOe=async(r,e)=>{let t=new tH(r).child(new tH(rH)),n=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(t);return iH(new TextDecoder().decode(n||"").trim())};eH.exports={readme:dOe,parseShardFun:iH,readShardFun:yOe,Prefix:rA,Suffix:iA,NextToLast:nA,README_FN:pOe,SHARDING_FN:rH,PREFIX:rv}});var sH=p((C2t,nH)=>{l();"use strict";var{Adapter:gOe,Key:nv,Errors:bOe}=ir(),vg=sA(),mOe=mg(),Jd=new nv(vg.SHARDING_FN),wg=new nv(vg.README_FN),El=class extends gOe{constructor(e,t){super();this.child=new mOe(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=t}async open(){await this.child.open(),this.shard=await El.create(this.child,this.shard)}_convertKey(e){let t=e.toString();return t===Jd.toString()||t===wg.toString()?e:new nv(this.shard.fun(t)).child(e)}_invertKey(e){let t=e.toString();return t===Jd.toString()||t===wg.toString()?e:nv.withNamespaces(e.list().slice(1))}static async createOrOpen(e,t){try{await El.create(e,t)}catch(i){if(i&&i.message!=="datastore exists")throw i}return El.open(e)}static async open(e){let t=await vg.readShardFun("/",e);return new El(e,t)}static async create(e,t){let i=await e.has(Jd);if(!i&&!t)throw bOe.dbOpenFailedError(Error("Shard is required when datastore doesn't have a shard key already."));if(!i){let a=typeof e.putRaw=="function"?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([a(Jd,new TextEncoder().encode(t.toString()+`
`)),a(wg,new TextEncoder().encode(vg.readme))]),t}let n=await vg.readShardFun("/",e),s=(n||"").toString(),o=t.toString();if(s!==o)throw new Error(`specified fun ${o} does not match repo shard fun ${s}`);return n}put(e,t,i){return this.child.put(e,t,i)}get(e,t){return this.child.get(e,t)}has(e,t){return this.child.has(e,t)}delete(e,t){return this.child.delete(e,t)}batch(){return this.child.batch()}query(e,t){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.key.toString()!==Jd.toString(),s=>s.key.toString()!==wg.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s.key).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>({key:c,value:u})=>o({key:this._invertKey(c),value:u}));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s({key:this._invertKey(a.key),value:a.value},{key:this._invertKey(c.key),value:c.value}))),this.child.query(i,t)}queryKeys(e,t){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.toString()!==Jd.toString(),s=>s.toString()!==wg.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>c=>o(this._invertKey(c)));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s(this._invertKey(a),this._invertKey(c)))),this.child.queryKeys(i,t)}close(){return this.child.close()}};nH.exports=El});var aH=p((O2t,oH)=>{l();oH.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var oA=p((N2t,cH)=>{l();var uH=aH();cH.exports=class{constructor(e){this.hwm=e||16,this.head=new uH(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new uH(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var Wc=p((D2t,fH)=>{l();var aA=oA();fH.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new aA,i,n,s,o=()=>{if(!t.isEmpty()){if(r.writev){let m,x=[];for(;!t.isEmpty();){if(m=t.shift(),m.error)throw m.error;x.push(m.value)}return{done:m.done,value:x}}let g=t.shift();if(g.error)throw g.error;return g}return s?{done:!0}:new Promise((g,m)=>{n=x=>(n=null,x.error?m(x.error):r.writev&&!x.done?g({done:x.done,value:[x.value]}):g(x),i)})},a=g=>n?n(g):(t.push(g),i),c=g=>(t=new aA,n?n({error:g}):(t.push({error:g}),i)),u=g=>s?i:a({done:!1,value:g}),f=g=>s?i:(s=!0,g?c(g):a({done:!0})),h=()=>(t=new aA,f(),{done:!0}),d=g=>(f(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:h,throw:d,push:u,end:f},!e)return i;let y=i;return i={[Symbol.asyncIterator](){return this},next(){return y.next()},throw(g){return y.throw(g),e&&(e(g),e=null),{done:!0}},return(){return y.return(),e&&(e(),e=null),{done:!0}},push:u,end(g){return y.end(g),e&&(e(g),e=null),i}},i}});var hH=p((q2t,lH)=>{l();"use strict";var vOe=Wc(),wOe=async function*(...r){let e=vOe();setTimeout(async()=>{try{await Promise.all(r.map(async t=>{for await(let i of t)e.push(i)})),e.end()}catch(t){e.end(t)}},0),yield*e};lH.exports=wOe});var vH=p((M2t,dH)=>{l();"use strict";var{Adapter:_Oe,Key:EOe,Errors:cA,utils:{sortAll:pH,replaceStartWith:uA}}=ir(),sv=hl(),yH=y2(),gH=hH(),bH=mg(),mH=class extends _Oe{constructor(e){super();this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(let t of this.mounts)if(t.prefix.toString()===e.toString()||t.prefix.isAncestorOf(e)){let i=uA(e.toString(),t.prefix.toString());return{datastore:t.datastore,mountpoint:t.prefix,rest:new EOe(i)}}}put(e,t,i){let n=this._lookup(e);if(n==null)throw cA.dbWriteFailedError(new Error("No datastore mounted for this key"));return n.datastore.put(n.rest,t,i)}get(e,t){let i=this._lookup(e);if(i==null)throw cA.notFoundError(new Error("No datastore mounted for this key"));return i.datastore.get(i.rest,t)}has(e,t){let i=this._lookup(e);return i==null?Promise.resolve(!1):i.datastore.has(i.rest,t)}delete(e,t){let i=this._lookup(e);if(i==null)throw cA.dbDeleteFailedError(new Error("No datastore mounted for this key"));return i.datastore.delete(i.rest,t)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){let e={},t=i=>{let n=this._lookup(i);if(n==null)throw new Error("No datastore mounted for this key");let s=n.mountpoint.toString();return e[s]==null&&(e[s]=n.datastore.batch()),{batch:e[s],rest:n.rest}};return{put:(i,n)=>{let s=t(i);s.batch.put(s.rest,n)},delete:i=>{let n=t(i);n.batch.delete(n.rest)},commit:async i=>{await Promise.all(Object.keys(e).map(n=>e[n].commit(i)))}}}query(e,t){let i=this.mounts.map(s=>{let o=new bH(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=uA(e.prefix,s.prefix.toString())),o.query({prefix:a,filters:e.filters},t)}),n=gH(...i);if(e.filters&&e.filters.forEach(s=>{n=sv(n,s)}),e.orders&&e.orders.forEach(s=>{n=pH(n,s)}),e.offset!=null){let s=0;n=sv(n,()=>s++>=e.offset)}return e.limit!=null&&(n=yH(n,e.limit)),n}queryKeys(e,t){let i=this.mounts.map(s=>{let o=new bH(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=uA(e.prefix,s.prefix.toString())),o.queryKeys({prefix:a,filters:e.filters},t)}),n=gH(...i);if(e.filters&&e.filters.forEach(s=>{n=sv(n,s)}),e.orders&&e.orders.forEach(s=>{n=pH(n,s)}),e.offset!=null){let s=0;n=sv(n,()=>s++>=e.offset)}return e.limit!=null&&(n=yH(n,e.limit)),n}};dH.exports=mH});var EH=p((L2t,wH)=>{l();"use strict";var{Adapter:SOe,Errors:ov}=ir(),xOe=xe()("datastore:core:tiered"),_H=class extends SOe{constructor(e){super();this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch(e){throw ov.dbOpenFailedError()}}async put(e,t){try{await Promise.all(this.stores.map(i=>i.put(e,t)))}catch(i){throw ov.dbWriteFailedError()}}async get(e,t){for(let i of this.stores)try{let n=await i.get(e,t);if(n)return n}catch(n){xOe(n)}throw ov.notFoundError()}async has(e,t){for(let i of this.stores)if(await i.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map(i=>i.delete(e,t)))}catch(i){throw ov.dbDeleteFailedError()}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(t=>t.batch());return{put:(t,i)=>{e.forEach(n=>n.put(t,i))},delete:t=>{e.forEach(i=>i.delete(t))},commit:async t=>{for(let i of e)await i.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}};wH.exports=_H});var AH=p((F2t,SH)=>{l();"use strict";var fA=ir().Key,AOe=mg(),xH=class extends AOe{constructor(e,t){super(e,{convert(i){return t.child(i)},invert(i){if(t.toString()==="/")return i;if(!t.isAncestorOf(i))throw new Error(`Expected prefix: (${t.toString()}) in key: ${i.toString()}`);return new fA(i.toString().slice(t.toString().length),!1)}});this.prefix=t}query(e,t){return e.prefix&&this.prefix.toString()!=="/"?super.query(Object.assign({},e,{prefix:this.prefix.child(new fA(e.prefix)).toString()})):super.query(e,t)}queryKeys(e,t){return e.prefix&&this.prefix.toString()!=="/"?super.queryKeys(Object.assign({},e,{prefix:this.prefix.child(new fA(e.prefix)).toString()})):super.queryKeys(e,t)}};SH.exports=xH});var av=p((U2t,IH)=>{l();"use strict";var IOe=mg(),TOe=sH(),ROe=vH(),kOe=EH(),COe=AH(),POe=sA();IH.exports={KeytransformDatastore:IOe,ShardingDatastore:TOe,MountDatastore:ROe,TieredDatastore:kOe,NamespaceDatastore:COe,shard:POe}});var _g=p((lA,hA)=>{l();(function(r,e){typeof lA=="object"&&typeof hA!="undefined"?hA.exports=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}:typeof define=="function"&&define.amd?define(function(){return function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}}):r.dlv=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}})(lA)});var CH=p((K2t,TH)=>{l();"use strict";var OOe=ge(),RH=tt(),kH=ct(),cv="/record/";function BOe(r){return RH(r,"base32")}function NOe(r){(typeof r=="string"||r instanceof String)&&(r=kH(r.toString()));let e=RH(r,"base64url");return`${cv}${e}`}function DOe(r){if(r.substring(0,cv.length)!==cv)throw OOe(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=r.substring(cv.length);return kH(e,"base64url")}TH.exports={encodeBase32:BOe,keyToTopic:NOe,topicToKey:DOe}});var qH=p((PH,OH)=>{l();"use strict";var{Key:dA,Adapter:qOe}=ir(),{encodeBase32:BH,keyToTopic:uv,topicToKey:MOe}=CH(),LOe=Dr(),no=ge(),NH=xe(),vn=Object.assign(NH("datastore-pubsub:publisher"),{error:NH("datastore-pubsub:publisher:error")}),DH=class extends qOe{constructor(e,t,i,n,s){super();if(!n)throw no(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof n.validate!="function")throw no(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof n.select!="function")throw no(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw no(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=i,this._validator=n,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this)}async put(e,t){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw vn.error(n),no(new Error(n),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){let n="received value is not a Uint8Array";throw vn.error(n),no(new Error(n),"ERR_INVALID_VALUE_RECEIVED")}let i=uv(e);vn(`publish value for topic ${i}`),await this._pubsub.publish(i,t)}async get(e){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw vn.error(n),no(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let t=uv(e),i=await this._pubsub.getTopics();if(i&&Array.isArray(i)&&i.indexOf(t)>-1)return this._getLocal(e);try{this._pubsub.on(t,this._onMessage),await this._pubsub.subscribe(t)}catch(n){let s=`cannot subscribe topic ${t}`;throw vn.error(s),no(new Error(s),"ERR_SUBSCRIBING_TOPIC")}return vn(`subscribed values for key ${t}`),this._getLocal(e)}unsubscribe(e){let t=uv(e);return this._pubsub.removeListener(t,this._onMessage),this._pubsub.unsubscribe(t)}async _getLocal(e){let t=new dA("/"+BH(e),!1),i;try{i=await this._datastore.get(t)}catch(n){if(n.code!=="ERR_NOT_FOUND"){let o=`unexpected error getting the ipns record for ${t.toString()}`;throw vn.error(o),no(new Error(o),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s=`local record requested was not found for ${t.toString()}`;throw vn.error(s),no(new Error(s),"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){let n="found record that we couldn't convert to a value";throw vn.error(n),no(new Error(n),"ERR_INVALID_RECORD_RECEIVED")}return i}async _onMessage(e){let{data:t,from:i,topicIDs:n}=e,s;try{s=MOe(n[0])}catch(o){vn.error(o);return}if(vn(`message received for topic ${n[0]}`),i===this._peerId.toB58String()){vn("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let o;try{o=await this._handleSubscriptionKeyFn(s)}catch(a){vn.error("message discarded by the subscriptionKeyFn");return}s=o}try{await this._storeIfSubscriptionIsBetter(s,t)}catch(o){vn.error(o)}}async _storeIfSubscriptionIsBetter(e,t){let i=!1;try{i=await this._isBetter(e,t)}catch(n){if(n.code!=="ERR_NOT_VALID_RECORD")throw n}i&&await this._storeRecord(e,t)}async _validateRecord(e,t){return this._validator.validate(e,t)}async _selectRecord(e,t){return await this._validator.select(e,t)===0}async _isBetter(e,t){try{await this._validateRecord(t,e)}catch(s){let o="record received through pubsub is not valid";throw vn.error(o),no(new Error(o),"ERR_NOT_VALID_RECORD")}let i=new dA(e),n;try{n=await this._getLocal(i.uint8Array())}catch(s){return!0}return LOe(n,t)?!1:this._selectRecord(e,[n,t])}async _storeRecord(e,t){let i=new dA("/"+BH(e),!1);await this._datastore.put(i,t),vn(`record for ${uv(e)} was stored in the datastore`)}};PH=OH.exports=DH});var yA=p((j2t,MH)=>{l();"use strict";var ef=Yd(),{toB58String:LH}=er().multihash,FOe=qH(),FH=tt(),UH=ct(),KH=ge(),jH=xe(),pA=Object.assign(jH("ipfs:ipns:pubsub"),{error:jH("ipfs:ipns:pubsub:error")}),VH=class{constructor(e,t,i){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new FOe(e,t,i,ef.validator,this._handleSubscriptionKey)}put(e,t){return this._pubsubDs.put(e,t)}async get(e){let t,i;try{t=await this._pubsubDs.get(e)}catch(s){i=s}let n=e.slice(0,ef.namespaceLength);if(FH(n)===ef.namespace){let s=LH(e),o=LH(e.slice(ef.namespaceLength));this._subscriptions[s]=o,pA(`subscribed to pubsub topic ${s}, id ${o}`)}if(i)throw i;return t}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=FH(e,"base58btc"));let t=this._subscriptions[e];if(!t)throw KH(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let i;try{i=ef.getIdKeys(UH(t,"base58btc"))}catch(n){throw pA.error(n),n}return i.routingKey.uint8Array()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(t=>`${ef.namespace}${t}`)}async cancel(e){if(typeof e!="string")throw KH(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(ef.namespace)&&(e=e.substring(ef.namespaceLength));let t=Object.keys(this._subscriptions).find(n=>this._subscriptions[n]===e);if(!t)return{canceled:!1};let i=UH(t);return this._pubsubDs.unsubscribe(i),delete this._subscriptions[t],pA(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}};MH.exports=VH});var GH=p((V2t,zH)=>{l();"use strict";var Qd=hi(),HH=Qd.Reader,UOe=Qd.Writer,so=Qd.util,Eg=Qd.roots["libp2p-record"]||(Qd.roots["libp2p-record"]={});Eg.Record=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key=so.newBuffer([]),r.prototype.value=so.newBuffer([]),r.prototype.timeReceived="",r.encode=function(t,i){return i||(i=UOe.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).bytes(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),t.timeReceived!=null&&Object.hasOwnProperty.call(t,"timeReceived")&&i.uint32(42).string(t.timeReceived),i},r.decode=function(t,i){t instanceof HH||(t=HH.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Eg.Record;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.bytes();break;case 2:s.value=t.bytes();break;case 5:s.timeReceived=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Eg.Record)return t;var i=new Eg.Record;return t.key!=null&&(typeof t.key=="string"?so.base64.decode(t.key,i.key=so.newBuffer(so.base64.length(t.key)),0):t.key.length&&(i.key=t.key)),t.value!=null&&(typeof t.value=="string"?so.base64.decode(t.value,i.value=so.newBuffer(so.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.timeReceived!=null&&(i.timeReceived=String(t.timeReceived)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=so.newBuffer(n.key))),i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=so.newBuffer(n.value))),n.timeReceived=""),t.key!=null&&t.hasOwnProperty("key")&&(n.key=i.bytes===String?so.base64.encode(t.key,0,t.key.length):i.bytes===Array?Array.prototype.slice.call(t.key):t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?so.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.timeReceived!=null&&t.hasOwnProperty("timeReceived")&&(n.timeReceived=t.timeReceived),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Qd.util.toJSONOptions)},r}();zH.exports=Eg});var $H=p((z2t,gA)=>{l();"use strict";gA.exports.toRFC3339=r=>{let e=r.getUTCFullYear(),t=String(r.getUTCMonth()+1).padStart(2,"0"),i=String(r.getUTCDate()).padStart(2,"0"),n=String(r.getUTCHours()).padStart(2,"0"),s=String(r.getUTCMinutes()).padStart(2,"0"),o=String(r.getUTCSeconds()).padStart(2,"0"),c=r.getUTCMilliseconds()*1e3*1e3;return`${e}-${t}-${i}T${n}:${s}:${o}.${c}Z`};gA.exports.parseRFC3339=r=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var XH=p((H2t,WH)=>{l();"use strict";var{Record:bA}=GH(),YH=$H(),Sg=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=i}serialize(){return bA.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&YH.toRFC3339(this.timeReceived)}}static deserialize(e){let t=bA.decode(e);return Sg.fromDeserialized(bA.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let t;return e.timeReceived&&(t=YH.parseRFC3339(e.timeReceived)),new Sg(e.key,e.value,t)}};WH.exports=Sg});var QH=p((G2t,JH)=>{l();"use strict";var KOe=er(),fv=ge(),jOe=tt(),VOe=Dr(),zOe=async(r,e)=>{if(!(r instanceof Uint8Array))throw fv(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(r.byteLength<5)throw fv(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(jOe(r.subarray(0,4))!=="/pk/")throw fv(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let i=r.slice(4),n=await KOe(e,"sha2-256");if(!VOe(i,n))throw fv(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};JH.exports={func:zOe,sign:!1}});var eG=p(($2t,ZH)=>{l();"use strict";ZH.exports={pk:QH()}});var rG=p((W2t,tG)=>{l();"use strict";var HOe=ge(),GOe=tt(),$Oe=(r,e)=>{let t=e.key,n=GOe(t).split("/");if(n.length<3)return;let s=r[n[1].toString()];if(!s){let o="Invalid record keytype";throw HOe(new Error(o),"ERR_INVALID_RECORD_KEY_TYPE")}return s.func(t,e.value)};tG.exports={verifyRecord:$Oe,validators:eG()}});var nG=p((Y2t,iG)=>{l();"use strict";var WOe=(r,e)=>0;iG.exports=WOe});var oG=p((X2t,sG)=>{l();"use strict";sG.exports={pk:nG()}});var cG=p((J2t,aG)=>{l();"use strict";var mA=ge(),YOe=tt(),XOe=(r,e,t)=>{if(t.length===0){let o="No records given";throw mA(new Error(o),"ERR_NO_RECORDS_RECEIVED")}let n=YOe(e).split("/");if(n.length<3){let o="Record key does not have a selector function";throw mA(new Error(o),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let s=r[n[1].toString()];if(!s){let o=`Unrecognized key prefix: ${n[1]}`;throw mA(new Error(o),"ERR_UNRECOGNIZED_KEY_PREFIX")}return s(e,t)};aG.exports={bestRecord:XOe,selectors:oG()}});var Sl=p((Q2t,uG)=>{l();"use strict";uG.exports={Record:XH(),validator:rG(),selection:cG()}});var vA=p((Z2t,fG)=>{l();"use strict";var lG=Yd(),JOe=tt();fG.exports={encodeBase32:r=>JOe(r,"base32upper"),validator:{func:(r,e)=>lG.validator.validate(e,r)},selector:(r,e)=>lG.validator.select(e[0],e[1])}});var _A=p((hG,dG)=>{l();"use strict";var{Key:QOe}=ir(),{Record:pG}=Sl(),{encodeBase32:ZOe}=vA(),xg=ge(),yG=xe(),wA=Object.assign(yG("ipfs:ipns:offline-datastore"),{error:yG("ipfs:ipns:offline-datastore:error")}),gG=class{constructor(e){this._repo=e,this.stores=[]}async put(e,t){if(!(e instanceof Uint8Array))throw xg(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw xg(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let i;try{i=this._routingKey(e)}catch(s){throw wA.error(s),xg(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=new pG(e,t);return this._repo.datastore.put(i,n.serialize())}async get(e){if(!(e instanceof Uint8Array))throw xg(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let t;try{t=this._routingKey(e)}catch(s){throw wA.error(s),xg(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=await this._repo.datastore.get(t),n;try{n=pG.deserialize(i)}catch(s){throw wA.error(s),s}return n.value}_routingKey(e){return new QOe("/"+ZOe(e),!1)}};hG=dG.exports=gG});var mG=p((evt,bG)=>{l();"use strict";var{TieredDatastore:eBe}=av(),EA=_g(),tBe=yA(),rBe=_A();bG.exports=({libp2p:r,repo:e,peerId:t,options:i})=>{let n=[],s;if(EA(i,"EXPERIMENTAL.ipnsPubsub",!1)){let o=r.pubsub,a=e.datastore;s=new tBe(o,a,t),n.push(s)}if(EA(i,"offline")||!EA(i,"libp2p.config.dht.enabled",!1)){let o=new rBe(e);n.push(o)}else n.push(r._dht);return new eBe(n)}});var SG=p((tvt,vG)=>{l();"use strict";var wG=$z(),iBe=mG(),nBe=_A(),{NotInitializedError:sBe,AlreadyInitializedError:_G}=Xu(),oBe=xe()("ipfs:components:ipns"),EG=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new sBe}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:i}){if(this.offline!=null)throw new _G;oBe("initializing IPNS keyspace");let n=new nBe(e),s=new wG(n,e.datastore,t,i,this.options);this.offline=s}async startOnline({libp2p:e,repo:t,peerId:i,keychain:n}){if(this.online!=null)throw new _G;let s=iBe({libp2p:e,repo:t,peerId:i,options:this.options}),o=new wG(s,t.datastore,i,n,this.options);await o.republisher.start(),this.online=o}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,i){return this.getIPNS().publish(e,t,i)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t){return this.getIPNS().initializeKeyspace(e,t)}};vG.exports=EG});var AG=p(xG=>{l();"use strict";var aBe=ll(),cBe=Gy(),uBe=xd();xG.resolvePath=async({ipns:r,ipld:e},t)=>{if(aBe.ipnsPath(t))return r.resolve(t);let{cid:i,path:n}=cBe(t);await uBe(e.resolve(i,n||""))}});var kG=p((ivt,IG)=>{l();"use strict";var TG=xe(),{default:fBe}=g2(),lBe=za(),RG=ge(),hBe=ct(),dBe=tt(),SA=Object.assign(TG("ipfs:name:publish"),{error:TG("ipfs:name:publish:error")}),{OFFLINE_ERROR:pBe,normalizePath:yBe}=zi(),gBe=Be(),{resolvePath:bBe}=AG();IG.exports=({ipns:r,ipld:e,peerId:t,isOnline:i,keychain:n})=>{let s=async a=>{if(a==="self")return t.privKey;try{let c=await n.exportKey(a,"temp");return await lBe.keys.import(c,"temp")}catch(c){throw SA.error(c),RG(c,"ERR_CANNOT_GET_KEY")}};async function o(a,c={}){let u=c.resolve!==!1,f=c.lifetime||"24h",h=c.key||"self";if(!i())throw RG(new Error(pBe),"OFFLINE_ERROR");try{a=yBe(a)}catch(x){throw SA.error(x),x}let d=0;try{d=fBe(f)||0,d=parseFloat(d.toFixed(6))}catch(x){throw SA.error(x),x}let y=await Promise.all([s(h),u?bBe({ipns:r,ipld:e},a):Promise.resolve()]),g=hBe(a),m=await r.publish(y[0],g,d);return{name:m.name,value:dBe(m.value)}}return gBe(o)}});var PG=p((nvt,CG)=>{l();"use strict";var mBe=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;CG.exports=function(e,t){if(t==null&&(t=!1),e.length<2||e.length>255)return!1;var i=e[e.length-1];if(t){if(i!==".")return!1}else if(i===".")return!1;return mBe.test(e)}});var DG=p((svt,OG)=>{l();"use strict";var BG=xe(),xA=ge(),{mergeOptions:vBe}=zi(),wBe=Qe(),_Be=PG(),EBe=tt(),SBe=Object.assign(BG("ipfs:name:resolve"),{error:BG("ipfs:name:resolve:error")}),{OFFLINE_ERROR:xBe}=zi(),ABe=Be(),NG=(r,e)=>e.length>0?r+"/"+e.join("/"):r;OG.exports=({dns:r,ipns:e,peerId:t,isOnline:i,options:{offline:n}})=>{async function*s(o,a={}){if(a=vBe({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw xA(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");o||(o=t.toB58String()),o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[c,u,...f]=o.slice(1).split("/");try{new wBe(u)}catch(d){if(_Be(u)){yield NG(await r(u,a),f);return}throw SBe.error(d),xA(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}if(!i()&&!n)throw xA(new Error(xBe),"OFFLINE_ERROR");let h=await e.resolve(`/${c}/${u}`,a);yield NG(h instanceof Uint8Array?EBe(h):h,f)}return ABe(s)}});var lv=p(qG=>{l();"use strict";var MG=yA(),LG=ge();qG.getPubsubRouting=(r,e)=>{if(!r||!(e&&e.ipnsPubsub))throw LG(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(r.routing instanceof MG)return r.routing;let t=(r.routing.stores||[]).find(i=>i instanceof MG);if(!t)throw LG(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return t}});var UG=p((avt,FG)=>{l();"use strict";var{getPubsubRouting:IBe}=lv(),TBe=Be();FG.exports=({ipns:r,options:e})=>{let t=e.EXPERIMENTAL;async function i(n,s={}){return IBe(r,t).cancel(n,s)}return TBe(i)}});var jG=p((cvt,KG)=>{l();"use strict";var{getPubsubRouting:RBe}=lv(),kBe=Be();KG.exports=({ipns:r,options:e})=>{let t=e.EXPERIMENTAL;async function i(n={}){try{return{enabled:Boolean(RBe(r,t))}}catch(s){return{enabled:!1}}}return kBe(i)}});var zG=p((uvt,VG)=>{l();"use strict";var{getPubsubRouting:CBe}=lv(),PBe=Be();VG.exports=({ipns:r,options:e})=>{let t=e.EXPERIMENTAL;async function i(n={}){return CBe(r,t).getSubscriptions(n)}return PBe(i)}});var $G=p((fvt,HG)=>{l();"use strict";var OBe=UG(),BBe=jG(),NBe=zG(),GG=class{constructor({ipns:e,options:t}){this.cancel=OBe({ipns:e,options:t}),this.state=BBe({ipns:e,options:t}),this.subs=NBe({ipns:e,options:t})}};HG.exports=GG});var XG=p((lvt,WG)=>{l();"use strict";var DBe=kG(),qBe=DG(),MBe=$G(),YG=class{constructor({dns:e,ipns:t,ipld:i,peerId:n,isOnline:s,keychain:o,options:a}){this.publish=DBe({ipns:t,ipld:i,peerId:n,isOnline:s,keychain:o}),this.resolve=qBe({dns:e,ipns:t,peerId:n,isOnline:s,options:a}),this.pubsub=new MBe({ipns:t,options:a})}};WG.exports=YG});var ZG=p((hvt,AA)=>{l();"use strict";var LBe=Qe(),{DAGNode:FBe}=Mr(),{Errors:UBe}=ir(),KBe=UBe.notFoundError().code,jBe=Be(),JG=Gy(),hv={default:"<dst>",edges:"<src> -> <dst>"};AA.exports=function({ipld:r,resolve:e,preload:t}){async function*i(n,s={}){if(s.maxDepth===0)return;if(s.edges&&s.format&&s.format!==hv.default)throw new Error("Cannot set edges to true and also specify format");s.format=s.edges?hv.edges:s.format,typeof s.maxDepth!="number"&&(s.maxDepth=s.recursive?Infinity:1);let a=(Array.isArray(n)?n:[n]).map(c=>VBe(t,c,s));for(let c of a)yield*zBe(e,r,c,s)}return jBe(i)};AA.exports.Format=hv;function VBe(r,e,t){let{cid:i,path:n}=JG(e);return t.preload!==!1&&r(i),`/ipfs/${i}${n||""}`}async function*zBe(r,e,t,i){let n=await r(t),{cid:s}=JG(n),o=i.maxDepth!=null?i.maxDepth:Infinity,a=i.unique||!1;for await(let c of GBe(e,s,o,a))!c.parent||c.isDuplicate||(yield{ref:HBe(c.parent.cid,c.node.cid,c.node.name,i.format)})}function HBe(r,e,t="",i=hv.default){let n=i.replace(/<src>/g,r.toString());return n=n.replace(/<dst>/g,e.toString()),n=n.replace(/<linkname>/g,t),n}async function*GBe(r,e,t,i){let n=new Set;async function*s(o,a){let c=a+1;if(!(c>t))try{for(let u of await $Be(r,o.cid))yield{parent:o,node:u,isDuplicate:i&&n.has(u.cid.toString())},i&&n.add(u.cid.toString()),yield*s(u,c)}catch(u){throw u.code===KBe&&(u.message=`Could not find object with CID: ${o.cid}`),u}}yield*s({cid:e},0)}async function $Be(r,e){let t=await r.get(e);if(t instanceof FBe){let i=({Name:n,Hash:s})=>({name:n,cid:s});return t.Links.map(i)}return QG(t)}function QG(r,e=""){let t=[];for(let[i,n]of Object.entries(r))LBe.isCID(n)?t.push({name:e+i,cid:n}):typeof n=="object"&&(t=t.concat(QG(n,e+i+"/")));return t}});var t$=p((dvt,e$)=>{l();"use strict";var WBe=Be();e$.exports=function({repo:r}){async function*e(t={}){for await(let i of r.blocks.queryKeys({},{signal:t.signal}))yield{ref:i.toString()}}return WBe(e)}});var i$=p((pvt,r$)=>{l();"use strict";var YBe=Be();r$.exports=({network:r})=>{async function e(t={}){let{bitswap:i}=await r.use(t),n=i.getWantlist();return Array.from(n).map(s=>s[1].cid)}return YBe(e)}});var s$=p((yvt,n$)=>{l();"use strict";var XBe=dt(),JBe=Be();n$.exports=({network:r})=>{async function e(t,i={}){let{bitswap:n}=await r.use(i),s=n.wantlistForPeer(XBe.createFromCID(t),i);return Array.from(s).map(o=>o[1].cid)}return JBe(e)}});var a$=p((gvt,o$)=>{l();"use strict";var QBe=Qe(),ZBe=ge(),eNe=Be();o$.exports=({network:r})=>{async function e(t,i={}){let{bitswap:n}=await r.use(i);Array.isArray(t)||(t=[t]);try{t=t.map(s=>new QBe(s))}catch(s){throw ZBe(s,"ERR_INVALID_CID")}return n.unwant(t)}return eNe(e)}});var IA=p((bvt,c$)=>{l();"use strict";var tNe=Be();c$.exports=({network:r})=>{async function e(t={}){let i=(await r.use(t)).bitswap,n=i.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(i.getWantlist()).map(s=>s[1].cid),peers:i.peers().map(s=>s.toB58String()),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}return tNe(e)}});var l$=p((mvt,u$)=>{l();"use strict";var rNe=i$(),iNe=s$(),nNe=a$(),sNe=IA(),f$=class{constructor({network:e}){this.wantlist=rNe({network:e}),this.wantlistForPeer=iNe({network:e}),this.unwant=nNe({network:e}),this.stat=sNe({network:e})}};u$.exports=f$});var TA=p(h$=>{l();"use strict";var oNe=fl().IPFS.matches;h$.isValidMultiaddr=r=>{try{return oNe(r)}catch(e){return!1}}});var p$=p((wvt,d$)=>{l();"use strict";var{isValidMultiaddr:aNe}=TA(),cNe=Be();d$.exports=({repo:r})=>{async function e(t,i={}){if(!aNe(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i),s=n.Bootstrap||[];return s.push(t.toString()),n.Bootstrap=Array.from(new Set(s)).sort((o,a)=>o.localeCompare(a)),await r.config.replace(n),{Peers:[t]}}return cNe(e)}});var g$=p((_vt,y$)=>{l();"use strict";var uNe=Be(),{Multiaddr:fNe}=lr();y$.exports=({repo:r})=>{async function e(t={}){let i=await r.config.getAll(t),n=i.Bootstrap||[];return i.Bootstrap=[],await r.config.replace(i),{Peers:n.map(s=>new fNe(s))}}return uNe(e)}});var m$=p((Evt,b$)=>{l();"use strict";var lNe=Be(),{Multiaddr:hNe}=lr();b$.exports=({repo:r})=>{async function e(t={}){return{Peers:(await r.config.get("Bootstrap",t)||[]).map(n=>new hNe(n))}}return lNe(e)}});var dv=p((Svt,v$)=>{l();"use strict";v$.exports=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:200,HighWater:500},DisableNatPortMap:!0},Routing:{Type:"none"}})});var E$=p((xvt,w$)=>{l();"use strict";var _$=dv(),dNe=Be(),{Multiaddr:pNe}=lr();w$.exports=({repo:r})=>{async function e(t={}){let i=await r.config.getAll(t);return i.Bootstrap=_$().Bootstrap,await r.config.replace(i),{Peers:_$().Bootstrap.map(n=>new pNe(n))}}return dNe(e)}});var x$=p((Avt,S$)=>{l();"use strict";var{isValidMultiaddr:yNe}=TA(),gNe=Be();S$.exports=({repo:r})=>{async function e(t,i={}){if(!yNe(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i);return n.Bootstrap=(n.Bootstrap||[]).filter(s=>s.toString()!==t.toString()),await r.config.replace(n),{Peers:[t]}}return gNe(e)}});var T$=p((Ivt,A$)=>{l();"use strict";var bNe=p$(),mNe=g$(),vNe=m$(),wNe=E$(),_Ne=x$(),I$=class{constructor({repo:e}){this.add=bNe({repo:e}),this.list=vNe({repo:e}),this.rm=_Ne({repo:e}),this.clear=mNe({repo:e}),this.reset=wNe({repo:e})}};A$.exports=I$});var pv=p(R$=>{l();"use strict";var k$=Qe(),ENe=ge();R$.cleanCid=r=>{if(k$.isCID(r))return r;try{return new k$(r)}catch(e){throw ENe(e,"ERR_INVALID_CID")}}});var P$=p((Rvt,C$)=>{l();"use strict";var{cleanCid:SNe}=pv(),xNe=Be();C$.exports=({blockService:r,preload:e})=>{async function t(i,n={}){return i=SNe(i),n.preload!==!1&&e(i),r.get(i,n)}return xNe(t)}});var B$=p((kvt,O$)=>{O$.exports={_from:"ipld-block@^0.11.0",_id:"ipld-block@0.11.1",_inBundle:!1,_integrity:"sha512-sDqqLqD5qh4QzGq6ssxLHUCnH4emCf/8F8IwjQM2cjEEIEHMUj57XhNYgmGbemdYPznUhffxFGEHsruh5+HQRw==",_location:"/ipld-block",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"ipld-block@^0.11.0",name:"ipld-block",escapedName:"ipld-block",rawSpec:"^0.11.0",saveSpec:null,fetchSpec:"^0.11.0"},_requiredBy:["/","/ipfs-bitswap","/ipfs-repo","/ipld"],_resolved:"https://registry.npmjs.org/ipld-block/-/ipld-block-0.11.1.tgz",_shasum:"c3a7b41aee3244187bd87a73f980e3565d299b6e",_spec:"ipld-block@^0.11.0",_where:"/Users/alex/Documents/Workspaces/ipfs/js-ipfs",bugs:{url:"https://github.com/ipld/js-ipld-block/issues"},bundleDependencies:!1,contributors:[{name:"David Dias",email:"daviddias.p@gmail.com"},{name:"Volker Mische",email:"volker.mische@gmail.com"},{name:"Friedel Ziegelmayer",email:"dignifiedquire@gmail.com"},{name:"Irakli Gozalishvili",email:"contact@gozala.io"},{name:"achingbrain",email:"alex@achingbrain.net"},{name:"\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D",email:"victorbjelkholm@gmail.com"},{name:"Alan Shaw",email:"alan.shaw@protocol.ai"},{name:"Charlie",email:"the_charlie_daly@hotmail.co.uk"},{name:"Diogo Silva",email:"fsdiogo@gmail.com"},{name:"Hugo Dias",email:"hugomrdias@gmail.com"},{name:"Mikeal Rogers",email:"mikeal.rogers@gmail.com"},{name:"Richard Littauer",email:"richard.littauer@gmail.com"},{name:"Richard Schneider",email:"makaretu@gmail.com"},{name:"Xmader",email:"xmader@outlook.com"}],dependencies:{cids:"^1.0.0"},deprecated:!1,description:"JavaScript Implementation of IPLD Block",devDependencies:{aegir:"^31.0.4",uint8arrays:"^2.1.3"},engines:{node:">=6.0.0",npm:">=3.0.0"},homepage:"https://github.com/ipld/js-ipld-block#readme",keywords:["IPLD"],leadMaintainer:"Volker Mische <volker.mische@gmail.com>",license:"MIT",main:"src/index.js",name:"ipld-block","pre-push":["lint","test"],repository:{type:"git",url:"git+https://github.com/ipld/js-ipld-block.git"},scripts:{check:"tsc --noEmit --noErrorTruncation",coverage:"aegir coverage","coverage-publish":"aegir coverage --provider coveralls",docs:"aegir docs",lint:"aegir lint",prepare:"aegir build --no-bundle",prepublishOnly:"aegir build",release:"aegir release --docs","release-major":"aegir release --type major --docs","release-minor":"aegir release --type minor --docs",test:"aegir test","test:browser":"aegir test --target browser","test:node":"aegir test --target node"},types:"dist/src/index.d.ts",version:"0.11.1"}});var xl=p((Cvt,N$)=>{l();"use strict";var ANe=Qe(),{version:INe}=B$(),D$=Symbol.for("@ipld/js-ipld-block/block"),q$={writable:!1,configurable:!1,enumerable:!0},M$=class{constructor(e,t){if(!e||!(e instanceof Uint8Array))throw new Error("first argument  must be a Uint8Array");if(!t||!ANe.isCID(t))throw new Error("second argument must be a CID");this.data=e,this.cid=t,Object.defineProperties(this,{data:q$,cid:q$})}get _data(){return RNe(),this.data}get _cid(){return TNe(),this.cid}get[Symbol.toStringTag](){return"Block"}get[D$](){return!0}static isBlock(e){return Boolean(e&&e[D$])}},L$=(r,e)=>{let t=!1;return()=>{if(r.test(INe))t||(t=!0,console.warn(e));else throw new Error(e)}},TNe=L$(/^0\.10|^0\.11/,"block._cid is deprecated and will be removed in 0.12 release. Please use block.cid instead"),RNe=L$(/^0\.10|^0.11/,"block._data is deprecated and will be removed in 0.12 release. Please use block.data instead");N$.exports=M$});var U$=p((Pvt,F$)=>{l();"use strict";var RA=xl(),kNe=er(),kA=Qe(),CNe=ll(),PNe=Be();F$.exports=({blockService:r,pin:e,gcLock:t,preload:i})=>{async function n(s,o={}){if(Array.isArray(s))throw new Error("Array is not supported");if(!RA.isBlock(s)){let c=s;if(o.cid&&CNe.cid(o.cid)){let u=kA.isCID(o.cid)?o.cid:new kA(o.cid);s=new RA(c,u)}else{let u=o.mhtype||"sha2-256",f=o.format||"dag-pb",h=1;o.version==null?h=u==="sha2-256"&&f==="dag-pb"?0:1:h=o.version;let d=await kNe(c,u),y=new kA(h,f,d);s=new RA(c,y)}}let a=await t.readLock();try{return await r.put(s,{signal:o.signal}),o.preload!==!1&&i(s.cid),o.pin===!0&&await e.add(s.cid,{recursive:!0,signal:o.signal}),s}finally{a()}}return PNe(n)}});var Al=p((yv,K$)=>{l();(function(r,e){typeof yv=="object"&&typeof K$!="undefined"?e(yv):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.streamingIterables={}))})(yv,function(r){"use strict";async function*e(T,K){let F=[];for await(let N of K)F.push(N),F.length===T&&(yield F,F=[]);F.length>0&&(yield F)}function*t(T,K){let F=[];for(let N of K)F.push(N),F.length===T&&(yield F,F=[]);F.length>0&&(yield F)}function i(T,K){return K===void 0?F=>i(T,F):K[Symbol.asyncIterator]?e(T,K):t(T,K)}function n(T){if(typeof T.next=="function")return T;if(typeof T[Symbol.iterator]=="function")return T[Symbol.iterator]();if(typeof T[Symbol.asyncIterator]=="function")return T[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function s(){let T,K;return{promise:new Promise((N,Y)=>{K=N,T=Y}),reject:T,resolve:K}}function o(T,K){let F=n(K),N=[],Y=[],ne=!1,te=!1;function he(){for(;Y.length>0&&N.length>0;){let Ae=Y.shift(),{error:Ve,value:Xe}=N.shift();Ve?Ae.reject(Ve):Ae.resolve({done:!1,value:Xe})}for(;Y.length>0&&te;){let{resolve:Ae}=Y.shift();Ae({done:!0,value:void 0})}}async function me(){if(!te&&!ne&&!(N.length>=T)){ne=!0;try{let{done:Ae,value:Ve}=await F.next();Ae?te=!0:N.push({value:Ve})}catch(Ae){te=!0,N.push({error:Ae})}he(),ne=!1,me()}}async function fe(){if(N.length>0){let{error:Ve,value:Xe}=N.shift();if(Ve)throw Ve;return me(),{done:!1,value:Xe}}if(te)return{done:!0,value:void 0};let Ae=s();return Y.push(Ae),me(),Ae.promise}let je={next:fe,[Symbol.asyncIterator]:()=>je};return je}function*a(T,K){let F=[],N;try{for(let Y of K)F.push(Y),!(F.length<=T)&&(yield F.shift())}catch(Y){N=Y}for(let Y of F)yield Y;if(N)throw N}function c(T,K){return K===void 0?F=>c(T,F):T===0?K:K[Symbol.asyncIterator]?o(T,K):a(T,K)}async function u(T){let K=[];for await(let F of T)K.push(F);return K}function f(T){return T[Symbol.asyncIterator]?u(T):Array.from(T)}async function*h(T){for await(let K of T)yield*K}function*d(T){for(let K of T)yield*K}function y(...T){return T.find(F=>F[Symbol.asyncIterator]!==void 0)?h(T):d(T)}async function g(T){for await(let K of T);}function m(T){if(T[Symbol.asyncIterator])return g(T);for(let K of T);}async function*x(T,K){for await(let F of K)await T(F)&&(yield F)}function _(T,K){return K===void 0?F=>x(T,F):x(T,K)}async function*P(T){for await(let K of T)K&&typeof K!="string"&&(K[Symbol.iterator]||K[Symbol.asyncIterator])?yield*P(K):yield K}async function*q(T,K){for await(let F of K)yield await T(F)}function X(T,K){return K===void 0?F=>q(T,F):q(T,K)}function W(T,K){return K===void 0?F=>W(T,F):_(F=>F!=null,P(X(T,K)))}function z(T,K,F){let N=n(F),Y=[],ne=[],te=!1,he=!1,me=0,fe=null;function je(){for(;ne.length>0&&Y.length>0;){let{resolve:ve}=ne.shift(),at=Y.shift();ve({done:!1,value:at})}for(;ne.length>0&&me===0&&te;){let{resolve:ve,reject:at}=ne.shift();fe?(at(fe),fe=null):ve({done:!0,value:void 0})}}async function Ae(){if(te){je();return}if(!he&&!(me+Y.length>=T)){he=!0,me++;try{let{done:ve,value:at}=await N.next();ve?(te=!0,me--,je()):Ve(at)}catch(ve){te=!0,me--,fe=ve,je()}he=!1,Ae()}}async function Ve(ve){try{let at=await K(ve);if(at&&at[Symbol.asyncIterator])for await(let St of at)Y.push(St);else Y.push(at)}catch(at){te=!0,fe=at}me--,je(),Ae()}async function Xe(){if(Y.length===0){let at=s();return ne.push(at),Ae(),at.promise}let ve=Y.shift();return Ae(),{done:!1,value:ve}}let Ge={next:Xe,[Symbol.asyncIterator]:()=>Ge};return Ge}function Z(T,K,F){return K===void 0?(N,Y)=>Y?Z(T,N,Y):Z(T,N):F===void 0?N=>Z(T,K,N):_(N=>N!=null,P(z(T,K,F)))}async function ee(T){return new Promise(K=>{T.once("readable",()=>{K()})})}async function*re(T){for(;;){let K=T.read();if(K!==null){yield K;continue}if(T._readableState.ended)break;await ee(T)}}function L(T){return typeof T[Symbol.asyncIterator]=="function"?T:re(T)}async function*b(...T){let K=new Set(T.map(n));for(;K.size>0;)for(let F of K){let N=await F.next();N.done?K.delete(F):yield N.value}}function w(T,...K){let F=T();for(let N of K)F=N(F);return F}async function*R(T,K,F){let N=null,Y=me=>({value:K(me)}),ne=async function*(me){for await(let fe of me){if(N)return;yield fe}},te=w(()=>F,c(1),ne,X(Y),c(T-1)),he=n(te);for(;;){let{value:me,done:fe}=await he.next();if(fe)break;try{let je=await me.value;N||(yield je)}catch(je){N=je}}if(N)throw N}function B(T,K,F){return K===void 0?(N,Y)=>B(T,N,Y):F===void 0?N=>B(T,K,N):T===1?X(K,F):R(T,K,F)}function U(T,K,F){return K===void 0?(N,Y)=>Y?U(T,N,Y):U(T,N):F===void 0?N=>U(T,K,N):_(N=>N!=null,P(B(T,K,F)))}async function*Q(...T){let K=T.map(n),F=new Set,N=new Map,Y=null,ne=null,te=null,he=Ae=>{Y=Ae,ne&&ne(Ae)},me=Ae=>{te&&te(Ae)},fe=()=>new Promise((Ae,Ve)=>{if(Y&&Ve(Y),N.size>0)return Ae();te=Ae,ne=Ve}),je=Ae=>{let Ve=Promise.resolve(Ae.next()).then(async({done:Xe,value:Ge})=>{Xe||N.set(Ae,Ge),F.delete(Ve)});F.add(Ve),Ve.then(me,he)};for(let Ae of K)je(Ae);for(;;){if(F.size===0&&N.size===0)return;await fe();for(let[Ae,Ve]of N)N.delete(Ae),yield Ve,je(Ae)}}async function G(T,K,F){let N=K;for await(let Y of F)N=await T(N,Y);return N}function M(T,K,F){return K===void 0?(N,Y)=>Y?G(T,N,Y):M(T,N):F===void 0?N=>M(T,K,N):G(T,K,F)}async function*v(T,K){let F=0;for await(let N of K)if(yield await N,F++,F>=T)break}function*V(T,K){let F=0;for(let N of K)if(yield N,F++,F>=T)break}function de(T,K){return K===void 0?F=>de(T,F):K[Symbol.asyncIterator]?v(T,K):V(T,K)}async function*J(T,K){for await(let F of K)await T(F),yield F}function ue(T,K){return K===void 0?F=>J(T,F):J(T,K)}function S(T,K){let F=T[0]+K[0],N=T[1]+K[1];if(N>=1e9){let Y=N%1e9;F+=(N-Y)/1e9,N=Y}return[F,N]}async function*A(T,K){let F=K[Symbol.asyncIterator](),N=[0,0];for(;;){let Y=process.hrtime(),{value:ne,done:te}=await F.next(),he=process.hrtime(Y);if(N=S(N,he),T.progress&&T.progress(he,N),te)return T.total&&T.total(N),ne;yield ne}}function*ie(T,K){let F=K[Symbol.iterator](),N=[0,0];for(;;){let Y=process.hrtime(),{value:ne,done:te}=F.next(),he=process.hrtime(Y);if(N=S(N,he),T.progress&&T.progress(he,N),te)return T.total&&T.total(N),ne;yield ne}}function ae(T={},K){return K===void 0?F=>ae(T,F):K[Symbol.asyncIterator]!==void 0?A(T,K):ie(T,K)}function E(T,K,F){let N=n(F),Y=[],ne=[],te=!1,he=!1,me=0,fe=null;function je(){for(;ne.length>0&&Y.length>0;){let{resolve:ve}=ne.shift(),at=Y.shift();ve({done:!1,value:at})}for(;ne.length>0&&me===0&&te;){let{resolve:ve,reject:at}=ne.shift();fe?(at(fe),fe=null):ve({done:!0,value:void 0})}}async function Ae(){if(te){je();return}if(!he&&!(me+Y.length>=T)){he=!0,me++;try{let{done:ve,value:at}=await N.next();ve?(te=!0,me--,je()):Ve(at)}catch(ve){te=!0,me--,fe=ve,je()}he=!1,Ae()}}async function Ve(ve){try{let at=await K(ve);Y.push(at)}catch(at){te=!0,fe=at}me--,je(),Ae()}async function Xe(){if(Y.length===0){let at=s();return ne.push(at),Ae(),at.promise}let ve=Y.shift();return Ae(),{done:!1,value:ve}}let Ge={next:Xe,[Symbol.asyncIterator]:()=>Ge};return Ge}function I(T,K,F){return K===void 0?(N,Y)=>Y?I(T,N,Y):I(T,N):F===void 0?N=>I(T,K,N):E(T,K,F)}async function j(T,K){let F=null,N=null,Y=null,ne=fe=>{F=fe,N&&N(fe)},te=()=>{Y&&Y()},he=()=>{T.removeListener("error",ne),T.removeListener("drain",te)};T.once("error",ne);let me=()=>new Promise((fe,je)=>{if(F)return je(F);T.once("drain",te),Y=fe,N=je});for await(let fe of K)if(T.write(fe)===!1&&await me(),F)break;if(he(),F)throw F}function H(T,K){return K===void 0?F=>j(T,F):j(T,K)}r.batch=i,r.buffer=c,r.collect=f,r.concat=y,r.consume=m,r.filter=_,r.flatMap=W,r.flatTransform=Z,r.flatten=P,r.fromStream=L,r.getIterator=n,r.map=X,r.merge=b,r.parallelFlatMap=U,r.parallelMap=B,r.parallelMerge=Q,r.pipeline=w,r.reduce=M,r.take=de,r.tap=ue,r.time=ae,r.transform=I,r.writeToStream=H,Object.defineProperty(r,"__esModule",{value:!0})})});var pi=p((Ovt,Zd)=>{l();var j$=(...r)=>{let e;for(;r.length;)e=r.shift()(e);return e},CA=r=>r&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),gv=r=>r&&typeof r.sink=="function"&&CA(r.source),ONe=r=>e=>(r.sink(e),r.source),V$=(...r)=>{if(gv(r[0])){let e=r[0];r[0]=()=>e.source}else if(CA(r[0])){let e=r[0];r[0]=()=>e}if(r.length>1&&gv(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)gv(r[e])&&(r[e]=ONe(r[e]));return j$(...r)};Zd.exports=V$;Zd.exports.pipe=V$;Zd.exports.rawPipe=j$;Zd.exports.isIterable=CA;Zd.exports.isDuplex=gv});var H$=p((Bvt,z$)=>{l();"use strict";var BNe=Qe(),PA=ge(),{parallelMap:NNe,filter:DNe}=Al(),{pipe:qNe}=pi(),{PinTypes:MNe}=jd(),{cleanCid:LNe}=pv(),FNe=Be(),UNe=8;z$.exports=({blockService:r,gcLock:e,pinManager:t})=>{async function*i(n,s={}){Array.isArray(n)||(n=[n]);let o=await e.writeLock();try{yield*qNe(n,NNe(UNe,async a=>{a=LNe(a);let c={cid:a};try{let u=await t.isPinnedWithType(a,MNe.all);if(u.pinned)throw BNe.isCID(u.reason)?PA(new Error(`pinned via ${u.reason}`),"ERR_BLOCK_PINNED"):PA(new Error(`pinned: ${u.reason}`),"ERR_BLOCK_PINNED");if(!await r._repo.blocks.has(a))throw PA(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await r.delete(a)}catch(u){s.force||(u.message=`cannot remove ${a}: ${u.message}`,c.error=u)}return c}),DNe(()=>!s.quiet))}finally{o()}}return FNe(i)}});var $$=p((Nvt,G$)=>{l();"use strict";var{cleanCid:KNe}=pv(),jNe=Be();G$.exports=({blockService:r,preload:e})=>{async function t(i,n={}){i=KNe(i),n.preload!==!1&&e(i);let s=await r.get(i);return{cid:i,size:s.data.length}}return jNe(t)}});var X$=p((Dvt,W$)=>{l();"use strict";var VNe=P$(),zNe=U$(),HNe=H$(),GNe=$$(),Y$=class{constructor({blockService:e,preload:t,gcLock:i,pinManager:n,pin:s}){this.get=VNe({blockService:e,preload:t}),this.put=zNe({blockService:e,preload:t,gcLock:i,pin:s}),this.rm=HNe({blockService:e,gcLock:i,pinManager:n}),this.stat=GNe({blockService:e,preload:t})}};W$.exports=Y$});var Q$=p((qvt,J$)=>{l();"use strict";var $Ne=$a();J$.exports=({addAll:r})=>{async function e(t,i={}){let n=await $Ne(r(t,i));if(n==null)throw Error("Failed to add a file, if you see this please report a bug");return n}return e}});var bv=p((Mvt,Z$)=>{l();"use strict";async function*WNe(r,e=1){let t=[];e<1&&(e=1);for await(let i of r)for(t.push(i);t.length>=e;)yield t.slice(0,e),t=t.slice(e);for(;t.length;)yield t.slice(0,e),t=t.slice(e)}Z$.exports=WNe});var OA=p((Lvt,eW)=>{l();"use strict";var YNe=bv();async function*XNe(r,e=1){for await(let t of YNe(r,e)){let i=t.map(n=>n().then(s=>({ok:!0,value:s}),s=>({ok:!1,err:s})));for(let n=0;n<i.length;n++){let s=await i[n];if(s.ok)yield s.value;else throw s.err}}}eW.exports=XNe});var mv=p((Fvt,tW)=>{l();"use strict";var JNe=Gr().bind({ignoreUndefined:!0}),QNe=er();async function ZNe(r){let t=(await QNe(r,"murmur3-128")).slice(2,10),i=t.length,n=new Uint8Array(i);for(let s=0;s<i;s++)n[i-s-1]=t[s];return n}var eDe={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hashAlg:"sha2-256",leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:17437180132763652,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,pin:!1,recursive:!1,hidden:!1,preload:!1,timeout:void 0,hamtHashFn:ZNe,hamtHashCode:34,hamtBucketBits:8};tW.exports=function(r={}){return JNe(eDe,r)}});var Il=p((Uvt,rW)=>{l();"use strict";var tDe=er(),rDe=Qe(),iDe=async(r,e,t)=>{t.codec||(t.codec="dag-pb"),t.cidVersion||(t.cidVersion=0),t.hashAlg||(t.hashAlg="sha2-256"),t.hashAlg!=="sha2-256"&&(t.cidVersion=1);let i=await tDe(r,t.hashAlg),n=new rDe(t.cidVersion,t.codec,i);return t.onlyHash||await e.put(r,{pin:t.pin,preload:t.preload,timeout:t.timeout,cid:n}),n};rW.exports=iDe});var nW=p((Kvt,iW)=>{l();"use strict";var{UnixFS:nDe}=_i(),sDe=Il(),{DAGNode:oDe}=Mr(),aDe=async(r,e,t)=>{let i=new nDe({type:"directory",mtime:r.mtime,mode:r.mode}),n=new oDe(i.marshal()).serialize(),s=await sDe(n,e,t),o=r.path;return{cid:s,path:o,unixfs:i,size:n.length}};iW.exports=aDe});var oW=p((jvt,sW)=>{l();"use strict";var cDe=jy();sW.exports=async function(r,e){return e(await cDe(r))}});var uW=p((Vvt,aW)=>{l();"use strict";var uDe=bv();function fDe(r,e,t){return cW(r,e,t)}async function cW(r,e,t){let i=[];for await(let n of uDe(r,t.maxChildrenPerNode))i.push(await e(n));return i.length>1?cW(i,e,t):i[0]}aW.exports=fDe});var hW=p((zvt,fW)=>{l();"use strict";var lDe=bv();fW.exports=async function(e,t,i){let n=new lW(i.layerRepeat),s=0,o=1,a=n;for await(let c of lDe(e,i.maxChildrenPerNode))a.isFull()&&(a!==n&&n.addChild(await a.reduce(t)),s&&s%i.layerRepeat==0&&o++,a=new BA(o,i.layerRepeat,s),s++),a.append(c);return a&&a!==n&&n.addChild(await a.reduce(t)),n.reduce(t)};var BA=class{constructor(e,t,i=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=i,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let i=[];return e.children.length&&(i=await Promise.all(e.children.filter(n=>n.data).map(n=>this._reduce(n,t)))),t((e.data||[]).concat(i))}_findParent(e,t){let i=e.parent;if(!(!i||i.depth===0))return i.children.length===i.maxChildren||!i.maxChildren?this._findParent(i,t):i}},lW=class extends BA{constructor(e){super(0,e);this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}});var pW=p((Hvt,dW)=>{l();"use strict";var{UnixFS:hDe}=_i(),dDe=Il(),{DAGNode:pDe}=Mr();async function*yDe(r,e,t){for await(let i of r.content)yield async()=>{t.progress(i.length,r.path);let n,s={codec:"dag-pb",cidVersion:t.cidVersion,hashAlg:t.hashAlg,onlyHash:t.onlyHash};return t.rawLeaves?(s.codec="raw",s.cidVersion=1):(n=new hDe({type:t.leafType,data:i,mtime:r.mtime,mode:r.mode}),i=new pDe(n.marshal()).serialize()),{cid:await dDe(i,e,s),unixfs:n,size:i.length}}}dW.exports=yDe});var wW=p((Gvt,yW)=>{l();"use strict";var gDe=ge(),{UnixFS:gW}=_i(),bW=Il(),{DAGNode:mW,DAGLink:vW}=Mr(),bDe=OA(),mDe=er().multihash,vDe={flat:oW(),balanced:uW(),trickle:hW()};async function*wDe(r,e,t){let i=-1,n,s;typeof t.bufferImporter=="function"?s=t.bufferImporter:s=pW();for await(let o of bDe(s(r,e,t),t.blockWriteConcurrency)){if(i++,i===0){n=o;continue}else i===1&&n&&(yield n,n=null);yield o}n&&(n.single=!0,yield n)}var _De=(r,e,t)=>{async function i(n){if(n.length===1&&n[0].single&&t.reduceSingleLeafToSelf){let f=n[0];if(f.cid.codec==="raw"&&(r.mtime!==void 0||r.mode!==void 0)){let{data:h}=await e.get(f.cid,t);f.unixfs=new gW({type:"file",mtime:r.mtime,mode:r.mode,data:h});let d=mDe.decode(f.cid.multihash);h=new mW(f.unixfs.marshal()).serialize(),f.cid=await bW(h,e,{...t,codec:"dag-pb",hashAlg:d.name,cidVersion:t.cidVersion}),f.size=h.length}return{cid:f.cid,path:r.path,unixfs:f.unixfs,size:f.size}}let s=new gW({type:"file",mtime:r.mtime,mode:r.mode}),o=n.filter(f=>f.cid.codec==="raw"&&f.size||f.unixfs&&!f.unixfs.data&&f.unixfs.fileSize()?!0:Boolean(f.unixfs&&f.unixfs.data&&f.unixfs.data.length)).map(f=>f.cid.codec==="raw"?(s.addBlockSize(f.size),new vW("",f.size,f.cid)):(!f.unixfs||!f.unixfs.data?s.addBlockSize(f.unixfs&&f.unixfs.fileSize()||0):s.addBlockSize(f.unixfs.data.length),new vW("",f.size,f.cid))),a=new mW(s.marshal(),o),c=a.serialize();return{cid:await bW(c,e,t),path:r.path,unixfs:s,size:c.length+a.Links.reduce((f,h)=>f+h.Tsize,0)}}return i};function EDe(r,e,t){let i=vDe[t.strategy];if(!i)throw gDe(new Error(`Unknown importer build strategy name: ${t.strategy}`),"ERR_BAD_STRATEGY");return i(wDe(r,e,t),_De(r,e,t),t)}yW.exports=EDe});var NA=p(($vt,_W)=>{l();"use strict";var{Buffer:Wo}=xt(),EW=Symbol.for("BufferList");function Ar(r){if(!(this instanceof Ar))return new Ar(r);Ar._init.call(this,r)}Ar._init=function(e){Object.defineProperty(this,EW,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Ar.prototype._new=function(e){return new Ar(e)};Ar.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};Ar.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};Ar.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};Ar.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};Ar.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Wo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&t||0,f=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Wo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,u),u+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-f)return s?this._bufs[o[0]].copy(e,t,f,f+c):this._bufs[o[0]].slice(f,f+c);s||(e=Wo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-f;if(c>d)this._bufs[h].copy(e,u,f),u+=d;else{this._bufs[h].copy(e,u,f,f+c),u+=d;break}c-=d,f&&(f=0)}return e.length>u?e.slice(0,u):e};Ar.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};Ar.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};Ar.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Ar.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};Ar.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Wo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Wo.from(e));return this};Ar.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Ar.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=Wo.from([r]):typeof r=="string"?r=Wo.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=Wo.from(r.buffer,r.byteOffset,r.byteLength):Wo.isBuffer(r)||(r=Wo.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};Ar.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?Ar.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:Ar.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();Ar.prototype._isBufferList=function(e){return e instanceof Ar||Ar.isBufferList(e)};Ar.isBufferList=function(e){return e!=null&&e[EW]};_W.exports=Ar});var AW=p((Wvt,SW)=>{l();var xW=class{constructor(e,t=12,i=8*1024,n=32*1024,s=64,o){this.bits=t,this.min=i,this.max=n,this.asModule=e,this.rabin=new e.Rabin(t,i,n,s,o),this.polynomial=o}fingerprint(e){let{__retain:t,__release:i,__allocArray:n,__getInt32Array:s,Int32Array_ID:o,Uint8Array_ID:a}=this.asModule,c=new Int32Array(Math.ceil(e.length/this.min)),u=t(n(o,c)),f=t(n(a,e)),h=this.rabin.fingerprint(f,u),d=s(h);i(f),i(u);let y=d.indexOf(0);return y>=0?d.subarray(0,y):d}};SW.exports=xW});var LW=p(Ag=>{l();"use strict";var DA=-8,vv=-4,SDe=0,IW=1,TW=1<<0,wv=1<<1,Yvt=1<<2,Xvt=1<<3,RW=5,Jvt=1<<RW,kW=1<<10,CW=1<<11,Qvt=1<<12,xDe=1<<13,PW=14,Zvt=1<<PW,ewt=1<<19,twt=1<<20,rwt=1<<21,iwt=1<<22,ADe=0,qA=4,IDe=8,TDe=12,OW=12,RDe=16,kDe=typeof BigUint64Array!="undefined",Ig=Symbol(),Tg=1024;function BW(r,e){let t=new Uint32Array(r),i=new Uint16Array(r);var n=t[e+vv>>>2]>>>1,s=e>>>1;if(n<=Tg)return String.fromCharCode.apply(String,i.subarray(s,s+n));let o=[];do{let a=i[s+Tg-1],c=a>=55296&&a<56320?Tg-1:Tg;o.push(String.fromCharCode.apply(String,i.subarray(s,s+=c))),n-=c}while(n>Tg);return o.join("")+String.fromCharCode.apply(String,i.subarray(s,s+n))}function MA(r){let e={};function t(n,s){return n?BW(n.buffer,s):"<yet unknown>"}let i=r.env=r.env||{};return i.abort=i.abort||function(s,o,a,c){let u=e.memory||i.memory;throw Error("abort: "+t(u,s)+" at "+t(u,o)+":"+a+":"+c)},i.trace=i.trace||function(s,o){let a=e.memory||i.memory;console.log("trace: "+t(a,s)+(o?" ":"")+Array.prototype.slice.call(arguments,2,2+o).join(", "))},r.Math=r.Math||Math,r.Date=r.Date||Date,e}function LA(r,e){let t=e.exports,i=t.memory,n=t.table,s=t.__alloc,o=t.__retain,a=t.__rtti_base||~0;function c(z){let Z=new Uint32Array(i.buffer),ee=Z[a>>>2];if((z>>>=0)>=ee)throw Error("invalid id: "+z);return Z[(a+4>>>2)+z*2]}function u(z){let Z=new Uint32Array(i.buffer),ee=Z[a>>>2];if((z>>>=0)>=ee)throw Error("invalid id: "+z);return Z[(a+4>>>2)+z*2+1]}function f(z){return 31-Math.clz32(z>>>RW&31)}function h(z){return 31-Math.clz32(z>>>PW&31)}function d(z){let Z=z.length,ee=s(Z<<1,IW),re=new Uint16Array(i.buffer);for(var L=0,b=ee>>>1;L<Z;++L)re[b+L]=z.charCodeAt(L);return ee}r.__allocString=d;function y(z){let Z=i.buffer;if(new Uint32Array(Z)[z+DA>>>2]!==IW)throw Error("not a string: "+z);return BW(Z,z)}r.__getString=y;function g(z,Z,ee){let re=i.buffer;if(ee)switch(z){case 2:return new Float32Array(re);case 3:return new Float64Array(re)}else switch(z){case 0:return new(Z?Int8Array:Uint8Array)(re);case 1:return new(Z?Int16Array:Uint16Array)(re);case 2:return new(Z?Int32Array:Uint32Array)(re);case 3:return new(Z?BigInt64Array:BigUint64Array)(re)}throw Error("unsupported align: "+z)}function m(z,Z){let ee=c(z);if(!(ee&(TW|wv)))throw Error("not an array: "+z+" @ "+ee);let re=f(ee),L=Z.length,b=s(L<<re,SDe),w=s(ee&wv?RDe:TDe,z),R=new Uint32Array(i.buffer);R[w+ADe>>>2]=o(b),R[w+qA>>>2]=b,R[w+IDe>>>2]=L<<re,ee&wv&&(R[w+OW>>>2]=L);let B=g(re,ee&kW,ee&CW);if(ee&xDe)for(let U=0;U<L;++U)B[(b>>>re)+U]=o(Z[U]);else B.set(Z,b>>>re);return w}r.__allocArray=m;function x(z){let Z=new Uint32Array(i.buffer),ee=Z[z+DA>>>2],re=c(ee);if(!(re&TW))throw Error("not an array: "+ee);let L=f(re);var b=Z[z+qA>>>2];let w=re&wv?Z[z+OW>>>2]:Z[b+vv>>>2]>>>L;return g(L,re&kW,re&CW).subarray(b>>>=L,b+w)}r.__getArrayView=x;function _(z){let Z=x(z),ee=Z.length,re=new Array(ee);for(let L=0;L<ee;L++)re[L]=Z[L];return re}r.__getArray=_;function P(z){let Z=i.buffer,ee=new Uint32Array(Z)[z+vv>>>2];return Z.slice(z,z+ee)}r.__getArrayBuffer=P;function q(z,Z,ee){return new z(X(z,Z,ee))}function X(z,Z,ee){let re=i.buffer,L=new Uint32Array(re),b=L[ee+qA>>>2];return new z(re,b,L[b+vv>>>2]>>>Z)}r.__getInt8Array=q.bind(null,Int8Array,0),r.__getInt8ArrayView=X.bind(null,Int8Array,0),r.__getUint8Array=q.bind(null,Uint8Array,0),r.__getUint8ArrayView=X.bind(null,Uint8Array,0),r.__getUint8ClampedArray=q.bind(null,Uint8ClampedArray,0),r.__getUint8ClampedArrayView=X.bind(null,Uint8ClampedArray,0),r.__getInt16Array=q.bind(null,Int16Array,1),r.__getInt16ArrayView=X.bind(null,Int16Array,1),r.__getUint16Array=q.bind(null,Uint16Array,1),r.__getUint16ArrayView=X.bind(null,Uint16Array,1),r.__getInt32Array=q.bind(null,Int32Array,2),r.__getInt32ArrayView=X.bind(null,Int32Array,2),r.__getUint32Array=q.bind(null,Uint32Array,2),r.__getUint32ArrayView=X.bind(null,Uint32Array,2),kDe&&(r.__getInt64Array=q.bind(null,BigInt64Array,3),r.__getInt64ArrayView=X.bind(null,BigInt64Array,3),r.__getUint64Array=q.bind(null,BigUint64Array,3),r.__getUint64ArrayView=X.bind(null,BigUint64Array,3)),r.__getFloat32Array=q.bind(null,Float32Array,2),r.__getFloat32ArrayView=X.bind(null,Float32Array,2),r.__getFloat64Array=q.bind(null,Float64Array,3),r.__getFloat64ArrayView=X.bind(null,Float64Array,3);function W(z,Z){let ee=new Uint32Array(i.buffer);var re=ee[z+DA>>>2];if(re<=ee[a>>>2])do if(re==Z)return!0;while(re=u(re));return!1}return r.__instanceof=W,r.memory=r.memory||i,r.table=r.table||n,NW(t,r)}function DW(r){return typeof Response!="undefined"&&r instanceof Response}async function MW(r,e){return DW(r=await r)?qW(r,e):LA(MA(e||(e={})),await WebAssembly.instantiate(r instanceof WebAssembly.Module?r:await WebAssembly.compile(r),e))}Ag.instantiate=MW;function CDe(r,e){return LA(MA(e||(e={})),new WebAssembly.Instance(r instanceof WebAssembly.Module?r:new WebAssembly.Module(r),e))}Ag.instantiateSync=CDe;async function qW(r,e){return WebAssembly.instantiateStreaming?LA(MA(e||(e={})),(await WebAssembly.instantiateStreaming(r,e)).instance):MW(DW(r=await r)?r.arrayBuffer():r,e)}Ag.instantiateStreaming=qW;function NW(r,e){var t=e?Object.create(e):{},i=r.__argumentsLength?function(n){r.__argumentsLength.value=n}:r.__setArgumentsLength||r.__setargc||function(){};for(let n in r){if(!Object.prototype.hasOwnProperty.call(r,n))continue;let s=r[n],o=n.split("."),a=t;for(;o.length>1;){let f=o.shift();Object.prototype.hasOwnProperty.call(a,f)||(a[f]={}),a=a[f]}let c=o[0],u=c.indexOf("#");if(u>=0){let f=c.substring(0,u),h=a[f];if(typeof h=="undefined"||!h.prototype){let d=function(...y){return d.wrap(d.prototype.constructor(0,...y))};d.prototype={valueOf:function(){return this[Ig]}},d.wrap=function(y){return Object.create(d.prototype,{[Ig]:{value:y,writable:!1}})},h&&Object.getOwnPropertyNames(h).forEach(y=>Object.defineProperty(d,y,Object.getOwnPropertyDescriptor(h,y))),a[f]=d}if(c=c.substring(u+1),a=a[f].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let d=r[n.replace("set:","get:")],y=r[n.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return d(this[Ig])},set:function(g){y(this[Ig],g)},enumerable:!0})}}else c==="constructor"?(a[c]=(...d)=>(i(d.length),s(...d))).original=s:(a[c]=function(...d){return i(d.length),s(this[Ig],...d)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:r[n.replace("set:","get:")],set:r[n.replace("get:","set:")],enumerable:!0}):typeof s=="function"&&s!==i?(a[c]=(...f)=>(i(f.length),s(...f))).original=s:a[c]=s}return t}Ag.demangle=NW});var UW=p((swt,FW)=>{l();var{instantiate:PDe}=LW();FA.supported=typeof WebAssembly!="undefined";function FA(r={}){if(!FA.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return PDe(new Response(new Blob([e],{type:"application/wasm"})),r)}FW.exports=FA});var VW=p((owt,KW)=>{l();var jW=AW(),ODe=UW(),BDe=async(r,e,t,i,n)=>{let s=await ODe();return new jW(s,r,e,t,i,n)};KW.exports={Rabin:jW,create:BDe}});var GW=p((awt,zW)=>{l();"use strict";var NDe=NA(),{create:DDe}=VW(),HW=ge();zW.exports=async function*(e,t){let i,n,s;if(t.minChunkSize&&t.maxChunkSize&&t.avgChunkSize)s=t.avgChunkSize,i=t.minChunkSize,n=t.maxChunkSize;else if(t.avgChunkSize)s=t.avgChunkSize,i=s/3,n=s+s/2;else throw HW(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(i<16)throw HW(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<i&&(n=i),s<i&&(s=i);let o=Math.floor(Math.log2(s));for await(let a of qDe(e,{min:i,max:n,bits:o,window:t.window,polynomial:t.polynomial}))yield a};async function*qDe(r,e){let t=await DDe(e.bits,e.min,e.max,e.window),i=new NDe;for await(let n of r){i.append(n);let s=t.fingerprint(n);for(let o=0;o<s.length;o++){let a=s[o],c=i.slice(0,a);i.consume(a),yield c}}i.length&&(yield i.slice(0))}});var WW=p((cwt,$W)=>{l();"use strict";var UA=NA();$W.exports=async function*(e,t){let i=new UA,n=0,s=!1,o=t.maxChunkSize;for await(let a of e)for(i.append(a),n+=a.length;n>=o;)if(yield i.slice(0,o),s=!0,o===i.length)i=new UA,n=0;else{let c=new UA;c.append(i.shallowSlice(o)),i=c,n-=o}(!s||n)&&(yield i.slice(0,n))}});var JW=p((uwt,YW)=>{l();"use strict";var XW=ge(),MDe=ct();async function*LDe(r){for await(let e of r){if(e.length===void 0)throw XW(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield MDe(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw XW(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}YW.exports=LDe});var eY=p((fwt,QW)=>{l();"use strict";var FDe=nW(),UDe=wW(),ZW=ge();function KDe(r){return Symbol.iterator in r}function jDe(r){return Symbol.asyncIterator in r}function VDe(r){try{if(r instanceof Uint8Array)return async function*(){yield r}();if(KDe(r))return async function*(){yield*r}();if(jDe(r))return r}catch{throw ZW(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw ZW(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*zDe(r,e,t){for await(let i of r)if(i.path&&(i.path.substring(0,2)==="./"&&(t.wrapWithDirectory=!0),i.path=i.path.split("/").filter(n=>n&&n!==".").join("/")),i.content){let n;typeof t.chunker=="function"?n=t.chunker:t.chunker==="rabin"?n=GW():n=WW();let s;typeof t.chunkValidator=="function"?s=t.chunkValidator:s=JW();let o={path:i.path,mtime:i.mtime,mode:i.mode,content:n(s(VDe(i.content),t),t)};yield()=>UDe(o,e,t)}else if(i.path){let n={path:i.path,mtime:i.mtime,mode:i.mode};yield()=>FDe(n,e,t)}else throw new Error("Import candidate must have content or path or both")}QW.exports=zDe});var _v=p((lwt,tY)=>{l();"use strict";var rY=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}};tY.exports=rY});var KA=p((hwt,iY)=>{l();"use strict";var{DAGLink:HDe,DAGNode:GDe}=Mr(),{UnixFS:$De}=_i(),nY=_v(),WDe=Il(),sY=class extends nY{constructor(e,t){super(e,t);this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let t=0;t<e.length;t++){let i=e[t];yield{key:i,child:this._children[i]}}}async*flush(e){let t=Object.keys(this._children),i=[];for(let u=0;u<t.length;u++){let f=this._children[t[u]];if(f instanceof nY)for await(let h of f.flush(e))f=h,yield f;f.size!=null&&f.cid&&i.push(new HDe(t[u],f.size,f.cid))}let n=new $De({type:"directory",mtime:this.mtime,mode:this.mode}),s=new GDe(n.marshal(),i),o=s.serialize(),a=await WDe(o,e,this.options),c=o.length+s.Links.reduce((u,f)=>u+f.Tsize,0);this.cid=a,this.size=c,yield{cid:a,unixfs:n,path:this.path,size:c}}};iY.exports=sY});var cY=p((pwt,oY)=>{l();"use strict";var Ev=7;oY.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let i=this._internalPositionFor(e,!1);if(t===void 0)i!==-1&&(this._unsetInternalPos(i),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;i===-1?(i=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(i,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let t=this._internalPositionFor(e,!0);if(t!==-1)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,i=new Array(this.length);for(;t<this.length;)i[t]=e(this.get(t),t,this),t++;return i}reduce(e,t){let i=0,n=t;for(;i<this.length;){let s=this.get(i);n=e(n,s,i),i++}return n}find(e){let t=0,i,n;for(;t<this.length&&!i;)n=this.get(t),i=e(n),t++;return i?n:void 0}_internalPositionFor(e,t){let i=this._bytePosFor(e,t);if(i>=this._bitArrays.length)return-1;let n=this._bitArrays[i],s=e-i*Ev;if(!((n&1<<s)>0))return-1;let a=this._bitArrays.slice(0,i).reduce(YDe,0),c=~(4294967295<<s+1),u=aY(n&c);return a+u-1}_bytePosFor(e,t){let i=Math.floor(e/Ev),n=i+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return i}_setBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-t*Ev}_unsetBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-t*Ev)}_setInternalPos(e,t,i,n){let s=this._data,o=[t,i];if(n)this._sortData(),s[e]=o;else{if(s.length)if(s[s.length-1][0]>=t)s.push(o);else if(s[0][0]<=t)s.unshift(o);else{let a=Math.round(s.length/2);this._data=s.slice(0,a).concat(o).concat(s.slice(a))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(XDe),this._changedData=!1}bitField(){let e=[],t=8,i=0,n=0,s,o=this._bitArrays.slice();for(;o.length||i;){i===0&&(s=o.shift(),i=7);let c=Math.min(i,t),u=~(255<<c);n|=(s&u)<<8-t,s=s>>>c,i-=c,t-=c,(!t||!i&&!o.length)&&(e.push(n),n=0,t=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(JDe)}};function YDe(r,e){return r+aY(e)}function aY(r){let e=r;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function XDe(r,e){return r[0]-e[0]}function JDe(r){return r[1]}});var lY=p((ywt,uY)=>{l();"use strict";var QDe=cY(),ZDe=ct(),Yo=class{constructor(e,t,i=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=i,this._children=new QDe,this.key=null}async put(e,t){let i=await this._findNewBucketAndPos(e);await i.bucket._putAt(i,e,t)}async get(e){let t=await this._findChild(e);if(t)return t.value}async del(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);i&&i.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce((t,i)=>i instanceof Yo?t+i.leafCount():t+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let t of e)t instanceof Yo?yield*t.eachLeafSeries():yield t;return[]}serialize(e,t){let i=[];return t(this._children.reduce((n,s,o)=>(s&&(s instanceof Yo?n.push(s.serialize(e,t)):n.push(e(s,o))),n),i))}asyncTransform(e,t){return fY(this,e,t)}toJSON(){return this.serialize(tqe,rqe)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);if(!(i instanceof Yo)&&i&&i.key===e)return i}async _findPlace(e){let t=this._options.hash(typeof e=="string"?ZDe(e):e),i=await t.take(this._options.bits),n=this._children.get(i);return n instanceof Yo?n._findPlace(t):{bucket:this,pos:i,hash:t,existingChild:n}}async _findNewBucketAndPos(e){let t=await this._findPlace(e);if(t.existingChild&&t.existingChild.key!==e){let i=new Yo(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,i);let n=await i._findPlace(t.existingChild.hash);return n.bucket._putAt(n,t.existingChild.key,t.existingChild.value),i._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,i){this._putObjectAt(e.pos,{key:t,value:i,hash:e.hash})}_putObjectAt(e,t){this._children.get(e)||this._popCount++,this._children.set(e,t)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(eqe);if(e&&!(e instanceof Yo)){let t=e.hash;t.untake(this._options.bits);let i={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(i,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function eqe(r){return Boolean(r)}function tqe(r,e){return r.key}function rqe(r){return r}async function fY(r,e,t){let i=[];for(let n of r._children.compactArray())if(n instanceof Yo)await fY(n,e,t);else{let s=await e(n);i.push({bitField:r._children.bitField(),children:s})}return t(i)}uY.exports=Yo});var dY=p((bwt,hY)=>{l();"use strict";var iqe=[255,254,252,248,240,224,192,128],nqe=[1,3,7,15,31,63,127,255];hY.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let t=e,i=0;for(;t&&this._haveBits();){let n=this._value[this._currentBytePos],s=this._currentBitPos+1,o=Math.min(s,t),a=sqe(n,s-o,o);i=(i<<o)+a,t-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return i}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function sqe(r,e,t){let i=oqe(e,t);return(r&i)>>>e}function oqe(r,e){return iqe[r]&nqe[Math.min(e+r-1,7)]}});var pY=p((mwt,jA)=>{l();"use strict";var aqe=dY(),cqe=vi();function uqe(r){function e(t){return t instanceof Sv?t:new Sv(t,r)}return e}var Sv=class{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let i=0;for(;t>0;){let n=this._buffers[this._currentBufferIndex],s=Math.min(n.availableBits(),t),o=n.take(s);i=(i<<s)+o,t-=s,this._availableBits-=s,n.availableBits()===0&&this._currentBufferIndex++}return i}untake(e){let t=e;for(;t>0;){let i=this._buffers[this._currentBufferIndex],n=Math.min(i.totalBits()-i.availableBits(),t);i.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&i.totalBits()===i.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?cqe([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),i=new aqe(t);this._buffers.push(i),this._availableBits+=i.availableBits()}};jA.exports=uqe;jA.exports.InfiniteHash=Sv});var xv=p((vwt,yY)=>{l();"use strict";var gY=lY(),fqe=pY();function lqe(r){if(!r||!r.hashFn)throw new Error("please define an options.hashFn");let e={bits:r.bits||8,hash:fqe(r.hashFn)};return new gY(e)}yY.exports={createHAMT:lqe,Bucket:gY}});var Av=p((wwt,bY)=>{l();"use strict";var{DAGLink:VA,DAGNode:hqe}=Mr(),{UnixFS:dqe}=_i(),pqe=_v(),yqe=Il(),{createHAMT:gqe,Bucket:bqe}=xv(),mY=class extends pqe{constructor(e,t){super(e,t);this._bucket=gqe({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(let t of vY(this._bucket,e,this,this.options))yield{...t,path:this.path}}};bY.exports=mY;async function*vY(r,e,t,i){let n=r._children,s=[],o=0;for(let y=0;y<n.length;y++){let g=n.get(y);if(!g)continue;let m=y.toString(16).toUpperCase().padStart(2,"0");if(g instanceof bqe){let x;for await(let _ of await vY(g,e,null,i))x=_;if(!x)throw new Error("Could not flush sharded directory, no subshard found");s.push(new VA(m,x.size,x.cid)),o+=x.size}else if(typeof g.value.flush=="function"){let x=g.value,_;for await(let q of x.flush(e))_=q,yield _;let P=m+g.key;s.push(new VA(P,_.size,_.cid)),o+=_.size}else{let x=g.value;if(!x.cid)continue;let _=m+g.key,P=x.size;s.push(new VA(_,P,x.cid)),o+=P}}let a=Uint8Array.from(n.bitField().reverse()),c=new dqe({type:"hamt-sharded-directory",data:a,fanout:r.tableSize(),hashType:i.hamtHashCode,mtime:t&&t.mtime,mode:t&&t.mode}),f=new hqe(c.marshal(),s).serialize(),h=await yqe(f,e,i),d=f.length+o;yield{cid:h,unixfs:c,size:d}}});var _Y=p((_wt,wY)=>{l();"use strict";var mqe=Av(),vqe=KA();wY.exports=async function r(e,t,i,n){let s=t;t instanceof vqe&&t.directChildrenCount()>=i&&(s=await wqe(t,n));let o=s.parent;if(o){if(s!==t){if(e&&(e.parent=s),!s.parentKey)throw new Error("No parent key found");await o.put(s.parentKey,s)}return r(s,o,i,n)}return s};async function wqe(r,e){let t=new mqe({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},e);for await(let{key:i,child:n}of r.eachChildSeries())await t.put(i,n);return t}});var SY=p((Ewt,EY)=>{l();"use strict";var _qe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);EY.exports=_qe});var RY=p((Swt,xY)=>{l();"use strict";var AY=KA(),Eqe=_Y(),IY=_v(),Sqe=SY();async function xqe(r,e,t){let i=Sqe(r.path||""),n=i.length-1,s=e,o="";for(let a=0;a<i.length;a++){let c=i[a];o+=`${o?"/":""}${c}`;let u=a===n;if(s.dirty=!0,s.cid=void 0,s.size=void 0,u)await s.put(c,r),e=await Eqe(null,s,t.shardSplitThreshold,t);else{let f=await s.get(c);(!f||!(f instanceof IY))&&(f=new AY({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:f&&f.unixfs&&f.unixfs.mtime,mode:f&&f.unixfs&&f.unixfs.mode},t)),await s.put(c,f),s=f}}return e}async function*TY(r,e){if(!(r instanceof IY)){r&&r.unixfs&&r.unixfs.isDirectory()&&(yield r);return}yield*r.flush(e)}async function*Aqe(r,e,t){let i=new AY({root:!0,dir:!0,path:"",dirty:!0,flat:!0},t);for await(let n of r)!n||(i=await xqe(n,i,t),(!n.unixfs||!n.unixfs.isDirectory())&&(yield n));if(t.wrapWithDirectory)yield*TY(i,e);else for await(let n of i.eachChildSeries())!n||(yield*TY(n.child,e))}xY.exports=Aqe});var Iv=p((xwt,kY)=>{l();"use strict";var Iqe=OA(),Tqe=mv();async function*Rqe(r,e,t={}){let i=Tqe(t),n;typeof t.dagBuilder=="function"?n=t.dagBuilder:n=eY();let s;typeof t.treeBuilder=="function"?s=t.treeBuilder:s=RY();let o;Symbol.asyncIterator in r||Symbol.iterator in r?o=r:o=[r];for await(let a of s(Iqe(n(o,e,i),i.fileImportConcurrency),e,i))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}kY.exports={importer:Rqe}});var Tv=p((Awt,CY)=>{l();"use strict";async function*kqe(r,e={}){let t=r.getReader();try{for(;;){let i=await t.read();if(i.done)return;yield i.value}}finally{e.preventCancel!==!0&&t.cancel(),t.releaseLock()}}CY.exports=kqe});var BY=p((Iwt,PY)=>{l();"use strict";var OY=Tv();function Cqe(r){return typeof r.stream=="function"?OY(r.stream()):OY(new Response(r).body)}PY.exports=Cqe});var zA=p((Twt,NY)=>{l();"use strict";function Pqe(r){let[e,t]=r[Symbol.asyncIterator]?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],i=[];return{peek:()=>e.next(),push:n=>{i.push(n)},next:()=>i.length?{done:!1,value:i.shift()}:e.next(),[t](){return this}}}NY.exports=Pqe});var HA=p((Rwt,DY)=>{l();"use strict";var{Blob:qY}=globalThis;function Oqe(r){return ArrayBuffer.isView(r)||r instanceof ArrayBuffer}function Bqe(r){return typeof qY!="undefined"&&r instanceof qY}function Nqe(r){return typeof r=="object"&&(r.path||r.content)}var Dqe=r=>r&&typeof r.getReader=="function";DY.exports={isBytes:Oqe,isBlob:Bqe,isFileObject:Nqe,isReadableStream:Dqe}});var FY=p((kwt,MY)=>{l();"use strict";var qqe=ge(),Mqe=ct(),Lqe=Tv(),Fqe=BY(),Uqe=zA(),Kqe=jy(),jqe=$c(),{isBytes:LY,isReadableStream:Vqe,isBlob:zqe}=HA();async function*Hqe(r){if(LY(r)){yield GA(r);return}if(typeof r=="string"||r instanceof String){yield GA(r.toString());return}if(zqe(r)){yield*Fqe(r);return}if(Vqe(r)&&(r=Lqe(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let e=Uqe(r),{value:t,done:i}=await e.peek();if(i){yield*[];return}if(e.push(t),Number.isInteger(t)){yield Uint8Array.from(await Kqe(e));return}if(LY(t)||typeof t=="string"||t instanceof String){yield*jqe(e,GA);return}}throw qqe(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}function GA(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Array.isArray(r)?Uint8Array.from(r):Mqe(r.toString())}MY.exports=Hqe});var GY=p((Cwt,UY)=>{l();"use strict";var Gqe=ge(),$qe=Tv(),Wqe=zA(),KY=$c(),{isBytes:jY,isBlob:VY,isReadableStream:zY,isFileObject:HY}=HA(),{parseMtime:Yqe,parseMode:Xqe}=_i();UY.exports=async function*(e,t){if(e!=null){if(typeof e=="string"||e instanceof String){yield ep(e.toString(),t);return}if(jY(e)||VY(e)){yield ep(e,t);return}if(zY(e)&&(e=$qe(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let i=Wqe(e),{value:n,done:s}=await i.peek();if(s){yield*[];return}if(i.push(n),Number.isInteger(n)||jY(n)){yield ep(i,t);return}if(HY(n)||VY(n)||typeof n=="string"||n instanceof String){yield*KY(i,o=>ep(o,t));return}if(n[Symbol.iterator]||n[Symbol.asyncIterator]||zY(n)){yield*KY(i,o=>ep(o,t));return}}if(HY(e)){yield ep(e,t);return}throw Gqe(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}};async function ep(r,e){let{path:t,mode:i,mtime:n,content:s}=r,o={path:t||"",mode:Xqe(i),mtime:Yqe(n)};return s?o.content=await e(s):t||(o.content=await e(r)),o}});var WY=p((Pwt,$Y)=>{l();"use strict";var Jqe=FY(),Qqe=GY();$Y.exports=r=>Qqe(r,Jqe)});var JY=p((Owt,YY)=>{l();"use strict";var Zqe=r=>{if(r)if(r.startsWith("size-")){let e=r.split("-")[1],t=parseInt(e);if(isNaN(t))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:t}}else{if(r.startsWith("rabin"))return{chunker:"rabin",...XY(r)};throw new Error(`Unrecognized chunker option: ${r}`)}else return{chunker:"fixed"}},XY=r=>{let e={},t=r.split("-");switch(t.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=Rg(t[1],"avg");break;case 4:e.minChunkSize=Rg(t[1],"min"),e.avgChunkSize=Rg(t[2],"avg"),e.maxChunkSize=Rg(t[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},Rg=(r,e)=>{let t=parseInt(r);if(isNaN(t))throw new Error(`Chunker parameter ${e} must be an integer`);return t};YY.exports={parseChunkSize:Rg,parseRabinString:XY,parseChunkerString:Zqe}});var ZY=p((Bwt,QY)=>{l();"use strict";var{importer:e7e}=Iv(),t7e=WY(),{parseChunkerString:r7e}=JY(),{pipe:i7e}=pi(),n7e=Be(),s7e=Gr().bind({ignoreUndefined:!0});QY.exports=({block:r,gcLock:e,preload:t,pin:i,options:n})=>{let s=n&&n.sharding;async function*o(a,c={}){let u=s7e({shardSplitThreshold:s?1e3:Infinity,strategy:"balanced"},c,{...r7e(c.chunker)});u.hashAlg&&u.hashAlg!=="sha2-256"&&u.cidVersion!==1&&(u.cidVersion=1),u.trickle&&(u.strategy="trickle"),u.strategy==="trickle"&&(u.leafType="raw",u.reduceSingleLeafToSelf=!1),u.cidVersion>0&&u.rawLeaves===void 0&&(u.rawLeaves=!0),u.hashAlg!==void 0&&u.rawLeaves===void 0&&(u.rawLeaves=!0),delete u.trickle;let f={};if(u.progress){let y=u.progress;u.progress=(g,m)=>{f[m]||(f[m]=0),f[m]+=g,y(f[m],m)}}let h=i7e(t7e(a),y=>e7e(y,r,{...u,pin:!1}),o7e(u),a7e(t,u),c7e(i,u)),d=await e.readLock();try{for await(let y of h)delete f[y.path],yield y}finally{d()}}return n7e(o)};function o7e(r){async function*e(t){for await(let i of t){let n=i.cid;r.cidVersion===1&&(n=n.toV1());let s=i.path?i.path:n.toString();r.wrapWithDirectory&&!i.path&&(s=""),yield{path:s,cid:n,size:i.size,mode:i.unixfs&&i.unixfs.mode,mtime:i.unixfs&&i.unixfs.mtime}}}return e}function a7e(r,e){async function*t(i){for await(let n of i)(!n.path||e.wrapWithDirectory?n.path==="":!n.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&r(n.cid),yield n}return t}function c7e(r,e){async function*t(i){for await(let n of i){let s=!(n.path&&n.path.includes("/"));(e.pin==null?!0:e.pin)&&s&&!e.onlyHash&&await r.add(n.cid,{preload:!1,lock:!1}),yield n}}return t}});var iX=p((Nwt,eX)=>{l();"use strict";var{Bucket:u7e,createHAMT:f7e}=xv(),l7e=er(),h7e=async function(r){let t=(await l7e(r,"murmur3-128")).slice(2,10),i=t.length,n=new Uint8Array(i);for(let s=0;s<i;s++)n[i-s-1]=t[s];return n},d7e=(r,e,t)=>Promise.all(r.map(i=>{if(i.Name.length===2){let n=parseInt(i.Name,16);return e._putObjectAt(n,new u7e({hash:t._options.hash,bits:t._options.bits},e,n))}return t.put(i.Name.substring(2),!0)})),tX=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),p7e=r=>{let e=r.bucket,t=[];for(;e._parent;)t.push(e),e=e._parent;return t.push(e),t.reverse()},rX=async(r,e,t,i,n)=>{if(!i){let u=f7e({hashFn:h7e});i={rootBucket:u,hamtDepth:1,lastBucket:u}}await d7e(r.Links,i.lastBucket,i.rootBucket);let s=await i.rootBucket._findNewBucketAndPos(e),o=tX(s.pos),a=p7e(s);a.length>i.hamtDepth&&(i.lastBucket=a[i.hamtDepth],o=tX(i.lastBucket._posAtParent));let c=r.Links.find(u=>{let f=u.Name.substring(0,2),h=u.Name.substring(2);return!(f!==o||h&&h!==e)});return c?c.Name.substring(2)===e?c.Hash:(i.hamtDepth++,r=await t.get(c.Hash,n),rX(r,e,t,i,n)):null};eX.exports=rX});var Rv=p((Dwt,nX)=>{l();"use strict";nX.exports=function(e,t,i,n){let s=e.length,o=t+s;return i>=o||n<t?new Uint8Array(0):(n>=t&&n<o&&(e=e.slice(0,n-t)),i>=t&&i<o&&(e=e.slice(i-t)),e)}});var kv=p((qwt,sX)=>{l();"use strict";var $A=ge(),y7e=(r,e,t)=>{if(e||(e=0),e<0)throw $A(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>r)throw $A(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!t&&t!==0&&(t=r-e),t<0)throw $A(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+t>r&&(t=r-e),{offset:e,length:t}};sX.exports=y7e});var WA=p((Mwt,oX)=>{l();"use strict";var aX=Rv(),g7e=kv(),{UnixFS:b7e}=_i(),m7e=ge();async function*cX(r,e,t,i,n=0,s){if(e instanceof Uint8Array){let c=aX(e,n,t,i);return c.length&&(yield c),n+=c.length,n}let o;try{o=b7e.unmarshal(e.Data)}catch(c){throw m7e(c,"ERR_NOT_UNIXFS")}if(o.data&&o.data.length){let c=aX(o.data,n,t,i);c.length&&(yield c),n+=o.data.length}let a=n;for(let c=0;c<e.Links.length;c++){let u=e.Links[c],f=n+o.blockSizes[c];if(t>=a&&t<f||i>a&&i<=f||t<a&&i>f){let h=await r.get(u.Hash,{signal:s.signal});for await(let d of cX(r,h,t,i,n,s))n+=d.length,yield d}n=f,a=f+1}}var v7e=(r,e,t,i,n,s,o)=>{function a(c={}){let u=t.fileSize();if(u===void 0)throw new Error("File was a directory");let{offset:f,length:h}=g7e(u,c.offset,c.length),d=f,y=f+h;return cX(o,e,d,y,0,c)}return a};oX.exports=v7e});var fX=p((Lwt,uX)=>{l();"use strict";var w7e=(r,e,t,i,n,s,o)=>{async function*a(c={}){let u=c.offset||0,f=c.length||e.Links.length,h=e.Links.slice(u,f);for(let d of h){let y=await n(d.Hash,d.Name,`${i}/${d.Name}`,[],s+1,o,c);y.entry&&(yield y.entry)}}return a};uX.exports=w7e});var dX=p((Fwt,lX)=>{l();"use strict";var _7e=(r,e,t,i,n,s,o)=>{function a(c={}){return hX(e,i,n,s,o,c)}return a};async function*hX(r,e,t,i,n,s){let o=r.Links;for(let a of o){let c=a.Name.substring(2);if(c)yield(await t(a.Hash,c,`${e}/${c}`,[],i+1,n,s)).entry;else{r=await n.get(a.Hash);for await(let u of hX(r,e,t,i,n,s))yield u}}}lX.exports=_7e});var gX=p((Uwt,pX)=>{l();"use strict";var yX=ge(),{UnixFS:E7e}=_i(),S7e=iX(),x7e=(r,e)=>{let t=r.Links.find(i=>i.Name===e);return t&&t.Hash},A7e={raw:WA(),file:WA(),directory:fX(),"hamt-sharded-directory":dX(),metadata:(r,e,t,i,n,s,o)=>()=>[],symlink:(r,e,t,i,n,s,o)=>()=>[]},I7e=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r,a),u,f;e||(e=r.toString());try{u=E7e.unmarshal(c.Data)}catch(h){throw yX(h,"ERR_NOT_UNIXFS")}if(t||(t=e),i.length){let h;if(u&&u.type==="hamt-sharded-directory"?h=await S7e(c,i[0],o):h=x7e(c,i[0]),!h)throw yX(new Error("file does not exist"),"ERR_NOT_FOUND");let d=i.shift(),y=`${t}/${d}`;f={cid:h,toResolve:i,name:d||"",path:y}}return{entry:{type:u.isDirectory()?"directory":"file",name:e,path:t,cid:r,content:A7e[u.type](r,c,u,t,n,s,o),unixfs:u,depth:s,node:c,size:u.fileSize()},next:f}};pX.exports=I7e});var mX=p((Kwt,bX)=>{l();"use strict";var T7e=ge(),R7e=Rv(),k7e=kv(),C7e=r=>{async function*e(t={}){let{offset:i,length:n}=k7e(r.length,t.offset,t.length);yield R7e(r,0,i,i+n)}return e},P7e=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw T7e(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await o.get(r,a);return{entry:{type:"raw",name:e,path:t,cid:r,content:C7e(c),depth:s,size:c.length,node:c}}};bX.exports=P7e});var _X=p((jwt,vX)=>{l();"use strict";var wX=Qe(),O7e=ge(),B7e=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r,a),u=await o.get(new wX(1,"raw",r.multihash)),f=c,h=t;for(;i.length;){let d=i[0];if(d in f){if(i.shift(),h=`${h}/${d}`,wX.isCID(f[d]))return{entry:{type:"object",name:e,path:t,cid:r,node:u,depth:s,size:u.length,content:async function*(){yield c}},next:{cid:f[d],name:d,path:h,toResolve:i}};f=f[d]}else throw O7e(new Error(`No property named ${d} found in cbor node ${r}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:t,cid:r,node:u,depth:s,size:u.length,content:async function*(){yield c}}}};vX.exports=B7e});var SX=p((Vwt,EX)=>{l();"use strict";var N7e=ge(),D7e=Rv(),q7e=kv(),M7e=er().multihash,L7e=r=>{async function*e(t={}){let{offset:i,length:n}=q7e(r.length,t.offset,t.length);yield D7e(r,0,i,i+n)}return e},F7e=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw N7e(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await M7e.decode(r.multihash);return{entry:{type:"identity",name:e,path:t,cid:r,content:L7e(c.digest),depth:s,size:c.length,node:c.digest}}};EX.exports=F7e});var IX=p((zwt,xX)=>{l();"use strict";var U7e=ge(),K7e={"dag-pb":gX(),raw:mX(),"dag-cbor":_X(),identity:SX()};function AX(r,e,t,i,n,s,o){let a=K7e[r.codec];if(!a)throw U7e(new Error(`No resolver for codec ${r.codec}`),"ERR_NO_RESOLVER");return a(r,e,t,i,AX,n,s,o)}xX.exports=AX});var Xo=p((Hwt,TX)=>{l();"use strict";var YA=ge(),XA=Qe(),j7e=IX(),V7e=$a(),z7e=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),H7e=r=>{if(r instanceof Uint8Array)return{cid:new XA(r),toResolve:[]};if(XA.isCID(r))return{cid:r,toResolve:[]};if(typeof r=="string"){r.indexOf("/ipfs/")===0&&(r=r.substring(6));let e=z7e(r);return{cid:new XA(e[0]),toResolve:e.slice(1)}}throw YA(new Error(`Unknown path type ${r}`),"ERR_BAD_PATH")};async function*RX(r,e,t={}){let{cid:i,toResolve:n}=H7e(r),s=i.toString(),o=s,a=n.length;for(;;){let c=await j7e(i,s,o,n,a,e,t);if(!c.entry&&!c.next)throw YA(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;n=c.next.toResolve,i=c.next.cid,s=c.next.name,o=c.next.path}}async function kX(r,e,t={}){let i=await V7e(RX(r,e,t));if(!i)throw YA(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");return i}async function*G7e(r,e,t={}){let i=await kX(r,e,t);if(!i)return;if(yield i,i.type==="directory")for await(let s of n(i,t))yield s;async function*n(s,o){for await(let a of s.content(o))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*n(a,o))}}TX.exports={exporter:kX,walkPath:RX,recursive:G7e}});var PX=p((Gwt,CX)=>{l();"use strict";var{exporter:$7e}=Xo(),{normalizeCidPath:W7e}=zi(),Y7e=Be(),X7e=Qe();CX.exports=function({ipld:r,preload:e}){async function*t(i,n={}){if(i=W7e(i),n.preload!==!1){let o=i.split("/");e(new X7e(o[0]))}let s=await $7e(i,r,n);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(n)}return Y7e(t)}});var BX=p(($wt,OX)=>{l();"use strict";var J7e=Xo(),Q7e=ge(),{normalizeCidPath:Z7e,mapFile:eMe}=zi(),tMe=Be(),rMe=Qe();OX.exports=function({ipld:r,preload:e}){async function*t(i,n={}){if(n.preload!==!1){let s;try{s=Z7e(i).split("/")}catch(o){throw Q7e(o,"ERR_INVALID_PATH")}e(new rMe(s[0]))}for await(let s of J7e.recursive(i,r,n))yield eMe(s,{...n,includeContent:!0})}return tMe(t)}});var DX=p((Wwt,NX)=>{l();"use strict";var{exporter:iMe,recursive:nMe}=Xo(),sMe=ge(),{normalizeCidPath:oMe,mapFile:JA}=zi(),aMe=Be(),cMe=Qe();NX.exports=function({ipld:r,preload:e}){async function*t(i,n={}){let o=oMe(i).split("/");n.preload!==!1&&e(new cMe(o[0]));let a=await iMe(i,r,n);if(a.type==="file"){yield JA(a,n);return}if(a.type==="directory"){if(n.recursive){for await(let c of nMe(a.cid,r,n))a.cid.toBaseEncodedString()!==c.cid.toBaseEncodedString()&&(yield JA(c,n));return}for await(let c of a.content()){let u=JA(c,n);u.depth--,yield u}return}throw sMe(new Error(`Unknown UnixFS type ${a.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return aMe(t)}});var LX=p((Ywt,qX)=>{l();"use strict";var uMe=Q$(),fMe=ZY(),lMe=PX(),hMe=BX(),dMe=DX(),MX=class{constructor({preload:e,gcLock:t,pin:i,block:n,ipld:s,options:o}){let a=fMe({preload:e,gcLock:t,block:n,pin:i,options:o});this.addAll=a,this.add=uMe({addAll:a}),this.cat=lMe({ipld:s,preload:e}),this.get=hMe({ipld:s,preload:e}),this.ls=dMe({ipld:s,preload:e})}};qX.exports=MX});var Cv=p((Xwt,FX)=>{FX.exports={name:"ipfs-core",version:"0.7.1",description:"JavaScript implementation of the IPFS specification",keywords:["IPFS"],homepage:"https://github.com/ipfs/js-ipfs/tree/master/packages/ipfs-core#readme",bugs:"https://github.com/ipfs/js-ipfs/issues",license:"(Apache-2.0 OR MIT)",leadMaintainer:"Alex Potsides <alex@achingbrain.net>",main:"src/index.js",types:"dist/src/index.d.ts",files:["src","dist","!dist/*.tsbuildinfo"],browser:{"./src/runtime/init-assets-nodejs.js":"./src/runtime/init-assets-browser.js","./src/runtime/config-nodejs.js":"./src/runtime/config-browser.js","./src/runtime/dns-nodejs.js":"./src/runtime/dns-browser.js","./src/runtime/libp2p-nodejs.js":"./src/runtime/libp2p-browser.js","./src/runtime/libp2p-pubsub-routers-nodejs.js":"./src/runtime/libp2p-pubsub-routers-browser.js","./src/runtime/preload-nodejs.js":"./src/runtime/preload-browser.js","./src/runtime/repo-nodejs.js":"./src/runtime/repo-browser.js","./test/utils/create-repo-nodejs.js":"./test/utils/create-repo-browser.js","ipfs-utils/src/files/glob-source":!1},typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"],"src/":["dist/src/index"]}},repository:{type:"git",url:"git+https://github.com/ipfs/js-ipfs.git"},scripts:{build:"aegir build",lint:"aegir lint",test:"aegir test","test:node":"aegir test -t node","test:browser":"aegir test -t browser","test:webworker":"aegir test -t webworker","test:electron-main":"aegir test -t electron-main","test:electron-renderer":"aegir test -t electron-renderer","test:bootstrapers":"IPFS_TEST=bootstrapers aegir test -t browser -f test/bootstrapers.js",coverage:"nyc --reporter=text --reporter=lcov npm run test:node",clean:"rimraf ./dist","dep-check":"aegir dep-check -i interface-ipfs-core -i ipfs-core-types -i abort-controller"},dependencies:{"abort-controller":"^3.0.0","array-shuffle":"^2.0.0",cborg:"^1.2.1",cids:"^1.1.6","dag-cbor-links":"^2.0.0","datastore-core":"^4.0.0","datastore-pubsub":"^0.6.1",debug:"^4.1.1",dlv:"^1.1.3","err-code":"^3.0.1","hamt-sharding":"^2.0.0",hashlru:"^2.3.0","interface-datastore":"^4.0.0","ipfs-bitswap":"^5.0.3","ipfs-block-service":"^0.19.0","ipfs-core-types":"^0.5.1","ipfs-core-utils":"^0.8.2","ipfs-repo":"^9.1.6","ipfs-unixfs":"^4.0.3","ipfs-unixfs-exporter":"^5.0.3","ipfs-unixfs-importer":"^7.0.3","ipfs-utils":"^8.1.2",ipld:"^0.30.0","ipld-block":"^0.11.0","ipld-dag-cbor":"^1.0.0","ipld-dag-pb":"^0.22.1","ipld-raw":"^7.0.0",ipns:"^0.12.0","is-domain-name":"^1.0.1","is-ipfs":"^5.0.0","it-all":"^1.0.4","it-drain":"^1.0.3","it-first":"^1.0.4","it-last":"^1.0.4","it-map":"^1.0.4","it-pipe":"^1.1.0","just-safe-set":"^2.2.1",libp2p:"^0.31.6","libp2p-bootstrap":"^0.12.3","libp2p-crypto":"^0.19.3","libp2p-floodsub":"^0.25.1","libp2p-gossipsub":"^0.9.2","libp2p-kad-dht":"^0.22.0","libp2p-mdns":"^0.16.0","libp2p-mplex":"^0.10.2","libp2p-noise":"^3.1.0","libp2p-record":"^0.10.3","libp2p-tcp":"^0.15.4","libp2p-webrtc-star":"^0.22.2","libp2p-websockets":"^0.15.6",mafmt:"^9.0.0","merge-options":"^3.0.4",mortice:"^2.0.0",multiaddr:"^9.0.1","multiaddr-to-uri":"^7.0.0",multibase:"^4.0.2",multicodec:"^3.0.1","multihashing-async":"^2.1.2","native-abort-controller":"^1.0.3","p-queue":"^6.6.1","parse-duration":"^1.0.0","peer-id":"^0.14.1","streaming-iterables":"^5.0.2",uint8arrays:"^2.1.3"},devDependencies:{"@types/dlv":"^1.1.2",aegir:"^33.0.0",delay:"^5.0.0","go-ipfs":"0.8.0","interface-ipfs-core":"^0.146.1","ipfsd-ctl":"^8.0.1","ipld-git":"^0.6.1","iso-url":"^1.0.0",nanoid:"^3.1.12","p-defer":"^3.0.0",rimraf:"^3.0.2",sinon:"^10.0.1"}}});var KX=p((Jwt,UX)=>{l();"use strict";var QA=Cv(),pMe=Be();UX.exports=({repo:r})=>{async function e(t={}){let i=await r.version.get();return{version:QA.version,repo:`${i}`,commit:QA.gitHead||"","interface-ipfs-core":QA.devDependencies["interface-ipfs-core"]}}return pMe(e)}});var VX=p((Qwt,jX)=>{l();"use strict";var yMe=Cv().version,{Multiaddr:gMe}=lr(),bMe=Be(),Pv=tt(),mMe=dt(),{NotStartedError:vMe}=Xu();jX.exports=({peerId:r,network:e})=>{async function t(i={}){i.peerId===r.toB58String()&&delete i.peerId;let n=e.try();if(!n){if(i.peerId)throw new vMe;return{id:r.toB58String(),publicKey:Pv(r.pubKey.bytes,"base64pad"),addresses:[],agentVersion:`js-ipfs/${yMe}`,protocolVersion:"9000",protocols:[]}}let s=i.peerId?mMe.createFromB58String(i.peerId.toString()):r,{libp2p:o}=n,a=i.peerId?o.peerStore.keyBook.get(s):s.pubKey,c=i.peerId?o.peerStore.addressBook.getMultiaddrsForPeer(s):o.multiaddrs,u=i.peerId?o.peerStore.protoBook.get(s):Array.from(o.upgrader.protocols.keys()),f=Pv(o.peerStore.metadataBook.getValue(s,"AgentVersion")||new Uint8Array),h=Pv(o.peerStore.metadataBook.getValue(s,"ProtocolVersion")||new Uint8Array),d=s.toB58String();return{id:d,publicKey:Pv(a.bytes,"base64pad"),addresses:(c||[]).map(y=>{let g=y.toString();return g.endsWith(`/p2p/${d}`)?g:`${g}/p2p/${d}`}).sort().map(y=>new gMe(y)),agentVersion:f,protocolVersion:h,protocols:(u||[]).sort()}}return bMe(t)}});var ZA=p((Zwt,zX)=>{l();zX.exports=wMe;function wMe(r,e,t){typeof e=="string"&&(e=e.split(".")),typeof e=="symbol"&&(e=[e]);var i=e.pop();if(!i)return!1;for(var n;n=e.shift();)if(typeof r[n]=="undefined"&&(r[n]={}),r=r[n],!r||typeof r!="object")return!1;return r[i]=t,!0}});var r5=p((e_t,e5)=>{l();"use strict";var si=ZA(),t5=dv(),tp=Be(),_Me=xe()("ipfs:core:config");e5.exports=({repo:r})=>{return{getAll:tp(e),get:tp(t),set:tp(i),replace:tp(n),profiles:{apply:tp(s),list:tp(EMe)}};async function e(o={}){return r.config.getAll(o)}async function t(o,a){return o?r.config.get(o,a):Promise.reject(new Error("key argument is required"))}async function i(o,a,c){return r.config.set(o,a,c)}async function n(o,a){return r.config.replace(o,a)}async function s(o,a={dryRun:!1}){let{dryRun:c}=a,u=Ov[o];if(!u)throw new Error(`No profile with name '${o}' exists`);try{let f=await r.config.getAll(a),h=JSON.parse(JSON.stringify(f));return h=u.transform(h),c||await r.config.replace(h,a),delete f.Identity.PrivKey,delete h.Identity.PrivKey,{original:f,updated:h}}catch(f){throw _Me(f),new Error(`Could not apply profile '${o}' to config: ${f.message}`)}}};async function EMe(r){return Object.keys(Ov).map(e=>({name:e,description:Ov[e].description}))}var Ov={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:r=>(si(r,"Discovery.MDNS.Enabled",!1),si(r,"Discovery.webRTCStar.Enabled",!1),r.Swarm={...r.Swarm||{},DisableNatPortMap:!0},r)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:r=>(si(r,"Discovery.MDNS.Enabled",!0),si(r,"Discovery.webRTCStar.Enabled",!0),si(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:r=>{let e=t5();return si(r,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),si(r,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),si(r,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),si(r,"Addresses.Delegates",[]),si(r,"Bootstrap",[]),si(r,"Discovery.MDNS.Enabled",!1),si(r,"Discovery.webRTCStar.Enabled",!1),si(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!0}),r}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:r=>{let e=t5();return si(r,"Addresses.API",e.Addresses.API),si(r,"Addresses.Gateway",e.Addresses.Gateway),si(r,"Addresses.Swarm",e.Addresses.Swarm),si(r,"Addresses.Delegates",e.Addresses.Delegates),si(r,"Bootstrap",e.Bootstrap),si(r,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),si(r,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),si(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:r=>{let e=r.Swarm||{},t=e.ConnMgr||{};return t.LowWater=20,t.HighWater=40,e.ConnMgr=t,r.Swarm=e,r}},"default-power":{description:'Inverse of "lowpower" profile.',transform:r=>{let e=t5();return r.Swarm=e.Swarm,r}}};e5.exports.profiles=Ov});var GX=p((t_t,HX)=>{l();"use strict";var SMe=Be(),xMe=qd(),AMe=$a();HX.exports=({ipld:r,preload:e})=>SMe(async function(n,s={}){return s.preload!==!1&&e(n),s.path?s.localResolve?await xMe(r.resolve(n,s.path)):await AMe(r.resolve(n,s.path)):{value:await r.get(n,s),remainderPath:""}})});var WX=p((r_t,$X)=>{l();"use strict";var IMe=Be(),TMe=Gy();$X.exports=({ipld:r,preload:e})=>{async function*t(i,n={}){let{cid:s,path:o}=TMe(i);o&&(n.path=o),n.preload!==!1&&e(s),yield*r.tree(s,n.path,n)}return IMe(t)}});var JX=p((i_t,YX)=>{l();"use strict";var Bv=$r(),XX=er().multihash,RMe=r=>Bv.getCodeFromName(r),kMe=r=>XX.names[r],CMe=Be();YX.exports=({ipld:r,pin:e,gcLock:t,preload:i})=>{async function n(s,o={}){let{cidVersion:a,format:c,hashAlg:u}=PMe(o),f=o.pin?await t.readLock():null;try{let h=await r.put(s,c,{hashAlg:u,cidVersion:a,signal:o.signal});return o.pin&&await e.add(h,{lock:!1}),o.preload!==!1&&i(h),h}finally{f&&f()}}return CMe(n)};var PMe=r=>{if(r.cid&&(r.format||r.hashAlg))throw new Error("Can't put dag node. Please provide either `cid` OR `format` and `hashAlg` options.");if(r.format&&!r.hashAlg||!r.format&&r.hashAlg)throw new Error("Can't put dag node. Please provide `format` AND `hashAlg` options.");let{hashAlg:e,format:t}=r.cid!=null?{format:r.cid.code,hashAlg:void 0}:OMe({...NMe,...r});return{cidVersion:BMe({...r,format:t,hashAlg:e}),format:t,hashAlg:e}},OMe=({format:r,hashAlg:e})=>({format:typeof r=="string"?RMe(r):r,hashAlg:typeof e=="string"?kMe(e):e}),BMe=({version:r,cid:e,format:t,hashAlg:i})=>typeof r=="number"?r:e?e.version:t===Bv.DAG_PB&&i===Bv.SHA2_256?0:1,NMe={format:Bv.getCodeFromName("dag-cbor"),hashAlg:XX.names["sha2-256"]}});var eJ=p((n_t,QX)=>{l();"use strict";var DMe=GX(),qMe=P6(),MMe=WX(),LMe=JX(),ZX=class{constructor({ipld:e,pin:t,preload:i,gcLock:n}){this.get=DMe({ipld:e,preload:i}),this.resolve=qMe({ipld:e,preload:i}),this.tree=MMe({ipld:e,preload:i}),this.put=LMe({ipld:e,preload:i,pin:t,gcLock:n})}};QX.exports=ZX});var i5=p((s_t,tJ)=>{l();var{Multiaddr:FMe}=lr(),Nv=(r,e)=>e,UMe=(r,e,t,i)=>{if(i&&i.assumeHttp===!1)return`tcp://${r}:${e}`;let n="tcp",s=`:${e}`;return t[t.length-1].protocol==="tcp"&&(n=e==="443"?"https":"http",s=e==="443"||e==="80"?"":s),`${n}://${r}${s}`},KMe={ip4:Nv,ip6:(r,e,t,i)=>i.length===1&&i[0].protocol==="ip6"?e:`[${e}]`,tcp:(r,e,t,i,n)=>i.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${r}:${e}`:UMe(r,e,i,n),udp:(r,e)=>`udp://${r}:${e}`,dnsaddr:Nv,dns4:Nv,dns6:Nv,ipfs:(r,e)=>`${r}/ipfs/${e}`,p2p:(r,e)=>`${r}/p2p/${e}`,http:r=>`http://${r}`,https:r=>`https://${r}`,ws:r=>`ws://${r}`,wss:r=>`wss://${r}`,"p2p-websocket-star":r=>`${r}/p2p-websocket-star`,"p2p-webrtc-star":r=>`${r}/p2p-webrtc-star`,"p2p-webrtc-direct":r=>`${r}/p2p-webrtc-direct`};tJ.exports=(r,e)=>{let t=new FMe(r),i=r.toString().split("/").slice(1);return t.tuples().map(n=>({protocol:i.shift(),content:n[1]?i.shift():null})).reduce((n,s,o,a)=>{let c=KMe[s.protocol];if(!c)throw new Error(`Unsupported protocol ${s.protocol}`);return c(n,s.content,o,a,e)},"")}});var iJ=p((o_t,rJ)=>{l();"use strict";rJ.exports=r=>{if(!Array.isArray(r))throw new TypeError(`Expected an array, got ${typeof r}`);r=[...r];for(let e=r.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}return r}});var oJ=p((a_t,nJ)=>{l();"use strict";var{default:jMe}=yl(),VMe=Vb(),sJ=xe(),zMe=Object.assign(sJ("ipfs:preload"),{error:sJ("ipfs:preload:error")}),HMe=new jMe({concurrency:4});nJ.exports=function(e,t={}){return zMe(e),HMe.add(async()=>{let n=(await VMe.post(e,{signal:t.signal})).body.getReader();try{for(;;){let{done:s}=await n.read();if(s)return}}finally{n.releaseLock()}})}});var uJ=p((c_t,aJ)=>{l();"use strict";var GMe=i5(),cJ=xe(),$Me=iJ(),{AbortController:WMe}=Q0(),YMe=oJ(),XMe=Qy(),kg=Object.assign(cJ("ipfs:preload"),{error:cJ("ipfs:preload:error")}),JMe=(r={})=>{if(r.enabled=Boolean(r.enabled),r.addresses=r.addresses||[],r.cache=r.cache||1e3,!r.enabled||!r.addresses.length)return kg("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,t=[],i=r.addresses.map(GMe),n=XMe(r.cache),s=async o=>{try{if(e)throw new Error(`preload ${o} but preloader is not started`);let a=o.toString();if(n.has(a))return;n.set(a,!0);let c=$Me(i),u=!1,f=Date.now();for(let h of c){if(e)throw new Error(`preload aborted for ${a}`);let d;try{d=new WMe,t=t.concat(d),await YMe(`${h}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:d.signal}),u=!0}catch(y){y.type!=="aborted"&&kg.error(y)}finally{t=t.filter(y=>y!==d)}if(u)break}kg(`${u?"":"un"}successfully preloaded ${a} in ${Date.now()-f}ms`)}catch(a){kg.error(a)}};return s.start=()=>{e=!1},s.stop=()=>{e=!0,kg(`aborting ${t.length} pending preload request(s)`),t.forEach(o=>o.abort()),t=[]},s};aJ.exports=JMe});var dJ=p((u_t,fJ)=>{l();"use strict";var lJ=xe(),{cidToString:hJ}=t4(),Dv=Object.assign(lJ("ipfs:mfs-preload"),{error:lJ("ipfs:mfs-preload:error")});fJ.exports=({preload:r,files:e,options:t={}})=>{if(t.interval=t.interval||30*1e3,!t.enabled){Dv("MFS preload disabled");let o=async()=>{};return{start:o,stop:o}}let i="",n,s=async()=>{try{let o=await e.stat("/"),a=hJ(o.cid,{base:"base32"});i!==a&&(Dv(`preloading updated MFS root ${i} -> ${o.cid}`),await r(o.cid),i=a)}catch(o){Dv.error("failed to preload MFS root",o)}finally{n=setTimeout(s,t.interval)}};return{async start(){let o=await e.stat("/");i=hJ(o.cid,{base:"base32"}),Dv(`monitoring MFS root ${o.cid}`),n=setTimeout(s,t.interval)},stop(){clearTimeout(n)}}}});var Lr=p((f_t,n5)=>{l();"use strict";var rp=typeof Reflect=="object"?Reflect:null,pJ=rp&&typeof rp.apply=="function"?rp.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},qv;rp&&typeof rp.ownKeys=="function"?qv=rp.ownKeys:Object.getOwnPropertySymbols?qv=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:qv=function(e){return Object.getOwnPropertyNames(e)};function QMe(r){console&&console.warn&&console.warn(r)}var yJ=Number.isNaN||function(e){return e!==e};function dr(){dr.init.call(this)}n5.exports=dr;n5.exports.once=ZMe;dr.EventEmitter=dr;dr.prototype._events=void 0;dr.prototype._eventsCount=0;dr.prototype._maxListeners=void 0;var gJ=10;function Mv(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(dr,"defaultMaxListeners",{enumerable:!0,get:function(){return gJ},set:function(r){if(typeof r!="number"||r<0||yJ(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");gJ=r}});dr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};dr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||yJ(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function bJ(r){return r._maxListeners===void 0?dr.defaultMaxListeners:r._maxListeners}dr.prototype.getMaxListeners=function(){return bJ(this)};dr.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")pJ(c,this,t);else for(var u=c.length,f=mJ(c,u),i=0;i<u;++i)pJ(f[i],this,t);return!0};function vJ(r,e,t,i){var n,s,o;if(Mv(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),o=s[e]),o===void 0)o=s[e]=t,++r._eventsCount;else if(typeof o=="function"?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),n=bJ(r),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=o.length,QMe(a)}return r}dr.prototype.addListener=function(e,t){return vJ(this,e,t,!1)};dr.prototype.on=dr.prototype.addListener;dr.prototype.prependListener=function(e,t){return vJ(this,e,t,!0)};function e9e(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function wJ(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=e9e.bind(i);return n.listener=t,i.wrapFn=n,n}dr.prototype.once=function(e,t){return Mv(t),this.on(e,wJ(this,e,t)),this};dr.prototype.prependOnceListener=function(e,t){return Mv(t),this.prependListener(e,wJ(this,e,t)),this};dr.prototype.removeListener=function(e,t){var i,n,s,o,a;if(Mv(t),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():t9e(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};dr.prototype.off=dr.prototype.removeListener;dr.prototype.removeAllListeners=function(e){var t,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function _J(r,e,t){var i=r._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?r9e(n):mJ(n,n.length)}dr.prototype.listeners=function(e){return _J(this,e,!0)};dr.prototype.rawListeners=function(e){return _J(this,e,!1)};dr.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):EJ.call(r,e)};dr.prototype.listenerCount=EJ;function EJ(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}dr.prototype.eventNames=function(){return this._eventsCount>0?qv(this._events):[]};function mJ(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function t9e(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function r9e(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function ZMe(r,e){return new Promise(function(t,i){function n(o){r.removeListener(e,s),i(o)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}SJ(r,e,s,{once:!0}),e!=="error"&&i9e(r,n,{once:!0})})}function i9e(r,e,t){typeof r.on=="function"&&SJ(r,"error",e,t)}function SJ(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(s){i.once&&r.removeEventListener(e,n),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var s5=p((l_t,xJ)=>{l();xJ.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var AJ=p(()=>{l()});var DJ=p((p_t,IJ)=>{l();var n9e=Lr().EventEmitter,{nanoid:s9e}=(Ky(),Uy),{WORKER_REQUEST_READ_LOCK:TJ,WORKER_RELEASE_READ_LOCK:RJ,MASTER_GRANT_READ_LOCK:kJ,WORKER_REQUEST_WRITE_LOCK:CJ,WORKER_RELEASE_WRITE_LOCK:PJ,MASTER_GRANT_WRITE_LOCK:OJ}=s5(),Cg,BJ=(r,e,t,i,n)=>(s,o)=>{o&&o.type===t&&r.emit(e,o.name,()=>(s.send({type:n,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=u=>{u&&u.type===i&&u.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},NJ=(r,e,t,i)=>()=>{let n=s9e();return process.send({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{a&&a.type===t&&a.identifier===n&&(process.removeListener("message",o),s(()=>{process.send({type:i,identifier:n,name:r})}))};process.on("message",o)})};IJ.exports=r=>{try{if(Cg=AJ(),!Object.keys(Cg).length)return}catch(e){return}if(Cg.isMaster||r.singleProcess){let e=new n9e;return Cg.on("message",BJ(e,"requestReadLock",TJ,RJ,kJ)),Cg.on("message",BJ(e,"requestWriteLock",CJ,PJ,OJ)),e}return{isWorker:!0,readLock:e=>NJ(e,TJ,kJ,RJ),writeLock:e=>NJ(e,CJ,OJ,PJ)}}});var o5=p((y_t,qJ)=>{l();var tf={},ip=r=>{r.addEventListener("message",e=>{ip.dispatchEvent("message",r,e)}),r.port&&r.port.addEventListener("message",e=>{ip.dispatchEvent("message",r,e)})};ip.addEventListener=(r,e)=>{tf[r]||(tf[r]=[]),tf[r].push(e)};ip.removeEventListener=(r,e)=>{!tf[r]||(tf[r]=tf[r].filter(t=>t===e))};ip.dispatchEvent=function(){let r=Array.prototype.slice.call(arguments),e=r.shift();!tf[e]||tf[e].forEach(t=>t.apply(null,r))};qJ.exports=ip});var $J=p((g_t,MJ)=>{l();var o9e=Lr().EventEmitter,{nanoid:a9e}=(Ky(),Uy),{WORKER_REQUEST_READ_LOCK:LJ,WORKER_RELEASE_READ_LOCK:FJ,MASTER_GRANT_READ_LOCK:UJ,WORKER_REQUEST_WRITE_LOCK:KJ,WORKER_RELEASE_WRITE_LOCK:jJ,MASTER_GRANT_WRITE_LOCK:VJ}=s5(),zJ=o5(),HJ=(r,e,t,i,n)=>(s,o)=>{if(!o||!o.data||o.data.type!==t)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};r.emit(e,a.name,()=>(s.postMessage({type:n,name:a.name,identifier:a.identifier}),new Promise(c=>{let u=f=>{if(!f||!f.data)return;let h={type:f.data.type,name:f.data.name,identifier:f.data.identifier};h&&h.type===i&&h.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)})))},GJ=(r,e,t,i)=>()=>{let n=a9e();return globalThis.postMessage({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===t&&c.identifier===n&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:i,identifier:n,name:r})}))};globalThis.addEventListener("message",o)})},c9e={singleProcess:!1};MJ.exports=r=>{if(r=Object.assign({},c9e,r),!!globalThis.document||r.singleProcess){let t=new o9e;return zJ.addEventListener("message",HJ(t,"requestReadLock",LJ,FJ,UJ)),zJ.addEventListener("message",HJ(t,"requestWriteLock",KJ,jJ,VJ)),t}return{isWorker:!0,readLock:t=>GJ(t,LJ,UJ,FJ),writeLock:t=>GJ(t,KJ,VJ,jJ)}}});var WJ=p((m_t,a5)=>{l();"use strict";var Lv,b_t=a5.exports.timeout=function(r,e){var t=new Lv,i;return Promise.race([r,new Promise(function(n,s){i=setTimeout(function(){s(t)},e)})]).then(function(n){return clearTimeout(i),n},function(n){throw clearTimeout(i),n})};Lv=a5.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};Lv.prototype=Object.create(Error.prototype);Lv.prototype.name="TimeoutError"});var f5=p((v_t,c5)=>{l();var u9e=DJ(),f9e=$J(),{default:YJ}=yl(),{timeout:l9e}=WJ(),h9e=o5(),Tl={},rf;function u5(r,e){let t,i=new Promise(n=>{t=n});return r.add(()=>l9e((()=>new Promise(n=>{t(()=>{n()})}))(),e.timeout)),i}var d9e=(r,e)=>{if(rf.isWorker)return{readLock:rf.readLock(r,e),writeLock:rf.writeLock(r,e)};let t=new YJ({concurrency:1}),i=null;return{readLock:()=>{if(i)return u5(i,e);i=new YJ({concurrency:e.concurrency,autoStart:!1});let n=i,s=u5(i,e);return t.add(()=>(n.start(),n.onIdle().then(()=>{i===n&&(i=null)}))),s},writeLock:()=>(i=null,u5(t,e))}},p9e={concurrency:Infinity,timeout:846e5,global:globalThis,singleProcess:!1};c5.exports=(r,e)=>(e||(e={}),typeof r=="object"&&(e=r,r="lock"),r||(r="lock"),e=Object.assign({},p9e,e),rf||(rf=u9e(e)||f9e(e),rf.isWorker||(rf.on("requestReadLock",(t,i)=>{!Tl[t]||Tl[t].readLock().then(n=>i().finally(()=>n()))}),rf.on("requestWriteLock",async(t,i)=>{!Tl[t]||Tl[t].writeLock().then(n=>i().finally(()=>n()))}))),Tl[r]||(Tl[r]=d9e(r,e)),Tl[r]);c5.exports.Worker=function(r,e){e=e||globalThis.Worker;let t;try{t=new e(r)}catch(i){i.message.includes("not a constructor")&&(t=e(r))}if(!t)throw new Error("Could not create Worker from",e);return h9e(t),t}});var l5=p((w_t,XJ)=>{l();"use strict";var y9e=f5(),Fv;XJ.exports=(r=!1)=>{if(Fv)return Fv;let e=y9e({singleProcess:r});return Fv={readLock:t=>async(...i)=>{let n=await e.readLock();try{return await t.apply(null,i)}finally{n()}},writeLock:t=>async(...i)=>{let n=await e.writeLock();try{return await t.apply(null,i)}finally{n()}}},Fv}});var h5=p((__t,JJ)=>{l();"use strict";var g9e=Qe(),{UnixFS:b9e}=_i(),{DAGNode:m9e}=Mr(),QJ=xe()("ipfs:mfs:utils:with-mfs-root"),v9e=$r(),w9e=er().multihash,ZJ=ge(),{MFS_ROOT_KEY:eQ}=zi(),_9e=async(r,e)=>{if(e&&e.signal&&e.signal.aborted)throw ZJ(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.open();let t;try{let i=await r.repo.datastore.get(eQ);t=new g9e(i)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i;QJ("Creating new MFS root");let n=new m9e(new b9e({type:"directory"}).marshal());if(t=await r.ipld.put(n,v9e.DAG_PB,{cidVersion:0,hashAlg:w9e.names["sha2-256"]}),e&&e.signal&&e.signal.aborted)throw ZJ(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.put(eQ,t.bytes)}return QJ(`Loaded MFS root /ipfs/${t}`),t};JJ.exports=_9e});var Uv=p((E_t,tQ)=>{l();"use strict";var E9e=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);tQ.exports=E9e});var Yc=p((S_t,rQ)=>{l();"use strict";var S9e=h5(),x9e=Uv(),{exporter:A9e}=Xo(),iQ=ge(),I9e=Qe(),d5="ipfs",T9e=async(r,e,t)=>{let i=await S9e(r,t),n={entryType:"file"};if(I9e.isCID(e)&&(e=`/ipfs/${e}`),e=(e||"").trim(),e=e.replace(/(\/\/+)/g,"/"),e.endsWith("/")&&e.length>1&&(e=e.substring(0,e.length-1)),!e)throw iQ(new Error("paths must not be empty"),"ERR_NO_PATH");if(e.substring(0,1)!=="/")throw iQ(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");e.substring(e.length-1)==="/"&&(e=e.substring(0,e.length-1));let s=x9e(e);if(s[0]===d5){let a;s.length===2?a=`/${s.join("/")}`:a=`/${s.slice(0,s.length-1).join("/")}`,n={type:"ipfs",depth:s.length-2,entryType:"file",mfsPath:`/${s.join("/")}`,mfsDirectory:a,parts:s,path:`/${s.join("/")}`,name:s[s.length-1]}}else{let a=`/${d5}/${i}${s.length?"/"+s.join("/"):""}`,c=`/${d5}/${i}/${s.slice(0,s.length-1).join("/")}`;n={type:"mfs",depth:s.length,entryType:"file",mfsDirectory:c,mfsPath:a,parts:s,path:`/${s.join("/")}`,name:s[s.length-1]}}let o=n.type==="mfs"?n.mfsPath:n.path;try{let a=await A9e(o,r.ipld);n.cid=a.cid,n.mfsPath=`/ipfs/${a.path}`,n.entryType=a.type,n.content=a.content,(n.entryType==="file"||n.entryType==="directory")&&(a.type==="file"||a.type==="directory")&&(n.unixfs=a.unixfs)}catch(a){if(a.code!=="ERR_NOT_FOUND")throw a}return n.exists=Boolean(n.cid),n};rQ.exports=T9e});var Pg=p((x_t,nQ)=>{l();"use strict";var R9e=Gr().bind({ignoreUndefined:!0}),k9e=Yc(),{exporter:C9e}=Xo(),P9e=xe()("ipfs:mfs:stat"),O9e=ge(),B9e=Be(),N9e={withLocal:!1};nQ.exports=r=>{async function e(t,i={}){i=R9e(N9e,i),P9e(`Fetching stats for ${t}`);let{type:n,cid:s,mfsPath:o}=await k9e(r,t,i),a=n==="ipfs"&&s?s:o,c;try{c=await C9e(a,r.ipld)}catch(u){throw u.code==="ERR_NOT_FOUND"?O9e(new Error(`${t} does not exist`),"ERR_NOT_FOUND"):u}if(!sQ[c.type])throw new Error(`Cannot stat codec ${c.cid.codec}`);return sQ[c.type](c)}return B9e(e)};var sQ={raw:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:r=>{let e={cid:r.cid,type:"file",size:r.unixfs.fileSize(),cumulativeSize:r.node.size,blocks:r.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},directory:r=>{let e={cid:r.cid,type:"directory",size:0,cumulativeSize:r.node.size,blocks:r.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},object:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})}});var np=p((A_t,oQ)=>{l();"use strict";var{walkPath:D9e}=Xo(),q9e=xe()("ipfs:mfs:utils:to-trail"),M9e=async(r,e)=>{q9e(`Creating trail for path ${e}`);let t=[];for await(let i of D9e(e,r.ipld)){let n;i.node instanceof Uint8Array?n=i.node.length:n=i.node.size,t.push({name:i.name,cid:i.cid,size:n,type:i.type})}return t};oQ.exports=M9e});var y5=p((I_t,aQ)=>{l();"use strict";var{DAGNode:L9e}=Mr(),{Bucket:cQ,createHAMT:F9e}=xv(),U9e=Av(),p5=mv(),Kv=xe()("ipfs:mfs:core:utils:hamt-utils"),{UnixFS:uQ}=_i(),K9e=$r(),j9e=er().multihash,V9e=$a(),z9e=async(r,e,t,i)=>{let n=p5(),s=Uint8Array.from(t._children.bitField().reverse()),o=uQ.unmarshal(i.parent.Data),a=new uQ({type:"hamt-sharded-directory",data:s,fanout:t.tableSize(),hashType:n.hamtHashCode,mode:o.mode,mtime:o.mtime}),c=j9e.names[i.hashAlg],u=new L9e(a.marshal(),e),f=await r.ipld.put(u,K9e.DAG_PB,{cidVersion:i.cidVersion,hashAlg:c,onlyHash:!i.flush});return{node:u,cid:f,size:u.size}},fQ=async(r,e,t,i)=>{let n=new cQ({hash:e._options.hash,bits:e._options.bits},t,i);return t._putObjectAt(i,n),await jv(r,n,e),n},lQ=async r=>{let e=p5(),t=F9e({hashFn:e.hamtHashFn,bits:e.hamtBucketBits});return await jv(r,t,t),t},jv=async(r,e,t)=>{await Promise.all(r.map(i=>{if(i.Name.length===2){let n=parseInt(i.Name,16);return e._putObjectAt(n,new cQ({hash:t._options.hash,bits:t._options.bits},e,n)),Promise.resolve()}return t.put(i.Name.substring(2),{size:i.Tsize,cid:i.Hash})}))},Vv=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),H9e=async(r,e,t)=>{let i=await lQ(t.Links),n=await i._findNewBucketAndPos(e),s=[{bucket:n.bucket,prefix:Vv(n.pos)}],o=n.bucket;for(;o!==i;)s.push({bucket:o,prefix:Vv(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=t;for(let a=0;a<s.length;a++){let c=s[a];if(!c.node)throw new Error("Could not generate HAMT path");let u=c.node.Links.filter(d=>d.Name.substring(0,2)===c.prefix).pop();if(!u){Kv(`Link ${c.prefix}${e} will be added`);continue}if(u.Name===`${c.prefix}${e}`){Kv(`Link ${c.prefix}${e} will be replaced`);continue}Kv(`Found subshard ${c.prefix}`);let f=await r.ipld.get(u.Hash);if(!s[a+1]){Kv(`Loaded new subshard ${c.prefix}`),await fQ(f.Links,i,c.bucket,parseInt(c.prefix,16));let d=await i._findNewBucketAndPos(e);s.push({bucket:d.bucket,prefix:Vv(d.pos),node:f});continue}let h=s[a+1];await jv(f.Links,h.bucket,i),h.node=f}return await i.put(e,!0),s.reverse(),{rootBucket:i,path:s}},G9e=async(r,e,t={})=>{let i=p5(),n=new U9e({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mtime:t.mtime,mode:t.mode},{hamtHashFn:i.hamtHashFn,hamtHashCode:i.hamtHashCode,hamtBucketBits:i.hamtBucketBits,...t,codec:"dag-pb"});for(let s=0;s<e.length;s++)await n._bucket.put(e[s].name,{size:e[s].size,cid:e[s].cid});return V9e(n.flush(r.block))};aQ.exports={generatePath:H9e,updateHamtDirectory:z9e,recreateHamtLevel:fQ,recreateInitialHamtLevel:lQ,addLinksToHamtBucket:jv,toPrefix:Vv,createShard:G9e}});var Rl=p((T_t,hQ)=>{l();"use strict";var{DAGLink:$9e,DAGNode:W9e}=Mr(),g5=Qe(),tc=xe()("ipfs:mfs:core:utils:add-link"),{UnixFS:b5}=_i(),Y9e=Av(),X9e=mv(),{updateHamtDirectory:J9e,recreateHamtLevel:Q9e,recreateInitialHamtLevel:Z9e,createShard:eLe,toPrefix:m5,addLinksToHamtBucket:tLe}=y5(),Og=ge(),rLe=$r(),iLe=er().multihash,nLe=$a(),cLe=async(r,e)=>{let t=e.parent;if(e.parentCid){if(!g5.isCID(e.parentCid))throw Og(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");tc(`Loading parent node ${e.parentCid}`),t=await r.ipld.get(e.parentCid)}if(!t)throw Og(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw Og(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw Og(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(g5.isCID(e.cid)||(e.cid=new g5(e.cid)),!e.size&&e.size!==0)throw Og(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");let i=b5.unmarshal(t.Data);return i.type==="hamt-sharded-directory"?(tc("Adding link to sharded directory"),aLe(r,{...e,parent:t})):t.Links.length>=e.shardSplitThreshold?(tc("Converting directory to sharded directory"),sLe(r,{...e,parent:t,mtime:i.mtime,mode:i.mode})):(tc(`Adding ${e.name} (${e.cid}) to regular directory`),oLe(r,{...e,parent:t}))},sLe=async(r,e)=>{let t=await eLe(r,e.parent.Links.map(i=>({name:i.Name,size:i.Tsize,cid:i.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return tc(`Converted directory to sharded directory ${t.cid}`),t},oLe=async(r,e)=>{e.parent.rmLink(e.name),e.parent.addLink(new $9e(e.name,e.size,e.cid));let t=b5.unmarshal(e.parent.Data);if(t.mtime){let s=Date.now(),o=Math.floor(s/1e3);t.mtime={secs:o,nsecs:(s-o*1e3)*1e3},e.parent=new W9e(t.marshal(),e.parent.Links)}let i=iLe.names[e.hashAlg],n=await r.ipld.put(e.parent,rLe.DAG_PB,{cidVersion:e.cidVersion,hashAlg:i,onlyHash:!e.flush});return{node:e.parent,cid:n,size:e.parent.size}},aLe=async(r,e)=>{let{shard:t,path:i}=await uLe(r,e),n=await nLe(t.flush(r.block)),s=await r.ipld.get(n.cid),o=e.parent.Links.find(c=>c.Name.substring(0,2)===i[0].prefix),a=s.Links.find(c=>c.Name.substring(0,2)===i[0].prefix);if(!a)throw new Error(`No link found with prefix ${i[0].prefix}`);return o&&e.parent.rmLink(o.Name),e.parent.addLink(a),J9e(r,e.parent.Links,i[0].bucket,e)},uLe=async(r,e)=>{let t={name:e.name,cid:e.cid,size:e.size},i=await Z9e(e.parent.Links),n=b5.unmarshal(e.parent.Data),s=X9e(),o=new Y9e({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mode:n.mode},{hamtHashFn:s.hamtHashFn,hamtHashCode:s.hamtHashCode,hamtBucketBits:s.hamtBucketBits,...e});o._bucket=i,n.mtime&&(o.mtime=new Date);let a=await i._findNewBucketAndPos(t.name),c=fLe(a);c[0].node=e.parent;let u=0;for(;u<c.length;){let f=c[u];u++;let h=f.node;if(!h)throw new Error("Segment had no node");let d=h.Links.find(m=>m.Name.substring(0,2)===f.prefix);if(!d){tc(`Link ${f.prefix}${t.name} will be added`),u=c.length;break}if(d.Name===`${f.prefix}${t.name}`){tc(`Link ${f.prefix}${t.name} will be replaced`),u=c.length;break}if(d.Name.length>2){tc(`Link ${d.Name} ${d.Hash} will be replaced with a subshard`),u=c.length;break}tc(`Found subshard ${f.prefix}`);let y=await r.ipld.get(d.Hash);if(!c[u]){tc(`Loaded new subshard ${f.prefix}`),await Q9e(y.Links,i,f.bucket,parseInt(f.prefix,16));let m=await i._findNewBucketAndPos(t.name);c.push({bucket:m.bucket,prefix:m5(m.pos),node:y});break}let g=c[u];await tLe(y.Links,g.bucket,i),g.node=y}return await o._bucket.put(t.name,{size:t.size,cid:t.cid}),{shard:o,path:c}},fLe=r=>{let e=[{bucket:r.bucket,prefix:m5(r.pos)}],t=r.bucket._parent,i=r.bucket._posAtParent;for(;t;)e.push({bucket:t,prefix:m5(i)}),i=t._posAtParent,t=t._parent;return e.reverse(),e};hQ.exports=cLe});var kl=p((R_t,dQ)=>{l();"use strict";var pQ=xe()("ipfs:mfs:utils:update-tree"),lLe=Rl(),hLe={shardSplitThreshold:1e3},dLe=async(r,e,t)=>{t=Object.assign({},hLe,t),pQ("Trail",e),e=e.slice().reverse();let i=0,n;for await(let o of r.ipld.getMany(e.map(a=>a.cid))){let a=e[i].cid,c=e[i].name;if(i++,!n){n={cid:a,name:c,size:o.size};continue}let u=await lLe(r,{parent:o,name:n.name,cid:n.cid,size:n.size,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold,hashAlg:t.hashAlg,cidVersion:t.cidVersion});n={cid:u.cid,name:c,size:u.size}}let{cid:s}=n;return pQ(`Final CID ${s}`),s};dQ.exports=dLe});var Cl=p((k_t,yQ)=>{l();"use strict";var pLe=xe()("ipfs:mfs:utils:update-mfs-root"),{MFS_ROOT_KEY:yLe}=zi(),gLe=ge(),bLe=async(r,e,t)=>{if(t&&t.signal&&t.signal.aborted)throw gLe(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return pLe(`New MFS root will be ${e}`),await r.repo.datastore.put(yLe,e.bytes),e};yQ.exports=bLe});var bQ=p((C_t,gQ)=>{l();"use strict";var{UnixFS:mLe}=_i(),{DAGNode:vLe}=Mr(),wLe=$r(),_Le=er().multihash,ELe=async(r,e,t)=>{let i=_Le.names[t.hashAlg],n=new mLe({type:e,mode:t.mode,mtime:t.mtime}),s=new vLe(n.marshal());return{cid:await r.ipld.put(s,wLe.DAG_PB,{cidVersion:t.cidVersion,hashAlg:i,onlyHash:!t.flush}),node:s}};gQ.exports=ELe});var zv=p((P_t,mQ)=>{l();"use strict";var sp=ge(),vQ=xe()("ipfs:mfs:mkdir"),{exporter:SLe}=Xo(),xLe=bQ(),ALe=Uv(),ILe=Cl(),TLe=kl(),RLe=Rl(),kLe=h5(),CLe=Gr().bind({ignoreUndefined:!0}),PLe=Be(),OLe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};mQ.exports=r=>{async function e(t,i={}){let n=CLe(OLe,i);if(!t)throw new Error("no path given to Mkdir");if(t=t.trim(),t==="/"){if(n.parents)return;throw sp(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(t.substring(0,1)!=="/")throw sp(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");vQ(`Creating ${t}`);let s=ALe(t);if(s[0]==="ipfs")throw sp(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let o=await kLe(r,n),a,c=[],u=await xLe(r,"directory",n);for(let h=0;h<=s.length;h++){let d=s.slice(0,h),y=`/ipfs/${o}/${d.join("/")}`;try{if(a=await SLe(y,r.ipld),a.type!=="file"&&a.type!=="directory")throw sp(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(h===s.length){if(n.parents)return;throw sp(new Error("file already exists"),"ERR_ALREADY_EXISTS")}c.push({name:a.name,cid:a.cid})}catch(g){if(g.code==="ERR_NOT_FOUND"){if(h<s.length&&!n.parents)throw sp(new Error(`Intermediate directory path ${y} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await BLe(r,d[d.length-1],u,c[c.length-1],c,n)}else throw g}}let f=await TLe(r,c,n);await ILe(r,f,n)}return PLe(e)};var BLe=async(r,e,t,i,n,s)=>{vQ(`Adding empty dir called ${e} to ${i.cid}`);let o=await RLe(r,{parent:i.node,parentCid:i.cid,size:t.node.size,cid:t.cid,name:e,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});n[n.length-1].cid=o.cid,n.push({name:e,cid:t.cid})}});var $v=p((O_t,wQ)=>{l();"use strict";var _Q=zv(),NLe=Pg(),Hv=xe()("ipfs:mfs:cp"),Pl=ge(),EQ=kl(),SQ=Cl(),DLe=Rl(),Gv=Yc(),qLe=Gr().bind({ignoreUndefined:!0}),MLe=np(),LLe=Be(),FLe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};wQ.exports=r=>{async function e(t,i,n={}){let s=qLe(FLe,n);Array.isArray(t)||(t=[t]);let o=await Promise.all(t.map(d=>Gv(r,d,s))),a=await Gv(r,i,s);if(!o.length||!a)throw Pl(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let c=o.find(d=>!d.exists);if(c)throw Pl(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");let u=xQ(a);if(a.exists){if(Hv("Destination exists"),o.length===1&&!u)throw Pl(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(Hv("Destination does not exist"),o.length>1){if(!s.parents)throw Pl(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await _Q(r)(a.path,s),a=await Gv(r,a.path,s)}else if(a.parts.length>1){let d=`/${a.parts.slice(0,-1).join("/")}`;try{await NLe(r)(d,s)}catch(y){if(y.code!=="ERR_NOT_FOUND")throw y;if(!s.parents)throw Pl(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await _Q(r)(d,s),a=await Gv(r,a.path,s)}}let f=xQ(a)?a.mfsPath:a.mfsDirectory,h=await MLe(r,f);if(o.length===1){let d=o.pop();if(!d)throw Pl(new Error("could not find source"),"ERR_INVALID_PARAMS");let y=u?d.name:a.name;return Hv(`Only one source, copying to destination ${u?"directory":"file"} ${y}`),ULe(r,d,y,h,s)}return Hv("Multiple sources, wrapping in a directory"),KLe(r,o,a,h,s)}return LLe(e)};var xQ=r=>r.unixfs&&r.unixfs.type&&r.unixfs.type.includes("directory"),ULe=async(r,e,t,i,n)=>{let s=i.pop();if(!s)throw Pl(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await AQ(r,e,t,s,n),i.push(s);let o=await EQ(r,i,n);await SQ(r,o,n)},KLe=async(r,e,t,i,n)=>{for(let o=0;o<e.length;o++){let a=e[o];t=await AQ(r,a,a.name,t,n)}i[i.length-1]=t;let s=await EQ(r,i,n);await SQ(r,s,n)},AQ=async(r,e,t,i,n)=>{let s=await r.repo.blocks.get(e.cid),{node:o,cid:a}=await DLe(r,{parentCid:i.cid,size:s.data.length,cid:e.cid,name:t,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});return i.node=o,i.cid=a,i.size=o.size,i}});var RQ=p((B_t,IQ)=>{l();"use strict";var{DAGLink:jLe}=Mr(),VLe=Qe(),nf=xe()("ipfs:mfs:core:utils:remove-link"),{UnixFS:zLe}=_i(),{generatePath:HLe,updateHamtDirectory:v5}=y5(),op=ge(),GLe=$r(),$Le=er().multihash,XLe=async(r,e)=>{let t=e.parent;if(e.parentCid){if(!VLe.isCID(e.parentCid))throw op(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");nf(`Loading parent node ${e.parentCid}`),t=await r.ipld.get(e.parentCid)}if(!t)throw op(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw op(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");return zLe.unmarshal(t.Data).type==="hamt-sharded-directory"?(nf(`Removing ${e.name} from sharded directory`),YLe(r,{...e,parent:t})):(nf(`Removing link ${e.name} regular directory`),WLe(r,{...e,parent:t}))},WLe=async(r,e)=>{let t=$Le.names[e.hashAlg];e.parent.rmLink(e.name);let i=await r.ipld.put(e.parent,GLe.DAG_PB,{cidVersion:e.cidVersion,hashAlg:t});return nf(`Updated regular directory ${i}`),{node:e.parent,cid:i}},YLe=async(r,e)=>{let{rootBucket:t,path:i}=await HLe(r,e.name,e.parent);await t.del(e.name);let{node:n}=await TQ(r,i,e.name,e);return v5(r,n.Links,t,e)},TQ=async(r,e,t,i)=>{let n=e.pop();if(!n)throw op(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:o,node:a}=n;if(!a)throw op(new Error("Could not find parent"),"EINVALIDPARENT");let c=a.Links.find(y=>y.Name.substring(0,2)===o);if(!c)throw op(new Error(`No link found with prefix ${o} for file ${t}`),"ERR_NOT_FOUND");if(c.Name===`${o}${t}`)return nf(`Removing existing link ${c.Name}`),a.rmLink(c.Name),await s.del(t),v5(r,a.Links,s,i);nf(`Descending into sub-shard ${c.Name} for ${o}${t}`);let u=await TQ(r,e,t,i),f=u.cid,h=u.size,d=o;if(u.node.Links.length===1){nf(`Removing subshard for ${o}`);let y=u.node.Links[0];d=`${o}${y.Name.substring(2)}`,f=y.Hash,h=y.Tsize}return nf(`Updating shard ${o} with name ${d}`),JLe(r,s,a,o,d,h,f,i)},JLe=(r,e,t,i,n,s,o,a)=>(t.rmLink(i),t.addLink(new jLe(n,s,o)),v5(r,t.Links,e,a));IQ.exports=XLe});var Yv=p((N_t,kQ)=>{l();"use strict";var Wv=ge(),QLe=kl(),ZLe=Cl(),eFe=RQ(),CQ=Yc(),tFe=np(),rFe=Be(),iFe=Gr().bind({ignoreUndefined:!0}),nFe={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};kQ.exports=r=>{async function e(t,i={}){let n=iFe(nFe,i);Array.isArray(t)||(t=[t]);let s=await Promise.all(t.map(o=>CQ(r,o,n)));if(!s.length)throw Wv(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(o=>{if(o.path==="/")throw Wv(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let o of s)await sFe(r,o.path,n)}return rFe(e)};var sFe=async(r,e,t)=>{let i=await CQ(r,e,t),n=await tFe(r,i.mfsPath),s=n[n.length-1];n.pop();let o=n[n.length-1];if(!o)throw Wv(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!t.recursive)throw Wv(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await eFe(r,{parentCid:o.cid,name:s.name,hashAlg:t.hashAlg,cidVersion:t.cidVersion,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold});o.cid=a;let c=await QLe(r,n,t);await ZLe(r,c,t)}});var qQ=p((D_t,PQ)=>{l();"use strict";var oFe=Gr().bind({ignoreUndefined:!0}),aFe=Yc(),cFe=xe()("ipfs:mfs:touch"),w5=ge(),{UnixFS:OQ}=_i(),uFe=np(),fFe=Rl(),lFe=kl(),hFe=Cl(),{DAGNode:BQ}=Mr(),dFe=$r(),pFe=er().multihash,{pipe:yFe}=pi(),{importer:gFe}=Iv(),{recursive:bFe}=Xo(),mFe=$a(),vFe=$v(),wFe=Yv(),_Fe=Il(),EFe=Be(),NQ={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function SFe(r,e,t){let i=0;return(r.includes("x")||r.includes("X")&&(t||e&1||e&8||e&64))&&(i+=1),r.includes("w")&&(i+=2),r.includes("r")&&(i+=4),i}function xFe(r,e){let t=0;return r.includes("u")&&(t+=e<<6),r.includes("g")&&(t+=e<<3),r.includes("o")&&(t+=e),t}function AFe(r,e,t){return e.includes("t")&&(t+=parseInt("1000",8)),e.includes("s")&&(r.includes("u")&&(t+=parseInt("4000",8)),r.includes("g")&&(t+=parseInt("2000",8))),t}function IFe(r,e,t){e||(e=0);let i=r.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!i)throw new Error(`Invalid file mode: ${r}`);let[,n,s,o]=i;(n==="a"||!n)&&(n="ugo");let a=SFe(o,e,t);return a=xFe(n,a),a=AFe(n,o,a),s==="="?(n.includes("u")&&(e=e&parseInt("7077",8),e=e|a),n.includes("g")&&(e=e&parseInt("7707",8),e=e|a),n.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):s==="+"?a|e:s==="-"?a^e:e}function DQ(r,e){if(r instanceof String||typeof r=="string"){let t=`${r}`;t.match(/^\d+$/g)?r=parseInt(t,8):r=0+t.split(",").reduce((i,n)=>IFe(n,i,e.isDirectory()),e.mode||0)}return r}PQ.exports=r=>{async function e(t,i,n={}){let s=oFe(NQ,n);cFe(`Fetching stats for ${t}`);let{cid:o,mfsDirectory:a,name:c}=await aFe(r,t,s);if(o.codec!=="dag-pb")throw w5(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let P=await yFe(async function*(){for await(let q of bFe(o,r.ipld)){if(q.type!=="file"&&q.type!=="directory")throw w5(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");q.unixfs.mode=DQ(i,q.unixfs);let X=new BQ(q.unixfs.marshal(),q.node.Links);yield{path:q.path,content:X}}},q=>gFe(q,r.block,{...s,pin:!1,dagBuilder:async function*(X,W,z){for await(let Z of X)yield async function(){let ee=Z.content,re=ee.serialize(),L=await _Fe(re,W,z),b=OQ.unmarshal(ee.Data);return{cid:L,size:re.length,path:Z.path,unixfs:b}}}}),q=>mFe(q));if(!P)throw w5(new Error(`Could not chmod ${t}`),"ERR_COULD_NOT_CHMOD");await wFe(r)(t,s),await vFe(r)(`/ipfs/${P.cid}`,t,s);return}let u=await r.ipld.get(o),f=OQ.unmarshal(u.Data);f.mode=DQ(i,f),u=new BQ(f.marshal(),u.Links);let h=s.hashAlg||NQ.hashAlg,d=await r.ipld.put(u,dFe.DAG_PB,{cidVersion:o.version,hashAlg:pFe.names[h],onlyHash:!s.flush}),y=await uFe(r,a),g=y[y.length-1],m=await r.ipld.get(g.cid),x=await fFe(r,{parent:m,name:c,cid:d,size:u.serialize().length,flush:s.flush,hashAlg:h,cidVersion:o.version,shardSplitThreshold:Infinity});g.cid=x.cid;let _=await lFe(r,y,s);await hFe(r,_,s)}return EFe(e)}});var LQ=p((q_t,MQ)=>{l();"use strict";var TFe=Pg(),RFe=Be(),kFe=Gr().bind({ignoreUndefined:!0}),CFe={};MQ.exports=r=>{async function e(t,i={}){i=kFe(CFe,i);let{cid:n}=await TFe(r)(t,i);return n}return RFe(e)}});var UQ=p((M_t,FQ)=>{l();"use strict";var PFe=$v(),OFe=Yv(),BFe=Gr().bind({ignoreUndefined:!0}),NFe=Be(),DFe={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};FQ.exports=r=>{async function e(t,i,n={}){let s=BFe(DFe,n);await PFe(r)(t,i,s),await OFe(r)(t,{...s,recursive:!0})}return NFe(e)}});var GQ=p((L_t,KQ)=>{l();"use strict";var qFe=Gr().bind({ignoreUndefined:!0}),MFe=Yc(),LFe=xe()("ipfs:mfs:touch"),FFe=ge(),{UnixFS:jQ}=_i(),UFe=np(),KFe=Rl(),jFe=kl(),VFe=Cl(),{DAGNode:VQ}=Mr(),zQ=$r(),HQ=er().multihash,zFe=Be(),HFe={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};KQ.exports=r=>{async function e(t,i={}){let n=qFe(HFe,i);n.mtime=n.mtime||new Date,LFe(`Touching ${t} mtime: ${n.mtime}`);let{cid:s,mfsDirectory:o,name:a,exists:c}=await MFe(r,t,n),u,f,h=n.cidVersion;if(c){if(s.codec!=="dag-pb")throw FFe(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");h=s.version,u=await r.ipld.get(s);let _=jQ.unmarshal(u.Data);_.mtime=n.mtime,u=new VQ(_.marshal(),u.Links),f=await r.ipld.put(u,zQ.DAG_PB,{cidVersion:s.version,hashAlg:HQ.names["sha2-256"],onlyHash:!n.flush})}else{let _=new jQ({type:"file",mtime:n.mtime});u=new VQ(_.marshal()),f=await r.ipld.put(u,zQ.DAG_PB,{cidVersion:n.cidVersion,hashAlg:HQ.names["sha2-256"],onlyHash:!n.flush})}let d=await UFe(r,o),y=d[d.length-1],g=await r.ipld.get(y.cid),m=await KFe(r,{parent:g,name:a,cid:f,size:u.serialize().length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:"sha2-256",cidVersion:h});y.cid=m.cid;let x=await jFe(r,d,n);await VFe(r,x,n)}return zFe(e)}});var XQ=p((F_t,$Q)=>{l();"use strict";var WQ=ge(),Bg=xe()("ipfs:mfs:utils:to-async-iterator"),{MFS_MAX_CHUNK_SIZE:YQ}=zi(),GFe=ct(),$Fe=r=>{if(!r)throw WQ(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof r=="string"||r instanceof String)&&(Bg("Content was a string"),r=GFe(r.toString())),r.length)return Bg("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield r}};if(r[Symbol.asyncIterator])return Bg("Content was an async iterator"),r;if(r[Symbol.iterator])return Bg("Content was an iterator"),r;if(globalThis.Blob&&r instanceof globalThis.Blob){Bg("Content was an HTML5 Blob");let e=0,t={next:()=>e>r.size?{done:!0}:new Promise((i,n)=>{let s=r.slice(e,YQ);e+=YQ;let o=new globalThis.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return n(c.error);i({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>t}}throw WQ(new Error(`Don't know how to convert ${r} into an async iterator`),"ERR_INVALID_PARAMS")};$Q.exports=$Fe});var tZ=p((U_t,JQ)=>{l();"use strict";var rc=xe()("ipfs:mfs:write"),{importer:WFe}=Iv(),YFe=Pg(),XFe=zv(),JFe=Rl(),QFe=Gr().bind({ignoreUndefined:!0}),QQ=l5(),ZFe=XQ(),_5=Yc(),eUe=Uv(),tUe=np(),rUe=kl(),iUe=Cl(),Xc=ge(),{MFS_MAX_CHUNK_SIZE:nUe}=zi(),sUe=$a(),oUe=Be(),{parseMode:aUe,parseMtime:cUe}=_i(),uUe={offset:0,length:Infinity,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(r,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};JQ.exports=r=>{async function e(t,i,n={}){let s=QFe(uUe,n),o,a,c;if(rc("Reading source, destination and parent"),await QQ().readLock(async()=>{o=await ZFe(i),a=await _5(r,t,s),c=await _5(r,a.mfsDirectory,s)})(),rc("Read source, destination and parent"),!s.parents&&!c.exists)throw Xc(new Error("directory does not exist"),"ERR_NO_EXIST");if(o==null)throw Xc(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw Xc(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!a.exists)throw Xc(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw Xc(new Error("not a file"),"ERR_NOT_A_FILE");return fUe(r,t,o,a,s)}return oUe(e)};var fUe=async(r,e,t,i,n)=>{let s=await lUe(r,t,i,n);await QQ().writeLock(async()=>{let o=eUe(e),a=o.pop();if(a==null)throw Xc(new Error("source does not exist"),"ERR_NO_EXIST");let c=!1;try{await YFe(r)(`/${o.join("/")}`,n),c=!0}catch(m){if(m.code!=="ERR_NOT_FOUND")throw m}c||await XFe(r)(`/${o.join("/")}`,n);let u=await _5(r,e,n),f=await tUe(r,u.mfsDirectory),h=f[f.length-1];if(!h)throw Xc(new Error("directory does not exist"),"ERR_NO_EXIST");if(!h.type||!h.type.includes("directory"))throw Xc(new Error(`cannot write to ${h.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let d=await r.ipld.get(h.cid),y=await JFe(r,{parent:d,name:a,cid:s.cid,size:s.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});h.cid=y.cid;let g=await rUe(r,f,n);await iUe(r,g,n)})()},lUe=async(r,e,t,i)=>{t.exists?rc(`Overwriting file ${t.cid} offset ${i.offset} length ${i.length}`):rc(`Writing file offset ${i.offset} length ${i.length}`);let n=[];if(i.offset>0)if(t.unixfs){if(rc(`Writing first ${i.offset} bytes of original file`),n.push(()=>t.content({offset:0,length:i.offset})),t.unixfs.fileSize()<i.offset){let u=i.offset-t.unixfs.fileSize();rc(`Writing zeros for extra ${u} bytes`),n.push(eZ(u))}}else rc(`Writing zeros for first ${i.offset} bytes`),n.push(eZ(i.offset));n.push(ZQ(e,i.length));let s=dUe(hUe(n),u=>{if(t.unixfs&&!i.truncate){let f=t.unixfs.fileSize();if(f>u)return rc(`Writing last ${f-u} of ${f} bytes from original file starting at offset ${u}`),t.content({offset:u});rc("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),o;i.mode!==void 0&&i.mode!==null?o=aUe(i.mode):t&&t.unixfs&&(o=t.unixfs.mode);let a;i.mtime!=null?a=cUe(i.mtime):t&&t.unixfs&&(a=t.unixfs.mtime);let c=await sUe(WFe([{content:s,mode:o,mtime:a}],r.block,{progress:i.progress,hashAlg:i.hashAlg,cidVersion:i.cidVersion,strategy:i.strategy,rawLeaves:i.rawLeaves,reduceSingleLeafToSelf:i.reduceSingleLeafToSelf,leafType:i.leafType,pin:!1}));if(!c)throw Xc(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return rc(`Wrote ${c.cid}`),{cid:c.cid,size:c.size}},ZQ=(r,e)=>async function*(){let i=0;for await(let n of r){if(i+=n.length,i>e){yield n.slice(0,e-i);return}yield n}},eZ=(r,e=nUe)=>{let t=new Uint8Array(e);async function*i(){for(;;)yield t.slice()}return ZQ(i(),r)},hUe=async function*(r){for(let e=0;e<r.length;e++)yield*r[e]()},dUe=async function*(r,e){let t=0;for await(let i of r)t+=i.length,yield i;for await(let i of e(t))t+=i.length,yield i}});var nZ=p((K_t,rZ)=>{l();"use strict";var{exporter:pUe}=Xo(),yUe=Gr().bind({ignoreUndefined:!0}),gUe=Yc(),iZ=ge(),bUe=Be(),mUe={offset:0,length:Infinity};rZ.exports=r=>{function e(t,i={}){return i=yUe(mUe,i),{[Symbol.asyncIterator]:async function*(){let s=await gUe(r,t,i),o=await pUe(s.mfsPath,r.ipld);if(o.type!=="file")throw iZ(new Error(`${t} was not a file`),"ERR_NOT_FILE");if(!o.content)throw iZ(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");for await(let a of o.content({offset:i.offset,length:i.length}))yield a}}}return bUe(e)}});var aZ=p((j_t,sZ)=>{l();"use strict";var{exporter:vUe}=Xo(),wUe=Yc(),_Ue=Be(),EUe=$c(),oZ=r=>{let e={cid:r.cid,name:r.name,type:r.type==="directory"?"directory":"file",size:r.size};return(r.type==="file"||r.type==="directory")&&(e.mode=r.unixfs.mode,e.mtime=r.unixfs.mtime),e};sZ.exports=r=>{async function*e(t,i={}){let n=await wUe(r,t,i),s=await vUe(n.mfsPath,r.ipld);if(s.type==="directory"){yield*EUe(s.content(i),oZ);return}yield oZ(s)}return _Ue(e)}});var hZ=p((V_t,cZ)=>{l();"use strict";var SUe=l5(),uZ=ll(),xUe={stat:Pg()},AUe={chmod:qQ(),cp:$v(),flush:LQ(),mkdir:zv(),mv:UQ(),rm:Yv(),touch:GQ()},fZ={write:tZ(),read:nZ(),ls:aZ()},lZ=({options:r,mfs:e,operations:t,lock:i})=>{Object.keys(t).forEach(n=>{e[n]=i(t[n](r))})},IUe={repoOwner:!0,ipld:null,repo:null};function TUe(r){let{repoOwner:e}=Object.assign({},IUe||{},r);r.repo={blocks:r.blocks,datastore:r.datastore};let t=SUe(e),i=o=>t.readLock(o),n=o=>t.writeLock(o),s={};return lZ({options:r,mfs:s,operations:xUe,lock:i}),lZ({options:r,mfs:s,operations:AUe,lock:n}),Object.keys(fZ).forEach(o=>{s[o]=fZ[o](r)}),s}cZ.exports=({ipld:r,block:e,blockService:t,repo:i,preload:n,options:s})=>{let o=TUe({ipld:r,block:e,blocks:t,datastore:i.root,repoOwner:s.repoOwner}),a=c=>(...f)=>{let h=f.filter(d=>uZ.ipfsPath(d)||uZ.cid(d));if(h.length){let d=f[f.length-1];d&&d.preload!==!1&&h.forEach(y=>n(y))}return c(...f)};return{...o,chmod:o.chmod,cp:a(o.cp),mkdir:o.mkdir,stat:a(o.stat),rm:o.rm,read:a(o.read),touch:o.touch,write:o.write,mv:a(o.mv),flush:o.flush,ls:a(async function*(...c){for await(let u of o.ls(...c))yield{...u,size:u.size||0}})}}});var pZ=p((z_t,dZ)=>{l();"use strict";var RUe=Be();dZ.exports=({keychain:r})=>RUe((t,i)=>r.exportKey(t,i))});var mZ=p((H_t,yZ)=>{l();"use strict";var kUe=Be(),gZ="rsa",bZ=2048;yZ.exports=({keychain:r})=>kUe((t,i={type:gZ,size:bZ})=>r.createKey(t,i.type||gZ,i.size||bZ))});var wZ=p((G_t,vZ)=>{l();"use strict";var CUe=Be();vZ.exports=({keychain:r})=>CUe((t,i,n)=>r.importKey(t,i,n))});var EZ=p(($_t,_Z)=>{l();"use strict";var PUe=Be();_Z.exports=({keychain:r})=>PUe(t=>r.findKeyByName(t))});var xZ=p((W_t,SZ)=>{l();"use strict";var OUe=Be();SZ.exports=({keychain:r})=>OUe(()=>r.listKeys())});var IZ=p((Y_t,AZ)=>{l();"use strict";var BUe=Be();AZ.exports=({keychain:r})=>BUe(async(t,i)=>{let n=await r.renameKey(t,i);return{was:t,now:n.name,id:n.id,overwrite:!1}})});var RZ=p((X_t,TZ)=>{l();"use strict";var NUe=Be();TZ.exports=({keychain:r})=>NUe(t=>r.removeKey(t))});var PZ=p((J_t,kZ)=>{l();"use strict";var DUe=pZ(),qUe=mZ(),MUe=wZ(),LUe=EZ(),FUe=xZ(),UUe=IZ(),KUe=RZ(),CZ=class{constructor({keychain:e}){this.gen=qUe({keychain:e}),this.list=FUe({keychain:e}),this.rm=KUe({keychain:e}),this.rename=UUe({keychain:e}),this.export=DUe({keychain:e}),this.import=MUe({keychain:e}),this.info=LUe({keychain:e})}};kZ.exports=CZ});var sf=p((Q_t,OZ)=>{l();"use strict";var jUe=Qe(),VUe=ge(),zUe=Be();OZ.exports=({ipld:r,preload:e})=>{async function t(i,n={}){let s;try{s=new jUe(i)}catch(o){throw VUe(o,"ERR_INVALID_CID")}return n.preload!==!1&&e(s),r.get(s,{signal:n.signal})}return zUe(t)}});var NZ=p((Z_t,BZ)=>{l();"use strict";var HUe=Be();BZ.exports=({ipld:r,preload:e})=>{let t=sf()({ipld:r,preload:e});async function i(n,s={}){return(await t(n,s)).Data}return HUe(i)}});var MZ=p((eEt,DZ)=>{l();"use strict";var{DAGLink:qZ}=Mr(),E5=Qe(),GUe=Be();function S5(r,e=[]){for(let t in r){let i=r[t];if(t==="/"&&Object.keys(r).length===1)try{e.push(new qZ("",0,new E5(i)));continue}catch(n){}if(E5.isCID(i)){e.push(new qZ("",0,i));continue}Array.isArray(i)&&S5(i,e),i&&typeof i=="object"&&S5(i,e)}return e}DZ.exports=({ipld:r})=>{async function e(t,i={}){let n=new E5(t),s=await r.get(n,i);if(n.codec==="raw")return[];if(n.codec==="dag-pb")return s.Links;if(n.codec==="dag-cbor")return S5(s);throw new Error(`Cannot resolve links from codec ${n.codec}`)}return GUe(e)}});var FZ=p((tEt,LZ)=>{l();"use strict";var{DAGNode:$Ue}=Mr(),WUe=$r(),YUe=er().multihash,{UnixFS:XUe}=_i(),JUe=Be();LZ.exports=({ipld:r,preload:e})=>{async function t(i={}){let n;if(i.template)if(i.template==="unixfs-dir")n=new XUe({type:"directory"}).marshal();else throw new Error("unknown template");else n=new Uint8Array(0);let s=new $Ue(n),o=await r.put(s,WUe.DAG_PB,{cidVersion:0,hashAlg:YUe.names["sha2-256"],signal:i.signal});return i.preload!==!1&&e(o),o}return JUe(t)}});var ap=p((rEt,UZ)=>{l();"use strict";var{DAGNode:Xv,DAGLink:QUe,util:ZUe}=Mr(),KZ=er().multihash,eKe=$r(),tKe=Be(),rKe=tt(),iKe=ct();function oKe(r,e){switch(e){case"json":return nKe(r);case"protobuf":return sKe(r);default:throw new Error(`unknown encoding: ${e}`)}}function nKe(r){let e,t;try{let i=JSON.parse(rKe(r));t=(i.Links||[]).map(n=>new QUe(n.Name||n.name,n.Size||n.size,KZ.fromB58String(n.Hash||n.hash||n.multihash))),e=iKe(i.Data)}catch(i){throw new Error("failed to parse JSON: "+i)}return new Xv(e,t)}function sKe(r){return ZUe.deserialize(r)}UZ.exports=({ipld:r,gcLock:e,preload:t})=>{async function i(n,s={}){let o=s.enc,a;if(n instanceof Uint8Array)o?a=await oKe(n,o):a=new Xv(n);else if(n instanceof Xv)a=n;else if(typeof n=="object")a=new Xv(n.Data,n.Links);else throw new Error("obj not recognized");let c=await e.readLock();try{let u=await r.put(a,eKe.DAG_PB,{cidVersion:0,hashAlg:KZ.names["sha2-256"]});return s.preload!==!1&&t(u),u}finally{c()}}return tKe(i)}});var zZ=p((iEt,jZ)=>{l();"use strict";var VZ=Mr(),aKe=Be();jZ.exports=({ipld:r,preload:e})=>{let t=sf()({ipld:r,preload:e});async function i(n,s={}){let o=await t(n,s),a=VZ.util.serialize(o),c=await VZ.util.cid(a,{cidVersion:0}),u=a.length,f=o.Links.reduce((h,d)=>h+d.Tsize,0);return{Hash:c.toBaseEncodedString(),NumLinks:o.Links.length,BlockSize:u,LinksSize:u-o.Data.length,DataSize:o.Data.length,CumulativeSize:u+f}}return aKe(i)}});var GZ=p((nEt,HZ)=>{l();"use strict";var cKe=Be();HZ.exports=({ipld:r,gcLock:e,preload:t})=>{let i=sf()({ipld:r,preload:t}),n=ap()({ipld:r,gcLock:e,preload:t});async function s(o,a,c={}){let u=await i(o,c);return u.addLink(a),n(u,c)}return cKe(s)}});var WZ=p((sEt,$Z)=>{l();"use strict";var{DAGNode:uKe}=Mr(),fKe=Be(),lKe=vi();$Z.exports=({ipld:r,gcLock:e,preload:t})=>{let i=sf()({ipld:r,preload:t}),n=ap()({ipld:r,gcLock:e,preload:t});async function s(o,a,c={}){let u=await i(o,c),f=lKe([u.Data,a]);return n(new uKe(f,u.Links),c)}return fKe(s)}});var XZ=p((oEt,YZ)=>{l();"use strict";var hKe=Be();YZ.exports=({ipld:r,gcLock:e,preload:t})=>{let i=sf()({ipld:r,preload:t}),n=ap()({ipld:r,gcLock:e,preload:t});async function s(o,a,c={}){let u=await i(o,c);return u.rmLink(a.Name||a.name||a),n(u,c)}return hKe(s)}});var QZ=p((aEt,JZ)=>{l();"use strict";var{DAGNode:dKe}=Mr(),pKe=Be();JZ.exports=({ipld:r,gcLock:e,preload:t})=>{let i=sf()({ipld:r,preload:t}),n=ap()({ipld:r,gcLock:e,preload:t});async function s(o,a,c={}){let u=await i(o,c);return n(new dKe(a,u.Links),c)}return pKe(s)}});var tee=p((cEt,ZZ)=>{l();"use strict";var yKe=GZ(),gKe=WZ(),bKe=XZ(),mKe=QZ(),eee=class{constructor({ipld:e,preload:t,gcLock:i}){this.addLink=yKe({ipld:e,preload:t,gcLock:i}),this.appendData=gKe({ipld:e,preload:t,gcLock:i}),this.rmLink=bKe({ipld:e,preload:t,gcLock:i}),this.setData=mKe({ipld:e,preload:t,gcLock:i})}};ZZ.exports=eee});var nee=p((uEt,ree)=>{l();"use strict";var vKe=NZ(),wKe=sf(),_Ke=MZ(),EKe=FZ(),SKe=ap(),xKe=zZ(),AKe=tee(),iee=class{constructor({ipld:e,preload:t,gcLock:i}){this.data=vKe({ipld:e,preload:t}),this.get=wKe({ipld:e,preload:t}),this.links=_Ke({ipld:e}),this.new=EKe({ipld:e,preload:t}),this.put=SKe({ipld:e,preload:t,gcLock:i}),this.stat=xKe({ipld:e,preload:t}),this.patch=new AKe({ipld:e,preload:t,gcLock:i})}};ree.exports=iee});var cee=p((fEt,see)=>{l();"use strict";var oee=Qe(),Ng=xe()("ipfs:repo:gc"),{MFS_ROOT_KEY:IKe}=zi(),TKe=Be(),{Errors:RKe}=ir(),kKe=RKe.notFoundError().code,{parallelMerge:CKe,transform:PKe,map:OKe}=Al(),aee=en(),BKe=256;see.exports=({gcLock:r,pin:e,refs:t,repo:i})=>{async function*n(s={}){let o=Date.now();Ng("Creating set of marked blocks");let a=await r.writeLock();try{let c=await NKe({pin:e,refs:t,repo:i}),u=i.blocks.queryKeys({});yield*DKe({repo:i},c,u),Ng(`Complete (${Date.now()-o}ms)`)}finally{a()}}return TKe(n)};async function NKe({pin:r,refs:e,repo:t}){let i=OKe(({cid:o})=>o,r.ls()),n=async function*(){let o;try{o=await t.root.get(IKe)}catch(c){if(c.code===kKe){Ng("No blocks in MFS");return}throw c}let a=new oee(o);yield a;for await(let{ref:c}of e(a,{recursive:!0}))yield new oee(c)}(),s=new Set;for await(let o of CKe(i,n))s.add(aee.encode("base32",o.multihash).toString());return s}async function*DKe({repo:r},e,t){let i=0,n=0,s=async o=>{i++;try{let a=aee.encode("base32",o.multihash).toString();if(e.has(a))return null;try{await r.blocks.delete(o),n++}catch(c){return{err:new Error(`Could not delete block with CID ${o}: ${c.message}`)}}return{cid:o}}catch(a){let c=`Could delete block with CID ${o}`;return Ng(c,a),{err:new Error(c+`: ${a.message}`)}}};for await(let o of PKe(BKe,s,t))o&&(yield o);Ng(`Marked set has ${e.size} unique blocks. Blockstore has ${i} blocks. Deleted ${n} blocks.`)}});var x5=p((lEt,uee)=>{l();"use strict";var qKe=Be();uee.exports=({repo:r})=>{async function e(t={}){let i=await r.stat();return{numObjects:BigInt(i.numObjects.toString()),repoSize:BigInt(i.repoSize.toString()),repoPath:i.repoPath,version:`${i.version}`,storageMax:BigInt(i.storageMax.toString())}}return qKe(e)}});var A5=p((hEt,fee)=>{l();fee.exports=MKe;function MKe(r,e,t){if(!r)return t;var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");for(;i.length;)if(n=i.shift(),!r||(r=r[n],r===void 0))return t;return r}});var of=p((dEt,lee)=>{l();"use strict";var{Key:hee,Errors:dee}=ir(),pee=av(),LKe=pee.ShardingDatastore,FKe=new hee("/config"),UKe=new hee("/version");function KKe(r,e){if(!e||!e.storageBackends)throw new Error("Please pass storage backend definitions");if(!e.storageBackends[r])throw new Error(`Storage backend '${r}' not defined in config`);let t=e.storageBackends[r],i={};return e.storageBackendOptions!==void 0&&e.storageBackendOptions[r]!==void 0&&(i=e.storageBackendOptions[r]),{StorageBackend:t,storageOptions:i}}function I5(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function yee(r,e,t){let i=await e(r);if(i)return i;let n=I5(t);return n?new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function gee(r,e,t,i){if(await t(r))return e(r);let n=I5(i);if(!n)throw dee.notFoundError();return new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(dee.notFoundError())}})}function jKe(r,e,t){let{StorageBackend:i,storageOptions:n}=KKe(e,t);e!=="root"&&(r=`${r}/${e}`);let s=new i(r,n);n.sharding&&(s=new LKe(s,new pee.shard.NextToLast(2)));let o=s.get.bind(s),a=s.has.bind(s);return s.get=c=>gee(c,o,a,s),s.has=c=>yee(c,a,s),s}lee.exports={createStore:jKe,hasWithFallback:yee,getWithFallback:gee,findLevelJs:I5,CONFIG_KEY:FKe,VERSION_KEY:UKe}});var T5=p((pEt,bee)=>{l();"use strict";var VKe=async r=>{let e=0;for await(let t of r)e++;return e};bee.exports=VKe});var See=p((yEt,mee)=>{l();"use strict";var vee=Qe(),wee=ir().Key,Jv=en(),zKe=xe()("ipfs:repo:migrator:migration-8"),_ee=tt(),{createStore:HKe}=of(),GKe=T5();function $Ke(r){let e=Jv.decode(`b${r.toString().slice(1)}`),t=new vee(e).multihash;t=Jv.encode("base32",t).slice(1);let i=_ee(t).toUpperCase();return new wee(`/${i}`,!1)}function WKe(r){let e=Jv.decode(`b${r.toString().slice(1)}`),t=Jv.encode("base32",new vee(1,"raw",e).bytes).slice(1);return new wee(`/${_ee(t)}`.toUpperCase(),!1)}async function Eee(r,e,t,i){let n=HKe(r,"blocks",e);await n.open();let s;s=await GKe(n.queryKeys({filters:[o=>i(o).toString()!==o.toString()]}));try{let o=0;for await(let a of n.query({})){let c=i(a.key);c.toString()!==a.key.toString()&&(o+=1,zKe(`Migrating Block from ${a.key} to ${c}`),await n.delete(a.key),await n.put(c,a.value),t(o/s*100,`Migrated Block from ${a.key} to ${c}`))}}finally{await n.close()}}mee.exports={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(r,e,t=()=>{})=>Eee(r,e,t,$Ke),revert:(r,e,t=()=>{})=>Eee(r,e,t,WKe)}});var Iee=p((bEt,xee)=>{l();"use strict";var cp=hi(),Aee=cp.Reader,YKe=cp.Writer,gEt=cp.util,Dg=cp.roots.default||(cp.roots.default={});Dg.ipfs=function(){var r={};return r.pin=function(){var e={};return e.Set=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(n,s){return s||(s=YKe.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&s.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&s.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&s.uint32(29).fixed32(n.seed),s},t.decode=function(n,s){n instanceof Aee||(n=Aee.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Dg.ipfs.pin.Set;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.version=n.uint32();break;case 2:a.fanout=n.uint32();break;case 3:a.seed=n.fixed32();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof Dg.ipfs.pin.Set)return n;var s=new Dg.ipfs.pin.Set;return n.version!=null&&(s.version=n.version>>>0),n.fanout!=null&&(s.fanout=n.fanout>>>0),n.seed!=null&&(s.seed=n.seed>>>0),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(o.version=0,o.fanout=0,o.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(o.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(o.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(o.seed=n.seed),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,cp.util.toJSONOptions)},t}(),e}(),r}();xee.exports=Dg});var Ree=p((mEt,Tee)=>{l();R5.BASE=2166136261;function R5(r){for(var e=R5.BASE,t=0,i=r.length;t<i;t++)e^=r.charCodeAt(t),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}Tee.exports=R5});var Pee=p((vEt,kee)=>{l();kee.exports=k5;var Cee=128,XKe=127,JKe=~XKe,QKe=Math.pow(2,31);function k5(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw k5.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=QKe;)e[t++]=r&255|Cee,r/=128;for(;r&JKe;)e[t++]=r&255|Cee,r>>>=7;return e[t]=r|0,k5.bytes=t-i+1,e}});var Nee=p((wEt,Oee)=>{l();Oee.exports=C5;var ZKe=128,Bee=127;function C5(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw C5.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&Bee)<<i:(s&Bee)*Math.pow(2,i),i+=7}while(s>=ZKe);return C5.bytes=n-e,t}});var qee=p((_Et,Dee)=>{l();var eje=Math.pow(2,7),tje=Math.pow(2,14),rje=Math.pow(2,21),ije=Math.pow(2,28),nje=Math.pow(2,35),sje=Math.pow(2,42),oje=Math.pow(2,49),aje=Math.pow(2,56),cje=Math.pow(2,63);Dee.exports=function(r){return r<eje?1:r<tje?2:r<rje?3:r<ije?4:r<nje?5:r<sje?6:r<oje?7:r<aje?8:r<cje?9:10}});var Lee=p((EEt,Mee)=>{l();Mee.exports={encode:Pee(),decode:Nee(),encodingLength:qee()}});var P5=p((SEt,Fee)=>{l();"use strict";var uje=en(),{Key:Uee}=ir(),fje=er().multihash,lje=new Uee("/local/pins"),hje=256,dje=8192,pje=fje.fromB58String("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),yje={direct:"direct",recursive:"recursive"};function gje(r){return new Uee(`/${uje.encoding("base32upper").encode(r.multihash)}`)}Fee.exports={PIN_DS_KEY:lje,DEFAULT_FANOUT:hje,MAX_ITEMS:dje,EMPTY_KEY:pje,PinTypes:yje,cidToKey:gje}});var Gee=p((xEt,Kee)=>{l();"use strict";var bje=Qe(),{ipfs:{pin:{Set:O5}}}=Iee(),mje=Ree(),B5=Lee(),qg=Mr(),jee=_2(),Qv=$u(),Vee=er().multihash,{cidToKey:Zv,DEFAULT_FANOUT:N5,MAX_ITEMS:vje,EMPTY_KEY:zee}=P5(),D5=vi(),wje=D6(),_je=tt(),Eje=ct(),Sje=Dr();function xje(r){return new bje(r).toBaseEncodedString()}function Aje(r){let e=r.Data,t=B5.decode(e),i=B5.decode.bytes;if(i<=0)throw new Error("Invalid Set header length");if(i+t>e.length)throw new Error("Impossibly large set header length");let n=e.slice(i,t+i),s=O5.toObject(O5.decode(n),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>r.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:e.slice(t+i)}}function Ije(r,e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,r,!0);let n=Eje(xje(e)),s=D5([t,n],t.byteLength+n.byteLength);return mje(_je(s))}async function*Hee(r,e){let t=Aje(e),i=0;for(let n of e.Links){if(i<t.header.fanout){let s=n.Hash;if(!Sje(zee,s.bytes)){let o=await r.get(Zv(s)),a=qg.util.deserialize(o);yield*Hee(r,a)}}else yield n.Hash;i++}}async function*Tje(r,e,t){let i=e.Links.find(o=>o.Name===t);if(!i)throw new Error("No link found with name "+t);let n=await r.get(Zv(i.Hash)),s=qg.util.deserialize(n);yield*Hee(r,s)}function Rje(r,e){return t(e,0);async function t(i,n){let s=O5.encode({version:1,fanout:N5,seed:n}).finish(),o=B5.encode(s.length),a=D5([o,s]),c=[];for(let f=0;f<N5;f++)c.push(new Qv("",1,zee));if(i.length<=vje){let f=i.map(y=>({link:new Qv("",1,y.key),data:y.data||new Uint8Array})).sort((y,g)=>wje(y.link.Hash.bytes,g.link.Hash.bytes)),h=c.concat(f.map(y=>y.link)),d=D5([a,...f.map(y=>y.data)]);return new jee(d,h)}else{let f=i.reduce((d,y)=>{let g=Ije(n,y.key)%N5;return d[g]=g in d?d[g].concat([y]):[y],d},[]),h=0;for(let d of f){let y=await t(d,n+1);await u(y,h),h++}return new jee(a,c)}async function u(f,h){let d=qg.util.serialize(f),y=await qg.util.cid(d,{cidVersion:0,hashAlg:Vee.names["sha2-256"]});await r.put(Zv(y),d),c[h]=new Qv("",f.size,y)}}}async function kje(r,e,t){let i=await Rje(r,t.map(o=>({key:o}))),n=i.serialize(),s=await qg.util.cid(n,{cidVersion:0,hashAlg:Vee.names["sha2-256"]});return await r.put(Zv(s),n),new Qv(e,i.size,s)}Kee.exports={loadSet:Tje,storeSet:kje}});var Xee=p((AEt,$ee)=>{l();"use strict";var Wee=Qe(),q5=Mr(),M5=(G2(),H2),L5=$r(),Cje=en(),up=Gee(),{createStore:F5}=of(),{cidToKey:Mg,PIN_DS_KEY:ew,PinTypes:fp}=P5(),U5=T5();async function Pje(r,e,t,i){if(!await e.has(ew))return;let n=await e.get(ew),s=new Wee(n),o=await r.get(Mg(s)),a=q5.util.deserialize(o),c=0,u;u=await U5(up.loadSet(r,a,fp.recursive))+await U5(up.loadSet(r,a,fp.direct));for await(let f of up.loadSet(r,a,fp.recursive)){c++;let h={depth:Infinity};f.version!==0&&(h.version=f.version),f.codec!=="dag-pb"&&(h.codec=L5.getNumber(f.codec)),await t.put(Mg(f),M5.encode(h)),i(c/u*100,`Migrated recursive pin ${f}`)}for await(let f of up.loadSet(r,a,fp.direct)){c++;let h={depth:0};f.version!==0&&(h.version=f.version),f.codec!=="dag-pb"&&(h.codec=L5.getNumber(f.codec)),await t.put(Mg(f),M5.encode(h)),i(c/u*100,`Migrated direct pin ${f}`)}await r.delete(Mg(s)),await e.delete(ew)}async function Oje(r,e,t,i){let n=[],s=[],o=0,a=await U5(t.queryKeys({}));for await(let{key:h,value:d}of t.query({})){o++;let y=M5.decode(d),g=new Wee(y.version||0,y.codec&&L5.getName(y.codec)||"dag-pb",Cje.decode("b"+h.toString().split("/").pop()));y.depth===0?(i(o/a*100,`Reverted direct pin ${g}`),s.push(g)):(i(o/a*100,`Reverted recursive pin ${g}`),n.push(g))}i(100,"Updating pin root");let u=new q5.DAGNode(new Uint8Array,[await up.storeSet(r,fp.recursive,n),await up.storeSet(r,fp.direct,s)]).serialize(),f=await q5.util.cid(u,{cidVersion:0});await r.put(Mg(f),u),await e.put(ew,f.multihash)}async function Yee(r,e,t,i){let n=F5(r,"blocks",e),s=F5(r,"datastore",e),o=F5(r,"pins",e);await n.open(),await s.open(),await o.open();try{await i(n,s,o,t)}finally{await o.close(),await s.close(),await n.close()}}$ee.exports={version:9,description:"Migrates pins to datastore",migrate:(r,e,t=()=>{})=>Yee(r,e,t,Pje),revert:(r,e,t=()=>{})=>Yee(r,e,t,Oje)}});var tte=p((IEt,Jee)=>{l();"use strict";var{createStore:Bje,findLevelJs:Qee}=of(),Nje=ct(),Dje=tt();async function qje(r,e,t=()=>{}){let i=Qee(e);if(!i){t(`${r} did not need an upgrade`);return}t(`Upgrading ${r}`),await Zee(i,(s,o)=>[{type:"del",key:s},{type:"put",key:Nje(s),value:o}])}async function Mje(r,e,t=()=>{}){let i=Qee(e);if(!i){t(`${r} did not need a downgrade`);return}t(`Downgrading ${r}`),await Zee(i,(s,o)=>[{type:"del",key:s},{type:"put",key:Dje(s),value:o}])}async function ete(r,e,t,i){let n=Object.keys(e.storageBackends).filter(o=>e.storageBackends[o].name==="LevelDatastore").map(o=>({name:o,store:Bje(r,o,e)}));t(0,`Migrating ${n.length} dbs`);let s=0;for(let{name:o,store:a}of n){await a.open();try{await i(o,a,u=>{t(Math.round(s/n.length*100),u)})}finally{s++,a.close()}}t(100,`Migrated ${n.length} dbs`)}Jee.exports={version:10,description:"Migrates datastore-level keys to binary",migrate:(r,e,t=()=>{})=>ete(r,e,t,qje),revert:(r,e,t=()=>{})=>ete(r,e,t,Mje)};function Zee(r,e){function t(i,n){let s=r.store("readwrite"),o=s.transaction,a=0,c;o.onabort=()=>n(c||o.error||new Error("aborted by user")),o.oncomplete=()=>n();function u(){var f=i[a++],h=f.key;try{var d=f.type==="del"?s.delete(h):s.put(f.value,h)}catch(y){c=y,o.abort();return}a<i.length&&(d.onsuccess=u)}u()}return new Promise((i,n)=>{let s=r.iterator(),o=c=>c;s._deserializeKey=s._deserializeValue=o,a();function a(){let c=(u,f,h)=>{if(u||f===void 0){let d=y=>{if(y){n(y);return}i()};s.end(d);return}t(e(f,h),a)};s.next(c)}})}});var ite=p((TEt,rte)=>{l();"use strict";var Ol={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};rte.exports=[Object.assign({version:1},Ol),Object.assign({version:2},Ol),Object.assign({version:3},Ol),Object.assign({version:4},Ol),Object.assign({version:5},Ol),Object.assign({version:6},Ol),Object.assign({version:7},Ol),See(),Xee(),tte()]});var tw=p((REt,nte)=>{l();"use strict";var K5=class extends Error{constructor(e){super(e);this.name="NonReversibleMigrationError",this.code="ERR_NON_REVERSIBLE_MIGRATION",this.message=e}};K5.code="ERR_NON_REVERSIBLE_MIGRATION";var j5=class extends Error{constructor(e){super(e);this.name="NotInitializedRepoError",this.code="ERR_NOT_INITIALIZED_REPO",this.message=e}};j5.code="ERR_NOT_INITIALIZED_REPO";var V5=class extends Error{constructor(e){super(e);this.name="RequiredParameterError",this.code="ERR_REQUIRED_PARAMETER",this.message=e}};V5.code="ERR_REQUIRED_PARAMETER";var z5=class extends Error{constructor(e){super(e);this.name="InvalidValueError",this.code="ERR_INVALID_VALUE",this.message=e}};z5.code="ERR_INVALID_VALUE";var H5=class extends Error{constructor(e){super(e);this.name="MissingRepoOptionsError",this.code="ERR_MISSING_REPO_OPTIONS",this.message=e}};H5.code="ERR_MISSING_REPO_OPTIONS";nte.exports={NonReversibleMigrationError:K5,NotInitializedRepoError:j5,RequiredParameterError:V5,InvalidValueError:z5,MissingRepoOptionsError:H5}});var ote=p((kEt,ste)=>{l();"use strict";var G5=xe()("ipfs:repo:migrator:repo:init"),{CONFIG_KEY:Lje,VERSION_KEY:Fje,createStore:Uje}=of(),{MissingRepoOptionsError:Kje}=tw();async function jje(r,e){if(!e)throw new Kje("Please pass repo options when trying to open a repo");let t;try{t=Uje(r,"root",e),await t.open();let i=await t.has(Fje),n=await t.has(Lje);return!i||!n?(G5(`Version entry present: ${i}`),G5(`Config entry present: ${n}`),!1):!0}catch(i){return G5("While checking if repo is initialized error was thrown: "+i.message),!1}finally{t!==void 0&&await t.close()}}ste.exports={isRepoInitialized:jje}});var lte=p((CEt,ate)=>{l();"use strict";var Vje=ote(),{MissingRepoOptionsError:cte,NotInitializedRepoError:zje}=tw(),{VERSION_KEY:ute,createStore:fte}=of(),Hje=ct(),Gje=tt();async function $je(r,e){if(!await Vje.isRepoInitialized(r,e))throw new zje(`Repo in path ${r} is not initialized!`);if(!e)throw new cte("Please pass repo options when trying to open a repo");let t=fte(r,"root",e);await t.open();try{return parseInt(Gje(await t.get(ute)))}finally{await t.close()}}async function Wje(r,e,t){if(!t)throw new cte("Please pass repo options when trying to open a repo");let i=fte(r,"root",t);await i.open(),await i.put(ute,Hje(String(e))),await i.close()}ate.exports={getVersion:$je,setVersion:Wje}});var pte=p(hte=>{l();"use strict";var Yje=xe(),dte=Yje("ipfs:repo:migrator:repo_mem_lock"),Xje="repo.lock",rw={};hte.lock=async function(e,t){let i=t+"/"+Xje;if(dte("locking %s",i),rw[i]===!0)throw Error(`There is already present lock for: ${i}`);return rw[i]=!0,{close(){rw[i]&&(dte("releasing lock %s",i),delete rw[i])}}}});var mte=p(lp=>{l();"use strict";var $5=ite(),Bl=lte(),yte=pte(),Ts=tw(),Jo=xe()("ipfs:repo:migrator");lp.getCurrentRepoVersion=Bl.getVersion;lp.errors=Ts;function gte(r){return r=r||$5,!Array.isArray(r)||r.length===0?0:r[r.length-1].version}lp.getLatestMigrationVersion=gte;async function Jje(r,e,t,{ignoreLock:i=!1,onProgress:n,isDryRun:s=!1,migrations:o}){if(o=o||$5,!r)throw new Ts.RequiredParameterError("Path argument is required!");if(!e)throw new Ts.RequiredParameterError("repoOptions argument is required!");if(!t)throw new Ts.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(t)||t<=0)throw new Ts.InvalidValueError("Version has to be positive integer!");let a=await Bl.getVersion(r,e);if(a===t){Jo("Nothing to migrate.");return}if(a>t)throw new Ts.InvalidValueError(`Current repo's version (${a}) is higher then toVersion (${t}), you probably wanted to revert it?`);bte(o,a,t);let c;!s&&!i&&(c=await yte.lock(a,r,e));try{for(let u of o){if(t!==void 0&&u.version>t)break;if(!(u.version<=a)){Jo(`Migrating version ${u.version}`);try{if(!s){let f=()=>{};n&&(f=(h,d)=>n(u.version,h.toFixed(2),d)),await u.migrate(r,e,f)}}catch(f){let h=u.version-1;throw Jo(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${h}`),await Bl.setVersion(r,h,e),new Error(`During migration to version ${u.version} exception was raised: ${f.stack||f.message||f}`)}Jo(`Migrating to version ${u.version} finished`)}}s||await Bl.setVersion(r,t||gte(o),e),Jo("Repo successfully migrated",t!==void 0?`to version ${t}!`:"to latest version!")}finally{!s&&!i&&c&&await c.close()}}lp.migrate=Jje;async function Qje(r,e,t,{ignoreLock:i=!1,onProgress:n,isDryRun:s=!1,migrations:o}){if(o=o||$5,!r)throw new Ts.RequiredParameterError("Path argument is required!");if(!e)throw new Ts.RequiredParameterError("repoOptions argument is required!");if(!t)throw new Ts.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(t)||t<=0)throw new Ts.InvalidValueError("Version has to be positive integer!");let a=await Bl.getVersion(r,e);if(a===t){Jo("Nothing to revert.");return}if(a<t)throw new Ts.InvalidValueError(`Current repo's version (${a}) is lower then toVersion (${t}), you probably wanted to migrate it?`);bte(o,t,a,!0);let c;!s&&!i&&(c=await yte.lock(a,r,e)),Jo(`Reverting from version ${a} to ${t}`);try{let u=o.slice().reverse();for(let f of u){if(f.version<=t)break;if(!(f.version>a)){Jo(`Reverting migration version ${f.version}`);try{if(!s){let h=()=>{};n&&(h=(d,y)=>n(f.version,d.toFixed(2),y)),await f.revert(r,e,h)}}catch(h){let d=f.version;throw Jo(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${d}`),await Bl.setVersion(r,d,e),h.message=`During reversion to version ${f.version} exception was raised: ${h.message}`,h}Jo(`Reverting to version ${f.version} finished`)}}s||await Bl.setVersion(r,t,e),Jo(`All migrations successfully reverted to version ${t}!`)}finally{!s&&!i&&c&&await c.close()}}lp.revert=Qje;function bte(r,e,t,i=!1){let n=0;for(let s of r){if(s.version>t)break;if(s.version>e){if(i&&!s.revert)throw new Ts.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${s.version} is not reversible. Cancelling reversion.`);n++}}if(n!==t-e)throw new Ts.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}});var _te=p((BEt,iw)=>{l();"use strict";iw.exports=Zje;iw.exports.format=vte;iw.exports.parse=wte;var eVe=/\B(?=(\d{3})+(?!\d))/g,tVe=/(?:\.0*|(\.[^0]+)0+)$/,af={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},rVe=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function Zje(r,e){return typeof r=="string"?wte(r):typeof r=="number"?vte(r,e):null}function vte(r,e){if(!Number.isFinite(r))return null;var t=Math.abs(r),i=e&&e.thousandsSeparator||"",n=e&&e.unitSeparator||"",s=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!af[a.toLowerCase()])&&(t>=af.pb?a="PB":t>=af.tb?a="TB":t>=af.gb?a="GB":t>=af.mb?a="MB":t>=af.kb?a="KB":a="B");var c=r/af[a.toLowerCase()],u=c.toFixed(s);return o||(u=u.replace(tVe,"$1")),i&&(u=u.replace(eVe,i)),u+n+a}function wte(r){if(typeof r=="number"&&!isNaN(r))return r;if(typeof r!="string")return null;var e=rVe.exec(r),t,i="b";return e?(t=parseFloat(e[1]),i=e[4].toLowerCase()):(t=parseInt(r,10),i="b"),Math.floor(af[i]*t)}});var Ste=p((NEt,Ete)=>{l();"use strict";function iVe(...r){return r.length===0?".":r.join("/")}Ete.exports=iVe});var Ate=p((DEt,xte)=>{l();"use strict";xte.exports={repoVersion:10}});var Tte=p((qEt,Ite)=>{l();"use strict";function nVe(r,e,t){let i=t.storageBackends[r],n=Object.assign({},t.storageBackendOptions[r]||{});return new i(e,n)}Ite.exports={create:nVe}});var kte=p((MEt,Rte)=>{l();"use strict";var sVe=ir().Key,oVe=xe(),aVe=oVe("ipfs:repo:version"),cVe=tt(),uVe=ct(),{hasWithFallback:fVe,getWithFallback:lVe}=of(),W5=new sVe("version");Rte.exports=r=>({async exists(){return fVe(W5,r.has.bind(r),r)},async get(){let e=await lVe(W5,r.get.bind(r),r.has.bind(r),r);return parseInt(cVe(e),10)},set(e){return r.put(W5,uVe(String(e)))},async check(e){let t=await this.get();return aVe("comparing version: %s and %s",t,e),t===e||(t===6&&e===7||e===6&&t===7)}})});var nw=p(Nl=>{l();"use strict";var Lg=class extends Error{constructor(e){super(e);this.name="LockExistsError",this.code=Lg.code}};Lg.code="ERR_LOCK_EXISTS";Nl.LockExistsError=Lg;var Fg=class extends Error{constructor(e){super(e);this.name="NotFoundError",this.code=Fg.code}};Fg.code="ERR_NOT_FOUND";Nl.NotFoundError=Fg;var Ug=class extends Error{constructor(e){super(e);this.name="InvalidRepoVersionError",this.code=Ug.code}};Ug.code="ERR_INVALID_REPO_VERSION";Nl.InvalidRepoVersionError=Ug;Nl.ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED";Nl.ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN";Nl.ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED"});var Ote=p((FEt,Cte)=>{l();"use strict";var{Key:hVe}=ir(),{default:dVe}=yl(),pVe=A5(),yVe=ZA(),Y5=ge(),Pte=nw(),gVe=tt(),bVe=ct(),{hasWithFallback:mVe,getWithFallback:vVe}=of(),X5=new hVe("config");Cte.exports=r=>{let e=new dVe({concurrency:1}),t={async getAll(s={}){let o=await vVe(X5,r.get.bind(r),r.has.bind(r),r,{signal:s.signal});return JSON.parse(gVe(o))},async get(s,o={}){if(s==null)throw new Pte.NotFoundError(`Key ${s} does not exist in config`);let a=await this.getAll(o),c=pVe(a,s);if(c===void 0)throw new Pte.NotFoundError(`Key ${s} does not exist in config`);return c},set(s,o,a={}){if(typeof s!="string"&&!(s instanceof String))throw Y5(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(o===void 0||o instanceof Uint8Array)throw Y5(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>i({key:s,value:o},a.signal))},replace(s,o={}){if(!s||s instanceof Uint8Array)throw Y5(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>i({key:void 0,value:s},o.signal))},async exists(){return mVe(X5,r.has.bind(r),r)}};return t;async function i(s,o){if(o&&o.aborted)return;let a=s.key,c=s.value;if(a){let u=await t.getAll();return typeof u=="object"&&u!==null&&yVe(u,a,c),n(u)}return n(c)}function n(s){let o=bVe(JSON.stringify(s,null,2));return r.put(X5,o)}}});var Nte=p((UEt,Bte)=>{l();"use strict";Bte.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var qte=p((KEt,Dte)=>{l();"use strict";var J5=Nte();Dte.exports=(r,e={})=>{if(!J5(r)&&!Array.isArray(r))throw new TypeError("Expected a plain object or array");let{deep:t}=e,i=[],n=[],s=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u=[];return i.push(a),n.push(u),u.push(...a.map(f=>Array.isArray(f)?s(f):J5(f)?o(f):f)),u},o=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u={},f=Object.keys(a).sort(e.compare);i.push(a),n.push(u);for(let h of f){let d=a[h],y;t&&Array.isArray(d)?y=s(d):y=t&&J5(d)?o(d):d,Object.defineProperty(u,h,{...Object.getOwnPropertyDescriptor(a,h),value:y})}return u};return Array.isArray(r)?t?s(r):r.slice():o(r)}});var Lte=p((jEt,Mte)=>{l();"use strict";var wVe=ir().Key,_Ve=qte(),EVe=tt(),SVe=ct(),Q5=new wVe("datastore_spec");Mte.exports=r=>({exists(){return r.has(Q5)},async get(){let e=await r.get(Q5);return JSON.parse(EVe(e))},async set(e){return r.put(Q5,SVe(JSON.stringify(_Ve(e,{deep:!0}))))}})});var Ute=p((VEt,Fte)=>{l();"use strict";var xVe=ir().Key,AVe=ct(),Z5=new xVe("api");Fte.exports=r=>({async get(){let e=await r.get(Z5);return e&&e.toString()},set(e){return r.put(Z5,AVe(e.toString()))},delete(){return r.delete(Z5)}})});var tI=p(eI=>{l();"use strict";var{Key:IVe}=ir(),Kte=Qe(),jte=en(),TVe=ge(),RVe=tt();eI.cidToKey=r=>{if(!Kte.isCID(r))throw TVe(new Error("Not a valid cid"),"ERR_INVALID_CID");return new IVe("/"+RVe(jte.encode("base32",r.multihash)).slice(1).toUpperCase(),!1)};eI.keyToCid=r=>new Kte(1,"raw",jte.decode("b"+r.toString().slice(1).toLowerCase()))});var Hte=p((HEt,Vte)=>{l();"use strict";var{shard:kVe,ShardingDatastore:CVe}=av(),rI=xl(),{cidToKey:hp,keyToCid:zte}=tI(),PVe=$c(),OVe=xd(),BVe=Wc();Vte.exports=(r,e)=>{let t=NVe(r,e);return DVe(t)};function NVe(r,e){return e.sharding?new CVe(r,new kVe.NextToLast(2)):r}function DVe(r){return{open(){return r.open()},async*query(e,t){for await(let{key:i,value:n}of r.query(e,t))yield new rI(n,zte(i))},async*queryKeys(e,t){for await(let i of r.queryKeys(e,t))yield zte(i)},async get(e,t){let i=hp(e),n=await r.get(i,t);return new rI(n,e)},async*getMany(e,t){for await(let i of e)yield this.get(i,t)},async put(e,t){if(!rI.isBlock(e))throw new Error("invalid block");let i=hp(e.cid);return await r.has(i,t)||await r.put(i,e.data,t),e},async*putMany(e,t){let i=BVe();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{await OVe(r.putMany(async function*(){for await(let s of e){let o=hp(s.cid);await r.has(o,t)||(yield{key:o,value:s.data}),i.push(s)}}())),i.end()}catch(s){i.end(s)}}),yield*i},has(e,t){return r.has(hp(e),t)},delete(e,t){return r.delete(hp(e),t)},deleteMany(e,t){return r.deleteMany(PVe(e,i=>hp(i)),t)},close(){return r.close()}}}});var $te=p((GEt,Gte)=>{l();"use strict";var qVe=xl(),MVe=hl(),LVe=ko(),FVe=Wc(),UVe=xd(),KVe=Qe(),jVe=ge();Gte.exports=VVe;function VVe(r){return{open(){return r.open()},query(e,t){return r.query(e,t)},queryKeys(e,t){return r.queryKeys(e,t)},async get(e,t){let i=dp(e);return i.isIdentity?Promise.resolve(new qVe(i.digest,e)):r.get(e,t)},async*getMany(e,t){for await(let i of e)yield this.get(i,t)},async put(e,t){let{isIdentity:i}=dp(e.cid);return i?Promise.resolve(e):r.put(e,t)},async*putMany(e,t){let i=FVe();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{await UVe(r.putMany(async function*(){for await(let s of e)dp(s.cid).isIdentity||(yield s),i.push(s)}())),i.end()}catch(s){i.end(s)}}),yield*i},has(e,t){let{isIdentity:i}=dp(e);return i?Promise.resolve(!0):r.has(e,t)},delete(e,t){let{isIdentity:i}=dp(e);return i?Promise.resolve():r.delete(e,t)},deleteMany(e,t){return r.deleteMany(MVe(e,i=>!dp(i).isIdentity),t)},close(){return r.close()}}}function dp(r){if(!KVe.isCID(r))throw jVe(new Error("Not a valid cid"),"ERR_INVALID_CID");let e=LVe.decode(r.multihash);return e.name!=="identity"?{isIdentity:!1}:{isIdentity:!0,digest:e.digest}}});var Yte=p(($Et,Wte)=>{l();"use strict";Wte.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==n||o.enumerable!==!0)return!1}return!0}});var sw=p((WEt,Xte)=>{l();"use strict";var Jte=typeof Symbol!="undefined"&&Symbol,zVe=Yte();Xte.exports=function(){return typeof Jte!="function"||typeof Symbol!="function"||typeof Jte("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:zVe()}});var Zte=p((YEt,Qte)=>{l();"use strict";var HVe="Function.prototype.bind called on incompatible ",iI=Array.prototype.slice,GVe=Object.prototype.toString,$Ve="[object Function]";Qte.exports=function(e){var t=this;if(typeof t!="function"||GVe.call(t)!==$Ve)throw new TypeError(HVe+t);for(var i=iI.call(arguments,1),n,s=function(){if(this instanceof n){var f=t.apply(this,i.concat(iI.call(arguments)));return Object(f)===f?f:this}else return t.apply(e,i.concat(iI.call(arguments)))},o=Math.max(0,t.length-i.length),a=[],c=0;c<o;c++)a.push("$"+c);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n}});var ow=p((XEt,ere)=>{l();"use strict";var WVe=Zte();ere.exports=Function.prototype.bind||WVe});var rre=p((JEt,tre)=>{l();"use strict";var YVe=ow();tre.exports=YVe.call(Function.call,Object.prototype.hasOwnProperty)});var fw=p((QEt,ire)=>{l();"use strict";var Dt,Kg=SyntaxError,nre=Function,pp=TypeError,nI=function(r){try{return nre('"use strict"; return ('+r+").constructor;")()}catch(e){}},Dl=Object.getOwnPropertyDescriptor;if(Dl)try{Dl({},"")}catch(r){Dl=null}var sI=function(){throw new pp},XVe=Dl?function(){try{return arguments.callee,sI}catch(r){try{return Dl(arguments,"callee").get}catch(e){return sI}}}():sI,yp=sw()(),cf=Object.getPrototypeOf||function(r){return r.__proto__},gp={},JVe=typeof Uint8Array=="undefined"?Dt:cf(Uint8Array),bp={"%AggregateError%":typeof AggregateError=="undefined"?Dt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?Dt:ArrayBuffer,"%ArrayIteratorPrototype%":yp?cf([][Symbol.iterator]()):Dt,"%AsyncFromSyncIteratorPrototype%":Dt,"%AsyncFunction%":gp,"%AsyncGenerator%":gp,"%AsyncGeneratorFunction%":gp,"%AsyncIteratorPrototype%":gp,"%Atomics%":typeof Atomics=="undefined"?Dt:Atomics,"%BigInt%":typeof BigInt=="undefined"?Dt:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?Dt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?Dt:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?Dt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?Dt:FinalizationRegistry,"%Function%":nre,"%GeneratorFunction%":gp,"%Int8Array%":typeof Int8Array=="undefined"?Dt:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?Dt:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?Dt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":yp?cf(cf([][Symbol.iterator]())):Dt,"%JSON%":typeof JSON=="object"?JSON:Dt,"%Map%":typeof Map=="undefined"?Dt:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!yp?Dt:cf(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?Dt:Promise,"%Proxy%":typeof Proxy=="undefined"?Dt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?Dt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?Dt:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!yp?Dt:cf(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?Dt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":yp?cf(""[Symbol.iterator]()):Dt,"%Symbol%":yp?Symbol:Dt,"%SyntaxError%":Kg,"%ThrowTypeError%":XVe,"%TypedArray%":JVe,"%TypeError%":pp,"%Uint8Array%":typeof Uint8Array=="undefined"?Dt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?Dt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?Dt:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?Dt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?Dt:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?Dt:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?Dt:WeakSet},QVe=function r(e){var t;if(e==="%AsyncFunction%")t=nI("async function () {}");else if(e==="%GeneratorFunction%")t=nI("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=nI("async function* () {}");else if(e==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=r("%AsyncGenerator%");n&&(t=cf(n.prototype))}return bp[e]=t,t},sre={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},aw=ow(),cw=rre(),ZVe=aw.call(Function.call,Array.prototype.concat),eze=aw.call(Function.apply,Array.prototype.splice),ore=aw.call(Function.call,String.prototype.replace),uw=aw.call(Function.call,String.prototype.slice),tze=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,rze=/\\(\\)?/g,ize=function(e){var t=uw(e,0,1),i=uw(e,-1);if(t==="%"&&i!=="%")throw new Kg("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new Kg("invalid intrinsic syntax, expected opening `%`");var n=[];return ore(e,tze,function(s,o,a,c){n[n.length]=a?ore(c,rze,"$1"):o||s}),n},nze=function(e,t){var i=e,n;if(cw(sre,i)&&(n=sre[i],i="%"+n[0]+"%"),cw(bp,i)){var s=bp[i];if(s===gp&&(s=QVe(i)),typeof s=="undefined"&&!t)throw new pp("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new Kg("intrinsic "+e+" does not exist!")};ire.exports=function(e,t){if(typeof e!="string"||e.length===0)throw new pp("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new pp('"allowMissing" argument must be a boolean');var i=ize(e),n=i.length>0?i[0]:"",s=nze("%"+n+"%",t),o=s.name,a=s.value,c=!1,u=s.alias;u&&(n=u[0],eze(i,ZVe([0,1],u)));for(var f=1,h=!0;f<i.length;f+=1){var d=i[f],y=uw(d,0,1),g=uw(d,-1);if((y==='"'||y==="'"||y==="`"||g==='"'||g==="'"||g==="`")&&y!==g)throw new Kg("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(c=!0),n+="."+d,o="%"+n+"%",cw(bp,o))a=bp[o];else if(a!=null){if(!(d in a)){if(!t)throw new pp("base intrinsic for "+e+" exists, but the property is not available.");return}if(Dl&&f+1>=i.length){var m=Dl(a,d);h=!!m,h&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else h=cw(a,d),a=a[d];h&&!c&&(bp[o]=a)}}return a}});var hre=p((ZEt,lw)=>{l();"use strict";var oI=ow(),mp=fw(),are=mp("%Function.prototype.apply%"),cre=mp("%Function.prototype.call%"),ure=mp("%Reflect.apply%",!0)||oI.call(cre,are),fre=mp("%Object.getOwnPropertyDescriptor%",!0),ql=mp("%Object.defineProperty%",!0),sze=mp("%Math.max%");if(ql)try{ql({},"a",{value:1})}catch(r){ql=null}lw.exports=function(e){var t=ure(oI,cre,arguments);if(fre&&ql){var i=fre(t,"length");i.configurable&&ql(t,"length",{value:1+sze(0,e.length-(arguments.length-1))})}return t};var lre=function(){return ure(oI,are,arguments)};ql?ql(lw.exports,"apply",{value:lre}):lw.exports.apply=lre});var hw=p((e3t,dre)=>{l();"use strict";var pre=fw(),yre=hre(),oze=yre(pre("String.prototype.indexOf"));dre.exports=function(e,t){var i=pre(e,!!t);return typeof i=="function"&&oze(e,".prototype.")>-1?yre(i):i}});var mre=p((t3t,gre)=>{l();"use strict";var aze=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",cze=hw(),aI=cze("Object.prototype.toString"),dw=function(e){return aze&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:aI(e)==="[object Arguments]"},bre=function(e){return dw(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&aI(e)!=="[object Array]"&&aI(e.callee)==="[object Function]"},uze=function(){return dw(arguments)}();dw.isLegacyArguments=bre;gre.exports=uze?dw:bre});var _re=p((r3t,vre)=>{l();"use strict";var fze=Object.prototype.toString,lze=Function.prototype.toString,hze=/^\s*(?:function)?\*/,wre=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",cI=Object.getPrototypeOf,dze=function(){if(!wre)return!1;try{return Function("return function*() {}")()}catch(r){}},uI;vre.exports=function(e){if(typeof e!="function")return!1;if(hze.test(lze.call(e)))return!0;if(!wre){var t=fze.call(e);return t==="[object GeneratorFunction]"}if(!cI)return!1;if(typeof uI=="undefined"){var i=dze();uI=i?cI(i):!1}return cI(e)===uI}});var fI=p((i3t,Ere)=>{l();var pze=Object.prototype.hasOwnProperty,yze=Object.prototype.toString;Ere.exports=function(e,t,i){if(yze.call(t)!=="[object Function]")throw new TypeError("iterator must be a function");var n=e.length;if(n===+n)for(var s=0;s<n;s++)t.call(i,e[s],s,e);else for(var o in e)pze.call(e,o)&&t.call(i,e[o],o,e)}});var hI=p((n3t,Sre)=>{l();"use strict";var lI=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];Sre.exports=function(){for(var e=[],t=0;t<lI.length;t++)typeof globalThis[lI[t]]=="function"&&(e[e.length]=lI[t]);return e}});var dI=p((s3t,xre)=>{l();"use strict";var gze=fw(),pw=gze("%Object.getOwnPropertyDescriptor%");if(pw)try{pw([],"length")}catch(r){pw=null}xre.exports=pw});var gI=p((o3t,Are)=>{l();"use strict";var Ire=fI(),bze=hI(),pI=hw(),mze=pI("Object.prototype.toString"),vze=sw()(),Tre=vze&&typeof Symbol.toStringTag=="symbol",Rre=bze(),wze=pI("Array.prototype.indexOf",!0)||function(e,t){for(var i=0;i<e.length;i+=1)if(e[i]===t)return i;return-1},_ze=pI("String.prototype.slice"),kre={},yw=dI(),yI=Object.getPrototypeOf;Tre&&yw&&yI&&Ire(Rre,function(r){var e=new globalThis[r];if(!(Symbol.toStringTag in e))throw new EvalError("this engine has support for Symbol.toStringTag, but "+r+" does not have the property! Please report this.");var t=yI(e),i=yw(t,Symbol.toStringTag);if(!i){var n=yI(t);i=yw(n,Symbol.toStringTag)}kre[r]=i.get});var Eze=function(e){var t=!1;return Ire(kre,function(i,n){if(!t)try{t=i.call(e)===n}catch(s){}}),t};Are.exports=function(e){if(!e||typeof e!="object")return!1;if(!Tre){var t=_ze(mze(e),8,-1);return wze(Rre,t)>-1}return yw?Eze(e):!1}});var Dre=p((a3t,Cre)=>{l();"use strict";var Pre=fI(),Sze=hI(),Ore=hw(),xze=Ore("Object.prototype.toString"),Aze=sw()(),Bre=Aze&&typeof Symbol.toStringTag=="symbol",Ize=Sze(),Tze=Ore("String.prototype.slice"),Nre={},bI=dI(),mI=Object.getPrototypeOf;Bre&&bI&&mI&&Pre(Ize,function(r){if(typeof globalThis[r]=="function"){var e=new globalThis[r];if(!(Symbol.toStringTag in e))throw new EvalError("this engine has support for Symbol.toStringTag, but "+r+" does not have the property! Please report this.");var t=mI(e),i=bI(t,Symbol.toStringTag);if(!i){var n=mI(t);i=bI(n,Symbol.toStringTag)}Nre[r]=i.get}});var Rze=function(e){var t=!1;return Pre(Nre,function(i,n){if(!t)try{var s=i.call(e);s===n&&(t=s)}catch(o){}}),t},kze=gI();Cre.exports=function(e){return kze(e)?Bre?Rze(e):Tze(xze(e),8,-1):!1}});var Yre=p(Tt=>{l();"use strict";var Cze=mre(),Pze=_re(),Qo=Dre(),qre=gI();function vp(r){return r.call.bind(r)}var Mre=typeof BigInt!="undefined",Lre=typeof Symbol!="undefined",oo=vp(Object.prototype.toString),Oze=vp(Number.prototype.valueOf),Bze=vp(String.prototype.valueOf),Nze=vp(Boolean.prototype.valueOf);Mre&&(Fre=vp(BigInt.prototype.valueOf));var Fre;Lre&&(Ure=vp(Symbol.prototype.valueOf));var Ure;function jg(r,e){if(typeof r!="object")return!1;try{return e(r),!0}catch(t){return!1}}Tt.isArgumentsObject=Cze;Tt.isGeneratorFunction=Pze;Tt.isTypedArray=qre;function Dze(r){return typeof Promise!="undefined"&&r instanceof Promise||r!==null&&typeof r=="object"&&typeof r.then=="function"&&typeof r.catch=="function"}Tt.isPromise=Dze;function qze(r){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(r):qre(r)||Kre(r)}Tt.isArrayBufferView=qze;function Mze(r){return Qo(r)==="Uint8Array"}Tt.isUint8Array=Mze;function Lze(r){return Qo(r)==="Uint8ClampedArray"}Tt.isUint8ClampedArray=Lze;function Fze(r){return Qo(r)==="Uint16Array"}Tt.isUint16Array=Fze;function Uze(r){return Qo(r)==="Uint32Array"}Tt.isUint32Array=Uze;function Kze(r){return Qo(r)==="Int8Array"}Tt.isInt8Array=Kze;function jze(r){return Qo(r)==="Int16Array"}Tt.isInt16Array=jze;function Vze(r){return Qo(r)==="Int32Array"}Tt.isInt32Array=Vze;function zze(r){return Qo(r)==="Float32Array"}Tt.isFloat32Array=zze;function Hze(r){return Qo(r)==="Float64Array"}Tt.isFloat64Array=Hze;function Gze(r){return Qo(r)==="BigInt64Array"}Tt.isBigInt64Array=Gze;function $ze(r){return Qo(r)==="BigUint64Array"}Tt.isBigUint64Array=$ze;function gw(r){return oo(r)==="[object Map]"}gw.working=typeof Map!="undefined"&&gw(new Map);function Wze(r){return typeof Map=="undefined"?!1:gw.working?gw(r):r instanceof Map}Tt.isMap=Wze;function bw(r){return oo(r)==="[object Set]"}bw.working=typeof Set!="undefined"&&bw(new Set);function Yze(r){return typeof Set=="undefined"?!1:bw.working?bw(r):r instanceof Set}Tt.isSet=Yze;function mw(r){return oo(r)==="[object WeakMap]"}mw.working=typeof WeakMap!="undefined"&&mw(new WeakMap);function Xze(r){return typeof WeakMap=="undefined"?!1:mw.working?mw(r):r instanceof WeakMap}Tt.isWeakMap=Xze;function vI(r){return oo(r)==="[object WeakSet]"}vI.working=typeof WeakSet!="undefined"&&vI(new WeakSet);function Jze(r){return vI(r)}Tt.isWeakSet=Jze;function vw(r){return oo(r)==="[object ArrayBuffer]"}vw.working=typeof ArrayBuffer!="undefined"&&vw(new ArrayBuffer);function jre(r){return typeof ArrayBuffer=="undefined"?!1:vw.working?vw(r):r instanceof ArrayBuffer}Tt.isArrayBuffer=jre;function ww(r){return oo(r)==="[object DataView]"}ww.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&ww(new DataView(new ArrayBuffer(1),0,1));function Kre(r){return typeof DataView=="undefined"?!1:ww.working?ww(r):r instanceof DataView}Tt.isDataView=Kre;var wI=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:void 0;function Vg(r){return oo(r)==="[object SharedArrayBuffer]"}function Vre(r){return typeof wI=="undefined"?!1:(typeof Vg.working=="undefined"&&(Vg.working=Vg(new wI)),Vg.working?Vg(r):r instanceof wI)}Tt.isSharedArrayBuffer=Vre;function Qze(r){return oo(r)==="[object AsyncFunction]"}Tt.isAsyncFunction=Qze;function Zze(r){return oo(r)==="[object Map Iterator]"}Tt.isMapIterator=Zze;function eHe(r){return oo(r)==="[object Set Iterator]"}Tt.isSetIterator=eHe;function tHe(r){return oo(r)==="[object Generator]"}Tt.isGeneratorObject=tHe;function rHe(r){return oo(r)==="[object WebAssembly.Module]"}Tt.isWebAssemblyCompiledModule=rHe;function zre(r){return jg(r,Oze)}Tt.isNumberObject=zre;function Hre(r){return jg(r,Bze)}Tt.isStringObject=Hre;function Gre(r){return jg(r,Nze)}Tt.isBooleanObject=Gre;function $re(r){return Mre&&jg(r,Fre)}Tt.isBigIntObject=$re;function Wre(r){return Lre&&jg(r,Ure)}Tt.isSymbolObject=Wre;function iHe(r){return zre(r)||Hre(r)||Gre(r)||$re(r)||Wre(r)}Tt.isBoxedPrimitive=iHe;function nHe(r){return typeof Uint8Array!="undefined"&&(jre(r)||Vre(r))}Tt.isAnyArrayBuffer=nHe;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(r){Object.defineProperty(Tt,r,{enumerable:!1,value:function(){throw new Error(r+" is not supported in userland")}})})});var Jre=p((u3t,Xre)=>{l();Xre.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var iie=p(Rt=>{l();var Qre=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++)i[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return i},sHe=/%[sdj%]/g;Rt.format=function(r){if(!Ew(r)){for(var e=[],t=0;t<arguments.length;t++)e.push(uf(arguments[t]));return e.join(" ")}for(var t=1,i=arguments,n=i.length,s=String(r).replace(sHe,function(a){if(a==="%%")return"%";if(t>=n)return a;switch(a){case"%s":return String(i[t++]);case"%d":return Number(i[t++]);case"%j":try{return JSON.stringify(i[t++])}catch(c){return"[Circular]"}default:return a}}),o=i[t];t<n;o=i[++t])_w(o)||!wp(o)?s+=" "+o:s+=" "+uf(o);return s};Rt.deprecate=function(r,e){if(typeof process!="undefined"&&process.noDeprecation===!0)return r;if(typeof process=="undefined")return function(){return Rt.deprecate(r,e).apply(this,arguments)};var t=!1;function i(){if(!t){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),t=!0}return r.apply(this,arguments)}return i};var Sw={},Zre=/^$/;process.env.NODE_DEBUG&&(xw=process.env.NODE_DEBUG,xw=xw.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),Zre=new RegExp("^"+xw+"$","i"));var xw;Rt.debuglog=function(r){if(r=r.toUpperCase(),!Sw[r])if(Zre.test(r)){var e=process.pid;Sw[r]=function(){var t=Rt.format.apply(Rt,arguments);console.error("%s %d: %s",r,e,t)}}else Sw[r]=function(){};return Sw[r]};function uf(r,e){var t={seen:[],stylize:aHe};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),_I(e)?t.showHidden=e:e&&Rt._extend(t,e),Ml(t.showHidden)&&(t.showHidden=!1),Ml(t.depth)&&(t.depth=2),Ml(t.colors)&&(t.colors=!1),Ml(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=oHe),Aw(t,r,t.depth)}Rt.inspect=uf;uf.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};uf.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function oHe(r,e){var t=uf.styles[e];return t?"["+uf.colors[t][0]+"m"+r+"["+uf.colors[t][1]+"m":r}function aHe(r,e){return r}function cHe(r){var e={};return r.forEach(function(t,i){e[t]=!0}),e}function Aw(r,e,t){if(r.customInspect&&e&&Tw(e.inspect)&&e.inspect!==Rt.inspect&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(t,r);return Ew(i)||(i=Aw(r,i,t)),i}var n=uHe(r,e);if(n)return n;var s=Object.keys(e),o=cHe(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),Hg(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return EI(e);if(s.length===0){if(Tw(e)){var a=e.name?": "+e.name:"";return r.stylize("[Function"+a+"]","special")}if(zg(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(Iw(e))return r.stylize(Date.prototype.toString.call(e),"date");if(Hg(e))return EI(e)}var c="",u=!1,f=["{","}"];if(eie(e)&&(u=!0,f=["[","]"]),Tw(e)){var h=e.name?": "+e.name:"";c=" [Function"+h+"]"}if(zg(e)&&(c=" "+RegExp.prototype.toString.call(e)),Iw(e)&&(c=" "+Date.prototype.toUTCString.call(e)),Hg(e)&&(c=" "+EI(e)),s.length===0&&(!u||e.length==0))return f[0]+c+f[1];if(t<0)return zg(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var d;return u?d=fHe(r,e,t,o,s):d=s.map(function(y){return SI(r,e,t,o,y,u)}),r.seen.pop(),lHe(d,c,f)}function uHe(r,e){if(Ml(e))return r.stylize("undefined","undefined");if(Ew(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(tie(e))return r.stylize(""+e,"number");if(_I(e))return r.stylize(""+e,"boolean");if(_w(e))return r.stylize("null","null")}function EI(r){return"["+Error.prototype.toString.call(r)+"]"}function fHe(r,e,t,i,n){for(var s=[],o=0,a=e.length;o<a;++o)rie(e,String(o))?s.push(SI(r,e,t,i,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(SI(r,e,t,i,c,!0))}),s}function SI(r,e,t,i,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=r.stylize("[Getter/Setter]","special"):a=r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),rie(i,n)||(o="["+n+"]"),a||(r.seen.indexOf(c.value)<0?(_w(t)?a=Aw(r,c.value,null):a=Aw(r,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(u){return"   "+u}).join(`
`))):a=r.stylize("[Circular]","special")),Ml(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function lHe(r,e,t){var i=0,n=r.reduce(function(s,o){return i++,o.indexOf(`
`)>=0&&i++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}Rt.types=Yre();function eie(r){return Array.isArray(r)}Rt.isArray=eie;function _I(r){return typeof r=="boolean"}Rt.isBoolean=_I;function _w(r){return r===null}Rt.isNull=_w;function hHe(r){return r==null}Rt.isNullOrUndefined=hHe;function tie(r){return typeof r=="number"}Rt.isNumber=tie;function Ew(r){return typeof r=="string"}Rt.isString=Ew;function dHe(r){return typeof r=="symbol"}Rt.isSymbol=dHe;function Ml(r){return r===void 0}Rt.isUndefined=Ml;function zg(r){return wp(r)&&xI(r)==="[object RegExp]"}Rt.isRegExp=zg;Rt.types.isRegExp=zg;function wp(r){return typeof r=="object"&&r!==null}Rt.isObject=wp;function Iw(r){return wp(r)&&xI(r)==="[object Date]"}Rt.isDate=Iw;Rt.types.isDate=Iw;function Hg(r){return wp(r)&&(xI(r)==="[object Error]"||r instanceof Error)}Rt.isError=Hg;Rt.types.isNativeError=Hg;function Tw(r){return typeof r=="function"}Rt.isFunction=Tw;function pHe(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r=="undefined"}Rt.isPrimitive=pHe;Rt.isBuffer=Jre();function xI(r){return Object.prototype.toString.call(r)}function AI(r){return r<10?"0"+r.toString(10):r.toString(10)}var yHe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function gHe(){var r=new Date,e=[AI(r.getHours()),AI(r.getMinutes()),AI(r.getSeconds())].join(":");return[r.getDate(),yHe[r.getMonth()],e].join(" ")}Rt.log=function(){console.log("%s - %s",gHe(),Rt.format.apply(Rt,arguments))};Rt.inherits=rn();Rt._extend=function(r,e){if(!e||!wp(e))return r;for(var t=Object.keys(e),i=t.length;i--;)r[t[i]]=e[t[i]];return r};function rie(r,e){return Object.prototype.hasOwnProperty.call(r,e)}var Ll=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;Rt.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if(Ll&&e[Ll]){var t=e[Ll];if(typeof t!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,Ll,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var i,n,s=new Promise(function(c,u){i=c,n=u}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,u){c?n(c):i(u)});try{e.apply(this,o)}catch(c){n(c)}return s}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Ll&&Object.defineProperty(t,Ll,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,Qre(e))};Rt.promisify.custom=Ll;function bHe(r,e){if(!r){var t=new Error("Promise was rejected with a falsy value");t.reason=r,r=t}return e(r)}function mHe(r){if(typeof r!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var n=t.pop();if(typeof n!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};r.apply(this,t).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(bHe.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(r)),Object.defineProperties(e,Qre(r)),e}Rt.callbackify=mHe});var II=p((l3t,nie)=>{l();"use strict";nie.exports=function(...e){let t=e.reduce((i,n)=>Object.assign(i,n),{});return Object.assign(t,{bufferKeys:t.bufferKeys||!1,snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,openCallback:t.openCallback||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:t.encodings||!1,additionalMethods:Object.assign({},t.additionalMethods)})}});var oie=p((h3t,sie)=>{l();sie.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var Rw=p((d3t,aie)=>{l();var cie;aie.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:globalThis):r=>(cie||(cie=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0))});var kw=p((p3t,uie)=>{l();"use strict";var fie=Rw();uie.exports=function(r,...e){e.length===0?fie(r):fie(()=>r(...e))}});var TI=p((y3t,lie)=>{l();"use strict";function ff(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._ended=!1,this._nexting=!1}ff.prototype.next=function(r){if(typeof r!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(r,new Error("cannot call next() after end()")),this):this._nexting?(this._nextTick(r,new Error("cannot call next() before previous next() has completed")),this):(this._nexting=!0,this._next((e,...t)=>{this._nexting=!1,r(e,...t)}),this)};ff.prototype._next=function(r){this._nextTick(r)};ff.prototype.seek=function(r){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");r=this.db._serializeKey(r),this._seek(r)};ff.prototype._seek=function(r){};ff.prototype.end=function(r){if(typeof r!="function")throw new Error("end() requires a callback argument");if(this._ended)return this._nextTick(r,new Error("end() already called on iterator"));this._ended=!0,this._end(r)};ff.prototype._end=function(r){this._nextTick(r)};ff.prototype._nextTick=kw();lie.exports=ff});var RI=p((g3t,hie)=>{l();"use strict";var die=Object.freeze({});function Zo(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._operations=[],this._written=!1}Zo.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};Zo.prototype.put=function(r,e,t){this._checkWritten();let i=this.db._checkKey(r)||this.db._checkValue(e);if(i)throw i;return r=this.db._serializeKey(r),e=this.db._serializeValue(e),this._put(r,e,t??die),this};Zo.prototype._put=function(r,e,t){this._operations.push({...t,type:"put",key:r,value:e})};Zo.prototype.del=function(r,e){this._checkWritten();let t=this.db._checkKey(r);if(t)throw t;return r=this.db._serializeKey(r),this._del(r,e??die),this};Zo.prototype._del=function(r,e){this._operations.push({...e,type:"del",key:r})};Zo.prototype.clear=function(){return this._checkWritten(),this._clear(),this};Zo.prototype._clear=function(){this._operations=[]};Zo.prototype.write=function(r,e){if(this._checkWritten(),typeof r=="function"&&(e=r),typeof e!="function")throw new Error("write() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),this._written=!0,this._write(r,e)};Zo.prototype._write=function(r,e){this.db._batch(this._operations,r,e)};Zo.prototype._nextTick=kw();hie.exports=Zo});var gie=p((b3t,pie)=>{l();"use strict";var vHe=II(),wHe=oie(),_He=TI(),EHe=RI(),SHe=Object.prototype.hasOwnProperty,xHe=["lt","lte","gt","gte"];function jr(r){this.status="new",this.supports=vHe(r,{status:!0})}jr.prototype.open=function(r,e){let t=this.status;if(typeof r=="function"&&(e=r),typeof e!="function")throw new Error("open() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),r.createIfMissing=r.createIfMissing!==!1,r.errorIfExists=!!r.errorIfExists,this.status="opening",this._open(r,i=>{if(i)return this.status=t,e(i);this.status="open",e()})};jr.prototype._open=function(r,e){this._nextTick(e)};jr.prototype.close=function(r){let e=this.status;if(typeof r!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(t=>{if(t)return this.status=e,r(t);this.status="closed",r()})};jr.prototype._close=function(r){this._nextTick(r)};jr.prototype.get=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("get() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(r,e,t)};jr.prototype._get=function(r,e,t){this._nextTick(function(){t(new Error("NotFound"))})};jr.prototype.put=function(r,e,t,i){if(typeof t=="function"&&(i=t),typeof i!="function")throw new Error("put() requires a callback argument");let n=this._checkKey(r)||this._checkValue(e);if(n)return this._nextTick(i,n);r=this._serializeKey(r),e=this._serializeValue(e),(typeof t!="object"||t===null)&&(t={}),this._put(r,e,t,i)};jr.prototype._put=function(r,e,t,i){this._nextTick(i)};jr.prototype.del=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("del() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),this._del(r,e,t)};jr.prototype._del=function(r,e,t){this._nextTick(t)};jr.prototype.batch=function(r,e,t){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(t=e),typeof r=="function"&&(t=r),typeof t!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(r))return this._nextTick(t,new Error("batch(array) requires an array argument"));if(r.length===0)return this._nextTick(t);(typeof e!="object"||e===null)&&(e={});let i=new Array(r.length);for(let n=0;n<r.length;n++){if(typeof r[n]!="object"||r[n]===null)return this._nextTick(t,new Error("batch(array) element must be an object and not `null`"));let s=Object.assign({},r[n]);if(s.type!=="put"&&s.type!=="del")return this._nextTick(t,new Error("`type` must be 'put' or 'del'"));let o=this._checkKey(s.key);if(o)return this._nextTick(t,o);if(s.key=this._serializeKey(s.key),s.type==="put"){let a=this._checkValue(s.value);if(a)return this._nextTick(t,a);s.value=this._serializeValue(s.value)}i[n]=s}this._batch(i,e,t)};jr.prototype._batch=function(r,e,t){this._nextTick(t)};jr.prototype.clear=function(r,e){if(typeof r=="function")e=r;else if(typeof e!="function")throw new Error("clear() requires a callback argument");r=yie(this,r),r.reverse=!!r.reverse,r.limit="limit"in r?r.limit:-1,this._clear(r,e)};jr.prototype._clear=function(r,e){r.keys=!0,r.values=!1,r.keyAsBuffer=!0,r.valueAsBuffer=!0;let t=this._iterator(r),i={},n=s=>{if(s)return t.end(function(){e(s)});t.next((o,a)=>{if(o)return n(o);if(a===void 0)return t.end(e);this._del(a,i,n)})};n()};jr.prototype._setupIteratorOptions=function(r){return r=yie(this,r),r.reverse=!!r.reverse,r.keys=r.keys!==!1,r.values=r.values!==!1,r.limit="limit"in r?r.limit:-1,r.keyAsBuffer=r.keyAsBuffer!==!1,r.valueAsBuffer=r.valueAsBuffer!==!1,r};function yie(r,e){let t={};for(let i in e){if(!SHe.call(e,i))continue;if(i==="start"||i==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let n=e[i];AHe(i)&&(n=r._serializeKey(n)),t[i]=n}return t}function AHe(r){return xHe.indexOf(r)!==-1}jr.prototype.iterator=function(r){return(typeof r!="object"||r===null)&&(r={}),r=this._setupIteratorOptions(r),this._iterator(r)};jr.prototype._iterator=function(r){return new _He(this)};jr.prototype._chainedBatch=function(){return new EHe(this)};jr.prototype._serializeKey=function(r){return r};jr.prototype._serializeValue=function(r){return r};jr.prototype._checkKey=function(r){if(r==null)return new Error("key cannot be `null` or `undefined`");if(wHe(r)&&r.length===0)return new Error("key cannot be an empty Buffer");if(r==="")return new Error("key cannot be an empty String");if(Array.isArray(r)&&r.length===0)return new Error("key cannot be an empty Array")};jr.prototype._checkValue=function(r){if(r==null)return new Error("value cannot be `null` or `undefined`")};jr.prototype._nextTick=kw();pie.exports=jr});var lf=p(Cw=>{l();"use strict";Cw.AbstractLevelDOWN=gie();Cw.AbstractIterator=TI();Cw.AbstractChainedBatch=RI()});var vie=p((v3t,bie)=>{l();"use strict";var mie=lf().AbstractIterator,IHe=rn();function _p(r,e){mie.call(this,r),this._options=e,this._iterator=null,this._operations=[]}IHe(_p,mie);_p.prototype.setDb=function(r){let e=this._iterator=r.iterator(this._options);for(let t of this._operations)e[t.method](...t.args)};_p.prototype._operation=function(r,e){if(this._iterator)return this._iterator[r](...e);this._operations.push({method:r,args:e})};for(let r of["next","end"])_p.prototype["_"+r]=function(...e){this._operation(r,e)};_p.prototype.seek=function(...r){this._operation("seek",r)};bie.exports=_p});var xie=p((w3t,kI)=>{l();"use strict";var wie=lf().AbstractLevelDOWN,THe=rn(),_ie=vie(),Eie="put get del batch clear".split(" "),RHe="approximateSize compactRange".split(" ");function Fl(r){wie.call(this,r.supports||{});for(let e of RHe)typeof r[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this._db=r,this._operations=[],Sie(this)}THe(Fl,wie);Fl.prototype.type="deferred-leveldown";Fl.prototype._open=function(r,e){this._db.open(r,t=>{if(t)return e(t);for(let i of this._operations)i.iterator?i.iterator.setDb(this._db):this._db[i.method](...i.args);this._operations=[],kHe(this),e()})};Fl.prototype._close=function(r){this._db.close(e=>{if(e)return r(e);Sie(this),r()})};function kHe(r){for(let e of Eie.concat("iterator"))r["_"+e]=function(...t){return this._db[e](...t)};for(let e of Object.keys(r.supports.additionalMethods))r[e]=function(...t){return this._db[e](...t)}}function Sie(r){for(let e of Eie)r["_"+e]=function(...t){this._operations.push({method:e,args:t})};for(let e of Object.keys(r.supports.additionalMethods))r[e]=function(...t){this._operations.push({method:e,args:t})};r._iterator=function(e){let t=new _ie(r,e);return this._operations.push({iterator:t}),t}}Fl.prototype._serializeKey=function(r){return r};Fl.prototype._serializeValue=function(r){return r};kI.exports=Fl;kI.exports.DeferredIterator=_ie});var CI=p((_3t,Aie)=>{l();Aie.exports=Lr().EventEmitter});var PI=p(()=>{l()});var kie=p((x3t,Iie)=>{l();"use strict";function Tie(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function PHe(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Tie(Object(t),!0).forEach(function(i){CHe(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Tie(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function CHe(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function OHe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Rie(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function BHe(r,e,t){return e&&Rie(r.prototype,e),t&&Rie(r,t),r}var NHe=xt(),Pw=NHe.Buffer,DHe=PI(),OI=DHe.inspect,qHe=OI&&OI.custom||"inspect";function MHe(r,e,t){Pw.prototype.copy.call(r,e,t)}Iie.exports=function(){function r(){OHe(this,r),this.head=null,this.tail=null,this.length=0}return BHe(r,[{key:"push",value:function(t){var i={data:t,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(t){var i={data:t,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=t+i.data;return n}},{key:"concat",value:function(t){if(this.length===0)return Pw.alloc(0);for(var i=Pw.allocUnsafe(t>>>0),n=this.head,s=0;n;)MHe(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(t,i){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):t===this.head.data.length?n=this.shift():n=i?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var i=this.head,n=1,s=i.data;for(t-=s.length;i=i.next;){var o=i.data,a=t>o.length?o.length:t;if(a===o.length?s+=o:s+=o.slice(0,t),t-=a,t===0){a===o.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(t){var i=Pw.allocUnsafe(t),n=this.head,s=1;for(n.data.copy(i),t-=n.data.length;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,a),t-=a,t===0){a===o.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++s}return this.length-=s,i}},{key:qHe,value:function(t,i){return OI(this,PHe({},i,{depth:0,customInspect:!1}))}}]),r}()});var NI=p((A3t,Cie)=>{l();"use strict";function LHe(r,e){var t=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(BI,this,r)):process.nextTick(BI,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(s){!e&&s?t._writableState?t._writableState.errorEmitted?process.nextTick(Ow,t):(t._writableState.errorEmitted=!0,process.nextTick(Pie,t,s)):process.nextTick(Pie,t,s):e?(process.nextTick(Ow,t),e(s)):process.nextTick(Ow,t)}),this)}function Pie(r,e){BI(r,e),Ow(r)}function Ow(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function FHe(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function BI(r,e){r.emit("error",e)}function UHe(r,e){var t=r._readableState,i=r._writableState;t&&t.autoDestroy||i&&i.autoDestroy?r.destroy(e):r.emit("error",e)}Cie.exports={destroy:LHe,undestroy:FHe,errorOrDestroy:UHe}});var Ul=p((I3t,Oie)=>{l();"use strict";function KHe(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var Bie={};function ao(r,e,t){t||(t=Error);function i(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){KHe(o,s);function o(a,c,u){return s.call(this,i(a,c,u))||this}return o}(t);n.prototype.name=t.name,n.prototype.code=r,Bie[r]=n}function Nie(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(i){return String(i)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:t===2?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}else return"of ".concat(e," ").concat(String(r))}function jHe(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function VHe(r,e,t){return(t===void 0||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function zHe(r,e,t){return typeof t!="number"&&(t=0),t+e.length>r.length?!1:r.indexOf(e,t)!==-1}ao("ERR_INVALID_OPT_VALUE",function(r,e){return'The value "'+e+'" is invalid for option "'+r+'"'},TypeError);ao("ERR_INVALID_ARG_TYPE",function(r,e,t){var i;typeof e=="string"&&jHe(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(VHe(r," argument"))n="The ".concat(r," ").concat(i," ").concat(Nie(e,"type"));else{var s=zHe(r,".")?"property":"argument";n='The "'.concat(r,'" ').concat(s," ").concat(i," ").concat(Nie(e,"type"))}return n+=". Received type ".concat(typeof t),n},TypeError);ao("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");ao("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"});ao("ERR_STREAM_PREMATURE_CLOSE","Premature close");ao("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"});ao("ERR_MULTIPLE_CALLBACK","Callback called multiple times");ao("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");ao("ERR_STREAM_WRITE_AFTER_END","write after end");ao("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);ao("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError);ao("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Oie.exports.codes=Bie});var DI=p((T3t,Die)=>{l();"use strict";var HHe=Ul().codes.ERR_INVALID_OPT_VALUE;function GHe(r,e,t){return r.highWaterMark!=null?r.highWaterMark:e?r[t]:null}function $He(r,e,t,i){var n=GHe(e,i,t);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?t:"highWaterMark";throw new HHe(s,n)}return Math.floor(n)}return r.objectMode?16:16*1024}Die.exports={getHighWaterMark:$He}});var Mie=p((R3t,qie)=>{l();qie.exports=WHe;function WHe(r,e){if(qI("noDeprecation"))return r;var t=!1;function i(){if(!t){if(qI("throwDeprecation"))throw new Error(e);qI("traceDeprecation")?console.trace(e):console.warn(e),t=!0}return r.apply(this,arguments)}return i}function qI(r){try{if(!globalThis.localStorage)return!1}catch(t){return!1}var e=globalThis.localStorage[r];return e==null?!1:String(e).toLowerCase()==="true"}});var FI=p((k3t,Lie)=>{l();"use strict";Lie.exports=Xr;function Fie(r){var e=this;this.next=null,this.entry=null,this.finish=function(){YHe(e,r)}}var Ep;Xr.WritableState=Gg;var XHe={deprecate:Mie()},Uie=CI(),Bw=xt().Buffer,JHe=globalThis.Uint8Array||function(){};function QHe(r){return Bw.from(r)}function ZHe(r){return Bw.isBuffer(r)||r instanceof JHe}var MI=NI(),eGe=DI(),tGe=eGe.getHighWaterMark,hf=Ul().codes,rGe=hf.ERR_INVALID_ARG_TYPE,iGe=hf.ERR_METHOD_NOT_IMPLEMENTED,nGe=hf.ERR_MULTIPLE_CALLBACK,sGe=hf.ERR_STREAM_CANNOT_PIPE,oGe=hf.ERR_STREAM_DESTROYED,aGe=hf.ERR_STREAM_NULL_VALUES,cGe=hf.ERR_STREAM_WRITE_AFTER_END,uGe=hf.ERR_UNKNOWN_ENCODING,Sp=MI.errorOrDestroy;rn()(Xr,Uie);function fGe(){}function Gg(r,e,t){Ep=Ep||Kl(),r=r||{},typeof t!="boolean"&&(t=e instanceof Ep),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.writableObjectMode),this.highWaterMark=tGe(this,r,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=r.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){lGe(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Fie(this)}Gg.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};(function(){try{Object.defineProperty(Gg.prototype,"buffer",{get:XHe.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(r){}})();var Nw;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Nw=Function.prototype[Symbol.hasInstance],Object.defineProperty(Xr,Symbol.hasInstance,{value:function(e){return Nw.call(this,e)?!0:this!==Xr?!1:e&&e._writableState instanceof Gg}})):Nw=function(e){return e instanceof this};function Xr(r){Ep=Ep||Kl();var e=this instanceof Ep;if(!e&&!Nw.call(Xr,this))return new Xr(r);this._writableState=new Gg(r,this,e),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final)),Uie.call(this)}Xr.prototype.pipe=function(){Sp(this,new sGe)};function hGe(r,e){var t=new cGe;Sp(r,t),process.nextTick(e,t)}function dGe(r,e,t,i){var n;return t===null?n=new aGe:typeof t!="string"&&!e.objectMode&&(n=new rGe("chunk",["string","Buffer"],t)),n?(Sp(r,n),process.nextTick(i,n),!1):!0}Xr.prototype.write=function(r,e,t){var i=this._writableState,n=!1,s=!i.objectMode&&ZHe(r);return s&&!Bw.isBuffer(r)&&(r=QHe(r)),typeof e=="function"&&(t=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof t!="function"&&(t=fGe),i.ending?hGe(this,t):(s||dGe(this,i,r,t))&&(i.pendingcb++,n=pGe(this,i,s,r,e,t)),n};Xr.prototype.cork=function(){this._writableState.corked++};Xr.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&Kie(this,r))};Xr.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new uGe(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Xr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function yGe(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=Bw.from(e,t)),e}Object.defineProperty(Xr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function pGe(r,e,t,i,n,s){if(!t){var o=yGe(e,i,n);i!==o&&(t=!0,n="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:t,callback:s,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else LI(r,e,!1,a,i,n,s);return c}function LI(r,e,t,i,n,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new oGe("write")):t?r._writev(n,e.onwrite):r._write(n,s,e.onwrite),e.sync=!1}function gGe(r,e,t,i,n){--e.pendingcb,t?(process.nextTick(n,i),process.nextTick($g,r,e),r._writableState.errorEmitted=!0,Sp(r,i)):(n(i),r._writableState.errorEmitted=!0,Sp(r,i),$g(r,e))}function bGe(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function lGe(r,e){var t=r._writableState,i=t.sync,n=t.writecb;if(typeof n!="function")throw new nGe;if(bGe(t),e)gGe(r,t,i,e,n);else{var s=Vie(t)||r.destroyed;!s&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&Kie(r,t),i?process.nextTick(jie,r,t,s,n):jie(r,t,s,n)}}function jie(r,e,t,i){t||mGe(r,e),e.pendingcb--,i(),$g(r,e)}function mGe(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function Kie(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=t;for(var o=0,a=!0;t;)n[o]=t,t.isBuf||(a=!1),t=t.next,o+=1;n.allBuffers=a,LI(r,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new Fie(e),e.bufferedRequestCount=0}else{for(;t;){var c=t.chunk,u=t.encoding,f=t.callback,h=e.objectMode?1:c.length;if(LI(r,e,!1,h,c,u,f),t=t.next,e.bufferedRequestCount--,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}Xr.prototype._write=function(r,e,t){t(new iGe("_write()"))};Xr.prototype._writev=null;Xr.prototype.end=function(r,e,t){var i=this._writableState;return typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),i.corked&&(i.corked=1,this.uncork()),i.ending||vGe(this,i,t),this};Object.defineProperty(Xr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Vie(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function wGe(r,e){r._final(function(t){e.pendingcb--,t&&Sp(r,t),e.prefinished=!0,r.emit("prefinish"),$g(r,e)})}function _Ge(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(wGe,r,e)):(e.prefinished=!0,r.emit("prefinish")))}function $g(r,e){var t=Vie(e);if(t&&(_Ge(r,e),e.pendingcb===0&&(e.finished=!0,r.emit("finish"),e.autoDestroy))){var i=r._readableState;(!i||i.autoDestroy&&i.endEmitted)&&r.destroy()}return t}function vGe(r,e,t){e.ending=!0,$g(r,e),t&&(e.finished?process.nextTick(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function YHe(r,e,t){var i=r.entry;for(r.entry=null;i;){var n=i.callback;e.pendingcb--,n(t),i=i.next}e.corkedRequestsFree.next=r}Object.defineProperty(Xr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Xr.prototype.destroy=MI.destroy;Xr.prototype._undestroy=MI.undestroy;Xr.prototype._destroy=function(r,e){e(r)}});var Kl=p((C3t,zie)=>{l();"use strict";var EGe=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};zie.exports=ic;var Hie=UI(),KI=FI();rn()(ic,Hie);for(jI=EGe(KI.prototype),Dw=0;Dw<jI.length;Dw++)qw=jI[Dw],ic.prototype[qw]||(ic.prototype[qw]=KI.prototype[qw]);var jI,qw,Dw;function ic(r){if(!(this instanceof ic))return new ic(r);Hie.call(this,r),KI.call(this,r),this.allowHalfOpen=!0,r&&(r.readable===!1&&(this.readable=!1),r.writable===!1&&(this.writable=!1),r.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",SGe)))}Object.defineProperty(ic.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(ic.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(ic.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function SGe(){this._writableState.ended||process.nextTick(xGe,this)}function xGe(r){r.end()}Object.defineProperty(ic.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var zI=p((VI,Gie)=>{l();var Mw=xt(),nc=Mw.Buffer;function $ie(r,e){for(var t in r)e[t]=r[t]}nc.from&&nc.alloc&&nc.allocUnsafe&&nc.allocUnsafeSlow?Gie.exports=Mw:($ie(Mw,VI),VI.Buffer=jl);function jl(r,e,t){return nc(r,e,t)}jl.prototype=Object.create(nc.prototype);$ie(nc,jl);jl.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return nc(r,e,t)};jl.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var i=nc(r);return e!==void 0?typeof t=="string"?i.fill(e,t):i.fill(e):i.fill(0),i};jl.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return nc(r)};jl.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Mw.SlowBuffer(r)}});var $I=p(Wie=>{l();"use strict";var HI=zI().Buffer,Yie=HI.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function AGe(r){if(!r)return"utf8";for(var e;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(e)return;r=(""+r).toLowerCase(),e=!0}}function IGe(r){var e=AGe(r);if(typeof e!="string"&&(HI.isEncoding===Yie||!Yie(r)))throw new Error("Unknown encoding: "+r);return e||r}Wie.StringDecoder=Wg;function Wg(r){this.encoding=IGe(r);var e;switch(this.encoding){case"utf16le":this.text=RGe,this.end=kGe,e=4;break;case"utf8":this.fillLast=TGe,e=4;break;case"base64":this.text=CGe,this.end=PGe,e=3;break;default:this.write=OGe,this.end=BGe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=HI.allocUnsafe(e)}Wg.prototype.write=function(r){if(r.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(r),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<r.length?e?e+this.text(r,t):this.text(r,t):e||""};Wg.prototype.end=NGe;Wg.prototype.text=DGe;Wg.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function GI(r){return r<=127?0:r>>5==6?2:r>>4==14?3:r>>3==30?4:r>>6==2?-1:-2}function qGe(r,e,t){var i=e.length-1;if(i<t)return 0;var n=GI(e[i]);return n>=0?(n>0&&(r.lastNeed=n-1),n):--i<t||n===-2?0:(n=GI(e[i]),n>=0?(n>0&&(r.lastNeed=n-2),n):--i<t||n===-2?0:(n=GI(e[i]),n>=0?(n>0&&(n===2?n=0:r.lastNeed=n-3),n):0))}function MGe(r,e,t){if((e[0]&192)!=128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return r.lastNeed=2,"\uFFFD"}}function TGe(r){var e=this.lastTotal-this.lastNeed,t=MGe(this,r,e);if(t!==void 0)return t;if(this.lastNeed<=r.length)return r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,e,0,r.length),this.lastNeed-=r.length}function DGe(r,e){var t=qGe(this,r,e);if(!this.lastNeed)return r.toString("utf8",e);this.lastTotal=t;var i=r.length-(t-this.lastNeed);return r.copy(this.lastChar,0,i),r.toString("utf8",e,i)}function NGe(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+"\uFFFD":e}function RGe(r,e){if((r.length-e)%2==0){var t=r.toString("utf16le",e);if(t){var i=t.charCodeAt(t.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",e,r.length-1)}function kGe(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function CGe(r,e){var t=(r.length-e)%3;return t===0?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function PGe(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function OGe(r){return r.toString(this.encoding)}function BGe(r){return r&&r.length?this.write(r):""}});var Lw=p((O3t,Xie)=>{l();"use strict";var Jie=Ul().codes.ERR_STREAM_PREMATURE_CLOSE;function LGe(r){var e=!1;return function(){if(!e){e=!0;for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];r.apply(this,i)}}}function FGe(){}function UGe(r){return r.setHeader&&typeof r.abort=="function"}function Qie(r,e,t){if(typeof e=="function")return Qie(r,null,e);e||(e={}),t=LGe(t||FGe);var i=e.readable||e.readable!==!1&&r.readable,n=e.writable||e.writable!==!1&&r.writable,s=function(){r.writable||a()},o=r._writableState&&r._writableState.finished,a=function(){n=!1,o=!0,i||t.call(r)},c=r._readableState&&r._readableState.endEmitted,u=function(){i=!1,c=!0,n||t.call(r)},f=function(g){t.call(r,g)},h=function(){var g;if(i&&!c)return(!r._readableState||!r._readableState.ended)&&(g=new Jie),t.call(r,g);if(n&&!o)return(!r._writableState||!r._writableState.ended)&&(g=new Jie),t.call(r,g)},d=function(){r.req.on("finish",a)};return UGe(r)?(r.on("complete",a),r.on("abort",h),r.req?d():r.on("request",d)):n&&!r._writableState&&(r.on("end",s),r.on("close",s)),r.on("end",u),r.on("finish",a),e.error!==!1&&r.on("error",f),r.on("close",h),function(){r.removeListener("complete",a),r.removeListener("abort",h),r.removeListener("request",d),r.req&&r.req.removeListener("finish",a),r.removeListener("end",s),r.removeListener("close",s),r.removeListener("finish",a),r.removeListener("end",u),r.removeListener("error",f),r.removeListener("close",h)}}Xie.exports=Qie});var ene=p((B3t,Zie)=>{l();"use strict";var Fw;function df(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var KGe=Lw(),pf=Symbol("lastResolve"),Vl=Symbol("lastReject"),Yg=Symbol("error"),Uw=Symbol("ended"),zl=Symbol("lastPromise"),WI=Symbol("handlePromise"),Hl=Symbol("stream");function yf(r,e){return{value:r,done:e}}function jGe(r){var e=r[pf];if(e!==null){var t=r[Hl].read();t!==null&&(r[zl]=null,r[pf]=null,r[Vl]=null,e(yf(t,!1)))}}function VGe(r){process.nextTick(jGe,r)}function zGe(r,e){return function(t,i){r.then(function(){if(e[Uw]){t(yf(void 0,!0));return}e[WI](t,i)},i)}}var HGe=Object.getPrototypeOf(function(){}),GGe=Object.setPrototypeOf((Fw={get stream(){return this[Hl]},next:function(){var e=this,t=this[Yg];if(t!==null)return Promise.reject(t);if(this[Uw])return Promise.resolve(yf(void 0,!0));if(this[Hl].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[Yg]?a(e[Yg]):o(yf(void 0,!0))})});var i=this[zl],n;if(i)n=new Promise(zGe(i,this));else{var s=this[Hl].read();if(s!==null)return Promise.resolve(yf(s,!1));n=new Promise(this[WI])}return this[zl]=n,n}},df(Fw,Symbol.asyncIterator,function(){return this}),df(Fw,"return",function(){var e=this;return new Promise(function(t,i){e[Hl].destroy(null,function(n){if(n){i(n);return}t(yf(void 0,!0))})})}),Fw),HGe),$Ge=function(e){var t,i=Object.create(GGe,(t={},df(t,Hl,{value:e,writable:!0}),df(t,pf,{value:null,writable:!0}),df(t,Vl,{value:null,writable:!0}),df(t,Yg,{value:null,writable:!0}),df(t,Uw,{value:e._readableState.endEmitted,writable:!0}),df(t,WI,{value:function(s,o){var a=i[Hl].read();a?(i[zl]=null,i[pf]=null,i[Vl]=null,s(yf(a,!1))):(i[pf]=s,i[Vl]=o)},writable:!0}),t));return i[zl]=null,KGe(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[Vl];s!==null&&(i[zl]=null,i[pf]=null,i[Vl]=null,s(n)),i[Yg]=n;return}var o=i[pf];o!==null&&(i[zl]=null,i[pf]=null,i[Vl]=null,o(yf(void 0,!0))),i[Uw]=!0}),e.on("readable",VGe.bind(null,i)),i};Zie.exports=$Ge});var rne=p((N3t,tne)=>{l();tne.exports=function(){throw new Error("Readable.from is not available in the browser")}});var UI=p((q3t,ine)=>{l();"use strict";ine.exports=Lt;var xp;Lt.ReadableState=nne;var D3t=Lr().EventEmitter,sne=function(e,t){return e.listeners(t).length},Xg=CI(),Kw=xt().Buffer,WGe=globalThis.Uint8Array||function(){};function YGe(r){return Kw.from(r)}function XGe(r){return Kw.isBuffer(r)||r instanceof WGe}var YI=PI(),_t;YI&&YI.debuglog?_t=YI.debuglog("stream"):_t=function(){};var JGe=kie(),XI=NI(),QGe=DI(),ZGe=QGe.getHighWaterMark,jw=Ul().codes,e$e=jw.ERR_INVALID_ARG_TYPE,t$e=jw.ERR_STREAM_PUSH_AFTER_EOF,r$e=jw.ERR_METHOD_NOT_IMPLEMENTED,i$e=jw.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Ap,JI,QI;rn()(Lt,Xg);var Jg=XI.errorOrDestroy,ZI=["error","close","destroy","pause","resume"];function n$e(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):Array.isArray(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function nne(r,e,t){xp=xp||Kl(),r=r||{},typeof t!="boolean"&&(t=e instanceof xp),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.readableObjectMode),this.highWaterMark=ZGe(this,r,"readableHighWaterMark",t),this.buffer=new JGe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(Ap||(Ap=$I().StringDecoder),this.decoder=new Ap(r.encoding),this.encoding=r.encoding)}function Lt(r){if(xp=xp||Kl(),!(this instanceof Lt))return new Lt(r);var e=this instanceof xp;this._readableState=new nne(r,this,e),this.readable=!0,r&&(typeof r.read=="function"&&(this._read=r.read),typeof r.destroy=="function"&&(this._destroy=r.destroy)),Xg.call(this)}Object.defineProperty(Lt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Lt.prototype.destroy=XI.destroy;Lt.prototype._undestroy=XI.undestroy;Lt.prototype._destroy=function(r,e){e(r)};Lt.prototype.push=function(r,e){var t=this._readableState,i;return t.objectMode?i=!0:typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=Kw.from(r,e),e=""),i=!0),one(this,r,e,!1,i)};Lt.prototype.unshift=function(r){return one(this,r,null,!0,!1)};function one(r,e,t,i,n){_t("readableAddChunk",e);var s=r._readableState;if(e===null)s.reading=!1,o$e(r,s);else{var o;if(n||(o=s$e(s,e)),o)Jg(r,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==Kw.prototype&&(e=YGe(e)),i)s.endEmitted?Jg(r,new i$e):e8(r,s,e,!0);else if(s.ended)Jg(r,new t$e);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!t?(e=s.decoder.write(e),s.objectMode||e.length!==0?e8(r,s,e,!1):t8(r,s)):e8(r,s,e,!1)}else i||(s.reading=!1,t8(r,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function e8(r,e,t,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,r.emit("data",t)):(e.length+=e.objectMode?1:t.length,i?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&Vw(r)),t8(r,e)}function s$e(r,e){var t;return!XGe(e)&&typeof e!="string"&&e!==void 0&&!r.objectMode&&(t=new e$e("chunk",["string","Buffer","Uint8Array"],e)),t}Lt.prototype.isPaused=function(){return this._readableState.flowing===!1};Lt.prototype.setEncoding=function(r){Ap||(Ap=$I().StringDecoder);var e=new Ap(r);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var t=this._readableState.buffer.head,i="";t!==null;)i+=e.write(t.data),t=t.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var ane=1073741824;function a$e(r){return r>=ane?r=ane:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function cne(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=a$e(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}Lt.prototype.read=function(r){_t("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return _t("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?r8(this):Vw(this),null;if(r=cne(r,e),r===0&&e.ended)return e.length===0&&r8(this),null;var i=e.needReadable;_t("need readable",i),(e.length===0||e.length-r<e.highWaterMark)&&(i=!0,_t("length less than watermark",i)),e.ended||e.reading?(i=!1,_t("reading or ended",i)):i&&(_t("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=cne(t,e)));var n;return r>0?n=une(r,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,r=0):(e.length-=r,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&r8(this)),n!==null&&this.emit("data",n),n};function o$e(r,e){if(_t("onEofChunk"),!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,e.sync?Vw(r):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,fne(r)))}}function Vw(r){var e=r._readableState;_t("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(_t("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(fne,r))}function fne(r){var e=r._readableState;_t("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(r.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,i8(r)}function t8(r,e){e.readingMore||(e.readingMore=!0,process.nextTick(c$e,r,e))}function c$e(r,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var t=e.length;if(_t("maybeReadMore read 0"),r.read(0),t===e.length)break}e.readingMore=!1}Lt.prototype._read=function(r){Jg(this,new r$e("_read()"))};Lt.prototype.pipe=function(r,e){var t=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r);break}i.pipesCount+=1,_t("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&r!==process.stdout&&r!==process.stderr,s=n?a:m;i.endEmitted?process.nextTick(s):t.once("end",s),r.on("unpipe",o);function o(x,_){_t("onunpipe"),x===t&&_&&_.hasUnpiped===!1&&(_.hasUnpiped=!0,f())}function a(){_t("onend"),r.end()}var c=u$e(t);r.on("drain",c);var u=!1;function f(){_t("cleanup"),r.removeListener("close",y),r.removeListener("finish",g),r.removeListener("drain",c),r.removeListener("error",d),r.removeListener("unpipe",o),t.removeListener("end",a),t.removeListener("end",m),t.removeListener("data",h),u=!0,i.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&c()}t.on("data",h);function h(x){_t("ondata");var _=r.write(x);_t("dest.write",_),_===!1&&((i.pipesCount===1&&i.pipes===r||i.pipesCount>1&&lne(i.pipes,r)!==-1)&&!u&&(_t("false write response, pause",i.awaitDrain),i.awaitDrain++),t.pause())}function d(x){_t("onerror",x),m(),r.removeListener("error",d),sne(r,"error")===0&&Jg(r,x)}n$e(r,"error",d);function y(){r.removeListener("finish",g),m()}r.once("close",y);function g(){_t("onfinish"),r.removeListener("close",y),m()}r.once("finish",g);function m(){_t("unpipe"),t.unpipe(r)}return r.emit("pipe",t),i.flowing||(_t("pipe resume"),t.resume()),r};function u$e(r){return function(){var t=r._readableState;_t("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&sne(r,"data")&&(t.flowing=!0,i8(r))}}Lt.prototype.unpipe=function(r){var e=this._readableState,t={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this,t),this);if(!r){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=lne(e.pipes,r);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this,t),this)};Lt.prototype.on=function(r,e){var t=Xg.prototype.on.call(this,r,e),i=this._readableState;return r==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):r==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,_t("on readable",i.length,i.reading),i.length?Vw(this):i.reading||process.nextTick(f$e,this)),t};Lt.prototype.addListener=Lt.prototype.on;Lt.prototype.removeListener=function(r,e){var t=Xg.prototype.removeListener.call(this,r,e);return r==="readable"&&process.nextTick(hne,this),t};Lt.prototype.removeAllListeners=function(r){var e=Xg.prototype.removeAllListeners.apply(this,arguments);return(r==="readable"||r===void 0)&&process.nextTick(hne,this),e};function hne(r){var e=r._readableState;e.readableListening=r.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:r.listenerCount("data")>0&&r.resume()}function f$e(r){_t("readable nexttick read 0"),r.read(0)}Lt.prototype.resume=function(){var r=this._readableState;return r.flowing||(_t("resume"),r.flowing=!r.readableListening,l$e(this,r)),r.paused=!1,this};function l$e(r,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(h$e,r,e))}function h$e(r,e){_t("resume",e.reading),e.reading||r.read(0),e.resumeScheduled=!1,r.emit("resume"),i8(r),e.flowing&&!e.reading&&r.read(0)}Lt.prototype.pause=function(){return _t("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(_t("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function i8(r){var e=r._readableState;for(_t("flow",e.flowing);e.flowing&&r.read()!==null;);}Lt.prototype.wrap=function(r){var e=this,t=this._readableState,i=!1;r.on("end",function(){if(_t("wrapped end"),t.decoder&&!t.ended){var o=t.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),r.on("data",function(o){if(_t("wrapped data"),t.decoder&&(o=t.decoder.write(o)),!(t.objectMode&&o==null)&&!(!t.objectMode&&(!o||!o.length))){var a=e.push(o);a||(i=!0,r.pause())}});for(var n in r)this[n]===void 0&&typeof r[n]=="function"&&(this[n]=function(a){return function(){return r[a].apply(r,arguments)}}(n));for(var s=0;s<ZI.length;s++)r.on(ZI[s],this.emit.bind(this,ZI[s]));return this._read=function(o){_t("wrapped _read",o),i&&(i=!1,r.resume())},this};typeof Symbol=="function"&&(Lt.prototype[Symbol.asyncIterator]=function(){return JI===void 0&&(JI=ene()),JI(this)});Object.defineProperty(Lt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Lt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Lt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Lt._fromList=une;Object.defineProperty(Lt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function une(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.first():t=e.buffer.concat(e.length),e.buffer.clear()):t=e.buffer.consume(r,e.decoder),t}function r8(r){var e=r._readableState;_t("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(d$e,e,r))}function d$e(r,e){if(_t("endReadableNT",r.endEmitted,r.length),!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"),r.autoDestroy)){var t=e._writableState;(!t||t.autoDestroy&&t.finished)&&e.destroy()}}typeof Symbol=="function"&&(Lt.from=function(r,e){return QI===void 0&&(QI=rne()),QI(Lt,r,e)});function lne(r,e){for(var t=0,i=r.length;t<i;t++)if(r[t]===e)return t;return-1}});var n8=p((M3t,dne)=>{l();"use strict";dne.exports=Jc;var zw=Ul().codes,p$e=zw.ERR_METHOD_NOT_IMPLEMENTED,y$e=zw.ERR_MULTIPLE_CALLBACK,g$e=zw.ERR_TRANSFORM_ALREADY_TRANSFORMING,b$e=zw.ERR_TRANSFORM_WITH_LENGTH_0,Hw=Kl();rn()(Jc,Hw);function m$e(r,e){var t=this._transformState;t.transforming=!1;var i=t.writecb;if(i===null)return this.emit("error",new y$e);t.writechunk=null,t.writecb=null,e!=null&&this.push(e),i(r);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function Jc(r){if(!(this instanceof Jc))return new Jc(r);Hw.call(this,r),this._transformState={afterTransform:m$e.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",v$e)}function v$e(){var r=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,t){pne(r,e,t)}):pne(this,null,null)}Jc.prototype.push=function(r,e){return this._transformState.needTransform=!1,Hw.prototype.push.call(this,r,e)};Jc.prototype._transform=function(r,e,t){t(new p$e("_transform()"))};Jc.prototype._write=function(r,e,t){var i=this._transformState;if(i.writecb=t,i.writechunk=r,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};Jc.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Jc.prototype._destroy=function(r,e){Hw.prototype._destroy.call(this,r,function(t){e(t)})};function pne(r,e,t){if(e)return r.emit("error",e);if(t!=null&&r.push(t),r._writableState.length)throw new b$e;if(r._transformState.transforming)throw new g$e;return r.push(null)}});var bne=p((L3t,yne)=>{l();"use strict";yne.exports=Qg;var gne=n8();rn()(Qg,gne);function Qg(r){if(!(this instanceof Qg))return new Qg(r);gne.call(this,r)}Qg.prototype._transform=function(r,e,t){t(null,r)}});var Ene=p((F3t,mne)=>{l();"use strict";var s8;function w$e(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var vne=Ul().codes,_$e=vne.ERR_MISSING_ARGS,E$e=vne.ERR_STREAM_DESTROYED;function wne(r){if(r)throw r}function S$e(r){return r.setHeader&&typeof r.abort=="function"}function x$e(r,e,t,i){i=w$e(i);var n=!1;r.on("close",function(){n=!0}),s8===void 0&&(s8=Lw()),s8(r,{readable:e,writable:t},function(o){if(o)return i(o);n=!0,i()});var s=!1;return function(o){if(!n&&!s){if(s=!0,S$e(r))return r.abort();if(typeof r.destroy=="function")return r.destroy();i(o||new E$e("pipe"))}}}function _ne(r){r()}function A$e(r,e){return r.pipe(e)}function I$e(r){return!r.length||typeof r[r.length-1]!="function"?wne:r.pop()}function T$e(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var i=I$e(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new _$e("streams");var n,s=e.map(function(o,a){var c=a<e.length-1,u=a>0;return x$e(o,c,u,function(f){n||(n=f),f&&s.forEach(_ne),!c&&(s.forEach(_ne),i(n))})});return e.reduce(A$e)}mne.exports=T$e});var o8=p((co,Sne)=>{l();co=Sne.exports=UI();co.Stream=co;co.Readable=co;co.Writable=FI();co.Duplex=Kl();co.Transform=n8();co.PassThrough=bne();co.finished=Lw();co.pipeline=Ene()});var Ine=p((U3t,xne)=>{l();"use strict";var R$e=rn(),{Readable:Ane}=o8();xne.exports=Ip;R$e(Ip,Ane);function Ip(r,e){if(!(this instanceof Ip))return new Ip(r,e);e=e||{},Ane.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=r,this._options=e,this.on("end",this.destroy.bind(this,null,null))}Ip.prototype._read=function(){this.destroyed||this._iterator.next((r,e,t)=>{if(!this.destroyed){if(r)return this.destroy(r);e===void 0&&t===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(t):this.push({key:e,value:t})}})};Ip.prototype._destroy=function(r,e){this._iterator.end(function(t){e(r||t)})}});var Rne=p((Tne,Gw)=>{l();(function(r,e,t){typeof Gw!="undefined"&&Gw.exports?Gw.exports=t():e[r]=t()})("prr",Tne,function(){var r=typeof Object.defineProperty=="function"?function(i,n,s){return Object.defineProperty(i,n,s),i}:function(i,n,s){return i[n]=s.value,i},e=function(i,n){var s=typeof n=="object",o=!s&&typeof n=="string",a=function(c){return s?!!n[c]:o?n.indexOf(c[0])>-1:!1};return{enumerable:a("enumerable"),configurable:a("configurable"),writable:a("writable"),value:i}},t=function(i,n,s,o){var a;if(o=e(s,o),typeof n=="object"){for(a in n)Object.hasOwnProperty.call(n,a)&&(o.value=n[a],r(i,a,o));return i}return r(i,n,o)};return t})});var Pne=p((K3t,kne)=>{l();var k$e=Rne();function Cne(r,e,t){!!e&&typeof e!="string"&&(e=e.message||e.name),k$e(this,{type:r,name:r,cause:typeof e!="string"?e:t,message:e},"ewr")}function a8(r,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),Cne.call(this,"CustomError",r,e)}a8.prototype=new Error;function C$e(r,e,t){var i=function(n,s){Cne.call(this,e,n,s),e=="FilesystemError"&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(r.errno[this.cause.errno]?r.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,i)};return i.prototype=t?new t:new a8,i}kne.exports=function(r){var e=function(t,i){return C$e(r,t,i)};return{CustomError:a8,FilesystemError:e("FilesystemError"),createError:e}}});var One=p((j3t,sc)=>{l();var P$e=sc.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];sc.exports.errno={};sc.exports.code={};P$e.forEach(function(r){sc.exports.errno[r.errno]=r,sc.exports.code[r.code]=r});sc.exports.custom=Pne()(sc.exports);sc.exports.create=sc.exports.custom.createError});var $w=p((V3t,Bne)=>{l();"use strict";var Gl=One().create,$l=Gl("LevelUPError"),c8=Gl("NotFoundError",$l);c8.prototype.notFound=!0;c8.prototype.status=404;Bne.exports={LevelUPError:$l,InitializationError:Gl("InitializationError",$l),OpenError:Gl("OpenError",$l),ReadError:Gl("ReadError",$l),WriteError:Gl("WriteError",$l),NotFoundError:c8,EncodingError:Gl("EncodingError",$l)}});var f8=p(u8=>{l();"use strict";u8.fromCallback=function(r){if(r===void 0){var e=new Promise(function(t,i){r=function(n,s){n?i(n):t(s)}});r.promise=e}return r};u8.fromPromise=function(r,e){if(e===void 0)return r;r.then(function(t){process.nextTick(e,null,t)}).catch(function(t){process.nextTick(e,t)})}});var Zg=p(l8=>{l();"use strict";l8.getCallback=function(r,e){return typeof r=="function"?r:e};l8.getOptions=function(r){return typeof r=="object"&&r!==null?r:{}}});var Dne=p((G3t,Nne)=>{l();"use strict";var e1=$w().WriteError,O$e=f8(),B$e=Zg().getCallback,N$e=Zg().getOptions;function t1(r){this.db=r,this.batch=r.db.batch(),this.ops=[],this.length=0}t1.prototype.put=function(r,e,t){try{this.batch.put(r,e,t)}catch(i){throw new e1(i)}return this.ops.push({...t,type:"put",key:r,value:e}),this.length++,this};t1.prototype.del=function(r,e){try{this.batch.del(r,e)}catch(t){throw new e1(t)}return this.ops.push({...e,type:"del",key:r}),this.length++,this};t1.prototype.clear=function(){try{this.batch.clear()}catch(r){throw new e1(r)}return this.ops=[],this.length=0,this};t1.prototype.write=function(r,e){let t=this.db,i=this.ops;e=B$e(r,e),e=O$e.fromCallback(e),r=N$e(r);try{this.batch.write(r,function(n){if(n)return e(new e1(n));t.emit("batch",i),e()})}catch(n){throw new e1(n)}return e.promise};Nne.exports=t1});var Lne=p(($3t,qne)=>{l();"use strict";var Mne=Rw();qne.exports=function(r,...e){e.length===0?Mne(r):Mne(()=>r(...e))}});var jne=p((W3t,Fne)=>{l();"use strict";var Ww=Lr().EventEmitter,D$e=iie().inherits,Une=xie(),q$e=Ine(),M$e=Dne(),Tp=$w(),L$e=II(),Wl=f8(),r1=Zg().getCallback,Rp=Zg().getOptions,Yw=Lne(),Xw=Tp.WriteError,Kne=Tp.ReadError,F$e=Tp.NotFoundError,U$e=Tp.OpenError,K$e=Tp.InitializationError;function Ir(r,e,t){if(!(this instanceof Ir))return new Ir(r,e,t);let i;if(Ww.call(this),this.setMaxListeners(Infinity),typeof e=="function"&&(t=e,e={}),e=e||{},!r||typeof r!="object"){if(i=new K$e("First argument must be an abstract-leveldown compliant store"),typeof t=="function")return Yw(t,i);throw i}if(typeof r.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=Rp(e),this._db=r,this.db=new Une(r),this.open(t||(n=>{n&&this.emit("error",n)})),this.supports=L$e(this.db.supports,{status:!1,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let n of Object.keys(this.supports.additionalMethods))this[n]==null&&(this[n]=function(...s){return this.db[n](...s)})}Ir.prototype.emit=Ww.prototype.emit;Ir.prototype.once=Ww.prototype.once;D$e(Ir,Ww);Ir.prototype.open=function(r,e){return typeof r=="function"&&(e=r,r=null),e=Wl.fromCallback(e),r||(r=this.options),this.isOpen()?(Yw(e,null,this),e.promise):this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.emit("opening"),this.db.open(r,t=>{if(t)return e(new U$e(t));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};Ir.prototype.close=function(r){return r=Wl.fromCallback(r),this.isOpen()?(this.db.close((e,...t)=>{this.emit("closed"),r(e,...t)}),this.emit("closing"),this.db=new Une(this._db)):this.isClosed()?Yw(r):this.db.status==="closing"?this.once("closed",r):this._isOpening()&&this.once("open",()=>{this.close(r)}),r.promise};Ir.prototype.isOpen=function(){return this.db.status==="open"};Ir.prototype._isOpening=function(){return this.db.status==="opening"};Ir.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};Ir.prototype.get=function(r,e,t){return t=r1(e,t),t=Wl.fromCallback(t),i1(this,t)||(e=Rp(e),this.db.get(r,e,function(i,n){if(i)return/notfound/i.test(i)||i.notFound?i=new F$e("Key not found in database ["+r+"]",i):i=new Kne(i),t(i);t(null,n)})),t.promise};Ir.prototype.put=function(r,e,t,i){return i=r1(t,i),i=Wl.fromCallback(i),i1(this,i)||(t=Rp(t),this.db.put(r,e,t,n=>{if(n)return i(new Xw(n));this.emit("put",r,e),i()})),i.promise};Ir.prototype.del=function(r,e,t){return t=r1(e,t),t=Wl.fromCallback(t),i1(this,t)||(e=Rp(e),this.db.del(r,e,i=>{if(i)return t(new Xw(i));this.emit("del",r),t()})),t.promise};Ir.prototype.batch=function(r,e,t){return arguments.length?(typeof r=="function"?t=r:t=r1(e,t),t=Wl.fromCallback(t),i1(this,t)||(e=Rp(e),this.db.batch(r,e,i=>{if(i)return t(new Xw(i));this.emit("batch",r),t()})),t.promise):new M$e(this)};Ir.prototype.iterator=function(r){return this.db.iterator(r)};Ir.prototype.clear=function(r,e){return e=r1(r,e),r=Rp(r),e=Wl.fromCallback(e),i1(this,e)||this.db.clear(r,t=>{if(t)return e(new Xw(t));this.emit("clear",r),e()}),e.promise};Ir.prototype.readStream=Ir.prototype.createReadStream=function(r){return r=Object.assign({keys:!0,values:!0},r),typeof r.limit!="number"&&(r.limit=-1),new q$e(this.db.iterator(r),r)};Ir.prototype.keyStream=Ir.prototype.createKeyStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!0,values:!1}))};Ir.prototype.valueStream=Ir.prototype.createValueStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!1,values:!0}))};Ir.prototype.toString=function(){return"LevelUP"};Ir.prototype.type="levelup";function i1(r,e){if(!r._isOpening()&&!r.isOpen())return Yw(e,new Kne("Database is not open")),!0}Ir.errors=Tp;Fne.exports=Ir});var Vne=p(Qc=>{l();"use strict";var{Buffer:h8}=xt();Qc.utf8=Qc["utf-8"]={encode:function(r){return d8(r)?r:String(r)},decode:Jw,buffer:!1,type:"utf8"};Qc.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};Qc.binary={encode:function(r){return d8(r)?r:h8.from(r)},decode:Jw,buffer:!0,type:"binary"};Qc.none={encode:Jw,decode:Jw,buffer:!1,type:"id"};Qc.id=Qc.none;var j$e=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let r of j$e)Qc[r]={encode:function(e){return d8(e)?e:h8.from(e,r)},decode:function(e){return e.toString(r)},buffer:!0,type:r};function Jw(r){return r}function d8(r){return r==null||h8.isBuffer(r)}});var Hne=p((X3t,zne)=>{l();"use strict";var p8=Vne(),V$e=new Set(["lt","gt","lte","gte"]);zne.exports=Bn;function Bn(r){if(!(this instanceof Bn))return new Bn(r);this.opts=r||{},this.encodings=p8}Bn.prototype._encoding=function(r){return typeof r=="string"&&(r=p8[r]),r||(r=p8.id),r};Bn.prototype._keyEncoding=function(r,e){return this._encoding(e&&e.keyEncoding||r&&r.keyEncoding||this.opts.keyEncoding)};Bn.prototype._valueEncoding=function(r,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||r&&(r.valueEncoding||r.encoding)||this.opts.valueEncoding||this.opts.encoding)};Bn.prototype.encodeKey=function(r,e,t){return this._keyEncoding(e,t).encode(r)};Bn.prototype.encodeValue=function(r,e,t){return this._valueEncoding(e,t).encode(r)};Bn.prototype.decodeKey=function(r,e){return this._keyEncoding(e).decode(r)};Bn.prototype.decodeValue=function(r,e){return this._valueEncoding(e).decode(r)};Bn.prototype.encodeBatch=function(r,e){return r.map(t=>{let i={type:t.type,key:this.encodeKey(t.key,e,t)};return this.keyAsBuffer(e,t)&&(i.keyEncoding="binary"),t.prefix&&(i.prefix=t.prefix),"value"in t&&(i.value=this.encodeValue(t.value,e,t),this.valueAsBuffer(e,t)&&(i.valueEncoding="binary")),i})};Bn.prototype.encodeLtgt=function(r){let e={};for(let t of Object.keys(r)){if(t==="start"||t==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[t]=V$e.has(t)?this.encodeKey(r[t],r):r[t]}return e};Bn.prototype.createStreamDecoder=function(r){return r.keys&&r.values?(e,t)=>({key:this.decodeKey(e,r),value:this.decodeValue(t,r)}):r.keys?e=>this.decodeKey(e,r):r.values?(e,t)=>this.decodeValue(t,r):function(){}};Bn.prototype.keyAsBuffer=function(r){return this._keyEncoding(r).buffer};Bn.prototype.valueAsBuffer=function(r){return this._valueEncoding(r).buffer}});var Jne=p((J3t,Gne)=>{l();"use strict";var $ne=lf().AbstractLevelDOWN,Wne=lf().AbstractChainedBatch,Yne=lf().AbstractIterator,y8=rn(),z$e=Hne(),Xne=$w().EncodingError,H$e=["approximateSize","compactRange"];Gne.exports=wn;function wn(r,e){if(!(this instanceof wn))return new wn(r,e);let t=r.supports||{},i=t.additionalMethods||{};$ne.call(this,t),this.supports.encodings=!0,this.supports.additionalMethods={},H$e.forEach(function(n){let s=typeof r[n]=="function";(i[n]||s)&&(this.supports.additionalMethods[n]=!0,this[n]=function(o,a,c,u){return o=this.codec.encodeKey(o,c),a=this.codec.encodeKey(a,c),this.db[n](o,a,c,u)})},this),e=e||{},typeof e.keyEncoding=="undefined"&&(e.keyEncoding="utf8"),typeof e.valueEncoding=="undefined"&&(e.valueEncoding="utf8"),this.db=r,this.codec=new z$e(e)}y8(wn,$ne);wn.prototype.type="encoding-down";wn.prototype._serializeKey=wn.prototype._serializeValue=function(r){return r};wn.prototype._open=function(r,e){this.db.open(r,e)};wn.prototype._close=function(r){this.db.close(r)};wn.prototype._put=function(r,e,t,i){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.db.put(r,e,t,i)};wn.prototype._get=function(r,e,t){r=this.codec.encodeKey(r,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(r,e,(i,n)=>{if(i)return t(i);try{n=this.codec.decodeValue(n,e)}catch(s){return t(new Xne(s))}t(null,n)})};wn.prototype._del=function(r,e,t){r=this.codec.encodeKey(r,e),this.db.del(r,e,t)};wn.prototype._chainedBatch=function(){return new kp(this)};wn.prototype._batch=function(r,e,t){r=this.codec.encodeBatch(r,e),this.db.batch(r,e,t)};wn.prototype._iterator=function(r){return r.keyAsBuffer=this.codec.keyAsBuffer(r),r.valueAsBuffer=this.codec.valueAsBuffer(r),new n1(this,r)};wn.prototype._clear=function(r,e){r=this.codec.encodeLtgt(r),this.db.clear(r,e)};function n1(r,e){Yne.call(this,r),this.codec=r.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=r.db.iterator(this.opts)}y8(n1,Yne);n1.prototype._next=function(r){this.it.next((e,t,i)=>{if(e)return r(e);try{this.keys&&typeof t!="undefined"?t=this.codec.decodeKey(t,this.opts):t=void 0,this.values&&typeof i!="undefined"?i=this.codec.decodeValue(i,this.opts):i=void 0}catch(n){return r(new Xne(n))}r(null,t,i)})};n1.prototype._seek=function(r){r=this.codec.encodeKey(r,this.opts),this.it.seek(r)};n1.prototype._end=function(r){this.it.end(r)};function kp(r,e){Wne.call(this,r),this.codec=r.codec,this.batch=r.db.batch()}y8(kp,Wne);kp.prototype._put=function(r,e,t){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.batch.put(r,e)};kp.prototype._del=function(r,e){r=this.codec.encodeKey(r,e),this.batch.del(r)};kp.prototype._clear=function(){this.batch.clear()};kp.prototype._write=function(r,e){this.batch.write(r,e)}});var ese=p((Q3t,Qne)=>{l();"use strict";var Zne=jne(),G$e=Jne();function $$e(r){function e(i,n,s){return typeof i=="function"?s=i:typeof n=="function"&&(s=n),t(n)||(n=t(i)?i:{}),Zne(G$e(r(i,n),n),n,s)}function t(i){return typeof i=="object"&&i!==null}for(let i of["destroy","repair"])typeof r[i]=="function"&&(e[i]=function(...n){r[i](...n)});return e.errors=Zne.errors,e}Qne.exports=$$e});var rse=p(oi=>{l();oi.compare=function(r,e){if(Buffer.isBuffer(r)){for(var t=Math.min(r.length,e.length),i=0;i<t;i++){var n=r[i]-e[i];if(n)return n}return r.length-e.length}return r<e?-1:r>e?1:0};function tse(r){return r!==void 0&&r!==""}function Cp(r,e){return Object.hasOwnProperty.call(r,e)}function oc(r,e){return Object.hasOwnProperty.call(r,e)&&e}var W$e=oi.lowerBoundKey=function(r){return oc(r,"gt")||oc(r,"gte")||oc(r,"min")||(r.reverse?oc(r,"end"):oc(r,"start"))||void 0},g8=oi.lowerBound=function(r,e){var t=W$e(r);return t?r[t]:e},b8=oi.lowerBoundInclusive=function(r){return!Cp(r,"gt")},m8=oi.upperBoundInclusive=function(r){return!Cp(r,"lt")},Y$e=oi.lowerBoundExclusive=function(r){return!b8(r)},X$e=oi.upperBoundExclusive=function(r){return!m8(r)},J$e=oi.upperBoundKey=function(r){return oc(r,"lt")||oc(r,"lte")||oc(r,"max")||(r.reverse?oc(r,"start"):oc(r,"end"))||void 0},v8=oi.upperBound=function(r,e){var t=J$e(r);return t?r[t]:e};oi.start=function(r,e){return r.reverse?v8(r,e):g8(r,e)};oi.end=function(r,e){return r.reverse?g8(r,e):v8(r,e)};oi.startInclusive=function(r){return r.reverse?m8(r):b8(r)};oi.endInclusive=function(r){return r.reverse?b8(r):m8(r)};function Q$e(r){return r}oi.toLtgt=function(r,e,t,i,n){e=e||{},t=t||Q$e;var s=arguments.length>3,o=oi.lowerBoundKey(r),a=oi.upperBoundKey(r);return o?o==="gt"?e.gt=t(r.gt,!1):e.gte=t(r[o],!1):s&&(e.gte=t(i,!1)),a?a==="lt"?e.lt=t(r.lt,!0):e.lte=t(r[a],!0):s&&(e.lte=t(n,!0)),r.reverse!=null&&(e.reverse=!!r.reverse),Cp(e,"max")&&delete e.max,Cp(e,"min")&&delete e.min,Cp(e,"start")&&delete e.start,Cp(e,"end")&&delete e.end,e};oi.contains=function(r,e,t){t=t||oi.compare;var i=g8(r);if(tse(i)){var n=t(e,i);if(n<0||n===0&&Y$e(r))return!1}var s=v8(r);if(tse(s)){var n=t(e,s);if(n>0||n===0&&X$e(r))return!1}return!0};oi.filter=function(r,e){return function(t){return oi.contains(r,t,e)}}});var w8=p((eSt,ise)=>{l();"use strict";var Qw=rse(),gf=Symbol("none");ise.exports=function(e){let t=Qw.lowerBound(e,gf),i=Qw.upperBound(e,gf),n=Qw.lowerBoundExclusive(e,gf),s=Qw.upperBoundExclusive(e,gf);return t!==gf&&i!==gf?IDBKeyRange.bound(t,i,n,s):t!==gf?IDBKeyRange.lowerBound(t,n):i!==gf?IDBKeyRange.upperBound(i,s):null}});var _8=p((tSt,nse)=>{l();"use strict";var Zw=xt().Buffer,Z$e=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return sse(e).toString()}}(),eWe=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return Zw.from(e).toString()}}();function sse(r){let e=Zw.from(r.buffer);return r.byteLength===r.buffer.byteLength?e:e.slice(r.byteOffset,r.byteOffset+r.byteLength)}nse.exports=function(r,e){return r instanceof Uint8Array?e?sse(r):Z$e(r):r instanceof ArrayBuffer?e?Zw.from(r):eWe(r):e?Zw.from(String(r)):String(r)}});var use=p((rSt,ose)=>{l();"use strict";var tWe=rn(),ase=lf().AbstractIterator,rWe=w8(),cse=_8(),iWe=function(){};ose.exports=ea;function ea(r,e,t){if(ase.call(this,r),this._limit=t.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=t.keys,this._values=t.values,this._keyAsBuffer=t.keyAsBuffer,this._valueAsBuffer=t.valueAsBuffer,this._limit===0){this._completed=!0;return}let i;try{i=rWe(t)}catch(n){this._completed=!0;return}this.createIterator(e,i,t.reverse)}tWe(ea,ase);ea.prototype.createIterator=function(r,e,t){let i=this.db.db.transaction([r],"readonly"),s=i.objectStore(r).openCursor(e,t?"prev":"next");s.onsuccess=o=>{let a=o.target.result;a&&this.onItem(a)},this._transaction=i,i.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},i.oncomplete=()=>{this.onComplete()}};ea.prototype.onItem=function(r){this._cache.push(r.key,r.value),(this._limit<=0||++this._count<this._limit)&&r.continue(),this.maybeNext()};ea.prototype.onAbort=function(r){this._aborted=!0,this._error=r,this.maybeNext()};ea.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};ea.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};ea.prototype._next=function(r){if(this._aborted){let e=this._error;this._error=null,this._nextTick(r,e)}else if(this._cache.length>0){let e=this._cache.shift(),t=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&t!==void 0?t=this._deserializeValue(t,this._valueAsBuffer):t=void 0,this._nextTick(r,null,e,t)}else this._completed?this._nextTick(r):this._callback=r};ea.prototype._deserializeKey=cse;ea.prototype._deserializeValue=cse;ea.prototype._end=function(r){if(this._aborted||this._completed)return this._nextTick(r,this._error);this.onItem=iWe,this.onAbort=r,this.onComplete=r}});var hse=p((iSt,fse)=>{l();"use strict";var lse=xt().Buffer,nWe=function(){if(globalThis.TextEncoder){let r=new TextEncoder("utf-8");return r.encode.bind(r)}else return lse.from}();fse.exports=function(r,e){return e?lse.isBuffer(r)?r:nWe(String(r)):String(r)}});var dse=p(e_=>{l();"use strict";var sWe=xt().Buffer;e_.test=function(r){return function(t){try{return t.cmp(r,0),!0}catch(i){return!1}}};e_.bufferKeys=e_.test(sWe.alloc(0))});var yse=p((sSt,pse)=>{l();"use strict";pse.exports=function(e,t,i,n,s){if(n.limit===0)return e._nextTick(s);let o=e.db.transaction([t],"readwrite"),a=o.objectStore(t),c=0;o.oncomplete=function(){s()},o.onabort=function(){s(o.error||new Error("aborted by user"))};let u=a.openKeyCursor?"openKeyCursor":"openCursor",f=n.reverse?"prev":"next";a[u](i,f).onsuccess=function(h){let d=h.target.result;d&&(a.delete(d.key).onsuccess=function(){(n.limit<=0||++c<n.limit)&&d.continue()})}}});var wse=p((oSt,gse)=>{l();"use strict";gse.exports=Ai;var bse=lf().AbstractLevelDOWN,oWe=rn(),aWe=use(),mse=hse(),E8=_8(),cWe=dse(),uWe=yse(),fWe=w8(),vse="level-js-";function Ai(r,e){if(!(this instanceof Ai))return new Ai(r,e);if(bse.call(this,{bufferKeys:cWe.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0}),e=e||{},typeof r!="string")throw new Error("constructor requires a location string argument");this.location=r,this.prefix=e.prefix==null?vse:e.prefix,this.version=parseInt(e.version||1,10)}oWe(Ai,bse);Ai.prototype.type="level-js";Ai.prototype._open=function(r,e){let t=indexedDB.open(this.prefix+this.location,this.version);t.onerror=function(){e(t.error||new Error("unknown error"))},t.onsuccess=()=>{this.db=t.result,e()},t.onupgradeneeded=i=>{let n=i.target.result;n.objectStoreNames.contains(this.location)||n.createObjectStore(this.location)}};Ai.prototype.store=function(r){return this.db.transaction([this.location],r).objectStore(this.location)};Ai.prototype.await=function(r,e){let t=r.transaction;t.onabort=function(){e(t.error||new Error("aborted by user"))},t.oncomplete=function(){e(null,r.result)}};Ai.prototype._get=function(r,e,t){let i=this.store("readonly"),n;try{n=i.get(r)}catch(s){return this._nextTick(t,s)}this.await(n,function(s,o){if(s)return t(s);if(o===void 0)return t(new Error("NotFound"));t(null,E8(o,e.asBuffer))})};Ai.prototype._del=function(r,e,t){let i=this.store("readwrite"),n;try{n=i.delete(r)}catch(s){return this._nextTick(t,s)}this.await(n,t)};Ai.prototype._put=function(r,e,t,i){let n=this.store("readwrite"),s;try{s=n.put(e,r)}catch(o){return this._nextTick(i,o)}this.await(s,i)};Ai.prototype._serializeKey=function(r){return mse(r,this.supports.bufferKeys)};Ai.prototype._serializeValue=function(r){return mse(r,!0)};Ai.prototype._iterator=function(r){return new aWe(this,this.location,r)};Ai.prototype._batch=function(r,e,t){if(r.length===0)return this._nextTick(t);let i=this.store("readwrite"),n=i.transaction,s=0,o;n.onabort=function(){t(o||n.error||new Error("aborted by user"))},n.oncomplete=function(){t()};function a(){let c=r[s++],u=c.key,f;try{f=c.type==="del"?i.delete(u):i.put(c.value,u)}catch(h){o=h,n.abort();return}s<r.length&&(f.onsuccess=a)}a()};Ai.prototype._clear=function(r,e){let t,i;try{t=fWe(r)}catch(n){return this._nextTick(e)}if(r.limit>=0)return uWe(this,this.location,t,r,e);try{let n=this.store("readwrite");i=t?n.delete(t):n.clear()}catch(n){return this._nextTick(e,n)}this.await(i,e)};Ai.prototype._close=function(r){this.db.close(),this._nextTick(r)};Ai.prototype.upgrade=function(r){if(this.status!=="open")return this._nextTick(r,new Error("cannot upgrade() before open()"));let e=this.iterator(),t={},i=this;e._deserializeKey=e._deserializeValue=a,n();function n(c){if(c)return o(c);e.next(s)}function s(c,u,f){if(c||u===void 0)return o(c);let h=i._serializeKey(E8(u,!0)),d=i._serializeValue(E8(f,!0));i._batch([{type:"del",key:u},{type:"put",key:h,value:d}],t,n)}function o(c){e.end(function(u){r(c||u)})}function a(c){return c}};Ai.destroy=function(r,e,t){typeof e=="function"&&(t=e,e=vse);let i=indexedDB.deleteDatabase(e+r);i.onsuccess=function(){t()},i.onerror=function(n){t(n)}}});var Ese=p((aSt,_se)=>{l();_se.exports=ese()(wse())});var Pp=p((cSt,Sse)=>{l();"use strict";var{Key:lWe,Errors:s1,Adapter:hWe,utils:{sortAll:xse}}=ir(),t_=hl(),dWe=$c(),Ase=y2(),Ise=class extends hWe{constructor(e,t){super();this.path=e,this.opts=t,t&&t.db?(this.database=t.db,delete t.db):this.database=Ese()}_initDb(){return new Promise((e,t)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},i=>{if(i)return t(i);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw s1.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(i){throw s1.dbWriteFailedError(i)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(i){throw i.notFound?s1.notFoundError(i):s1.dbWriteFailedError(i)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw s1.dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(t,i)=>{e.push({type:"put",key:t.toString(),value:i})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>t_(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>xse(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=t_(t,()=>s++>=i)}return n&&(t=Ase(t,n)),t}queryKeys(e){let t=dWe(this._query({values:!1,prefix:e.prefix}),({key:s})=>s);Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>t_(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>xse(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=t_(t,()=>s++>=i)}return n&&(t=Ase(t,n)),t}_query(e){let t={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let i=e.prefix.toString();t.gte=i,t.lt=i+"\xFF"}return pWe(this.db.iterator(t))}};function pWe(r){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,t)=>{r.next((i,n,s)=>{if(i)return t(i);if(n==null)return r.end(o=>{if(o)return t(o);e({done:!0,value:void 0})});e({done:!1,value:{key:new lWe(n,!1),value:s}})})}),return:()=>new Promise((e,t)=>{r.end(i=>{if(i)return t(i);e({done:!0,value:void 0})})})}}}}Sse.exports=Ise});var Rse=p((uSt,Tse)=>{l();"use strict";Tse.exports={autoMigrate:!0,onMigrationProgress:()=>{},lock:"memory",storageBackends:{root:Pp(),blocks:Pp(),keys:Pp(),datastore:Pp(),pins:Pp()},storageBackendOptions:{root:{extension:"",prefix:"",version:2},blocks:{sharding:!1,prefix:"",version:2},keys:{sharding:!1,prefix:"",version:2},datastore:{sharding:!1,prefix:"",version:2},pins:{sharding:!1,prefix:"",version:2}}}});var Cse=p((fSt,kse)=>{l();"use strict";kse.exports={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}}});var x8=p(S8=>{l();"use strict";var yWe=nw(),gWe=xe(),Pse=gWe("ipfs:repo:lock"),Ose="repo.lock",o1={};S8.lock=async r=>{let e=r+"/"+Ose;if(Pse("locking %s",e),o1[e]===!0)throw new yWe.LockExistsError(`Lock already being held for file: ${e}`);return o1[e]=!0,{async close(){o1[e]&&delete o1[e]}}};S8.locked=async r=>{let e=r+"/"+Ose;return Pse(`checking lock: ${e}`),Boolean(o1[e])}});var n_=p((hSt,a1)=>{l();"use strict";var Bse=A5(),bWe=xe(),Op=ge(),Nse=mte(),mWe=_te(),r_=Ste(),vWe=Gr(),i_=Ate(),c1=Tte(),wWe=kte(),_We=Ote(),EWe=Lte(),SWe=Ute(),xWe=Hte(),AWe=$te(),IWe=Rse(),Dse=Cse(),Zc=nw(),rs=bWe("ipfs:repo"),TWe=Number.MAX_SAFE_INTEGER,RWe="repoAutoMigrate",qse={memory:x8(),fs:x8()},Mse=class{constructor(e,t={}){if(typeof e!="string")throw new Error("missing repoPath");this.options=vWe(IWe,t),this.closed=!0,this.path=e,this._locker=this._getLocker(),this.root=c1.create("root",this.path,this.options),this.datastore=c1.create("datastore",r_(this.path,"datastore"),this.options),this.keys=c1.create("keys",r_(this.path,"keys"),this.options),this.pins=c1.create("pins",r_(this.path,"pins"),this.options);let i=c1.create("blocks",r_(this.path,"blocks"),this.options),n=xWe(i,this.options.storageBackendOptions.blocks);this.blocks=AWe(n),this.version=wWe(this.root),this.config=_We(this.root),this.spec=EWe(this.root),this.apiAddr=SWe(this.root)}async init(e){rs("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(kWe(e)),await this.spec.set(CWe(e)),await this.version.set(i_.repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw Op(new Error("repo is already open"),Zc.ERR_REPO_ALREADY_OPEN);rs("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this.lockfile=await this._openLock(this.path),rs("acquired repo.lock"),!await this.version.check(i_.repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(i_.repoVersion);else throw new Zc.InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");rs("creating datastore"),await this.datastore.open(),rs("creating blocks"),this.blocks.open(),rs("creating keystore"),await this.keys.open(),rs("creating pins"),await this.pins.open(),this.closed=!1,rs("all opened")}catch(e){if(this.lockfile)try{await this._closeLock(),this.lockfile=null}catch(t){rs("error removing lock",t)}throw e}}_getLocker(){if(typeof this.options.lock=="string"){if(!qse[this.options.lock])throw new Error("Unknown lock type: "+this.options.lock);return qse[this.options.lock]}if(!this.options.lock)throw new Error("No lock provided");return this.options.lock}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(e){let t=await this._locker.lock(e);if(typeof t.close!="function")throw Op(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return t}_closeLock(){return this.lockfile&&this.lockfile.close()}async _checkInitialized(){rs("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?Op(new Error("repo is not initialized yet"),Zc.ERR_REPO_NOT_INITIALIZED,{path:this.path}):t}if(!e)throw Op(new Error("repo is not initialized yet"),Zc.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw Op(new Error("repo is already closed"),Zc.ERR_REPO_ALREADY_CLOSED);rs("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Zc.ERR_REPO_NOT_INITIALIZED&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins].map(e=>e&&e.close())),rs("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,i,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),Lse(this.datastore),Lse(this.keys)]),o=t.size+n+s;return{repoPath:this.path,storageMax:e,version:i,numObjects:t.count,repoSize:o}}throw Op(new Error("repo is not initialized yet"),Zc.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(RWe)}catch(t){if(t.code===Zc.NotFoundError.code)e=!0;else throw t}return e}async _migrate(e){return await this.version.get()>e?(rs(`reverting to version ${e}`),Nse.revert(this.path,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(rs(`migrating to version ${e}`),Nse.migrate(this.path,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt(mWe(e))}catch(e){return BigInt(TWe)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let i of this.blocks.query({})){let n=i;e+=BigInt(1),t+=BigInt(n.data.byteLength),t+=BigInt(n.cid.bytes.byteLength)}return{count:e,size:t}}};async function Lse(r){let e=BigInt(0);for await(let t of r.query({}))e+=BigInt(t.value.byteLength),e+=BigInt(t.key.uint8Array().byteLength);return e}a1.exports=Mse;a1.exports.utils={blockstore:tI()};a1.exports.repoVersion=i_.repoVersion;a1.exports.errors=Zc;function kWe(r){return r.Datastore=Object.assign({},Dse,Bse(r,"datastore")),r}function CWe(r){let e={...Dse.Spec,...Bse(r,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}});var Use=p((dSt,Fse)=>{l();"use strict";var{repoVersion:PWe}=n_(),OWe=Be();Fse.exports=({repo:r})=>{async function e(t={}){try{await r._checkInitialized(t)}catch(i){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(s=>s.test(i.message)))return PWe;throw i}return r.version.get()}return OWe(e)}});var Vse=p((pSt,Kse)=>{l();"use strict";var BWe=cee(),NWe=x5(),DWe=Use(),jse=class{constructor({gcLock:e,pin:t,repo:i,refs:n}){this.gc=BWe({gcLock:e,pin:t,refs:n,repo:i}),this.stat=NWe({repo:i}),this.version=DWe({repo:i})}};Kse.exports=jse});var Gse=p((ySt,zse)=>{l();"use strict";var{default:qWe}=g2(),MWe=ge(),LWe=Be();function Hse(r,e){let t;if(r.metrics?e.peer?t=r.metrics.forPeer(e.peer):e.proto?t=r.metrics.forProtocol(e.proto):t=r.metrics.global:t=void 0,!t)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:BigInt(0),rateOut:BigInt(0)};let{movingAverages:i,snapshot:n}=t;return{totalIn:BigInt(n.dataReceived.toString()),totalOut:BigInt(n.dataSent.toString()),rateIn:BigInt(i.dataReceived[6e4].movingAverage()/60),rateOut:BigInt(i.dataSent[6e4].movingAverage()/60)}}zse.exports=({network:r})=>LWe(async function*(t={}){let{libp2p:i}=await r.use(t);if(!t.poll){yield Hse(i,t);return}let n=t.interval||1e3,s=-1;try{if(s=typeof n=="string"?qWe(n)||-1:n,!s||s<0)throw new Error("invalid duration")}catch(a){throw MWe(a,"ERR_INVALID_POLL_INTERVAL")}let o;try{for(;;)yield Hse(i,t),await new Promise(a=>{o=setTimeout(a,s)})}finally{clearTimeout(o)}})});var Yse=p((gSt,$se)=>{l();"use strict";var FWe=Gse(),UWe=x5(),KWe=IA(),Wse=class{constructor({repo:e,network:t}){this.repo=UWe({repo:e}),this.bw=FWe({network:t}),this.bitswap=KWe({network:t})}};$se.exports=Wse});var Zse=p((bSt,Xse)=>{l();"use strict";var jWe=$c(),Jse=ge(),Qse=class{constructor(e){this._repo=e,this._bitswap=null}setExchange(e){this._bitswap=e}unsetExchange(){this._bitswap=null}hasExchange(){return this._bitswap!=null}put(e,t){return this.hasExchange()?this._bitswap.put(e,t):this._repo.blocks.put(e,t)}putMany(e,t){return this.hasExchange()?this._bitswap.putMany(e,t):this._repo.blocks.putMany(e,t)}get(e,t){return this.hasExchange()?this._bitswap.get(e,t):this._repo.blocks.get(e,t)}getMany(e,t){if(!Array.isArray(e))throw new Error("first arg must be an array of cids");return this.hasExchange()?this._bitswap.getMany(e,t):jWe(e,i=>this._repo.blocks.get(i,t))}async delete(e,t){if(!await this._repo.blocks.has(e))throw Jse(new Error("blockstore: block not found"),"ERR_BLOCK_NOT_FOUND");return this._repo.blocks.delete(e,t)}deleteMany(e,t){let i=this._repo;return this._repo.blocks.deleteMany(async function*(){for await(let n of e){if(!await i.blocks.has(n))throw Jse(new Error("blockstore: block not found"),"ERR_BLOCK_NOT_FOUND");yield n}}(),t)}};Xse.exports=Qse});var toe=p((mSt,eoe)=>{l();eoe.exports=function(e,t,i){var n=new e.Uint8Array(i),s=t.pushInt,o=t.pushInt32,a=t.pushInt32Neg,c=t.pushInt64,u=t.pushInt64Neg,f=t.pushFloat,h=t.pushFloatSingle,d=t.pushFloatDouble,y=t.pushTrue,g=t.pushFalse,m=t.pushUndefined,x=t.pushNull,_=t.pushInfinity,P=t.pushInfinityNeg,q=t.pushNaN,X=t.pushNaNNeg,W=t.pushArrayStart,z=t.pushArrayStartFixed,Z=t.pushArrayStartFixed32,ee=t.pushArrayStartFixed64,re=t.pushObjectStart,L=t.pushObjectStartFixed,b=t.pushObjectStartFixed32,w=t.pushObjectStartFixed64,R=t.pushByteString,B=t.pushByteStringStart,U=t.pushUtf8String,Q=t.pushUtf8StringStart,G=t.pushSimpleUnassigned,M=t.pushTagStart,v=t.pushTagStart4,V=t.pushTagStart8,de=t.pushTagUnassigned,J=t.pushBreak,ue=e.Math.pow,S=0,A=0,ie=0;function ae(k){for(k=k|0,S=0,A=k;(S|0)<(A|0)&&(ie=xc[n[S]&255](n[S]|0)|0,!((ie|0)>0)););return ie|0}function E(k){return k=k|0,((S|0)+(k|0)|0)<(A|0)?0:1}function I(k){return k=k|0,n[k|0]<<8|n[k+1|0]|0}function j(k){return k=k|0,n[k|0]<<24|n[k+1|0]<<16|n[k+2|0]<<8|n[k+3|0]|0}function H(k){return k=k|0,s(k|0),S=S+1|0,0}function T(k){return k=k|0,E(1)|0?1:(s(n[S+1|0]|0),S=S+2|0,0)}function K(k){return k=k|0,E(2)|0?1:(s(I(S+1|0)|0),S=S+3|0,0)}function F(k){return k=k|0,E(4)|0?1:(o(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function N(k){return k=k|0,E(8)|0?1:(c(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function Y(k){return k=k|0,s(-1-(k-32|0)|0),S=S+1|0,0}function ne(k){return k=k|0,E(1)|0?1:(s(-1-(n[S+1|0]|0)|0),S=S+2|0,0)}function te(k){k=k|0;var qe=0;return E(2)|0?1:(qe=I(S+1|0)|0,s(-1-(qe|0)|0),S=S+3|0,0)}function he(k){return k=k|0,E(4)|0?1:(a(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function me(k){return k=k|0,E(8)|0?1:(u(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function fe(k){k=k|0;var qe=0,Le=0,Pe=0;return Pe=k-64|0,E(Pe|0)|0?1:(qe=S+1|0,Le=(S+1|0)+(Pe|0)|0,R(qe|0,Le|0),S=Le|0,0)}function je(k){k=k|0;var qe=0,Le=0,Pe=0;return E(1)|0||(Pe=n[S+1|0]|0,qe=S+2|0,Le=(S+2|0)+(Pe|0)|0,E(Pe+1|0)|0)?1:(R(qe|0,Le|0),S=Le|0,0)}function Ae(k){k=k|0;var qe=0,Le=0,Pe=0;return E(2)|0||(Pe=I(S+1|0)|0,qe=S+3|0,Le=(S+3|0)+(Pe|0)|0,E(Pe+2|0)|0)?1:(R(qe|0,Le|0),S=Le|0,0)}function Ve(k){k=k|0;var qe=0,Le=0,Pe=0;return E(4)|0||(Pe=j(S+1|0)|0,qe=S+5|0,Le=(S+5|0)+(Pe|0)|0,E(Pe+4|0)|0)?1:(R(qe|0,Le|0),S=Le|0,0)}function Xe(k){return k=k|0,1}function Ge(k){return k=k|0,B(),S=S+1|0,0}function ve(k){k=k|0;var qe=0,Le=0,Pe=0;return Pe=k-96|0,E(Pe|0)|0?1:(qe=S+1|0,Le=(S+1|0)+(Pe|0)|0,U(qe|0,Le|0),S=Le|0,0)}function at(k){k=k|0;var qe=0,Le=0,Pe=0;return E(1)|0||(Pe=n[S+1|0]|0,qe=S+2|0,Le=(S+2|0)+(Pe|0)|0,E(Pe+1|0)|0)?1:(U(qe|0,Le|0),S=Le|0,0)}function St(k){k=k|0;var qe=0,Le=0,Pe=0;return E(2)|0||(Pe=I(S+1|0)|0,qe=S+3|0,Le=(S+3|0)+(Pe|0)|0,E(Pe+2|0)|0)?1:(U(qe|0,Le|0),S=Le|0,0)}function kt(k){k=k|0;var qe=0,Le=0,Pe=0;return E(4)|0||(Pe=j(S+1|0)|0,qe=S+5|0,Le=(S+5|0)+(Pe|0)|0,E(Pe+4|0)|0)?1:(U(qe|0,Le|0),S=Le|0,0)}function Fr(k){return k=k|0,1}function mt(k){return k=k|0,Q(),S=S+1|0,0}function Ie(k){return k=k|0,z(k-128|0),S=S+1|0,0}function tr(k){return k=k|0,E(1)|0?1:(z(n[S+1|0]|0),S=S+2|0,0)}function Ze(k){return k=k|0,E(2)|0?1:(z(I(S+1|0)|0),S=S+3|0,0)}function Kt(k){return k=k|0,E(4)|0?1:(Z(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function cs(k){return k=k|0,E(8)|0?1:(ee(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function Gt(k){return k=k|0,W(),S=S+1|0,0}function De(k){k=k|0;var qe=0;return qe=k-160|0,E(qe|0)|0?1:(L(qe|0),S=S+1|0,0)}function us(k){return k=k|0,E(1)|0?1:(L(n[S+1|0]|0),S=S+2|0,0)}function $t(k){return k=k|0,E(2)|0?1:(L(I(S+1|0)|0),S=S+3|0,0)}function Wt(k){return k=k|0,E(4)|0?1:(b(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function fs(k){return k=k|0,E(8)|0?1:(w(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function Yt(k){return k=k|0,re(),S=S+1|0,0}function yt(k){return k=k|0,M(k-192|0|0),S=S+1|0,0}function So(k){return k=k|0,M(k|0),S=S+1|0,0}function ar(k){return k=k|0,M(k|0),S=S+1|0,0}function cr(k){return k=k|0,M(k|0),S=S+1|0,0}function xo(k){return k=k|0,M(k|0),S=S+1|0,0}function Ye(k){return k=k|0,M(k-192|0|0),S=S+1|0,0}function ur(k){return k=k|0,M(k|0),S=S+1|0,0}function Ao(k){return k=k|0,M(k|0),S=S+1|0,0}function fr(k){return k=k|0,M(k|0),S=S+1|0,0}function Xt(k){return k=k|0,E(1)|0?1:(M(n[S+1|0]|0),S=S+2|0,0)}function ls(k){return k=k|0,E(2)|0?1:(M(I(S+1|0)|0),S=S+3|0,0)}function Jt(k){return k=k|0,E(4)|0?1:(v(I(S+1|0)|0,I(S+3|0)|0),S=S+5|0,0)}function Qt(k){return k=k|0,E(8)|0?1:(V(I(S+1|0)|0,I(S+3|0)|0,I(S+5|0)|0,I(S+7|0)|0),S=S+9|0,0)}function rt(k){return k=k|0,G((k|0)-224|0),S=S+1|0,0}function Zt(k){return k=k|0,g(),S=S+1|0,0}function Ct(k){return k=k|0,y(),S=S+1|0,0}function xn(k){return k=k|0,x(),S=S+1|0,0}function Fn(k){return k=k|0,m(),S=S+1|0,0}function Un(k){return k=k|0,E(1)|0?1:(G(n[S+1|0]|0),S=S+2|0,0)}function Kn(k){k=k|0;var qe=0,Le=0,Pe=1,An=0,Qi=0,Mf=0;return E(2)|0?1:(qe=n[S+1|0]|0,Le=n[S+2|0]|0,(qe|0)&128&&(Pe=-1),An=+(((qe|0)&124)>>2),Qi=+(((qe|0)&3)<<8|Le),+An==0?f(+(+Pe*5960464477539063e-23*+Qi)):+An==31?+Pe==1?+Qi>0?q():_():+Qi>0?X():P():f(+(+Pe*ue(2,+(+An-25))*+(1024+Qi))),S=S+3|0,0)}function jn(k){return k=k|0,E(4)|0?1:(h(n[S+1|0]|0,n[S+2|0]|0,n[S+3|0]|0,n[S+4|0]|0),S=S+5|0,0)}function Vn(k){return k=k|0,E(8)|0?1:(d(n[S+1|0]|0,n[S+2|0]|0,n[S+3|0]|0,n[S+4|0]|0,n[S+5|0]|0,n[S+6|0]|0,n[S+7|0]|0,n[S+8|0]|0),S=S+9|0,0)}function ze(k){return k=k|0,1}function zn(k){return k=k|0,J(),S=S+1|0,0}var xc=[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,T,K,F,N,ze,ze,ze,ze,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,ne,te,he,me,ze,ze,ze,ze,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,je,Ae,Ve,Xe,ze,ze,ze,Ge,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,at,St,kt,Fr,ze,ze,ze,mt,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie,tr,Ze,Kt,cs,ze,ze,ze,Gt,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,De,us,$t,Wt,fs,ze,ze,ze,Yt,yt,yt,yt,yt,yt,yt,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Xt,ls,Jt,Qt,ze,ze,ze,ze,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,Zt,Ct,xn,Fn,Un,Kn,jn,Vn,ze,ze,ze,zn];return{parse:ae}}});var u1=p(Rs=>{l();"use strict";var A8=Ya().BigNumber;Rs.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};Rs.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};Rs.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};Rs.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};Rs.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};Rs.SHIFT32=Math.pow(2,32);Rs.SHIFT16=Math.pow(2,16);Rs.MAX_SAFE_HIGH=2097151;Rs.NEG_ONE=new A8(-1);Rs.TEN=new A8(10);Rs.TWO=new A8(2);Rs.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5}});var s_=p(uo=>{l();"use strict";var{Buffer:VWe}=xt(),roe=Ya().BigNumber,ioe=u1(),noe=ioe.SHIFT32,zWe=ioe.SHIFT16,HWe=2097151;uo.parseHalf=function(e){let t=e[0]&128?-1:1,i=(e[0]&124)>>2,n=(e[0]&3)<<8|e[1];return i?i===31?t*(n?0/0:Infinity):t*Math.pow(2,i-25)*(1024+n):t*5960464477539063e-23*n};function GWe(r){return r<16?"0"+r.toString(16):r.toString(16)}uo.arrayBufferToBignumber=function(r){let e=r.byteLength,t="";for(let i=0;i<e;i++)t+=GWe(r[i]);return new roe(t,16)};uo.buildMap=r=>{let e=new Map,t=Object.keys(r),i=t.length;for(let n=0;n<i;n++)e.set(t[n],r[t[n]]);return e};uo.buildInt32=(r,e)=>r*zWe+e;uo.buildInt64=(r,e,t,i)=>{let n=uo.buildInt32(r,e),s=uo.buildInt32(t,i);return n>HWe?new roe(n).times(noe).plus(s):n*noe+s};uo.writeHalf=function(e,t){let i=VWe.allocUnsafe(4);i.writeFloatBE(t,0);let n=i.readUInt32BE(0);if((n&8191)!=0)return!1;let s=n>>16&32768,o=n>>23&255,a=n&8388607;if(o>=113&&o<=142)s+=(o-112<<10)+(a>>13);else if(o>=103&&o<113){if(a&(1<<126-o)-1)return!1;s+=a+8388608>>126-o}else return!1;return e.writeUInt16BE(s,0),!0};uo.keySorter=function(r,e){let t=r[0].byteLength,i=e[0].byteLength;return t>i?1:i>t?-1:r[0].compare(e[0])};uo.isNegativeZero=r=>r===0&&1/r<0;uo.nextPowerOf2=r=>{let e=0;if(r&&!(r&r-1))return r;for(;r!==0;)r>>=1,e+=1;return 1<<e}});var R8=p((_St,soe)=>{l();"use strict";var I8=u1(),$We=I8.MT,o_=I8.SIMPLE,T8=I8.SYMS,f1=class{constructor(e){if(typeof e!="number")throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(e|0)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,$We.SIMPLE_FLOAT)}static isSimple(e){return e instanceof f1}static decode(e,t){switch(t==null&&(t=!0),e){case o_.FALSE:return!1;case o_.TRUE:return!0;case o_.NULL:return t?null:T8.NULL;case o_.UNDEFINED:return t?void 0:T8.UNDEFINED;case-1:if(!t)throw new Error("Invalid BREAK");return T8.BREAK;default:return new f1(e)}}};soe.exports=f1});var k8=p((ESt,ooe)=>{l();"use strict";var l1=class{constructor(e,t,i){if(this.tag=e,this.value=t,this.err=i,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){let t,i;if(i=e!=null?e[this.tag]:void 0,typeof i!="function"&&(i=l1["_tag"+this.tag],typeof i!="function"))return this;try{return i.call(l1,this.value)}catch(n){return t=n,this.err=t,this}}};ooe.exports=l1});var C8=p((SSt,aoe)=>{l();"use strict";var{Buffer:Bp}=xt(),coe=$0(),WWe=Ya().BigNumber,YWe=toe(),Nn=s_(),pr=u1(),XWe=R8(),JWe=k8(),{URL:QWe}=Oh(),Yl=class{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=Nn.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=Bp.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(t*1e3),2:t=>Nn.arrayBufferToBignumber(t),3:t=>pr.NEG_ONE.minus(Nn.arrayBufferToBignumber(t)),4:t=>pr.TEN.pow(t[0]).times(t[1]),5:t=>pr.TWO.pow(t[0]).times(t[1]),32:t=>new QWe(t),35:t=>new RegExp(t)},e.tags),this.parser=YWe(globalThis,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){let e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case pr.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case pr.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case pr.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case pr.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case pr.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case pr.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break;default:break}this._currentParent&&this._currentParent.type===pr.PARENT.TAG&&this._dec()}_dec(){let e=this._currentParent;e.length<0||(e.length--,e.length===0&&this._closeParent())}_push(e,t){let i=this._currentParent;switch(i.values++,i.type){case pr.PARENT.ARRAY:case pr.PARENT.BYTE_STRING:case pr.PARENT.UTF8_STRING:i.length>-1?this._ref[this._ref.length-i.length]=e:this._ref.push(e),this._dec();break;case pr.PARENT.OBJECT:i.tmpKey!=null?(this._ref[i.tmpKey]=e,i.tmpKey=null,this._dec()):(i.tmpKey=e,typeof i.tmpKey!="string"&&(i.type=pr.PARENT.MAP,i.ref=Nn.buildMap(i.ref)));break;case pr.PARENT.MAP:i.tmpKey!=null?(this._ref.set(i.tmpKey,e),i.tmpKey=null,this._dec()):i.tmpKey=e;break;case pr.PARENT.TAG:this._ref.push(e),t||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,t,i){this._parents[this._depth]={type:t,length:i,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:pr.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,t){let i=this._knownTags[e];return i?i(t):new JWe(e,t)}createMap(e,t){return e}createObject(e,t){return e}createArray(e,t){return e}createByteString(e,t){return Bp.concat(e)}createByteStringFromHeap(e,t){return e===t?Bp.alloc(0):Bp.from(this._heap.slice(e,t))}createInt(e){return e}createInt32(e,t){return Nn.buildInt32(e,t)}createInt64(e,t,i,n){return Nn.buildInt64(e,t,i,n)}createFloat(e){return e}createFloatSingle(e,t,i,n){return coe.read([e,t,i,n],0,!1,23,4)}createFloatDouble(e,t,i,n,s,o,a,c){return coe.read([e,t,i,n,s,o,a,c],0,!1,52,8)}createInt32Neg(e,t){return-1-Nn.buildInt32(e,t)}createInt64Neg(e,t,i,n){let s=Nn.buildInt32(e,t),o=Nn.buildInt32(i,n);return s>pr.MAX_SAFE_HIGH?pr.NEG_ONE.minus(new WWe(s).times(pr.SHIFT32).plus(o)):-1-(s*pr.SHIFT32+o)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return Infinity}createInfinityNeg(){return-Infinity}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,t){return e.join("")}createUtf8StringFromHeap(e,t){return e===t?"":this._buffer.toString("utf8",e,t)}createSimpleUnassigned(e){return new XWe(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,t){this._push(this.createInt32(e,t))}pushInt64(e,t,i,n){this._push(this.createInt64(e,t,i,n))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,t,i,n){this._push(this.createFloatSingle(e,t,i,n))}pushFloatDouble(e,t,i,n,s,o,a,c){this._push(this.createFloatDouble(e,t,i,n,s,o,a,c))}pushInt32Neg(e,t){this._push(this.createInt32Neg(e,t))}pushInt64Neg(e,t,i,n){this._push(this.createInt64Neg(e,t,i,n))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],pr.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,t){let i=Nn.buildInt32(e,t);this._createArrayStartFixed(i)}pushArrayStartFixed64(e,t,i,n){let s=Nn.buildInt64(e,t,i,n);this._createArrayStartFixed(s)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,t){let i=Nn.buildInt32(e,t);this._createObjectStartFixed(i)}pushObjectStartFixed64(e,t,i,n){let s=Nn.buildInt64(e,t,i,n);this._createObjectStartFixed(s)}pushByteStringStart(){this._parents[this._depth]={type:pr.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,t){this._push(this.createByteStringFromHeap(e,t))}pushUtf8StringStart(){this._parents[this._depth]={type:pr.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,t){this._push(this.createUtf8StringFromHeap(e,t))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:pr.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,t){this.pushTagStart(Nn.buildInt32(e,t))}pushTagStart8(e,t,i,n){this.pushTagStart(Nn.buildInt64(e,t,i,n))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){if(e===0){this._push(this.createObject({}));return}this._createParent({},pr.PARENT.OBJECT,e)}_createArrayStartFixed(e){if(e===0){this._push(this.createArray([]));return}this._createParent(new Array(e),pr.PARENT.ARRAY,e)}_decode(e){if(e.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(e);let t=this.parser.parse(e.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(t>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,t){return typeof e=="string"&&(e=Bp.from(e,t||"hex")),new Yl({size:e.length}).decodeFirst(e)}static decodeAll(e,t){return typeof e=="string"&&(e=Bp.from(e,t||"hex")),new Yl({size:e.length}).decodeAll(e)}};Yl.decodeFirst=Yl.decode;aoe.exports=Yl});var loe=p((xSt,uoe)=>{l();"use strict";var{Buffer:P8}=xt(),ZWe=C8(),eYe=s_(),a_=class extends ZWe{createTag(e,t){return`${e}(${t})`}createInt(e){return super.createInt(e).toString()}createInt32(e,t){return super.createInt32(e,t).toString()}createInt64(e,t,i,n){return super.createInt64(e,t,i,n).toString()}createInt32Neg(e,t){return super.createInt32Neg(e,t).toString()}createInt64Neg(e,t,i,n){return super.createInt64Neg(e,t,i,n).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){let t=super.createFloat(e);return eYe.isNegativeZero(e)?"-0_1":`${t}_1`}createFloatSingle(e,t,i,n){return`${super.createFloatSingle(e,t,i,n)}_2`}createFloatDouble(e,t,i,n,s,o,a,c){return`${super.createFloatDouble(e,t,i,n,s,o,a,c)}_3`}createByteString(e,t){let i=e.join(", ");return t===-1?`(_ ${i})`:`h'${i}`}createByteStringFromHeap(e,t){return`h'${P8.from(super.createByteStringFromHeap(e,t)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,t){let i=super.createArray(e,t);return t===-1?`[_ ${i.join(", ")}]`:`[${i.join(", ")}]`}createMap(e,t){let i=super.createMap(e),n=Array.from(i.keys()).reduce(foe(i),"");return t===-1?`{_ ${n}}`:`{${n}}`}createObject(e,t){let i=super.createObject(e),n=Object.keys(i).reduce(foe(i),"");return t===-1?`{_ ${n}}`:`{${n}}`}createUtf8String(e,t){let i=e.join(", ");return t===-1?`(_ ${i})`:`"${i}"`}createUtf8StringFromHeap(e,t){return`"${P8.from(super.createUtf8StringFromHeap(e,t)).toString("utf8")}"`}static diagnose(e,t){return typeof e=="string"&&(e=P8.from(e,t||"hex")),new a_().decodeFirst(e)}};uoe.exports=a_;function foe(r){return(e,t)=>e?`${e}, ${t}: ${r[t]}`:`${t}: ${r[t]}`}});var goe=p((ASt,hoe)=>{l();"use strict";var{Buffer:ac}=xt(),{URL:tYe}=Oh(),O8=Ya().BigNumber,B8=s_(),Ii=u1(),ta=Ii.MT,c_=Ii.NUMBYTES,doe=Ii.SHIFT32,poe=Ii.SYMS,Np=Ii.TAG,rYe=Ii.MT.SIMPLE_FLOAT<<5|Ii.NUMBYTES.TWO,iYe=Ii.MT.SIMPLE_FLOAT<<5|Ii.NUMBYTES.FOUR,nYe=Ii.MT.SIMPLE_FLOAT<<5|Ii.NUMBYTES.EIGHT,sYe=Ii.MT.SIMPLE_FLOAT<<5|Ii.SIMPLE.TRUE,oYe=Ii.MT.SIMPLE_FLOAT<<5|Ii.SIMPLE.FALSE,aYe=Ii.MT.SIMPLE_FLOAT<<5|Ii.SIMPLE.UNDEFINED,yoe=Ii.MT.SIMPLE_FLOAT<<5|Ii.SIMPLE.NULL,cYe=new O8("0x20000000000000"),uYe=ac.from("f97e00","hex"),fYe=ac.from("f9fc00","hex"),lYe=ac.from("f97c00","hex");function hYe(r){return{}.toString.call(r).slice(8,-1)}var h1=class{constructor(e){e=e||{},this.streaming=typeof e.stream=="function",this.onData=e.stream,this.semanticTypes=[[tYe,this._pushUrl],[O8,this._pushBigNumber]];let t=e.genTypes||[],i=t.length;for(let n=0;n<i;n++)this.addSemanticType(t[n][0],t[n][1]);this._reset()}addSemanticType(e,t){let i=this.semanticTypes.length;for(let n=0;n<i;n++)if(this.semanticTypes[n][0]===e){let o=this.semanticTypes[n][1];return this.semanticTypes[n][1]=t,o}return this.semanticTypes.push([e,t]),null}push(e){return e&&(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(e,t,i){return this.result[this.offset]=e,this.resultMethod[this.offset]=t,this.resultLength[this.offset]=i,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(uYe)}_pushInfinity(e){let t=e<0?fYe:lYe;return this.push(t)}_pushFloat(e){let t=ac.allocUnsafe(2);if(B8.writeHalf(t,e)&&B8.parseHalf(t)===e)return this._pushUInt8(rYe)&&this.push(t);let i=ac.allocUnsafe(4);return i.writeFloatBE(e,0),i.readFloatBE(0)===e?this._pushUInt8(iYe)&&this.push(i):this._pushUInt8(nYe)&&this._pushDoubleBE(e)}_pushInt(e,t,i){let n=t<<5;return e<24?this._pushUInt8(n|e):e<=255?this._pushUInt8(n|c_.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(n|c_.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(n|c_.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(n|c_.EIGHT)&&this._pushUInt32BE(Math.floor(e/doe))&&this._pushUInt32BE(e%doe):t===ta.NEG_INT?this._pushFloat(i):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,ta.NEG_INT,e):this._pushInt(e,ta.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!=0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){let t=ac.byteLength(e,"utf8");return this._pushInt(t,ta.UTF8_STRING)&&this.pushWrite(e,5,t)}_pushBoolean(e){return this._pushUInt8(e?sYe:oYe)}_pushUndefined(e){return this._pushUInt8(aYe)}_pushArray(e,t){let i=t.length;if(!e._pushInt(i,ta.ARRAY))return!1;for(let n=0;n<i;n++)if(!e.pushAny(t[n]))return!1;return!0}_pushTag(e){return this._pushInt(e,ta.TAG)}_pushDate(e,t){return e._pushTag(Np.DATE_EPOCH)&&e.pushAny(Math.round(t/1e3))}_pushBuffer(e,t){return e._pushInt(t.length,ta.BYTE_STRING)&&e.push(t)}_pushNoFilter(e,t){return e._pushBuffer(e,t.slice())}_pushRegexp(e,t){return e._pushTag(Np.REGEXP)&&e.pushAny(t.source)}_pushSet(e,t){if(!e._pushInt(t.size,ta.ARRAY))return!1;for(let i of t)if(!e.pushAny(i))return!1;return!0}_pushUrl(e,t){return e._pushTag(Np.URI)&&e.pushAny(t.format())}_pushBigint(e){let t=Np.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),t=Np.NEG_BIGINT);let i=e.toString(16);i.length%2&&(i="0"+i);let n=ac.from(i,"hex");return this._pushTag(t)&&this._pushBuffer(this,n)}_pushBigNumber(e,t){if(t.isNaN())return e._pushNaN();if(!t.isFinite())return e._pushInfinity(t.isNegative()?-Infinity:Infinity);if(t.isInteger())return e._pushBigint(t);if(!(e._pushTag(Np.DECIMAL_FRAC)&&e._pushInt(2,ta.ARRAY)))return!1;let i=t.decimalPlaces(),n=t.multipliedBy(new O8(10).pow(i));return e._pushIntNum(-i)?n.abs().isLessThan(cYe)?e._pushIntNum(n.toNumber()):e._pushBigint(n):!1}_pushMap(e,t){return e._pushInt(t.size,ta.MAP)?this._pushRawMap(t.size,Array.from(t)):!1}_pushObject(e){if(!e)return this._pushUInt8(yoe);let t=this.semanticTypes.length;for(let o=0;o<t;o++)if(e instanceof this.semanticTypes[o][0])return this.semanticTypes[o][1].call(e,this,e);let i=e.encodeCBOR;if(typeof i=="function")return i.call(e,this);let n=Object.keys(e),s=n.length;return this._pushInt(s,ta.MAP)?this._pushRawMap(s,n.map(o=>[o,e[o]])):!1}_pushRawMap(e,t){t=t.map(function(i){return i[0]=h1.encode(i[0]),i}).sort(B8.keySorter);for(let i=0;i<e;i++)if(!this.push(t[i][0])||!this.pushAny(t[i][1]))return!1;return!0}write(e){return this.pushAny(e)}pushAny(e){switch(hYe(e)){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,ac.isBuffer(e)?e:ac.from(e));case"Null":return this._pushUInt8(yoe);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case poe.NULL:return this._pushObject(null);case poe.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(this.offset===0)return null;let e=this.result,t=this.resultLength,i=this.resultMethod,n=this.offset,s=0,o=0;for(;o<n;o++)s+=t[o];let a=ac.allocUnsafe(s),c=0,u=0;for(o=0;o<n;o++){switch(u=t[o],i[o]){case 0:e[o].copy(a,c);break;case 1:a.writeUInt8(e[o],c,!0);break;case 2:a.writeUInt16BE(e[o],c,!0);break;case 3:a.writeUInt32BE(e[o],c,!0);break;case 4:a.writeDoubleBE(e[o],c,!0);break;case 5:a.write(e[o],c,u,"utf8");break;default:throw new Error("unkown method")}c+=u}let f=a;return this._reset(),f}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){let t=new h1;if(!t.pushAny(e))throw new Error("Failed to encode input");return t.finalize()}};hoe.exports=h1});var boe=p(Ti=>{l();"use strict";Ti.Diagnose=loe();Ti.Decoder=C8();Ti.Encoder=goe();Ti.Simple=R8();Ti.Tagged=k8();Ti.decodeAll=Ti.Decoder.decodeAll;Ti.decodeFirst=Ti.Decoder.decodeFirst;Ti.diagnose=Ti.Diagnose.diagnose;Ti.encode=Ti.Encoder.encode;Ti.decode=Ti.Decoder.decode;Ti.leveldb={decode:Ti.Decoder.decodeAll,encode:Ti.Encoder.encode,buffer:!0,name:"cbor"}});var M8=p((TSt,u_)=>{l();"use strict";var N8=boe(),moe=$r(),voe=er(),{multihash:woe}=voe,d1=Qe(),dYe=_4(),pYe=vi(),yYe=ct(),_oe=42;function gYe(r){let e;if(typeof r=="string")e=new d1(r).bytes;else if(d1.isCID(r))e=r.bytes;else throw new Error("Could not tag CID - was not string or CID");return new N8.Tagged(_oe,pYe([yYe("00","base16"),e],1+e.length))}function bYe(r){let e;try{e=dYe(r)}catch(i){e=!1}if(e)throw new Error("The object passed has circular references");function t(i){if(!i||i instanceof Uint8Array||typeof i=="string")return i;if(Array.isArray(i))return i.map(t);if(d1.isCID(i))return gYe(i);let n=Object.keys(i);if(n.length>0){let s={};return n.forEach(o=>{typeof i[o]=="object"?s[o]=t(i[o]):s[o]=i[o]}),s}else return i}return t(r)}var mYe=moe.DAG_CBOR,vYe=woe.names["sha2-256"],Eoe={[_oe]:r=>(r=r.slice(1),new d1(r))},Soe=64*1024,Dp=Soe,xoe=64*1024*1024,D8=xoe,Aoe;function q8(r){let e=Eoe;r?(typeof r.size=="number"&&(Dp=r.size),typeof r.maxSize=="number"&&(D8=r.maxSize),r.tags&&(e=Object.assign({},Eoe,r&&r.tags))):(Dp=Soe,D8=xoe);let t={tags:e,size:Dp};Aoe=new N8.Decoder(t),Dp=t.size}q8();function wYe(r){let e=bYe(r);return N8.encode(e)}function _Ye(r){if(r.length>Dp&&r.length<=D8&&q8({size:r.length}),r.length>Dp)throw new Error("Data is too large to deserialize with current decoder");let e=Aoe.decodeAll(r);if(e.length!==1)throw new Error("Extraneous CBOR data found beyond initial top-level object");return e[0]}async function EYe(r,e={}){let t={cidVersion:e.cidVersion==null?1:e.cidVersion,hashAlg:e.hashAlg==null?u_.exports.defaultHashAlg:e.hashAlg},i=woe.codes[t.hashAlg],n=await voe(r,i),s=moe.getNameFromCode(u_.exports.codec);return new d1(t.cidVersion,s,n)}u_.exports={codec:mYe,defaultHashAlg:vYe,configureDecoder:q8,serialize:wYe,deserialize:_Ye,cid:EYe}});var koe=p(L8=>{l();"use strict";var Ioe=Qe(),Toe=M8();L8.resolve=(r,e="")=>{let t=Toe.deserialize(r),i=e.split("/").filter(Boolean);for(;i.length;){let n=i.shift();if(!n||!(n in t))throw new Error(`Object has no property '${n}'`);if(t=t[n],Ioe.isCID(t))return{value:t,remainderPath:i.join("/")}}return{value:t,remainderPath:""}};var Roe=function*(r,e){if(!(r instanceof Uint8Array||Ioe.isCID(r)||typeof r=="string"||r===null))for(let t of Object.keys(r)){let i=e===void 0?t:e+"/"+t;yield i,yield*Roe(r[t],i)}};L8.tree=function*(r){let e=Toe.deserialize(r);yield*Roe(e)}});var U8=p((kSt,Coe)=>{l();"use strict";var F8=M8(),SYe=koe();Coe.exports={util:F8,resolver:SYe,codec:F8.codec,defaultHashAlg:F8.defaultHashAlg}});var K8=p((CSt,f_)=>{l();"use strict";var xYe=Qe(),Poe=er(),{multihash:Ooe}=Poe,Boe=$r();f_.exports={codec:Boe.RAW,defaultHashAlg:Ooe.names["sha2-256"],resolver:{resolve:(r,e)=>{if(e!=="/")throw new Error("Only the root path / may be resolved");return{value:r,remainderPath:""}},async*tree(r){}},util:{deserialize:r=>r,serialize:r=>r,cid:async(r,e={})=>{let t={cidVersion:e.cidVersion==null?1:e.cidVersion,hashAlg:e.hashAlg==null?f_.exports.defaultHashAlg:e.hashAlg},i=Ooe.codes[t.hashAlg],n=await Poe(r,i),s=Boe.getNameFromCode(f_.exports.codec);return new xYe(t.cidVersion,s,n)}}}});var qoe=p((PSt,Noe)=>{l();"use strict";var AYe=Gr(),l_=$r(),Doe={get[l_.DAG_PB](){return Mr()},get[l_.DAG_CBOR](){return U8()},get[l_.RAW](){return K8()}};Noe.exports=(r,e)=>AYe.call({concatArrays:!0},{blockService:r,formats:[],loadFormat:t=>{if(Doe[t])return Promise.resolve(Doe[t]);throw new Error(`Missing IPLD format "${l_.getName(t)}"`)}},e)});var Loe=p((h_,Moe)=>{l();(function(r,e){typeof h_=="object"&&typeof Moe!="undefined"?e(h_):typeof define=="function"&&define.amd?define(["exports"],e):(r=r||self,e(r.typical={}))})(h_,function(r){"use strict";function e(x){return!isNaN(parseFloat(x))&&isFinite(x)}function t(x){return x!==null&&typeof x=="object"&&x.constructor===Object}function i(x){return n(x)&&typeof x.length=="number"}function n(x){return typeof x=="object"&&x!==null}function s(x){return typeof x!="undefined"}function o(x){return!s(x)}function a(x){return x===null}function c(x){return s(x)&&!a(x)&&!Number.isNaN(x)}function u(x){return typeof x=="function"?/^class /.test(Function.prototype.toString.call(x)):!1}function f(x){if(x===null)return!0;switch(typeof x){case"string":case"number":case"symbol":case"undefined":case"boolean":return!0;default:return!1}}function h(x){if(x){let _=s(Promise)&&x instanceof Promise,P=x.then&&typeof x.then=="function";return!!(_||P)}else return!1}function d(x){return x===null||!s(x)?!1:typeof x[Symbol.iterator]=="function"||typeof x[Symbol.asyncIterator]=="function"}function y(x){return typeof x=="string"}function g(x){return typeof x=="function"}var m={isNumber:e,isPlainObject:t,isArrayLike:i,isObject:n,isDefined:s,isUndefined:o,isNull:a,isDefinedValue:c,isClass:u,isPrimitive:f,isPromise:h,isIterable:d,isString:y,isFunction:g};r.default=m,r.isArrayLike=i,r.isClass=u,r.isDefined=s,r.isDefinedValue=c,r.isFunction=g,r.isIterable=d,r.isNull=a,r.isNumber=e,r.isObject=n,r.isPlainObject=t,r.isPrimitive=f,r.isPromise=h,r.isString=y,r.isUndefined=o,Object.defineProperty(r,"__esModule",{value:!0})})});var Foe=p(bf=>{l();"use strict";bf.first=async r=>{for await(let e of r)return e};bf.last=async r=>{let e;for await(e of r);return e};bf.all=async r=>{let e=[];for await(let t of r)e.push(t);return e};bf.extendIterator=r=>(r.first=()=>bf.first(r),r.last=()=>bf.last(r),r.all=()=>bf.all(r),r)});var Koe=p((BSt,Uoe)=>{l();"use strict";var IYe=xl(),d_=Qe(),p_=Gr(),TYe=U8(),RYe=Mr(),kYe=K8(),qp=$r(),j8=Loe(),{extendIterator:p1}=Foe(),y1=class{constructor(e){let t=p_(y1.defaultOptions,e);if(!t.blockService)throw new Error("Missing blockservice");this.bs=t.blockService,this.resolvers={},typeof t.loadFormat!="function"?this.loadFormat=i=>{let n=qp.getNameFromCode(i);throw new Error(`No resolver found for codec "${n}"`)}:this.loadFormat=t.loadFormat;for(let i of t.formats)this.addFormat(i)}addFormat(e){let t=e.codec;if(this.resolvers[e.codec]){let i=qp.getNameFromCode(t);throw new Error(`Resolver already exists for codec "${i}"`)}return this.resolvers[t]=e,this}removeFormat(e){return this.resolvers[e]&&delete this.resolvers[e],this}resolve(e,t,i){if(!d_.isCID(e))throw new Error("`cid` argument must be a CID");if(typeof t!="string")throw new Error("`path` argument must be a string");let n=this;return p1(async function*(){for(;;){let o=await n.getFormat(qp.getCodeFromName(e.codec)),a=await n.bs.get(e,i),c=o.resolver.resolve(a.data,t);t=c.remainderPath;let u=c.value;if(Object.keys(u).length===1&&"/"in u)try{u=new d_(u["/"])}catch(f){u=null}if(yield{remainderPath:t,value:u},d_.isCID(u))e=u;else return}}())}async get(e,t){let i=await this.bs.get(e,t);return(await this.getFormat(i.cid.codec)).util.deserialize(i.data)}getMany(e,t){if(!j8.isIterable(e)||typeof e=="string"||e instanceof Uint8Array)throw new Error("`cids` must be an iterable of CIDs");let i=this;return p1(async function*(){for await(let s of e)yield i.get(s,t)}())}async put(e,t,i){if(t===void 0)throw new Error("`put` requires a format");if(typeof t!="number")throw new Error("`format` parameter must be number (multicodec)");let n=await this.getFormat(t),s={hashAlg:n.defaultHashAlg,cidVersion:1,onlyHash:!1},o=p_(s,i),a={cidVersion:o.cidVersion,hashAlg:o.hashAlg,onlyHash:o.onlyHash},c=n.util.serialize(e),u=await n.util.cid(c,a);if(!o.onlyHash){let f=new IYe(c,u);await this.bs.put(f,o)}return u}putMany(e,t,i){if(!j8.isIterable(e)||typeof e=="string"||e instanceof Uint8Array)throw new Error("`nodes` must be an iterable");if(t===void 0)throw new Error("`put` requires a format");if(typeof t!="number")throw new Error("`format` parameter must be number (multicodec)");let n,s,o=this;return p1(async function*(){for await(let c of e){if(n===void 0){s=await o.getFormat(t);let u={hashAlg:s.defaultHashAlg,cidVersion:1,onlyHash:!1};n=p_(u,i)}yield o.put(c,t,n)}}())}async remove(e,t){return this.bs.delete(e,t)}removeMany(e,t){if(!j8.isIterable(e)||typeof e=="string"||e instanceof Uint8Array)throw new Error("`cids` must be an iterable of CIDs");let i=this;return p1(async function*(){for await(let s of e)yield i.remove(s,t)}())}tree(e,t,i){typeof t=="object"&&(i=t,t=void 0),t=t||"";let s=p_({recursive:!1},i),o=async(u,f)=>{let d=(await this.getFormat(qp.getCodeFromName(u.cid.codec))).resolver.resolve(u.data,f);if(d_.isCID(d.value))return d.value},a=this;return p1(async function*(){let u=[],f,h=[{cid:e,basePath:""}],d;for(;u.length>0||h.length>0;){if(u.length===0&&h.length>0){let m=h.shift();if(m){({cid:e,basePath:d}=m);let x=await a.getFormat(qp.getCodeFromName(e.codec));f=await a.bs.get(e,s);let _=x.resolver.tree(f.data);u.push(..._)}}let y=u.shift()||"",g=d+y;if(s.recursive){let m=await o(f,y);m!=null&&h.push({cid:m,basePath:g+"/"})}t!==void 0&&g.startsWith(t)&&g.length>t.length&&(t.length>0&&(g=g.slice(t.length+1)),yield g)}}())}async getFormat(e){if(typeof e=="string"&&(e=qp.getCodeFromName(e)),this.resolvers[e])return this.resolvers[e];let t=await this.loadFormat(e);if(this.resolvers[e]==null)this.addFormat(t);else return this.resolvers[e];return t}};y1.defaultOptions={formats:[TYe,RYe,kYe]};Uoe.exports=y1});var Voe=p((NSt,joe)=>{l();"use strict";var CYe=qoe(),PYe=Koe(),OYe=({blockService:r,options:e})=>new PYe(CYe(r,e));joe.exports=OYe});var Hoe=p((DSt,zoe)=>{l();"use strict";var BYe=n_();zoe.exports=(r,e)=>{let t=e.path||"ipfs";return new BYe(t,{autoMigrate:e.autoMigrate,onMigrationProgress:e.onMigrationProgress||r})}});var V8=p((qSt,Goe)=>{l();"use strict";var $oe=()=>{},Woe=Symbol.for("@libp2p/js-interfaces/topology"),Yoe=class{constructor({min:e=0,max:t=Infinity,handlers:i={}}){this.min=e,this.max=t,this._onConnect=i.onConnect||$oe,this._onDisconnect=i.onDisconnect||$oe,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[Woe](){return!0}static isTopology(e){return Boolean(e&&e[Woe])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};Goe.exports=Yoe});var y_=p((MSt,Xoe)=>{l();"use strict";var NYe=V8(),Joe=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),Qoe=class extends NYe{constructor({min:e,max:t,multicodecs:i,handlers:n}){super({min:e,max:t,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[Joe](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[Joe])}set registrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),this._updatePeers(this._registrar.peerStore.peers.values())}_updatePeers(e){for(let{id:t,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(t.toB58String());let n=this._registrar.getConnection(t);n&&this._onConnect(t,n)}else this.peers.delete(t.toB58String())}_onProtocolChange({peerId:e,protocols:t}){let i=this.peers.has(e.toB58String()),n=t.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of t)if(this.multicodecs.includes(s)){let o=this._registrar.peerStore.get(e);this._updatePeers([o]);return}}_onPeerConnect(e){let t=e.remotePeer,i=this._registrar.peerStore.protoBook.get(t);!i||this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(t.toB58String()),this._onConnect(t,e))}};Xoe.exports=Qoe});var g_=p(Zoe=>{l();"use strict";Zoe.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var H8=p((FSt,eae)=>{l();"use strict";var mf=hi(),Mp=mf.Reader,z8=mf.Writer,Ft=mf.util,Ri=mf.roots["libp2p-pubsub-rpc"]||(mf.roots["libp2p-pubsub-rpc"]={});Ri.RPC=function(){function r(e){if(this.subscriptions=[],this.msgs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.subscriptions=Ft.emptyArray,r.prototype.msgs=Ft.emptyArray,r.encode=function(t,i){if(i||(i=z8.create()),t.subscriptions!=null&&t.subscriptions.length)for(var n=0;n<t.subscriptions.length;++n)Ri.RPC.SubOpts.encode(t.subscriptions[n],i.uint32(10).fork()).ldelim();if(t.msgs!=null&&t.msgs.length)for(var n=0;n<t.msgs.length;++n)Ri.RPC.Message.encode(t.msgs[n],i.uint32(18).fork()).ldelim();return i},r.decode=function(t,i){t instanceof Mp||(t=Mp.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ri.RPC;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(Ri.RPC.SubOpts.decode(t,t.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(Ri.RPC.Message.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Ri.RPC)return t;var i=new Ri.RPC;if(t.subscriptions){if(!Array.isArray(t.subscriptions))throw TypeError(".RPC.subscriptions: array expected");i.subscriptions=[];for(var n=0;n<t.subscriptions.length;++n){if(typeof t.subscriptions[n]!="object")throw TypeError(".RPC.subscriptions: object expected");i.subscriptions[n]=Ri.RPC.SubOpts.fromObject(t.subscriptions[n])}}if(t.msgs){if(!Array.isArray(t.msgs))throw TypeError(".RPC.msgs: array expected");i.msgs=[];for(var n=0;n<t.msgs.length;++n){if(typeof t.msgs[n]!="object")throw TypeError(".RPC.msgs: object expected");i.msgs[n]=Ri.RPC.Message.fromObject(t.msgs[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.subscriptions=[],n.msgs=[]),t.subscriptions&&t.subscriptions.length){n.subscriptions=[];for(var s=0;s<t.subscriptions.length;++s)n.subscriptions[s]=Ri.RPC.SubOpts.toObject(t.subscriptions[s],i)}if(t.msgs&&t.msgs.length){n.msgs=[];for(var s=0;s<t.msgs.length;++s)n.msgs[s]=Ri.RPC.Message.toObject(t.msgs[s],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,mf.util.toJSONOptions)},r.SubOpts=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.subscribe=!1,e.prototype.topicID="",e.encode=function(i,n){return n||(n=z8.create()),i.subscribe!=null&&Object.hasOwnProperty.call(i,"subscribe")&&n.uint32(8).bool(i.subscribe),i.topicID!=null&&Object.hasOwnProperty.call(i,"topicID")&&n.uint32(18).string(i.topicID),n},e.decode=function(i,n){i instanceof Mp||(i=Mp.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ri.RPC.SubOpts;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.subscribe=i.bool();break;case 2:o.topicID=i.string();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ri.RPC.SubOpts)return i;var n=new Ri.RPC.SubOpts;return i.subscribe!=null&&(n.subscribe=Boolean(i.subscribe)),i.topicID!=null&&(n.topicID=String(i.topicID)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(s.subscribe=!1,s.topicID=""),i.subscribe!=null&&i.hasOwnProperty("subscribe")&&(s.subscribe=i.subscribe),i.topicID!=null&&i.hasOwnProperty("topicID")&&(s.topicID=i.topicID),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,mf.util.toJSONOptions)},e}(),r.Message=function(){function e(t){if(this.topicIDs=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.from=Ft.newBuffer([]),e.prototype.data=Ft.newBuffer([]),e.prototype.seqno=Ft.newBuffer([]),e.prototype.topicIDs=Ft.emptyArray,e.prototype.signature=Ft.newBuffer([]),e.prototype.key=Ft.newBuffer([]),e.encode=function(i,n){if(n||(n=z8.create()),i.from!=null&&Object.hasOwnProperty.call(i,"from")&&n.uint32(10).bytes(i.from),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&n.uint32(18).bytes(i.data),i.seqno!=null&&Object.hasOwnProperty.call(i,"seqno")&&n.uint32(26).bytes(i.seqno),i.topicIDs!=null&&i.topicIDs.length)for(var s=0;s<i.topicIDs.length;++s)n.uint32(34).string(i.topicIDs[s]);return i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&n.uint32(42).bytes(i.signature),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(50).bytes(i.key),n},e.decode=function(i,n){i instanceof Mp||(i=Mp.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ri.RPC.Message;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.from=i.bytes();break;case 2:o.data=i.bytes();break;case 3:o.seqno=i.bytes();break;case 4:o.topicIDs&&o.topicIDs.length||(o.topicIDs=[]),o.topicIDs.push(i.string());break;case 5:o.signature=i.bytes();break;case 6:o.key=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ri.RPC.Message)return i;var n=new Ri.RPC.Message;if(i.from!=null&&(typeof i.from=="string"?Ft.base64.decode(i.from,n.from=Ft.newBuffer(Ft.base64.length(i.from)),0):i.from.length&&(n.from=i.from)),i.data!=null&&(typeof i.data=="string"?Ft.base64.decode(i.data,n.data=Ft.newBuffer(Ft.base64.length(i.data)),0):i.data.length&&(n.data=i.data)),i.seqno!=null&&(typeof i.seqno=="string"?Ft.base64.decode(i.seqno,n.seqno=Ft.newBuffer(Ft.base64.length(i.seqno)),0):i.seqno.length&&(n.seqno=i.seqno)),i.topicIDs){if(!Array.isArray(i.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");n.topicIDs=[];for(var s=0;s<i.topicIDs.length;++s)n.topicIDs[s]=String(i.topicIDs[s])}return i.signature!=null&&(typeof i.signature=="string"?Ft.base64.decode(i.signature,n.signature=Ft.newBuffer(Ft.base64.length(i.signature)),0):i.signature.length&&(n.signature=i.signature)),i.key!=null&&(typeof i.key=="string"?Ft.base64.decode(i.key,n.key=Ft.newBuffer(Ft.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.topicIDs=[]),n.defaults&&(n.bytes===String?s.from="":(s.from=[],n.bytes!==Array&&(s.from=Ft.newBuffer(s.from))),n.bytes===String?s.data="":(s.data=[],n.bytes!==Array&&(s.data=Ft.newBuffer(s.data))),n.bytes===String?s.seqno="":(s.seqno=[],n.bytes!==Array&&(s.seqno=Ft.newBuffer(s.seqno))),n.bytes===String?s.signature="":(s.signature=[],n.bytes!==Array&&(s.signature=Ft.newBuffer(s.signature))),n.bytes===String?s.key="":(s.key=[],n.bytes!==Array&&(s.key=Ft.newBuffer(s.key)))),i.from!=null&&i.hasOwnProperty("from")&&(s.from=n.bytes===String?Ft.base64.encode(i.from,0,i.from.length):n.bytes===Array?Array.prototype.slice.call(i.from):i.from),i.data!=null&&i.hasOwnProperty("data")&&(s.data=n.bytes===String?Ft.base64.encode(i.data,0,i.data.length):n.bytes===Array?Array.prototype.slice.call(i.data):i.data),i.seqno!=null&&i.hasOwnProperty("seqno")&&(s.seqno=n.bytes===String?Ft.base64.encode(i.seqno,0,i.seqno.length):n.bytes===Array?Array.prototype.slice.call(i.seqno):i.seqno),i.topicIDs&&i.topicIDs.length){s.topicIDs=[];for(var o=0;o<i.topicIDs.length;++o)s.topicIDs[o]=i.topicIDs[o]}return i.signature!=null&&i.hasOwnProperty("signature")&&(s.signature=n.bytes===String?Ft.base64.encode(i.signature,0,i.signature.length):n.bytes===Array?Array.prototype.slice.call(i.signature):i.signature),i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?Ft.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,mf.util.toJSONOptions)},e}(),r}();eae.exports=Ri});var G8=p((USt,tae)=>{l();"use strict";var{Buffer:ra}=xt(),rae=Symbol.for("BufferList");function Tr(r){if(!(this instanceof Tr))return new Tr(r);Tr._init.call(this,r)}Tr._init=function(e){Object.defineProperty(this,rae,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Tr.prototype._new=function(e){return new Tr(e)};Tr.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};Tr.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};Tr.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};Tr.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};Tr.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||ra.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&t||0,f=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:ra.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,u),u+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-f)return s?this._bufs[o[0]].copy(e,t,f,f+c):this._bufs[o[0]].slice(f,f+c);s||(e=ra.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-f;if(c>d)this._bufs[h].copy(e,u,f),u+=d;else{this._bufs[h].copy(e,u,f,f+c),u+=d;break}c-=d,f&&(f=0)}return e.length>u?e.slice(0,u):e};Tr.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};Tr.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};Tr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Tr.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};Tr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(ra.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(ra.from(e));return this};Tr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Tr.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=ra.from([r]):typeof r=="string"?r=ra.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=ra.from(r.buffer,r.byteOffset,r.byteLength):ra.isBuffer(r)||(r=ra.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};Tr.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?Tr.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:Tr.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();Tr.prototype._isBufferList=function(e){return e instanceof Tr||Tr.isBufferList(e)};Tr.isBufferList=function(e){return e!=null&&e[rae]};tae.exports=Tr});var sae=p((KSt,iae)=>{l();iae.exports=$8;var nae=128,DYe=127,qYe=~DYe,MYe=Math.pow(2,31);function $8(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw $8.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=MYe;)e[t++]=r&255|nae,r/=128;for(;r&qYe;)e[t++]=r&255|nae,r>>>=7;return e[t]=r|0,$8.bytes=t-i+1,e}});var cae=p((jSt,oae)=>{l();oae.exports=W8;var LYe=128,aae=127;function W8(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw W8.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&aae)<<i:(s&aae)*Math.pow(2,i),i+=7}while(s>=LYe);return W8.bytes=n-e,t}});var fae=p((VSt,uae)=>{l();var FYe=Math.pow(2,7),UYe=Math.pow(2,14),KYe=Math.pow(2,21),jYe=Math.pow(2,28),VYe=Math.pow(2,35),zYe=Math.pow(2,42),HYe=Math.pow(2,49),GYe=Math.pow(2,56),$Ye=Math.pow(2,63);uae.exports=function(r){return r<FYe?1:r<UYe?2:r<KYe?3:r<jYe?4:r<VYe?5:r<zYe?6:r<HYe?7:r<GYe?8:r<$Ye?9:10}});var Y8=p((zSt,lae)=>{l();lae.exports={encode:sae(),decode:cae(),encodingLength:fae()}});var X8=p((HSt,hae)=>{l();"use strict";var dae=Y8(),{Buffer:WYe}=xt(),pae=(r,e,t)=>{let i=dae.encode(r,e,t);return pae.bytes=dae.encode.bytes,e||WYe.from(i)};hae.exports=pae});var wae=p((GSt,b_)=>{l();"use strict";var{Buffer:yae}=xt(),gae=G8(),bae=X8(),J8=8,mae=10*1024;function vae(r){r=r||{};let e=Math.max(r.poolSize||mae,r.minPoolSize||J8),t=r.lengthEncoder||bae;return async function*(n){let s=yae.alloc(e),o=0;for await(let a of n){t(a.length,s,o);let c=s.slice(o,o+t.bytes);o+=t.bytes,s.length-o<J8&&(s=yae.alloc(e),o=0),yield new gae().append(c).append(a)}}}vae.single=(r,e)=>{e=e||{};let t=e.lengthEncoder||bae;return new gae([t(r.length),r.slice()])};b_.exports=vae;b_.exports.MIN_POOL_SIZE=J8;b_.exports.DEFAULT_POOL_SIZE=mae});var Q8=p(($St,_ae)=>{l();"use strict";var Eae=Y8(),{Buffer:YYe}=xt(),XYe=r=>new Proxy({},{get:(e,t)=>t[0]==="l"?r[t]:r.get(parseInt(t))}),Sae=r=>{let e=Eae.decode(YYe.isBuffer(r)?r:XYe(r));return Sae.bytes=Eae.decode.bytes,e};_ae.exports=Sae});var Tae=p((WSt,m_)=>{l();"use strict";var{Buffer:JYe}=xt(),Z8=G8(),QYe=Q8(),xae=8,Aae=1024*1024*4,Iae=JYe.alloc(0),vf={LENGTH:"readLength",DATA:"readData"},ZYe={[vf.LENGTH]:(r,e,t,i)=>{e=e.append(r);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:vf.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return r=e.shallowSlice(i.lengthDecoder.bytes),e=new Z8,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(Iae),{mode:vf.LENGTH,chunk:r,buffer:e,data:Iae}):{mode:vf.DATA,chunk:r,buffer:e,state:{dataLength:n},data:void 0}},[vf.DATA]:(r,e,t,i)=>{if(e=e.append(r),!t)throw new Error("state is required");if(e.length<t.dataLength)return{mode:vf.DATA,buffer:e,state:t,chunk:void 0,data:void 0};let{dataLength:n}=t,s=e.shallowSlice(0,n),o=e.length>n?e.shallowSlice(n):void 0;return e=new Z8,i.onData&&i.onData(s),{mode:vf.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function eT(r){r=r||{};let e={lengthDecoder:r.lengthDecoder||QYe,maxLengthLength:r.maxLengthLength||xae,maxDataLength:r.maxDataLength||Aae,onLength:r.onLength,onData:r.onData};return async function*(i){let n=new Z8,s=vf.LENGTH,o;for await(let a of i){let c=a;for(;c;){let u=ZYe[s](c,n,o,e);s=u.mode,c=u.chunk,n=u.buffer,o=u.state,u.data&&(yield u.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}eT.fromReader=(r,e)=>{let t=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await r.next(t)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{t=1}}};return eT({...e||{},onLength:s=>{t=s}})(i)};m_.exports=eT;m_.exports.MAX_LENGTH_LENGTH=xae;m_.exports.MAX_DATA_LENGTH=Aae});var Cae=p((YSt,Rae)=>{l();"use strict";var{Buffer:eXe}=xt(),kae=(r,e,t)=>(e=e||eXe.allocUnsafe(4),e.writeInt32BE(r,t),e);kae.bytes=4;Rae.exports=kae});var Bae=p((XSt,Pae)=>{l();"use strict";var Oae=r=>{if(r.length<4)throw RangeError("Could not decode int32BE");return r.readInt32BE(0)};Oae.bytes=4;Pae.exports=Oae});var ia=p(Xl=>{l();"use strict";Xl.encode=wae();Xl.decode=Tae();Xl.varintEncode=X8();Xl.varintDecode=Q8();Xl.int32BEEncode=Cae();Xl.int32BEDecode=Bae()});var v_=p((QSt,Nae)=>{l();Nae.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var qae=p((ext,Dae)=>{l();Dae.exports=class extends Error{constructor(e,t){super(e||"The operation was aborted");this.type="aborted",this.code=t||"ABORT_ERR"}}});var cc=p((txt,Jl)=>{l();var tXe=v_(),tT=qae(),Mae=(r,e,t)=>rT(r,Array.isArray(e)?e:[{signal:e,options:t}]),rT=(r,e)=>{r=tXe(r),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*t(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:f}=c;throw new tT(u,f)}let o=new Promise((a,c)=>{i=()=>{let{options:u}=e.find(({signal:d})=>d.aborted),{abortMessage:f,abortCode:h}=u;c(new tT(f,h))}});s=await Promise.race([o,r.next()]),i=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",n);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(r),typeof r.return=="function"&&await r.return(),c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return t()},Fae=(r,e,t)=>Lae(r,Array.isArray(e)?e:[{signal:e,options:t}]),Lae=(r,e)=>t=>r(rT(t,e)),iXe=(r,e,t)=>rXe(r,Array.isArray(e)?e:[{signal:e,options:t}]),rXe=(r,e)=>({sink:Lae(r.sink,e),source:rT(r.source,e)});Jl.exports=Mae;Jl.exports.AbortError=tT;Jl.exports.source=Mae;Jl.exports.sink=Fae;Jl.exports.transform=Fae;Jl.exports.duplex=iXe});var Hae=p((rxt,Uae)=>{l();"use strict";var Kae=xe(),nXe=Object.assign(Kae("libp2p-pubsub:peer-streams"),{error:Kae("libp2p-pubsub:peer-streams:err")}),{EventEmitter:sXe}=Lr(),jae=ia(),oXe=Wc(),{pipe:Vae}=pi(),{source:aXe}=cc(),cXe=Uf().default,zae=class extends sXe{constructor({id:e,protocol:t}){super();this.id=e,this.protocol=t,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new cXe,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let t=this.id.toB58String();throw new Error("No writable connection to "+t)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=aXe(Vae(this._rawInboundStream,jae.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let t=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=oXe({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),Vae(this.outboundStream,jae.encode(),this._rawOutboundStream).catch(i=>{nXe.error(i)}),t||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};Uae.exports=zae});var $ae=p(Gae=>{l();"use strict";var uXe={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};Gae.SignaturePolicy=uXe});var Xae=p((nxt,Wae)=>{l();"use strict";var fXe=py(),lXe=tt(),Yae=ct(),hXe=dt(),dXe=ko(),pXe=()=>fXe(8),yXe=(r,e)=>{let t=hXe.createFromB58String(r).id,i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i},gXe=r=>dXe.encode(r,"sha2-256"),bXe=(r,e)=>{let t;Array.isArray(e)?t=i=>e.indexOf(i)>-1:t=i=>e.has(i);for(let i of r)if(t(i))return!0;return!1},mXe=r=>Array.isArray(r)?r:[r],vXe=(r,e)=>{let t=Object.assign({},r);return r.from instanceof Uint8Array&&(t.from=lXe(r.from,"base58btc")),e&&(t.receivedFrom=e),t},wXe=r=>{let e=Object.assign({},r);return typeof r.from=="string"&&(e.from=Yae(r.from,"base58btc")),typeof r.data=="string"&&(e.data=Yae(r.data)),e};Wae.exports={randomSeqno:pXe,msgId:yXe,noSignMsgId:gXe,anyMatch:bXe,ensureArray:mXe,normalizeInRpcMessage:vXe,normalizeOutRpcMessage:wXe}});var tce=p((sxt,Jae)=>{l();"use strict";var iT=dt(),{RPC:Qae}=H8(),Zae=vi(),_Xe=ct(),nT=_Xe("libp2p-pubsub:");async function EXe(r,e){let t=Zae([nT,Qae.Message.encode(e).finish()]),i=await r.privKey.sign(t);return{...e,signature:i,key:r.pubKey.bytes}}async function SXe(r){if(!r.signature)throw new Error("Message must contain a signature to be verified");let e=Zae([nT,Qae.Message.encode({...r,from:iT.createFromCID(r.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await ece(r)).verify(e,r.signature)}async function ece(r){if(!r.from)throw new Error("Could not get the public key from the originator id");let e=iT.createFromCID(r.from);if(r.key){let t=await iT.createFromPubKey(r.key);if(t.equals(e))return t.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}Jae.exports={messagePublicKey:ece,signMessage:EXe,SignPrefix:nT,verifySignature:SXe}});var sce=p((oxt,rce)=>{l();"use strict";var ice=xe(),{EventEmitter:xXe}=Lr(),is=ge(),{pipe:AXe}=pi(),IXe=y_(),{codes:na}=g_(),{RPC:nce}=H8(),TXe=Hae(),{SignaturePolicy:eu}=$ae(),tu=Xae(),{signMessage:RXe,verifySignature:kXe}=tce(),w_=class extends xXe{constructor({debugName:e,multicodecs:t,libp2p:i,globalSignaturePolicy:n=eu.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!t)throw new Error("multicodecs are required");if(!i)throw new Error("libp2p is required");super();if(this.log=Object.assign(ice(e),{err:ice(`${e}:error`)}),this.multicodecs=tu.ensureArray(t),this._libp2p=i,this.registrar=i.registrar,this.peerId=i.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!eu[n])throw is(new Error("Invalid global signature policy"),na.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new IXe({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=this.registrar.register(e),this.log("started"),this.started=!0}stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:t,connection:i}){let n=i.remotePeer,s=n.toB58String(),o=this._addPeer(n,e),a=o.attachInboundStream(t);this._processMessages(s,a,o)}async _onPeerConnected(e,t){let i=e.toB58String();this.log("connected",i);try{let{stream:n,protocol:s}=await t.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(n)}catch(n){this.log.err(n)}this._sendSubscriptions(i,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,t){let i=e.toB58String();this.log("connection ended",i,t?t.message:""),this._removePeer(e)}_addPeer(e,t){let i=e.toB58String(),n=this.peers.get(i);if(n)return n;this.log("new peer",i);let s=new TXe({id:e,protocol:t});return this.peers.set(i,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let t=e.toB58String(),i=this.peers.get(t);if(!!i){i.removeAllListeners(),i.close(),this.log("delete peer",t),this.peers.delete(t);for(let n of this.topics.values())n.delete(t);return i}}async _processMessages(e,t,i){try{await AXe(t,async n=>{for await(let s of n){let o=s instanceof Uint8Array?s:s.slice(),a=this._decodeRpc(o);this._processRpc(e,i,a)}})}catch(n){this._onPeerDisconnected(i.id,n)}}_processRpc(e,t,i){this.log("rpc from",e);let n=i.subscriptions,s=i.msgs;return n.length&&(n.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",t.id,n)),this._acceptFrom(e)?(s.length&&s.forEach(o=>{if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(c=>this.subscriptions.has(c)))){this.log("received message we didn't subscribe to. Dropping.");return}let a=tu.normalizeInRpcMessage(o,e);this._processRpcMessage(a)}),!0):(this.log("received message from unacceptable peer %s",e),!1)}_processRpcSubOpt(e,t){let i=t.topicID;if(!i)return;let n=this.topics.get(i);n||(n=new Set,this.topics.set(i,n)),t.subscribe?n.add(e):n.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(t){this.log("Message is invalid, dropping it. %O",t);return}this._emitMessage(e),this._publish(tu.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(t=>{this.subscriptions.has(t)&&this.emit(t,e)})}getMsgId(e){let t=this.globalSignaturePolicy;switch(t){case eu.StrictSign:return tu.msgId(e.from,e.seqno);case eu.StrictNoSign:return tu.noSignMsgId(e.data);default:throw is(new Error("Cannot get message id: unhandled signature policy: "+t),na.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return nce.decode(e)}_encodeRpc(e){return nce.encode(e).finish()}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable){let n=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(n);return}i.write(this._encodeRpc(t))}_sendSubscriptions(e,t,i){return this._sendRpc(e,{subscriptions:t.map(n=>({topicID:n,subscribe:i}))})}async validate(e){let t=this.globalSignaturePolicy;switch(t){case eu.StrictNoSign:if(e.from)throw is(new Error("StrictNoSigning: from should not be present"),na.ERR_UNEXPECTED_FROM);if(e.signature)throw is(new Error("StrictNoSigning: signature should not be present"),na.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw is(new Error("StrictNoSigning: key should not be present"),na.ERR_UNEXPECTED_KEY);if(e.seqno)throw is(new Error("StrictNoSigning: seqno should not be present"),na.ERR_UNEXPECTED_SEQNO);break;case eu.StrictSign:if(!e.signature)throw is(new Error("StrictSigning: Signing required and no signature was present"),na.ERR_MISSING_SIGNATURE);if(!e.seqno)throw is(new Error("StrictSigning: Signing required and no seqno was present"),na.ERR_MISSING_SEQNO);if(!await kXe(e))throw is(new Error("StrictSigning: Invalid message signature"),na.ERR_INVALID_SIGNATURE);break;default:throw is(new Error("Cannot validate message: unhandled signature policy: "+t),na.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let i of e.topicIDs){let n=this.topicValidators.get(i);n&&await n(i,e)}}_buildMessage(e){let t=this.globalSignaturePolicy;switch(t){case eu.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=tu.randomSeqno(),RXe(this.peerId,tu.normalizeOutRpcMessage(e));case eu.StrictNoSign:return Promise.resolve(e);default:throw is(new Error("Cannot build message: unhandled signature policy: "+t),na.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw is(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw is(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let t=this.topics.get(e);return t?Array.from(t):[]}async publish(e,t){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,t);let n={receivedFrom:this.peerId.toB58String(),data:t,topicIDs:[e]},s=await this._buildMessage(n),o=tu.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw is(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};w_.utils=tu;w_.SignaturePolicy=eu;rce.exports=w_});var oce=p(__=>{l();"use strict";Object.defineProperty(__,"__esModule",{value:!0});__.createGossipRpc=void 0;function CXe(r=[],e={}){return{subscriptions:[],msgs:r,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}__.createGossipRpc=CXe});var ace=p(E_=>{l();"use strict";Object.defineProperty(E_,"__esModule",{value:!0});E_.shuffle=void 0;function PXe(r){if(r.length<=1)return r;let e=()=>Math.floor(Math.random()*Math.floor(r.length));for(let t=0;t<r.length;t++){let i=e(),n=r[t];r[t]=r[i],r[i]=n}return r}E_.shuffle=PXe});var Ql=p(Ce=>{l();"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.ERR_TOPIC_VALIDATOR_IGNORE=Ce.ERR_TOPIC_VALIDATOR_REJECT=Ce.TimeCacheDuration=Ce.GossipsubIWantFollowupTime=Ce.GossipsubMaxIHaveMessages=Ce.GossipsubMaxIHaveLength=Ce.GossipsubGraftFloodThreshold=Ce.GossipsubOpportunisticGraftPeers=Ce.GossipsubOpportunisticGraftTicks=Ce.GossipsubDirectConnectInitialDelay=Ce.GossipsubDirectConnectTicks=Ce.GossipsubConnectionTimeout=Ce.GossipsubMaxPendingConnections=Ce.GossipsubConnectors=Ce.GossipsubPruneBackoffTicks=Ce.GossipsubPruneBackoff=Ce.GossipsubPrunePeers=Ce.GossipsubFanoutTTL=Ce.GossipsubHeartbeatInterval=Ce.GossipsubHeartbeatInitialDelay=Ce.GossipsubGossipRetransmission=Ce.GossipsubGossipFactor=Ce.GossipsubDlazy=Ce.GossipsubHistoryGossip=Ce.GossipsubHistoryLength=Ce.GossipsubDout=Ce.GossipsubDscore=Ce.GossipsubDhi=Ce.GossipsubDlo=Ce.GossipsubD=Ce.GossipsubIDv11=Ce.GossipsubIDv10=Ce.FloodsubID=Ce.minute=Ce.second=void 0;Ce.second=1e3;Ce.minute=60*Ce.second;Ce.FloodsubID="/floodsub/1.0.0";Ce.GossipsubIDv10="/meshsub/1.0.0";Ce.GossipsubIDv11="/meshsub/1.1.0";Ce.GossipsubD=6;Ce.GossipsubDlo=4;Ce.GossipsubDhi=12;Ce.GossipsubDscore=4;Ce.GossipsubDout=2;Ce.GossipsubHistoryLength=5;Ce.GossipsubHistoryGossip=3;Ce.GossipsubDlazy=6;Ce.GossipsubGossipFactor=.25;Ce.GossipsubGossipRetransmission=3;Ce.GossipsubHeartbeatInitialDelay=100;Ce.GossipsubHeartbeatInterval=Ce.second;Ce.GossipsubFanoutTTL=Ce.minute;Ce.GossipsubPrunePeers=16;Ce.GossipsubPruneBackoff=Ce.minute;Ce.GossipsubPruneBackoffTicks=15;Ce.GossipsubConnectors=8;Ce.GossipsubMaxPendingConnections=128;Ce.GossipsubConnectionTimeout=30*Ce.second;Ce.GossipsubDirectConnectTicks=300;Ce.GossipsubDirectConnectInitialDelay=Ce.second;Ce.GossipsubOpportunisticGraftTicks=60;Ce.GossipsubOpportunisticGraftPeers=2;Ce.GossipsubGraftFloodThreshold=10*Ce.second;Ce.GossipsubMaxIHaveLength=5e3;Ce.GossipsubMaxIHaveMessages=10;Ce.GossipsubIWantFollowupTime=3*Ce.second;Ce.TimeCacheDuration=120*1e3;Ce.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";Ce.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE"});var uce=p(S_=>{l();"use strict";Object.defineProperty(S_,"__esModule",{value:!0});S_.hasGossipProtocol=void 0;var cce=Ql();function OXe(r){return r===cce.GossipsubIDv10||r===cce.GossipsubIDv11}S_.hasGossipProtocol=OXe});var fce=p(x_=>{l();"use strict";Object.defineProperty(x_,"__esModule",{value:!0});x_.messageIdToString=void 0;var BXe=tt();function NXe(r){return BXe(r,"base64")}x_.messageIdToString=NXe});var Zl=p(uc=>{l();"use strict";var DXe=uc&&uc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),A_=uc&&uc.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&DXe(e,r,t)};Object.defineProperty(uc,"__esModule",{value:!0});A_(oce(),uc);A_(ace(),uc);A_(uce(),uc);A_(fce(),uc)});var hce=p(I_=>{l();"use strict";Object.defineProperty(I_,"__esModule",{value:!0});I_.MessageCache=void 0;var T_=Zl(),lce=class{constructor(e,t,i){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let n=0;n<t;n++)this.history[n]=[];this.gossip=e,this.msgIdFn=i}put(e){let t=this.getMsgId(e),i=T_.messageIdToString(t);this.msgs.set(i,e),this.history[0].push({msgID:t,topics:e.topicIDs})}getMsgId(e){return this.msgIdFn(e)}get(e){return this.msgs.get(T_.messageIdToString(e))}getForPeer(e,t){let i=T_.messageIdToString(e),n=this.msgs.get(i);if(!n)return[void 0,0];let s=this.peertx.get(i);s||(s=new Map,this.peertx.set(i,s));let o=(s.get(t)||0)+1;return s.set(t,o),[n,o]}getGossipIDs(e){let t=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{for(let s of n.topics)if(s===e){t.push(n.msgID);break}});return t}shift(){this.history[this.history.length-1].forEach(t=>{let i=T_.messageIdToString(t.msgID);this.msgs.delete(i),this.peertx.delete(i)}),this.history.pop(),this.history.unshift([])}};I_.MessageCache=lce});var pce=p((dce,g1)=>{l();(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof g1=="object"&&g1&&g1.exports&&(g1.exports=e(hi()))})(dce,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots.default||(r.roots.default={});return n.RPC=function(){function s(a){if(this.subscriptions=[],this.msgs=[],a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}s.prototype.subscriptions=i.emptyArray,s.prototype.msgs=i.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(o=["control"]),set:i.oneOfSetter(o)}),s.encode=function(c,u){if(u||(u=t.create()),c.subscriptions!=null&&c.subscriptions.length)for(var f=0;f<c.subscriptions.length;++f)n.RPC.SubOpts.encode(c.subscriptions[f],u.uint32(10).fork()).ldelim();if(c.msgs!=null&&c.msgs.length)for(var f=0;f<c.msgs.length;++f)n.RPC.Message.encode(c.msgs[f],u.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&n.RPC.ControlMessage.encode(c.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(c,u){c instanceof e||(c=e.create(c));for(var f=u===void 0?c.len:c.pos+u,h=new n.RPC;c.pos<f;){var d=c.uint32();switch(d>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(n.RPC.SubOpts.decode(c,c.uint32()));break;case 2:h.msgs&&h.msgs.length||(h.msgs=[]),h.msgs.push(n.RPC.Message.decode(c,c.uint32()));break;case 3:h.control=n.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(d&7);break}}return h},s.fromObject=function(c){if(c instanceof n.RPC)return c;var u=new n.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var f=0;f<c.subscriptions.length;++f){if(typeof c.subscriptions[f]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[f]=n.RPC.SubOpts.fromObject(c.subscriptions[f])}}if(c.msgs){if(!Array.isArray(c.msgs))throw TypeError(".RPC.msgs: array expected");u.msgs=[];for(var f=0;f<c.msgs.length;++f){if(typeof c.msgs[f]!="object")throw TypeError(".RPC.msgs: object expected");u.msgs[f]=n.RPC.Message.fromObject(c.msgs[f])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");u.control=n.RPC.ControlMessage.fromObject(c.control)}return u},s.toObject=function(c,u){u||(u={});var f={};if((u.arrays||u.defaults)&&(f.subscriptions=[],f.msgs=[]),c.subscriptions&&c.subscriptions.length){f.subscriptions=[];for(var h=0;h<c.subscriptions.length;++h)f.subscriptions[h]=n.RPC.SubOpts.toObject(c.subscriptions[h],u)}if(c.msgs&&c.msgs.length){f.msgs=[];for(var h=0;h<c.msgs.length;++h)f.msgs[h]=n.RPC.Message.toObject(c.msgs[h],u)}return c.control!=null&&c.hasOwnProperty("control")&&(f.control=n.RPC.ControlMessage.toObject(c.control,u),u.oneofs&&(f._control="control")),f},s.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},s.SubOpts=function(){function a(u){if(u)for(var f=Object.keys(u),h=0;h<f.length;++h)u[f[h]]!=null&&(this[f[h]]=u[f[h]])}a.prototype.subscribe=null,a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:i.oneOfGetter(c=["subscribe"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(f,h){return h||(h=t.create()),f.subscribe!=null&&Object.hasOwnProperty.call(f,"subscribe")&&h.uint32(8).bool(f.subscribe),f.topicID!=null&&Object.hasOwnProperty.call(f,"topicID")&&h.uint32(18).string(f.topicID),h},a.decode=function(f,h){f instanceof e||(f=e.create(f));for(var d=h===void 0?f.len:f.pos+h,y=new n.RPC.SubOpts;f.pos<d;){var g=f.uint32();switch(g>>>3){case 1:y.subscribe=f.bool();break;case 2:y.topicID=f.string();break;default:f.skipType(g&7);break}}return y},a.fromObject=function(f){if(f instanceof n.RPC.SubOpts)return f;var h=new n.RPC.SubOpts;return f.subscribe!=null&&(h.subscribe=Boolean(f.subscribe)),f.topicID!=null&&(h.topicID=String(f.topicID)),h},a.toObject=function(f,h){h||(h={});var d={};return f.subscribe!=null&&f.hasOwnProperty("subscribe")&&(d.subscribe=f.subscribe,h.oneofs&&(d._subscribe="subscribe")),f.topicID!=null&&f.hasOwnProperty("topicID")&&(d.topicID=f.topicID,h.oneofs&&(d._topicID="topicID")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.Message=function(){function a(u){if(this.topicIDs=[],u)for(var f=Object.keys(u),h=0;h<f.length;++h)u[f[h]]!=null&&(this[f[h]]=u[f[h]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topicIDs=i.emptyArray,a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:i.oneOfGetter(c=["from"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:i.oneOfGetter(c=["data"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:i.oneOfGetter(c=["seqno"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:i.oneOfGetter(c=["signature"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:i.oneOfGetter(c=["key"]),set:i.oneOfSetter(c)}),a.encode=function(f,h){if(h||(h=t.create()),f.from!=null&&Object.hasOwnProperty.call(f,"from")&&h.uint32(10).bytes(f.from),f.data!=null&&Object.hasOwnProperty.call(f,"data")&&h.uint32(18).bytes(f.data),f.seqno!=null&&Object.hasOwnProperty.call(f,"seqno")&&h.uint32(26).bytes(f.seqno),f.topicIDs!=null&&f.topicIDs.length)for(var d=0;d<f.topicIDs.length;++d)h.uint32(34).string(f.topicIDs[d]);return f.signature!=null&&Object.hasOwnProperty.call(f,"signature")&&h.uint32(42).bytes(f.signature),f.key!=null&&Object.hasOwnProperty.call(f,"key")&&h.uint32(50).bytes(f.key),h},a.decode=function(f,h){f instanceof e||(f=e.create(f));for(var d=h===void 0?f.len:f.pos+h,y=new n.RPC.Message;f.pos<d;){var g=f.uint32();switch(g>>>3){case 1:y.from=f.bytes();break;case 2:y.data=f.bytes();break;case 3:y.seqno=f.bytes();break;case 4:y.topicIDs&&y.topicIDs.length||(y.topicIDs=[]),y.topicIDs.push(f.string());break;case 5:y.signature=f.bytes();break;case 6:y.key=f.bytes();break;default:f.skipType(g&7);break}}return y},a.fromObject=function(f){if(f instanceof n.RPC.Message)return f;var h=new n.RPC.Message;if(f.from!=null&&(typeof f.from=="string"?i.base64.decode(f.from,h.from=i.newBuffer(i.base64.length(f.from)),0):f.from.length&&(h.from=f.from)),f.data!=null&&(typeof f.data=="string"?i.base64.decode(f.data,h.data=i.newBuffer(i.base64.length(f.data)),0):f.data.length&&(h.data=f.data)),f.seqno!=null&&(typeof f.seqno=="string"?i.base64.decode(f.seqno,h.seqno=i.newBuffer(i.base64.length(f.seqno)),0):f.seqno.length&&(h.seqno=f.seqno)),f.topicIDs){if(!Array.isArray(f.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");h.topicIDs=[];for(var d=0;d<f.topicIDs.length;++d)h.topicIDs[d]=String(f.topicIDs[d])}return f.signature!=null&&(typeof f.signature=="string"?i.base64.decode(f.signature,h.signature=i.newBuffer(i.base64.length(f.signature)),0):f.signature.length&&(h.signature=f.signature)),f.key!=null&&(typeof f.key=="string"?i.base64.decode(f.key,h.key=i.newBuffer(i.base64.length(f.key)),0):f.key.length&&(h.key=f.key)),h},a.toObject=function(f,h){h||(h={});var d={};if((h.arrays||h.defaults)&&(d.topicIDs=[]),f.from!=null&&f.hasOwnProperty("from")&&(d.from=h.bytes===String?i.base64.encode(f.from,0,f.from.length):h.bytes===Array?Array.prototype.slice.call(f.from):f.from,h.oneofs&&(d._from="from")),f.data!=null&&f.hasOwnProperty("data")&&(d.data=h.bytes===String?i.base64.encode(f.data,0,f.data.length):h.bytes===Array?Array.prototype.slice.call(f.data):f.data,h.oneofs&&(d._data="data")),f.seqno!=null&&f.hasOwnProperty("seqno")&&(d.seqno=h.bytes===String?i.base64.encode(f.seqno,0,f.seqno.length):h.bytes===Array?Array.prototype.slice.call(f.seqno):f.seqno,h.oneofs&&(d._seqno="seqno")),f.topicIDs&&f.topicIDs.length){d.topicIDs=[];for(var y=0;y<f.topicIDs.length;++y)d.topicIDs[y]=f.topicIDs[y]}return f.signature!=null&&f.hasOwnProperty("signature")&&(d.signature=h.bytes===String?i.base64.encode(f.signature,0,f.signature.length):h.bytes===Array?Array.prototype.slice.call(f.signature):f.signature,h.oneofs&&(d._signature="signature")),f.key!=null&&f.hasOwnProperty("key")&&(d.key=h.bytes===String?i.base64.encode(f.key,0,f.key.length):h.bytes===Array?Array.prototype.slice.call(f.key):f.key,h.oneofs&&(d._key="key")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var u=Object.keys(c),f=0;f<u.length;++f)c[u[f]]!=null&&(this[u[f]]=c[u[f]])}return a.prototype.ihave=i.emptyArray,a.prototype.iwant=i.emptyArray,a.prototype.graft=i.emptyArray,a.prototype.prune=i.emptyArray,a.encode=function(u,f){if(f||(f=t.create()),u.ihave!=null&&u.ihave.length)for(var h=0;h<u.ihave.length;++h)n.RPC.ControlIHave.encode(u.ihave[h],f.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var h=0;h<u.iwant.length;++h)n.RPC.ControlIWant.encode(u.iwant[h],f.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var h=0;h<u.graft.length;++h)n.RPC.ControlGraft.encode(u.graft[h],f.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var h=0;h<u.prune.length;++h)n.RPC.ControlPrune.encode(u.prune[h],f.uint32(34).fork()).ldelim();return f},a.decode=function(u,f){u instanceof e||(u=e.create(u));for(var h=f===void 0?u.len:u.pos+f,d=new n.RPC.ControlMessage;u.pos<h;){var y=u.uint32();switch(y>>>3){case 1:d.ihave&&d.ihave.length||(d.ihave=[]),d.ihave.push(n.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:d.iwant&&d.iwant.length||(d.iwant=[]),d.iwant.push(n.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:d.graft&&d.graft.length||(d.graft=[]),d.graft.push(n.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:d.prune&&d.prune.length||(d.prune=[]),d.prune.push(n.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(y&7);break}}return d},a.fromObject=function(u){if(u instanceof n.RPC.ControlMessage)return u;var f=new n.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");f.ihave=[];for(var h=0;h<u.ihave.length;++h){if(typeof u.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");f.ihave[h]=n.RPC.ControlIHave.fromObject(u.ihave[h])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");f.iwant=[];for(var h=0;h<u.iwant.length;++h){if(typeof u.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");f.iwant[h]=n.RPC.ControlIWant.fromObject(u.iwant[h])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");f.graft=[];for(var h=0;h<u.graft.length;++h){if(typeof u.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");f.graft[h]=n.RPC.ControlGraft.fromObject(u.graft[h])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");f.prune=[];for(var h=0;h<u.prune.length;++h){if(typeof u.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");f.prune[h]=n.RPC.ControlPrune.fromObject(u.prune[h])}}return f},a.toObject=function(u,f){f||(f={});var h={};if((f.arrays||f.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),u.ihave&&u.ihave.length){h.ihave=[];for(var d=0;d<u.ihave.length;++d)h.ihave[d]=n.RPC.ControlIHave.toObject(u.ihave[d],f)}if(u.iwant&&u.iwant.length){h.iwant=[];for(var d=0;d<u.iwant.length;++d)h.iwant[d]=n.RPC.ControlIWant.toObject(u.iwant[d],f)}if(u.graft&&u.graft.length){h.graft=[];for(var d=0;d<u.graft.length;++d)h.graft[d]=n.RPC.ControlGraft.toObject(u.graft[d],f)}if(u.prune&&u.prune.length){h.prune=[];for(var d=0;d<u.prune.length;++d)h.prune[d]=n.RPC.ControlPrune.toObject(u.prune[d],f)}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var f=Object.keys(u),h=0;h<f.length;++h)u[f[h]]!=null&&(this[f[h]]=u[f[h]])}a.prototype.topicID=null,a.prototype.messageIDs=i.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(f,h){if(h||(h=t.create()),f.topicID!=null&&Object.hasOwnProperty.call(f,"topicID")&&h.uint32(10).string(f.topicID),f.messageIDs!=null&&f.messageIDs.length)for(var d=0;d<f.messageIDs.length;++d)h.uint32(18).bytes(f.messageIDs[d]);return h},a.decode=function(f,h){f instanceof e||(f=e.create(f));for(var d=h===void 0?f.len:f.pos+h,y=new n.RPC.ControlIHave;f.pos<d;){var g=f.uint32();switch(g>>>3){case 1:y.topicID=f.string();break;case 2:y.messageIDs&&y.messageIDs.length||(y.messageIDs=[]),y.messageIDs.push(f.bytes());break;default:f.skipType(g&7);break}}return y},a.fromObject=function(f){if(f instanceof n.RPC.ControlIHave)return f;var h=new n.RPC.ControlIHave;if(f.topicID!=null&&(h.topicID=String(f.topicID)),f.messageIDs){if(!Array.isArray(f.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var d=0;d<f.messageIDs.length;++d)typeof f.messageIDs[d]=="string"?i.base64.decode(f.messageIDs[d],h.messageIDs[d]=i.newBuffer(i.base64.length(f.messageIDs[d])),0):f.messageIDs[d].length&&(h.messageIDs[d]=f.messageIDs[d])}return h},a.toObject=function(f,h){h||(h={});var d={};if((h.arrays||h.defaults)&&(d.messageIDs=[]),f.topicID!=null&&f.hasOwnProperty("topicID")&&(d.topicID=f.topicID,h.oneofs&&(d._topicID="topicID")),f.messageIDs&&f.messageIDs.length){d.messageIDs=[];for(var y=0;y<f.messageIDs.length;++y)d.messageIDs[y]=h.bytes===String?i.base64.encode(f.messageIDs[y],0,f.messageIDs[y].length):h.bytes===Array?Array.prototype.slice.call(f.messageIDs[y]):f.messageIDs[y]}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var u=Object.keys(c),f=0;f<u.length;++f)c[u[f]]!=null&&(this[u[f]]=c[u[f]])}return a.prototype.messageIDs=i.emptyArray,a.encode=function(u,f){if(f||(f=t.create()),u.messageIDs!=null&&u.messageIDs.length)for(var h=0;h<u.messageIDs.length;++h)f.uint32(10).bytes(u.messageIDs[h]);return f},a.decode=function(u,f){u instanceof e||(u=e.create(u));for(var h=f===void 0?u.len:u.pos+f,d=new n.RPC.ControlIWant;u.pos<h;){var y=u.uint32();switch(y>>>3){case 1:d.messageIDs&&d.messageIDs.length||(d.messageIDs=[]),d.messageIDs.push(u.bytes());break;default:u.skipType(y&7);break}}return d},a.fromObject=function(u){if(u instanceof n.RPC.ControlIWant)return u;var f=new n.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");f.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)typeof u.messageIDs[h]=="string"?i.base64.decode(u.messageIDs[h],f.messageIDs[h]=i.newBuffer(i.base64.length(u.messageIDs[h])),0):u.messageIDs[h].length&&(f.messageIDs[h]=u.messageIDs[h])}return f},a.toObject=function(u,f){f||(f={});var h={};if((f.arrays||f.defaults)&&(h.messageIDs=[]),u.messageIDs&&u.messageIDs.length){h.messageIDs=[];for(var d=0;d<u.messageIDs.length;++d)h.messageIDs[d]=f.bytes===String?i.base64.encode(u.messageIDs[d],0,u.messageIDs[d].length):f.bytes===Array?Array.prototype.slice.call(u.messageIDs[d]):u.messageIDs[d]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(u){if(u)for(var f=Object.keys(u),h=0;h<f.length;++h)u[f[h]]!=null&&(this[f[h]]=u[f[h]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(f,h){return h||(h=t.create()),f.topicID!=null&&Object.hasOwnProperty.call(f,"topicID")&&h.uint32(10).string(f.topicID),h},a.decode=function(f,h){f instanceof e||(f=e.create(f));for(var d=h===void 0?f.len:f.pos+h,y=new n.RPC.ControlGraft;f.pos<d;){var g=f.uint32();switch(g>>>3){case 1:y.topicID=f.string();break;default:f.skipType(g&7);break}}return y},a.fromObject=function(f){if(f instanceof n.RPC.ControlGraft)return f;var h=new n.RPC.ControlGraft;return f.topicID!=null&&(h.topicID=String(f.topicID)),h},a.toObject=function(f,h){h||(h={});var d={};return f.topicID!=null&&f.hasOwnProperty("topicID")&&(d.topicID=f.topicID,h.oneofs&&(d._topicID="topicID")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var f=Object.keys(u),h=0;h<f.length;++h)u[f[h]]!=null&&(this[f[h]]=u[f[h]])}a.prototype.topicID=null,a.prototype.peers=i.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:i.oneOfGetter(c=["backoff"]),set:i.oneOfSetter(c)}),a.encode=function(f,h){if(h||(h=t.create()),f.topicID!=null&&Object.hasOwnProperty.call(f,"topicID")&&h.uint32(10).string(f.topicID),f.peers!=null&&f.peers.length)for(var d=0;d<f.peers.length;++d)n.RPC.PeerInfo.encode(f.peers[d],h.uint32(18).fork()).ldelim();return f.backoff!=null&&Object.hasOwnProperty.call(f,"backoff")&&h.uint32(24).uint64(f.backoff),h},a.decode=function(f,h){f instanceof e||(f=e.create(f));for(var d=h===void 0?f.len:f.pos+h,y=new n.RPC.ControlPrune;f.pos<d;){var g=f.uint32();switch(g>>>3){case 1:y.topicID=f.string();break;case 2:y.peers&&y.peers.length||(y.peers=[]),y.peers.push(n.RPC.PeerInfo.decode(f,f.uint32()));break;case 3:y.backoff=f.uint64();break;default:f.skipType(g&7);break}}return y},a.fromObject=function(f){if(f instanceof n.RPC.ControlPrune)return f;var h=new n.RPC.ControlPrune;if(f.topicID!=null&&(h.topicID=String(f.topicID)),f.peers){if(!Array.isArray(f.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var d=0;d<f.peers.length;++d){if(typeof f.peers[d]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[d]=n.RPC.PeerInfo.fromObject(f.peers[d])}}return f.backoff!=null&&(i.Long?(h.backoff=i.Long.fromValue(f.backoff)).unsigned=!0:typeof f.backoff=="string"?h.backoff=parseInt(f.backoff,10):typeof f.backoff=="number"?h.backoff=f.backoff:typeof f.backoff=="object"&&(h.backoff=new i.LongBits(f.backoff.low>>>0,f.backoff.high>>>0).toNumber(!0))),h},a.toObject=function(f,h){h||(h={});var d={};if((h.arrays||h.defaults)&&(d.peers=[]),f.topicID!=null&&f.hasOwnProperty("topicID")&&(d.topicID=f.topicID,h.oneofs&&(d._topicID="topicID")),f.peers&&f.peers.length){d.peers=[];for(var y=0;y<f.peers.length;++y)d.peers[y]=n.RPC.PeerInfo.toObject(f.peers[y],h)}return f.backoff!=null&&f.hasOwnProperty("backoff")&&(typeof f.backoff=="number"?d.backoff=h.longs===String?String(f.backoff):f.backoff:d.backoff=h.longs===String?i.Long.prototype.toString.call(f.backoff):h.longs===Number?new i.LongBits(f.backoff.low>>>0,f.backoff.high>>>0).toNumber(!0):f.backoff,h.oneofs&&(d._backoff="backoff")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(u){if(u)for(var f=Object.keys(u),h=0;h<f.length;++h)u[f[h]]!=null&&(this[f[h]]=u[f[h]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:i.oneOfGetter(c=["peerID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:i.oneOfGetter(c=["signedPeerRecord"]),set:i.oneOfSetter(c)}),a.encode=function(f,h){return h||(h=t.create()),f.peerID!=null&&Object.hasOwnProperty.call(f,"peerID")&&h.uint32(10).bytes(f.peerID),f.signedPeerRecord!=null&&Object.hasOwnProperty.call(f,"signedPeerRecord")&&h.uint32(18).bytes(f.signedPeerRecord),h},a.decode=function(f,h){f instanceof e||(f=e.create(f));for(var d=h===void 0?f.len:f.pos+h,y=new n.RPC.PeerInfo;f.pos<d;){var g=f.uint32();switch(g>>>3){case 1:y.peerID=f.bytes();break;case 2:y.signedPeerRecord=f.bytes();break;default:f.skipType(g&7);break}}return y},a.fromObject=function(f){if(f instanceof n.RPC.PeerInfo)return f;var h=new n.RPC.PeerInfo;return f.peerID!=null&&(typeof f.peerID=="string"?i.base64.decode(f.peerID,h.peerID=i.newBuffer(i.base64.length(f.peerID)),0):f.peerID.length&&(h.peerID=f.peerID)),f.signedPeerRecord!=null&&(typeof f.signedPeerRecord=="string"?i.base64.decode(f.signedPeerRecord,h.signedPeerRecord=i.newBuffer(i.base64.length(f.signedPeerRecord)),0):f.signedPeerRecord.length&&(h.signedPeerRecord=f.signedPeerRecord)),h},a.toObject=function(f,h){h||(h={});var d={};return f.peerID!=null&&f.hasOwnProperty("peerID")&&(d.peerID=h.bytes===String?i.base64.encode(f.peerID,0,f.peerID.length):h.bytes===Array?Array.prototype.slice.call(f.peerID):f.peerID,h.oneofs&&(d._peerID="peerID")),f.signedPeerRecord!=null&&f.hasOwnProperty("signedPeerRecord")&&(d.signedPeerRecord=h.bytes===String?i.base64.encode(f.signedPeerRecord,0,f.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(f.signedPeerRecord):f.signedPeerRecord,h.oneofs&&(d._signedPeerRecord="signedPeerRecord")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s}(),n})});var sT=p(R_=>{l();"use strict";Object.defineProperty(R_,"__esModule",{value:!0});R_.getGossipPeers=void 0;var yce=Zl();function qXe(r,e,t,i=()=>!0){let n=r.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(o=>{let a=r.peers.get(o);!a||yce.hasGossipProtocol(a.protocol)&&i(o)&&s.push(o)}),s=yce.shuffle(s),t>0&&s.length>t&&(s=s.slice(0,t)),new Set(s)}R_.getGossipPeers=qXe});var bce=p(fc=>{l();"use strict";var MXe=fc&&fc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),LXe=fc&&fc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),FXe=fc&&fc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&MXe(e,r,t);return LXe(e,r),e};Object.defineProperty(fc,"__esModule",{value:!0});fc.Heartbeat=void 0;var b1=FXe(Ql()),k_=sT(),UXe=Zl(),gce=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),t=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,b1.GossipsubHeartbeatInterval)},b1.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(i,n)=>{this._heartbeatTimer._intervalId=setInterval(i,n)},cancel:()=>{clearTimeout(t),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:t,Dhi:i,Dscore:n,Dout:s}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let o=new Map,a=d=>{let y=o.get(d);return y===void 0&&(y=this.gossipsub.score.score(d),o.set(d,y)),y},c=new Map,u=new Map,f=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((d,y)=>{let g=x=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",x,y),this.gossipsub.score.prune(x,y),this.gossipsub._addBackoff(x,y),d.delete(x);let _=u.get(x);_?_.push(y):u.set(x,[y])},m=x=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",x,y),this.gossipsub.score.graft(x,y),d.add(x);let _=c.get(x);_?_.push(y):c.set(x,[y])};if(d.forEach(x=>{let _=a(x);_<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",x,_,y),g(x),f.set(x,!0))}),d.size<t){let x=this.gossipsub.backoff.get(y),_=e-d.size;k_.getGossipPeers(this.gossipsub,y,_,q=>!d.has(q)&&!this.gossipsub.direct.has(q)&&(!x||!x.has(q))&&a(q)>=0).forEach(m)}if(d.size>i){let x=Array.from(d);x.sort((P,q)=>a(q)-a(P)),x=x.slice(0,n).concat(UXe.shuffle(x.slice(n)));let _=0;if(x.slice(0,e).forEach(P=>{this.gossipsub.outbound.get(P)&&_++}),_<s){let P=X=>{let W=x[X];for(let z=X;z>0;z--)x[z]=x[z-1];x[0]=W};if(_>0){let X=_;for(let W=1;W<e&&X>0;W++)this.gossipsub.outbound.get(x[W])&&(P(W),X--)}let q=e-_;for(let X=e;X<x.length&&q>0;X++)this.gossipsub.outbound.get(x[X])&&(P(X),q--)}x.slice(e).forEach(g)}if(d.size>=t){let x=0;if(d.forEach(_=>{this.gossipsub.outbound.get(_)&&x++}),x<s){let _=s-x,P=this.gossipsub.backoff.get(y);k_.getGossipPeers(this.gossipsub,y,_,q=>!d.has(q)&&!this.gossipsub.direct.has(q)&&(!P||!P.has(q))&&a(q)>=0).forEach(m)}}if(this.gossipsub.heartbeatTicks%b1.GossipsubOpportunisticGraftTicks==0&&d.size>1){let x=Array.from(d).sort((q,X)=>a(q)-a(X)),_=d.size/2,P=a(x[_]);if(P<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let q=this.gossipsub.backoff.get(y);k_.getGossipPeers(this.gossipsub,y,b1.GossipsubOpportunisticGraftPeers,W=>d.has(W)&&!this.gossipsub.direct.has(W)&&(!q||!q.has(W))&&a(W)>P).forEach(W=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",W,y),m(W)})}}this.gossipsub._emitGossip(y,d)});let h=this.gossipsub._now();this.gossipsub.lastpub.forEach((d,y)=>{d+b1.GossipsubFanoutTTL<h&&(this.gossipsub.fanout.delete(y),this.gossipsub.lastpub.delete(y))}),this.gossipsub.fanout.forEach((d,y)=>{let g=this.gossipsub.topics.get(y);if(d.forEach(m=>{(!g.has(m)||a(m)<this.gossipsub._options.scoreThresholds.publishThreshold)&&d.delete(m)}),d.size<e){let m=e-d.size;k_.getGossipPeers(this.gossipsub,y,m,_=>!d.has(_)&&!this.gossipsub.direct.has(_)&&a(_)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(_=>{d.add(_)})}this.gossipsub._emitGossip(y,d)}),this.gossipsub._sendGraftPrune(c,u,f),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};fc.Heartbeat=gce});var oT=p(Lp=>{l();"use strict";Object.defineProperty(Lp,"__esModule",{value:!0});Lp.ERR_INVALID_PEER_SCORE_THRESHOLDS=Lp.ERR_INVALID_PEER_SCORE_PARAMS=void 0;Lp.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";Lp.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var aT=p((bxt,mce)=>{l();"use strict";function vce(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function KXe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=void 0),e!=null&&(t.code=e);try{return vce(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),vce(new n,t)}}mce.exports=KXe});var cT=p(_n=>{l();"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.validateTopicScoreParams=_n.validatePeerScoreParams=_n.createTopicScoreParams=_n.createPeerScoreParams=_n.defaultTopicScoreParams=_n.defaultPeerScoreParams=void 0;var vr=oT(),wr=aT();_n.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};_n.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function jXe(r={}){return Object.assign(Object.assign(Object.assign({},_n.defaultPeerScoreParams),r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=wce(i),e),{}):{}})}_n.createPeerScoreParams=jXe;function wce(r={}){return Object.assign(Object.assign({},_n.defaultTopicScoreParams),r)}_n.createTopicScoreParams=wce;function VXe(r){for(let[e,t]of Object.entries(r.topics))try{_ce(t)}catch(i){throw wr(new Error(`invalid score parameters for topic ${e}: ${i.message}`),vr.ERR_INVALID_PEER_SCORE_PARAMS)}if(r.topicScoreCap<0)throw wr(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.appSpecificScore===null||r.appSpecificScore===void 0)throw wr(new Error("missing application specific score function"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight>0)throw wr(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight!==0&&r.IPColocationFactorThreshold<1)throw wr(new Error("invalid IPColocationFactorThreshold; must be at least 1"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight>0)throw wr(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight!==0&&(r.behaviourPenaltyDecay<=0||r.behaviourPenaltyDecay>=1))throw wr(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayInterval<1e3)throw wr(new Error("invalid DecayInterval; must be at least 1s"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayToZero<=0||r.decayToZero>=1)throw wr(new Error("invalid DecayToZero; must be between 0 and 1"),vr.ERR_INVALID_PEER_SCORE_PARAMS)}_n.validatePeerScoreParams=VXe;function _ce(r){if(r.topicWeight<0)throw wr(new Error("invalid topic weight; must be >= 0"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshQuantum===0)throw wr(new Error("invalid TimeInMeshQuantum; must be non zero"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight<0)throw wr(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshQuantum<=0)throw wr(new Error("invalid TimeInMeshQuantum; must be positive"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshCap<=0)throw wr(new Error("invalid TimeInMeshCap; must be positive"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight<0)throw wr(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&(r.firstMessageDeliveriesDecay<=0||r.firstMessageDeliveriesDecay>=1))throw wr(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&r.firstMessageDeliveriesCap<=0)throw wr(new Error("invalid FirstMessageDeliveriesCap; must be positive"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight>0)throw wr(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&(r.meshMessageDeliveriesDecay<=0||r.meshMessageDeliveriesDecay>=1))throw wr(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesCap<=0)throw wr(new Error("invalid MeshMessageDeliveriesCap; must be positive"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesThreshold<=0)throw wr(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWindow<0)throw wr(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesActivation<1e3)throw wr(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight>0)throw wr(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight!==0&&(r.meshFailurePenaltyDecay<=0||r.meshFailurePenaltyDecay>=1))throw wr(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesWeight>0)throw wr(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),vr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesDecay<=0||r.invalidMessageDeliveriesDecay>=1)throw wr(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),vr.ERR_INVALID_PEER_SCORE_PARAMS)}_n.validateTopicScoreParams=_ce});var Ece=p(ru=>{l();"use strict";Object.defineProperty(ru,"__esModule",{value:!0});ru.validatePeerScoreThresholds=ru.createPeerScoreThresholds=ru.defaultPeerScoreThresholds=void 0;var m1=oT(),v1=aT();ru.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function zXe(r={}){return Object.assign(Object.assign({},ru.defaultPeerScoreThresholds),r)}ru.createPeerScoreThresholds=zXe;function HXe(r){if(r.gossipThreshold>0)throw v1(new Error("invalid gossip threshold; it must be <= 0"),m1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.publishThreshold>0||r.publishThreshold>r.gossipThreshold)throw v1(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),m1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.graylistThreshold>0||r.graylistThreshold>r.publishThreshold)throw v1(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),m1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.acceptPXThreshold<0)throw v1(new Error("invalid accept PX threshold; it must be >= 0"),m1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.opportunisticGraftThreshold<0)throw v1(new Error("invalid opportunistic grafting threshold; it must be >= 0"),m1.ERR_INVALID_PEER_SCORE_THRESHOLDS)}ru.validatePeerScoreThresholds=HXe});var Sce=p(wf=>{l();"use strict";Object.defineProperty(wf,"__esModule",{value:!0});wf.ensureTopicStats=wf.createTopicStats=wf.createPeerStats=void 0;function GXe(r={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=uT(i),e),{}):{}})}wf.createPeerStats=GXe;function uT(r={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},r)}wf.createTopicStats=uT;function $Xe(r,e,t){let i=e.topics[r];if(i)return i;if(!!t.topics[r])return e.topics[r]=i=uT(),i}wf.ensureTopicStats=$Xe});var xce=p(C_=>{l();"use strict";Object.defineProperty(C_,"__esModule",{value:!0});C_.computeScore=void 0;function WXe(r,e,t,i){let n=0;return Object.entries(e.topics).forEach(([a,c])=>{let u=t.topics[a];if(!u)return;let f=0;if(c.inMesh){let g=c.meshTime/u.timeInMeshQuantum;g>u.timeInMeshCap&&(g=u.timeInMeshCap),f+=g*u.timeInMeshWeight}if(f+=c.firstMessageDeliveries*u.firstMessageDeliveriesWeight,c.meshMessageDeliveriesActive&&c.meshMessageDeliveries<u.meshMessageDeliveriesThreshold){let g=u.meshMessageDeliveriesThreshold-c.meshMessageDeliveries;f+=g*g*u.meshMessageDeliveriesWeight}f+=c.meshFailurePenalty*u.meshFailurePenaltyWeight,f+=c.invalidMessageDeliveries*c.invalidMessageDeliveries*u.invalidMessageDeliveriesWeight,n+=f*u.topicWeight}),t.topicScoreCap>0&&n>t.topicScoreCap&&(n=t.topicScoreCap),n+=t.appSpecificScore(r)*t.appSpecificWeight,e.ips.forEach(a=>{if(t.IPColocationFactorWhitelist.has(a))return;let c=i.get(a),u=c?c.size:0;if(u>t.IPColocationFactorThreshold){let f=u-t.IPColocationFactorThreshold;n+=f*f*t.IPColocationFactorWeight}}),n+=e.behaviourPenalty*e.behaviourPenalty*t.behaviourPenaltyWeight,n}C_.computeScore=WXe});var Ice=p((Ext,Ace)=>{l();"use strict";function Jr(r,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(r)&&this._fromArray(r)}Jr.prototype.peekAt=function(e){var t=e;if(t===(t|0)){var i=this.size();if(!(t>=i||t<-i))return t<0&&(t+=i),t=this._head+t&this._capacityMask,this._list[t]}};Jr.prototype.get=function(e){return this.peekAt(e)};Jr.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};Jr.prototype.peekFront=function(){return this.peek()};Jr.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(Jr.prototype,"length",{get:function(){return this.size()}});Jr.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Jr.prototype.unshift=function(e){if(e===void 0)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Jr.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}};Jr.prototype.push=function(e){if(e===void 0)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Jr.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),i}};Jr.prototype.removeOne=function(e){var t=e;if(t===(t|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(t>=i||t<-i)){t<0&&(t+=i),t=this._head+t&this._capacityMask;var s=this._list[t],o;if(e<i/2){for(o=e;o>0;o--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};Jr.prototype.remove=function(e,t){var i=e,n,s=t;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(i>=o||i<-o||t<1)){if(i<0&&(i+=o),t===1||!t)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+t>=o)return n=this.toArray(),this.clear(),n;i+t>o&&(t=o-i);var c;for(n=new Array(t),c=0;c<t;c++)n[c]=this._list[this._head+i+c&this._capacityMask];if(i=this._head+i&this._capacityMask,e+t===o){for(this._tail=this._tail-t+a&this._capacityMask,c=t;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+t+a&this._capacityMask,c=t-1;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+t+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;s>0;)this._list[i=i-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+t+a&this._capacityMask,c=o-(t+e);c>0;c--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};Jr.prototype.splice=function(e,t){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,a,c=arguments.length,u=this._list.length,f=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(t===0?(a=[],i>0&&(this._head=this._head+i+u&this._capacityMask)):(a=this.remove(i,t),this._head=this._head+i+u&this._capacityMask);c>f;)this.unshift(arguments[--c]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+t));var h=o.length;for(s=0;s<h;s++)o[s]=this._list[this._head+i+t+s&this._capacityMask];for(t===0?(a=[],i!=n&&(this._tail=this._head+i+u&this._capacityMask)):(a=this.remove(i,t),this._tail=this._tail-h+u&this._capacityMask);f<c;)this.push(arguments[f++]);for(s=0;s<h;s++)this.push(o[s])}return a}else return this.remove(i,t)}};Jr.prototype.clear=function(){this._head=0,this._tail=0};Jr.prototype.isEmpty=function(){return this._head===this._tail};Jr.prototype.toArray=function(){return this._copyArray(!1)};Jr.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])};Jr.prototype._copyArray=function(e){var t=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)t.push(i[s]);for(s=0;s<this._tail;s++)t.push(i[s])}else for(s=this._head;s<this._tail;s++)t.push(i[s]);return t};Jr.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length*=2,this._capacityMask=this._capacityMask<<1|1};Jr.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Ace.exports=Jr});var kce=p(iu=>{l();"use strict";var YXe=iu&&iu.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(iu,"__esModule",{value:!0});iu.MessageDeliveries=iu.DeliveryRecordStatus=void 0;var XXe=Ql(),JXe=YXe(Ice()),QXe=Zl(),Tce;(function(r){r[r.unknown=0]="unknown",r[r.valid=1]="valid",r[r.invalid=2]="invalid",r[r.ignored=3]="ignored"})(Tce=iu.DeliveryRecordStatus||(iu.DeliveryRecordStatus={}));var Rce=class{constructor(){this.records=new Map,this.queue=new JXe.default}ensureRecord(e){let t=QXe.messageIdToString(e),i=this.records.get(t);if(i)return i;i={status:Tce.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(t,i);let n={msgId:t,expire:Date.now()+XXe.TimeCacheDuration};return this.queue.push(n),i}gc(){let e=Date.now(),t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};iu.MessageDeliveries=Rce});var Pce=p(Fp=>{l();"use strict";var ZXe=Fp&&Fp.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Fp,"__esModule",{value:!0});Fp.PeerScore=void 0;var eJe=cT(),Up=Sce(),tJe=xce(),sa=kce(),rJe=Ql(),iJe=ZXe(dt()),nJe=xe(),sJe=g_(),{ERR_INVALID_SIGNATURE:oJe,ERR_MISSING_SIGNATURE:aJe}=sJe.codes,Kp=nJe("libp2p:gossipsub:score"),Cce=class{constructor(e,t,i){eJe.validatePeerScoreParams(e),this.params=e,this._connectionManager=t,this.peerStats=new Map,this.peerIPs=new Map,this.deliveryRecords=new sa.MessageDeliveries,this.msgId=i}start(){if(this._backgroundInterval){Kp("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),Kp("started")}stop(){if(!this._backgroundInterval){Kp("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),Kp("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this._removeIPs(n,i.ips),this.peerStats.delete(n));return}Object.entries(i.topics).forEach(([s,o])=>{let a=this.params.topics[s];!a||(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<t&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<t&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<t&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<t&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<t&&(i.behaviourPenalty=0)})}score(e){let t=this.peerStats.get(e);return t?tJe.computeScore(e,t,this.params,this.peerIPs):0}addPenalty(e,t){let i=this.peerStats.get(e);!i||(i.behaviourPenalty+=t)}addPeer(e){let t=Up.createPeerStats({connected:!0});this.peerStats.set(e,t);let i=this._getIPs(e);this._setIPs(e,i,t.ips),t.ips=i}removePeer(e){let t=this.peerStats.get(e);if(!!t){if(this.score(e)>0){this._removeIPs(e,t.ips),this.peerStats.delete(e);return}Object.entries(t.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){let i=this.peerStats.get(e);if(!i)return;let n=Up.ensureTopicStats(t,i,this.params);!n||(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1)}prune(e,t){let i=this.peerStats.get(e);if(!i)return;let n=Up.ensureTopicStats(t,i,this.params);if(!n)return;let s=this.params.topics[t].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}validateMessage(e){this.deliveryRecords.ensureRecord(this.msgId(e))}deliverMessage(e){let t=e.receivedFrom;this._markFirstMessageDelivery(t,e);let i=this.deliveryRecords.ensureRecord(this.msgId(e)),n=Date.now();if(i.status!==sa.DeliveryRecordStatus.unknown){Kp("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",t,n-i.firstSeen,sa.DeliveryRecordStatus[i.status]);return}i.status=sa.DeliveryRecordStatus.valid,i.validated=n,i.peers.forEach(s=>{s!==t&&this._markDuplicateMessageDelivery(s,e)})}rejectMessage(e,t){let i=e.receivedFrom;switch(t){case aJe:case oJe:this._markInvalidMessageDelivery(i,e);return}let n=this.deliveryRecords.ensureRecord(this.msgId(e));if(n.status!==sa.DeliveryRecordStatus.unknown){Kp("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",i,Date.now()-n.firstSeen,sa.DeliveryRecordStatus[n.status]);return}switch(t){case rJe.ERR_TOPIC_VALIDATOR_IGNORE:n.status=sa.DeliveryRecordStatus.ignored;return}n.status=sa.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(i,e),n.peers.forEach(s=>{this._markInvalidMessageDelivery(s,e)})}duplicateMessage(e){let t=e.receivedFrom,i=this.deliveryRecords.ensureRecord(this.msgId(e));if(!i.peers.has(t))switch(i.status){case sa.DeliveryRecordStatus.unknown:i.peers.add(t);break;case sa.DeliveryRecordStatus.valid:i.peers.add(t),this._markDuplicateMessageDelivery(t,e,i.validated);break;case sa.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(t,e);break}}_markInvalidMessageDelivery(e,t){let i=this.peerStats.get(e);!i||t.topicIDs.forEach(n=>{let s=Up.ensureTopicStats(n,i,this.params);!s||(s.invalidMessageDeliveries+=1)})}_markFirstMessageDelivery(e,t){let i=this.peerStats.get(e);!i||t.topicIDs.forEach(n=>{let s=Up.ensureTopicStats(n,i,this.params);if(!s)return;let o=this.params.topics[n].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[n].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))})}_markDuplicateMessageDelivery(e,t,i=0){let n=this.peerStats.get(e);if(!n)return;let s=i?Date.now():0;t.topicIDs.forEach(o=>{let a=Up.ensureTopicStats(o,n,this.params);if(!a||!a.inMesh)return;let c=this.params.topics[o];if(i&&s>i+c.meshMessageDeliveriesWindow)return;let u=c.meshMessageDeliveriesCap;a.meshMessageDeliveries+=1,a.meshMessageDeliveries>u&&(a.meshMessageDeliveries=u)})}_getIPs(e){return this._connectionManager.getAll(iJe.default.createFromB58String(e)).map(t=>t.remoteAddr.toOptions().host)}_setIPs(e,t,i){e:for(let n of t){for(let o of i)if(n===o)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let o of t)if(n===o)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}}_removeIPs(e,t){t.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))})}_updateIPs(){this.peerStats.forEach((e,t)=>{let i=this._getIPs(t);this._setIPs(t,i,e.ips),e.ips=i})}};Fp.PeerScore=Cce});var Oce=p(nu=>{l();"use strict";var cJe=nu&&nu.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),fT=nu&&nu.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&cJe(e,r,t)};Object.defineProperty(nu,"__esModule",{value:!0});fT(cT(),nu);fT(Ece(),nu);fT(Pce(),nu)});var Nce=p(P_=>{l();"use strict";Object.defineProperty(P_,"__esModule",{value:!0});P_.IWantTracer=void 0;var uJe=Ql(),lT=Zl(),fJe=g_(),{ERR_INVALID_SIGNATURE:lJe,ERR_MISSING_SIGNATURE:hJe}=fJe.codes,Bce=class{constructor(e){this.getMsgId=e,this.promises=new Map}addPromise(e,t){let i=Math.floor(Math.random()*t.length),n=t[i],s=lT.messageIdToString(n),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+uJe.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),t=new Map;return this.promises.forEach((i,n)=>{i.forEach((s,o)=>{s<e&&(t.set(o,(t.get(o)||0)+1),i.delete(o))}),i.size||this.promises.delete(n)}),t}deliverMessage(e){let t=this.getMsgId(e),i=lT.messageIdToString(t);this.promises.delete(i)}rejectMessage(e,t){switch(t){case lJe:case hJe:return}let i=this.getMsgId(e),n=lT.messageIdToString(i);this.promises.delete(n)}clear(){this.promises.clear()}};P_.IWantTracer=Bce});var Fce=p((Txt,Dce)=>{l();var qce="Expected a function",Mce=0/0,dJe="[object Symbol]",pJe=/^\s+|\s+$/g,yJe=/^[-+]0x[0-9a-f]+$/i,gJe=/^0b[01]+$/i,bJe=/^0o[0-7]+$/i,mJe=parseInt,vJe=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,wJe=typeof self=="object"&&self&&self.Object===Object&&self,_Je=vJe||wJe||Function("return this")(),EJe=Object.prototype,SJe=EJe.toString,xJe=Math.max,AJe=Math.min,hT=function(){return _Je.Date.now()};function IJe(r,e,t){var i,n,s,o,a,c,u=0,f=!1,h=!1,d=!0;if(typeof r!="function")throw new TypeError(qce);e=Lce(e)||0,O_(t)&&(f=!!t.leading,h="maxWait"in t,s=h?xJe(Lce(t.maxWait)||0,e):s,d="trailing"in t?!!t.trailing:d);function y(z){var Z=i,ee=n;return i=n=void 0,u=z,o=r.apply(ee,Z),o}function g(z){return u=z,a=setTimeout(_,e),f?y(z):o}function m(z){var Z=z-c,ee=z-u,re=e-Z;return h?AJe(re,s-ee):re}function x(z){var Z=z-c,ee=z-u;return c===void 0||Z>=e||Z<0||h&&ee>=s}function _(){var z=hT();if(x(z))return P(z);a=setTimeout(_,m(z))}function P(z){return a=void 0,d&&i?y(z):(i=n=void 0,o)}function q(){a!==void 0&&clearTimeout(a),u=0,i=c=n=a=void 0}function X(){return a===void 0?o:P(hT())}function W(){var z=hT(),Z=x(z);if(i=arguments,n=this,c=z,Z){if(a===void 0)return g(c);if(h)return a=setTimeout(_,e),y(c)}return a===void 0&&(a=setTimeout(_,e)),o}return W.cancel=q,W.flush=X,W}function TJe(r,e,t){var i=!0,n=!0;if(typeof r!="function")throw new TypeError(qce);return O_(t)&&(i="leading"in t?!!t.leading:i,n="trailing"in t?!!t.trailing:n),IJe(r,e,{leading:i,maxWait:e,trailing:n})}function O_(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function RJe(r){return!!r&&typeof r=="object"}function kJe(r){return typeof r=="symbol"||RJe(r)&&SJe.call(r)==dJe}function Lce(r){if(typeof r=="number")return r;if(kJe(r))return Mce;if(O_(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=O_(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(pJe,"");var t=gJe.test(r);return t||bJe.test(r)?mJe(r.slice(2),t?2:8):yJe.test(r)?Mce:+r}Dce.exports=TJe});var jce=p((Uce,Kce)=>{l();"use strict";var CJe=Fce();Uce=Kce.exports=dT;function dT(r){if(!(this instanceof dT))return new dT(r);r=r||{};let e=r.validity||30,t=new Map,i=CJe(()=>{t.forEach((n,s)=>{let o=n.validity||e;PJe(n.timestamp)>o&&t.delete(s)})},200);this.put=(n,s,o)=>{this.has(n)||t.set(n,{value:s,timestamp:new Date,validity:o}),i()},this.get=n=>{if(t.has(n))return t.get(n).value;throw new Error("key does not exist")},this.has=n=>t.has(n)}function PJe(r){let t=new Date().getTime()-r.getTime();return Math.floor(t/1e3)}});var Hce=p((Rxt,Vce)=>{l();Vce.exports=pT;var zce=128,OJe=127,BJe=~OJe,NJe=Math.pow(2,31);function pT(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw pT.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=NJe;)e[t++]=r&255|zce,r/=128;for(;r&BJe;)e[t++]=r&255|zce,r>>>=7;return e[t]=r|0,pT.bytes=t-i+1,e}});var Wce=p((kxt,Gce)=>{l();Gce.exports=yT;var DJe=128,$ce=127;function yT(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw yT.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&$ce)<<i:(s&$ce)*Math.pow(2,i),i+=7}while(s>=DJe);return yT.bytes=n-e,t}});var Xce=p((Cxt,Yce)=>{l();var qJe=Math.pow(2,7),MJe=Math.pow(2,14),LJe=Math.pow(2,21),FJe=Math.pow(2,28),UJe=Math.pow(2,35),KJe=Math.pow(2,42),jJe=Math.pow(2,49),VJe=Math.pow(2,56),zJe=Math.pow(2,63);Yce.exports=function(r){return r<qJe?1:r<MJe?2:r<LJe?3:r<FJe?4:r<UJe?5:r<KJe?6:r<jJe?7:r<VJe?8:r<zJe?9:10}});var Qce=p((Pxt,Jce)=>{l();Jce.exports={encode:Hce(),decode:Wce(),encodingLength:Xce()}});var yi=p(gT=>{l();"use strict";gT.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required"};gT.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}});var tue=p((Bxt,Zce)=>{l();"use strict";var jp=hi(),eue=jp.Reader,HJe=jp.Writer,Vr=jp.util,w1=jp.roots["libp2p-envelope"]||(jp.roots["libp2p-envelope"]={});w1.Envelope=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.publicKey=Vr.newBuffer([]),r.prototype.payloadType=Vr.newBuffer([]),r.prototype.payload=Vr.newBuffer([]),r.prototype.signature=Vr.newBuffer([]),r.encode=function(t,i){return i||(i=HJe.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&i.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&i.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(42).bytes(t.signature),i},r.decode=function(t,i){t instanceof eue||(t=eue.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new w1.Envelope;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.publicKey=t.bytes();break;case 2:s.payloadType=t.bytes();break;case 3:s.payload=t.bytes();break;case 5:s.signature=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof w1.Envelope)return t;var i=new w1.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?Vr.base64.decode(t.publicKey,i.publicKey=Vr.newBuffer(Vr.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?Vr.base64.decode(t.payloadType,i.payloadType=Vr.newBuffer(Vr.base64.length(t.payloadType)),0):t.payloadType.length&&(i.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?Vr.base64.decode(t.payload,i.payload=Vr.newBuffer(Vr.base64.length(t.payload)),0):t.payload.length&&(i.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?Vr.base64.decode(t.signature,i.signature=Vr.newBuffer(Vr.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Vr.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=Vr.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=Vr.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Vr.newBuffer(n.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Vr.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?Vr.base64.encode(t.payloadType,0,t.payloadType.length):i.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(n.payload=i.bytes===String?Vr.base64.encode(t.payload,0,t.payload.length):i.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Vr.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,jp.util.toJSONOptions)},r}();Zce.exports=w1});var _1=p((Nxt,rue)=>{l();"use strict";var GJe=ge(),$Je=vi(),WJe=ct(),YJe=Ym(),XJe=dt(),bT=Qce(),B_=Dr(),{codes:JJe}=yi(),{Envelope:iue}=tue(),_f=class{constructor({peerId:e,payloadType:t,payload:i,signature:n}){this.peerId=e,this.payloadType=t,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=YJe.marshalPublicKey(this.peerId.pubKey);return this._marshal=iue.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return B_(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&B_(this.payloadType,e.payloadType)&&B_(this.payload,e.payload)&&B_(this.signature,e.signature)}validate(e){let t=nue(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(t,this.signature)}},nue=(r,e,t)=>{let i=WJe(r),n=bT.encode(i.byteLength),s=bT.encode(e.length),o=bT.encode(t.length);return $Je([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(o),t])};_f.createFromProtobuf=async r=>{let e=iue.decode(r),t=await XJe.createFromPubKey(e.publicKey);return new _f({peerId:t,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};_f.seal=async(r,e)=>{let t=r.domain,i=r.codec,n=r.marshal(),s=nue(t,i,n),o=await e.privKey.sign(s);return new _f({peerId:e,payloadType:i,payload:n,signature:o})};_f.openAndCertify=async(r,e)=>{let t=await _f.createFromProtobuf(r);if(!await t.validate(e))throw GJe(new Error("envelope signature is not valid for the given domain"),JJe.ERR_SIGNATURE_NOT_VALID);return t};rue.exports=_f});var ST=p((su,sue)=>{l();"use strict";var QJe=su&&su.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),ZJe=su&&su.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),oue=su&&su.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&QJe(e,r,t);return ZJe(e,r),e},E1=su&&su.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(f){try{u(i.next(f))}catch(h){o(h)}}function c(f){try{u(i.throw(f))}catch(h){o(h)}}function u(f){f.done?s(f.value):n(f.value).then(a,c)}u((i=i.apply(r,e||[])).next())})},mT=oue(sce()),eQe=hce(),vT=pce(),Ut=oue(Ql()),tQe=bce(),N_=sT(),Wi=Zl(),wT=Oce(),rQe=Nce(),iQe=jce(),_T=dt(),nQe=_1(),ET=class extends mT.default{constructor(e,t={}){let i=[Ut.GossipsubIDv11,Ut.GossipsubIDv10],n=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:Ut.GossipsubD,Dlo:Ut.GossipsubDlo,Dhi:Ut.GossipsubDhi,Dscore:Ut.GossipsubDscore,Dout:Ut.GossipsubDout,Dlazy:Ut.GossipsubDlazy},t),{scoreParams:wT.createPeerScoreParams(t.scoreParams),scoreThresholds:wT.createPeerScoreThresholds(t.scoreThresholds)});n.fallbackToFloodsub&&i.push(Ut.FloodsubID),super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:i,libp2p:e},n)),this._options=n,this.direct=new Set(n.directPeers.map(s=>s.id.toB58String())),n.directPeers.forEach(s=>{e.peerStore.addressBook.add(s.id,s.addrs)}),this.seenCache=new iQe,this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=t.messageCache||new eQe.MessageCache(Ut.GossipsubHistoryGossip,Ut.GossipsubHistoryLength,this.getMsgId.bind(this)),this.heartbeat=new tQe.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new rQe.IWantTracer(this.getMsgId.bind(this)),this._libp2p=e,this.score=new wT.PeerScore(this._options.scoreParams,e.connectionManager,this.getMsgId.bind(this))}_decodeRpc(e){return vT.RPC.decode(e)}_encodeRpc(e){return vT.RPC.encode(e).finish()}_addPeer(e,t){let i=super._addPeer(e,t);this.score.addPeer(e.toB58String());let n=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>t===o.protocol)){n=!0;break}return this.outbound.set(i.id.toB58String(),n),i}_removePeer(e){let t=super._removePeer(e),i=e.toB58String();for(let n of this.mesh.values())n.delete(i);for(let n of this.fanout.values())n.delete(i);return this.gossip.delete(i),this.control.delete(i),this.outbound.delete(i),this.score.removePeer(i),t}_processRpc(e,t,i){return super._processRpc(e,t,i)?(i.control&&this._processRpcControlMessage(e,i.control),!0):!1}_processRpcControlMessage(e,t){if(!t)return;let i=t.ihave?this._handleIHave(e,t.ihave):[],n=t.iwant?this._handleIWant(e,t.iwant):[],s=t.graft?this._handleGraft(e,t.graft):[];if(t.prune&&this._handlePrune(e,t.prune),!i.length&&!n.length&&!s.length)return;let o=Wi.createGossipRpc(n,{iwant:i,prune:s});this._sendRpc(e,o)}_processRpcMessage(e){let t=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return E1(this,void 0,void 0,function*(){let i=this.getMsgId(e),n=Wi.messageIdToString(i);if(this.seenCache.has(n)){this.score.duplicateMessage(e);return}this.seenCache.put(n),this.score.validateMessage(e),yield t._processRpcMessage.call(this,e)})}_acceptFrom(e){return this.direct.has(e)||this.score.score(e)>=this._options.scoreThresholds.graylistThreshold}validate(e){let t=Object.create(null,{validate:{get:()=>super.validate}});return E1(this,void 0,void 0,function*(){try{yield t.validate.call(this,e)}catch(i){throw this.score.rejectMessage(e,i.code),this.gossipTracer.rejectMessage(e,i.code),i}})}_handleIHave(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),[];let n=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,n),n>Ut.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),[];let s=this.iasked.get(e)||0;if(s>=Ut.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(t.forEach(({topicID:u,messageIDs:f})=>{!u||!f||!this.mesh.has(u)||f.forEach(h=>{let d=Wi.messageIdToString(h);this.seenCache.has(d)||o.set(d,h)})}),!o.size)return[];let a=o.size;a+s>Ut.GossipsubMaxIHaveLength&&(a=Ut.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return Wi.shuffle(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}_handleIWant(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map;return t.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let[a,c]=this.messageCache.getForPeer(o,e);if(!!a){if(c>Ut.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(Wi.messageIdToString(o),a)}})}),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values()).map(mT.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,t){let i=[],n=this.score.score(e),s=this._now(),o=this._options.doPX;return t.forEach(({topicID:a})=>{var c;if(!a)return;let u=this.mesh.get(a);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(a),o=!1;return}let f=(c=this.backoff.get(a))===null||c===void 0?void 0:c.get(e);if(typeof f=="number"&&s<f){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let h=f+Ut.GossipsubGraftFloodThreshold-Ut.GossipsubPruneBackoff;s<h&&this.score.addPenalty(e,1),this._addBackoff(e,a),i.push(a);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,a),i.push(a),o=!1,this._addBackoff(e,a);return}if(u.size>=this._options.Dhi&&!this.outbound.get(e)){i.push(a),this._addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),u.add(e)}),i.length?i.map(a=>this._makePrune(e,a,o)):[]}_handlePrune(e,t){let i=this.score.score(e);t.forEach(({topicID:n,backoff:s,peers:o})=>{if(!n)return;let a=this.mesh.get(n);if(!!a&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),a.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,n,s*1e3):this._addBackoff(e,n),o&&o.length)){if(i<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this._pxConnect(o)}})}_addBackoff(e,t){this._doAddBackoff(e,t,Ut.GossipsubPruneBackoff)}_doAddBackoff(e,t,i){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));let s=this._now()+i;(n.get(e)||0)<s&&n.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e)})}_clearBackoff(){if(this.heartbeatTicks%Ut.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((t,i)=>{t.forEach((n,s)=>{n<e&&t.delete(s)}),t.size===0&&this.backoff.delete(i)})}_directConnect(){if(this.heartbeatTicks%Ut.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(t=>{let i=this.peers.get(t);(!i||!i.isWritable)&&e.push(t)}),e.length&&e.forEach(t=>{this._connect(t)})}_pxConnect(e){return E1(this,void 0,void 0,function*(){e.length>Ut.GossipsubPrunePeers&&(Wi.shuffle(e),e=e.slice(0,Ut.GossipsubPrunePeers));let t=[];yield Promise.all(e.map(i=>E1(this,void 0,void 0,function*(){if(!i.peerID)return;let s=_T.createFromBytes(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){t.push(s);return}try{let o=yield nQe.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),a=o.peerId.toB58String();if(s!==a){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",a,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}t.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!t.length&&t.forEach(i=>this._connect(i))})}start(){super.start(),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(e=>{this._connect(e)})},Ut.GossipsubDirectConnectInitialDelay)}stop(){super.stop(),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),clearTimeout(this._directPeerInitial)}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(_T.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let t=this.fanout.get(e);if(t)t.forEach(i=>{this.score.score(i)<0&&t.delete(i)}),t.size<this._options.D&&N_.getGossipPeers(this,e,this._options.D-t.size,i=>!t.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>t.add(i)),this.mesh.set(e,t),this.fanout.delete(e),this.lastpub.delete(e);else{let i=N_.getGossipPeers(this,e,this._options.D,n=>!this.direct.has(n)&&this.score.score(n)>=0);this.mesh.set(e,i)}this.mesh.get(e).forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this._sendGraft(i,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let t=this.mesh.get(e);t&&(t.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this._sendPrune(i,e)}),this.mesh.delete(e))}_publish(e){return E1(this,void 0,void 0,function*(){e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e),this.gossipTracer.deliverMessage(e));let t=this.getMsgId(e),i=Wi.messageIdToString(t);this.seenCache.put(i),this.messageCache.put(e);let n=new Set;e.topicIDs.forEach(o=>{let a=this.topics.get(o);if(!!a)if(this._options.floodPublish&&e.from===this.peerId.toB58String())a.forEach(c=>{(this.direct.has(c)||this.score.score(c)>=this._options.scoreThresholds.publishThreshold)&&n.add(c)});else{this.direct.forEach(u=>{n.add(u)}),a.forEach(u=>{let f=this.score.score(u),h=this.peers.get(u);!h||h.protocol===Ut.FloodsubID&&f>=this._options.scoreThresholds.publishThreshold&&n.add(u)});let c=this.mesh.get(o);if(!c||!c.size){if(c=this.fanout.get(o),!c){let u=N_.getGossipPeers(this,o,this._options.D,f=>this.score.score(f)>=this._options.scoreThresholds.publishThreshold);u.size>0?(c=u,this.fanout.set(o,u)):c=new Set}this.lastpub.set(o,this._now())}c.forEach(u=>{n.add(u)})}});let s=Wi.createGossipRpc([mT.utils.normalizeOutRpcMessage(e)]);n.forEach(o=>{o!==e.from&&this._sendRpc(o,s)})})}_sendGraft(e,t){let i=[{topicID:t}],n=Wi.createGossipRpc([],{graft:i});this._sendRpc(e,n)}_sendPrune(e,t){let i=[this._makePrune(e,t,this._options.doPX)],n=Wi.createGossipRpc([],{prune:i});this._sendRpc(e,n)}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable)return;let n=this.control.get(e);n&&(this._piggybackControl(e,t,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,t,s),this.gossip.delete(e)),i.write(vT.RPC.encode(t).finish())}_piggybackControl(e,t,i){let n=(i.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!n.length&&!s.length||(t.control?(t.control.graft=t.control.graft&&t.control.graft.concat(n),t.control.prune=t.control.prune&&t.control.prune.concat(s)):t.control={ihave:[],iwant:[],graft:n,prune:s})}_piggybackGossip(e,t,i){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=i}_sendGraftPrune(e,t,i){let n=this._options.doPX;for(let[s,o]of e){let a=o.map(h=>({topicID:h})),c=[],u=t.get(s);u&&(c=u.map(h=>this._makePrune(s,h,n&&!i.get(s))),t.delete(s));let f=Wi.createGossipRpc([],{graft:a,prune:c});this._sendRpc(s,f)}for(let[s,o]of t){let a=o.map(u=>this._makePrune(s,u,n&&!i.get(s))),c=Wi.createGossipRpc([],{prune:a});this._sendRpc(s,c)}}_emitGossip(e,t){let i=this.messageCache.getGossipIDs(e);if(!i.length)return;Wi.shuffle(i),i.length>Ut.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let u=this.peers.get(c);!u||!t.has(c)&&!this.direct.has(c)&&Wi.hasGossipProtocol(u.protocol)&&this.score.score(c)>=this._options.scoreThresholds.gossipThreshold&&n.push(c)});let o=this._options.Dlazy,a=Ut.GossipsubGossipFactor*n.length;a>o&&(o=a),o>n.length?o=n.length:Wi.shuffle(n),n.slice(0,o).forEach(c=>{let u=i;i.length>Ut.GossipsubMaxIHaveLength&&(u=Wi.shuffle(u.slice()).slice(0,Ut.GossipsubMaxIHaveLength)),this._pushGossip(c,{topicID:e,messageIDs:u})})}_flush(){for(let[e,t]of this.gossip.entries()){this.gossip.delete(e);let i=Wi.createGossipRpc([],{ihave:t});this._sendRpc(e,i)}for(let[e,t]of this.control.entries()){this.control.delete(e);let i=Wi.createGossipRpc([],{graft:t.graft,prune:t.prune});this._sendRpc(e,i)}}_pushGossip(e,t){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(t))}_now(){return Date.now()}_makePrune(e,t,i){if(this.peers.get(e).protocol===Ut.GossipsubIDv10)return{topicID:t,peers:[]};let n=Ut.GossipsubPruneBackoff/1e3,s=[];return i&&N_.getGossipPeers(this,t,Ut.GossipsubPrunePeers,a=>a!==e&&this.score.score(a)>=0).forEach(a=>{let c=_T.createFromB58String(a);s.push({peerID:c.toBytes(),signedPeerRecord:this._libp2p.peerStore.addressBook.getRawEnvelope(c)})}),{topicID:t,peers:s,backoff:n}}};ET.multicodec=Ut.GossipsubIDv11;sue.exports=ET});var cue=p((Dxt,aue)=>{l();"use strict";aue.exports={gossipsub:ST()}});var fue=p((qxt,uue)=>{l();"use strict";var sQe=async function*(r,e){let t=0;if(!(e<1)){for await(let i of r)if(yield i,t++,t===e)return}};uue.exports=sQe});var xT=p((Mxt,lue)=>{l();"use strict";var oQe=ge(),aQe=hl(),cQe=$c(),uQe=fue();function fQe(r,e){return cQe(r,t=>(e.addressBook.add(t.id,t.multiaddrs),t))}function lQe(r){let e=new Set;return aQe(r,t=>e.has(t.id.toString())?!1:(e.add(t.id.toString()),!0))}async function*hQe(r,e=1){let t=0;for await(let i of r)t++,yield i;if(t<e)throw oQe(new Error("not found"),"NOT_FOUND")}function dQe(r,e){return e?uQe(r,e):r}lue.exports={storeAddresses:fQe,uniquePeers:lQe,requirePeers:hQe,maybeLimitSource:dQe}});var AT=p((Lxt,hue)=>{l();"use strict";var pQe=Wc(),yQe=async function*(...r){let e=pQe();setTimeout(async()=>{try{await Promise.all(r.map(async t=>{for await(let i of t)e.push(i)})),e.end()}catch(t){e.end(t)}},0),yield*e};hue.exports=yQe});var IT=p((Fxt,due)=>{l();"use strict";var Vp=new Map,gQe=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function bQe(r,e,t){for(;Vp.get(t);){try{await r()}catch(i){setTimeout(()=>{throw i},1);break}if(!Vp.get(t))break;await new Promise(i=>{let n=setTimeout(i,e);Vp.set(t,n)})}}function mQe(r,e,t){t=t||e;let i=gQe(),n=setTimeout(()=>{bQe(r,e,i)},t);return Vp.set(i,n),i}function vQe(r){let e=Vp.get(r);e&&(clearTimeout(e),Vp.delete(r))}due.exports={setDelayedInterval:mQe,clearDelayedInterval:vQe}});var wue=p((Uxt,pue)=>{l();"use strict";var yue=xe(),wQe=Object.assign(yue("libp2p:peer-routing"),{error:yue("libp2p:peer-routing:err")}),D_=ge(),{storeAddresses:gue,uniquePeers:_Qe,requirePeers:EQe}=xT(),bue=AT(),{pipe:mue}=pi(),SQe=qd(),xQe=xd(),AQe=hl(),{setDelayedInterval:IQe,clearDelayedInterval:TQe}=IT(),vue=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(e._dht),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=IQe(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await xQe(this.getClosestPeers(this._peerId.id))}catch(e){wQe.error(e)}}stop(){TQe(this._timeoutId)}async findPeer(e,t){if(!this._routers.length)throw D_(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");if(e.toB58String()===this._peerId.toB58String())throw D_(new Error("Should not try to find self"),"ERR_FIND_SELF");let i=await mue(bue(...this._routers.map(n=>[n.findPeer(e,t)])),n=>AQe(n,Boolean),n=>gue(n,this._peerStore),n=>SQe(n));if(i)return i;throw D_(new Error("not found"),"NOT_FOUND")}async*getClosestPeers(e,t={timeout:3e4}){if(!this._routers.length)throw D_(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");yield*mue(bue(...this._routers.map(i=>i.getClosestPeers(e,t))),i=>gue(i,this._peerStore),i=>_Qe(i),i=>EQe(i))}};pue.exports=vue});var Sue=p((Kxt,_ue)=>{l();"use strict";var S1=ge(),{messages:TT,codes:RT}=yi(),{storeAddresses:RQe,uniquePeers:kQe,requirePeers:CQe,maybeLimitSource:PQe}=xT(),OQe=AT(),{pipe:BQe}=pi(),Eue=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(this.dht)}async*findProviders(e,t={}){if(!this.routers.length)throw S1(new Error("No content this.routers available"),"NO_ROUTERS_AVAILABLE");yield*BQe(OQe(...this.routers.map(i=>i.findProviders(e,t))),i=>RQe(i,this.libp2p.peerStore),i=>kQe(i),i=>PQe(i,t.maxNumProviders),i=>CQe(i))}async provide(e){if(!this.routers.length)throw S1(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");await Promise.all(this.routers.map(t=>t.provide(e)))}put(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw S1(new Error(TT.NOT_STARTED_YET),RT.DHT_NOT_STARTED);return this.dht.put(e,t,i)}get(e,t){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw S1(new Error(TT.NOT_STARTED_YET),RT.DHT_NOT_STARTED);return this.dht.get(e,t)}async getMany(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw S1(new Error(TT.NOT_STARTED_YET),RT.DHT_NOT_STARTED);return this.dht.getMany(e,t,i)}};_ue.exports=Eue});var kT=p((jxt,xue)=>{l();"use strict";var NQe=dt(),{Multiaddr:Aue}=lr(),Iue=ge(),{codes:Tue}=yi();function DQe(r){typeof r=="string"&&(r=new Aue(r));let e;if(Aue.isMultiaddr(r)){e=r;let t=r.getPeerId();if(!t)throw Iue(new Error(`${r} does not have a valid peer type`),Tue.ERR_INVALID_MULTIADDR);try{r=NQe.createFromB58String(t)}catch(i){throw Iue(new Error(`${r} is not a valid peer type`),Tue.ERR_INVALID_MULTIADDR)}}return{id:r,multiaddrs:e?[e]:void 0}}xue.exports=DQe});var kue=p((Vxt,Rue)=>{l();var zp=1e3,Hp=zp*60,Gp=Hp*60,eh=Gp*24,qQe=eh*7,MQe=eh*365.25;Rue.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return LQe(r);if(t==="number"&&isFinite(r))return e.long?UQe(r):FQe(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function LQe(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*MQe;case"weeks":case"week":case"w":return t*qQe;case"days":case"day":case"d":return t*eh;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Gp;case"minutes":case"minute":case"mins":case"min":case"m":return t*Hp;case"seconds":case"second":case"secs":case"sec":case"s":return t*zp;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function FQe(r){var e=Math.abs(r);return e>=eh?Math.round(r/eh)+"d":e>=Gp?Math.round(r/Gp)+"h":e>=Hp?Math.round(r/Hp)+"m":e>=zp?Math.round(r/zp)+"s":r+"ms"}function UQe(r){var e=Math.abs(r);return e>=eh?q_(r,e,eh,"day"):e>=Gp?q_(r,e,Gp,"hour"):e>=Hp?q_(r,e,Hp,"minute"):e>=zp?q_(r,e,zp,"second"):r+" ms"}function q_(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var Oue=p((zxt,Cue)=>{l();"use strict";Cue.exports=Pue;var KQe=kue(),Ef=Pue.prototype,jQe=new Date%1e9;function VQe(){return(Math.random()*1e9>>>0)+jQe++}function Pue(r){r=r||{},this.id=r.id||VQe(),this.max=r.max||Infinity,this.items=r.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(r.lastModified||new Date);for(var e,t,i=this.items.length;i--;)e=this.items[i],t=new Date(e.expires)-new Date,this._lookup[e.key]=e,t>0?this.expire(e.key,t):t<=0&&this.delete(e.key)}Ef.has=function(r){return r in this._lookup};Ef.get=function(r){if(!this.has(r))return null;var e=this._lookup[r];return e.refresh&&this.expire(r,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};Ef.meta=function(r){if(!this.has(r))return null;var e=this._lookup[r];return"meta"in e?e.meta:null};Ef.set=function(r,e,t){var i=this._lookup[r],n=this._lookup[r]={key:r,value:e};return this.lastModified=new Date,i?(clearTimeout(i.timeout),this.items.splice(this.items.indexOf(i),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),t&&("ttl"in t&&this.expire(r,t.ttl),"meta"in t&&(n.meta=t.meta),t.refresh&&(n.refresh=t.ttl)),this};Ef.delete=function(r){var e=this._lookup[r];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[r],this.size--,this):!1};Ef.expire=function(r,e){var t=e||0,i=this._lookup[r];if(!i)return this;if(typeof t=="string"&&(t=KQe(e)),typeof t!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),t),i.expires=Number(new Date)+t,this};Ef.clear=function(){for(var r=this.items.length;r--;)this.delete(this.items[r].key);return this};Ef.toJSON=function(){for(var r=new Array(this.items.length),e,t=r.length;t--;)e=this.items[t],r[t]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:r}}});var Nue=p((Hxt,Bue)=>{l();"use strict";var{default:zQe,Headers:HQe}=oS();function GQe({serverResolver:r,hostname:e,recordType:t}){return`${r}?name=${e}&type=${t}`}function $Qe(r){return zQe(r,{headers:new HQe({accept:"application/dns-json"})})}function WQe(r,e){return`${e}_${r}`}Bue.exports={buildResource:GQe,fetch:$Qe,getCacheKey:WQe}});var Mue=p((Gxt,Due)=>{l();"use strict";var que=xe(),M_=que("dns-over-http-resolver");M_.error=que("dns-over-http-resolver:error");var YQe=Oue(),fo=Nue(),L_=class{constructor({maxCache:e=100}={}){this._cache=new YQe({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let t=e.length-1;t>0;t--){let i=Math.floor(Math.random()*t),n=e[t];e[t]=e[i],e[i]=n}return e}setServers(e){this._servers=e}resolve(e,t="A"){switch(t){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){let t="A",i=this._cache.get(fo.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await fo.fetch(fo.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(fo.getCacheKey(e,t),a,{ttl:c}),a}catch(s){M_.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){let t="AAAA",i=this._cache.get(fo.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await fo.fetch(fo.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(fo.getCacheKey(e,t),a,{ttl:c}),a}catch(s){M_.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){let t="TXT",i=this._cache.get(fo.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await fo.fetch(fo.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(fo.getCacheKey(e,t),a,{ttl:c}),a}catch(s){M_.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}};L_.Resolver=L_;Due.exports=L_});var Fue=p(($xt,Lue)=>{l();"use strict";var XQe=Mue();Lue.exports=XQe});var Kue=p((Wxt,Uue)=>{l();"use strict";var JQe=Ry(),{code:QQe}=JQe("dnsaddr");async function ZQe(r){let e=Fue(),t=new e,i=r.getPeerId(),[,n]=r.stringTuples().find(([a])=>a===QQe)||[],o=(await t.resolveTxt(`_dnsaddr.${n}`)).flat().map(a=>a.split("=")[1]);return i&&(o=o.filter(a=>a.includes(i))),o}Uue.exports={dnsaddrResolver:ZQe}});var F_=p((Yxt,jue)=>{l();"use strict";jue.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var CT=p((Xxt,Vue)=>{Vue.exports={_from:"libp2p@^0.31.6",_id:"libp2p@0.31.7",_inBundle:!1,_integrity:"sha512-0FUHYlwoDQ8+x3qQM9iTrZP0Ui1LWYxAbLZ9H8Hs57hqevEv08eX5EDFlkpqu/W9dkl4gsQ3kv3sa7ye8+lokA==",_location:"/libp2p",_phantomChildren:{"it-pushable":"1.4.2"},_requested:{type:"range",registry:!0,raw:"libp2p@^0.31.6",name:"libp2p",escapedName:"libp2p",rawSpec:"^0.31.6",saveSpec:null,fetchSpec:"^0.31.6"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/libp2p/-/libp2p-0.31.7.tgz",_shasum:"49ff8b74cd5a3ed252b8584aaa6071f73cf62e6c",_spec:"libp2p@^0.31.6",_where:"/Users/alex/Documents/Workspaces/ipfs/js-ipfs",browser:{"@motrix/nat-api":!1},bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},bundleDependencies:!1,contributors:[{name:"David Dias",email:"daviddias.p@gmail.com"},{name:"Vasco Santos",email:"vasco.santos@moxy.studio"},{name:"Jacob Heun",email:"jacobheun@gmail.com"},{name:"Alex Potsides",email:"alex@achingbrain.net"},{name:"Alan Shaw",email:"alan@tableflip.io"},{name:"Cayman",email:"caymannava@gmail.com"},{name:"Pedro Teixeira",email:"i@pgte.me"},{name:"Friedel Ziegelmayer",email:"dignifiedquire@gmail.com"},{name:"Maciej Kr\xFCger",email:"mkg20001@gmail.com"},{name:"Hugo Dias",email:"mail@hugodias.me"},{name:"dirkmc",email:"dirkmdev@gmail.com"},{name:"Volker Mische",email:"volker.mische@gmail.com"},{name:"Richard Littauer",email:"richard.littauer@gmail.com"},{name:"Ryan Bell",email:"ryan@piing.net"},{name:"a1300",email:"matthias-knopp@gmx.net"},{name:"\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D",email:"victorbjelkholm@gmail.com"},{name:"Samlior",email:"samlior@foxmail.com"},{name:"Andrew Nesbitt",email:"andrewnez@gmail.com"},{name:"Thomas Eizinger",email:"thomas@eizinger.io"},{name:"Franck Royer",email:"franck@royer.one"},{name:"Giovanni T. Parra",email:"fiatjaf@gmail.com"},{name:"Elven",email:"mon.samuel@qq.com"},{name:"Didrik Nordstr\xF6m",email:"didrik.nordstrom@gmail.com"},{name:"RasmusErik Voel Jensen",email:"github@solsort.com"},{name:"Smite Chow",email:"xiaopengyou@live.com"},{name:"Soeren",email:"nikorpoulsen@gmail.com"},{name:"S\xF6nke Hahn",email:"soenkehahn@gmail.com"},{name:"TJKoury",email:"TJKoury@gmail.com"},{name:"Tiago Alves",email:"alvesjtiago@gmail.com"},{name:"Yusef Napora",email:"yusef@napora.org"},{name:"Zane Starr",email:"zcstarr@gmail.com"},{name:"ebinks",email:"elizabethjbinks@gmail.com"},{name:"isan_rivkin",email:"isanrivkin@gmail.com"},{name:"mcclure",email:"andi.m.mcclure@gmail.com"},{name:"robertkiel",email:"robert.kiel@validitylabs.org"},{name:"Aleksei",email:"vozhdb@gmail.com"},{name:"Bernd Strehl",email:"bernd.strehl@gmail.com"},{name:"Chris Bratlien",email:"chrisbratlien@gmail.com"},{name:"Cindy Wu",email:"ciindy.wu@gmail.com"},{name:"Daijiro Wachi",email:"daijiro.wachi@gmail.com"},{name:"Diogo Silva",email:"fsdiogo@gmail.com"},{name:"Dmitriy Ryajov",email:"dryajov@gmail.com"},{name:"Ethan Lam",email:"elmemphis2000@gmail.com"},{name:"Fei Liu",email:"liu.feiwood@gmail.com"},{name:"Felipe Martins",email:"felipebrasil93@gmail.com"},{name:"Florian-Merle",email:"florian.david.merle@gmail.com"},{name:"Francis Gulotta",email:"wizard@roborooter.com"},{name:"Henrique Dias",email:"hacdias@gmail.com"},{name:"Irakli Gozalishvili",email:"rfobic@gmail.com"},{name:"Joel Gustafson",email:"joelg@mit.edu"},{name:"Julien Bouquillon",email:"contact@revolunet.com"},{name:"Kevin Kwok",email:"antimatter15@gmail.com"},{name:"Kevin Lacker",email:"lacker@gmail.com"},{name:"Miguel Mota",email:"miguelmota2@gmail.com"},{name:"Nuno Nogueira",email:"nunofmn@gmail.com"},{name:"Philipp Muens",email:"raute1337@gmx.de"}],dependencies:{"@motrix/nat-api":"^0.3.1","@vascosantos/moving-average":"^1.1.0","abort-controller":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^2.1.1","bignumber.js":"^9.0.1",cids:"^1.1.5","class-is":"^1.1.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^6.1.1",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^4.0.0","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"1.0.0","it-pipe":"^1.1.0","it-take":"1.0.0","libp2p-crypto":"^0.19.4","libp2p-interfaces":"^0.10.4","libp2p-utils":"^0.3.1",mafmt:"^9.0.0","merge-options":"^3.0.4",multiaddr:"^9.0.1",multicodec:"^3.0.1","multihashing-async":"^2.1.2","multistream-select":"^2.0.0","mutable-proxy":"^1.0.0","node-forge":"^0.10.0","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.14.2","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^5.0.2","timeout-abort-controller":"^1.1.1",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},deprecated:!1,description:"JavaScript implementation of libp2p, a modular peer to peer network stack",devDependencies:{"@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node-forge":"^0.9.7","@types/varint":"^6.0.0","abortable-iterator":"^3.0.0",aegir:"^33.1.1",buffer:"^6.0.3",delay:"^5.0.0","interop-libp2p":"^0.4.0","into-stream":"^6.0.0","ipfs-http-client":"^50.1.1","it-concat":"^1.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.12.3","libp2p-delegated-content-routing":"^0.10.0","libp2p-delegated-peer-routing":"^0.9.0","libp2p-floodsub":"^0.25.0","libp2p-gossipsub":"^0.9.0","libp2p-kad-dht":"^0.22.0","libp2p-mdns":"^0.16.0","libp2p-mplex":"^0.10.1","libp2p-noise":"^3.0.0","libp2p-tcp":"^0.15.4","libp2p-webrtc-star":"^0.22.2","libp2p-websockets":"^0.15.8",multihashes:"^4.0.2",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^10.0.0",uint8arrays:"^2.1.3",util:"^0.12.3"},engines:{node:">=14.0.0"},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use"]},files:["dist","src"],homepage:"https://libp2p.io",keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",license:"MIT",main:"src/index.js",name:"libp2p",repository:{type:"git",url:"git+https://github.com/libp2p/js-libp2p.git"},scripts:{build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:address-book":"pbts -o src/peer-store/persistent/pb/address-book.d.ts src/peer-store/persistent/pb/address-book.js","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:proto-book":"pbts -o src/peer-store/persistent/pb/proto-book.d.ts src/peer-store/persistent/pb/proto-book.js","build:proto:address-book":"pbjs -t static-module -w commonjs -r libp2p-address-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/address-book.js ./src/peer-store/persistent/pb/address-book.proto","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:proto-book":"pbjs -t static-module -w commonjs -r libp2p-proto-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/proto-book.js ./src/peer-store/persistent/pb/proto-book.proto",coverage:"nyc --reporter=text --reporter=lcov npm run test:node",lint:"aegir lint",prepare:"aegir build --no-bundle",release:"aegir release -t node -t browser","release-major":"aegir release --type major -t node -t browser","release-minor":"aegir release --type minor -t node -t browser",test:"aegir test","test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use"},types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},version:"0.31.7"}});var PT=p((Jxt,x1)=>{l();"use strict";var eZe=CT().version;x1.exports.PROTOCOL_VERSION="ipfs/0.1.0";x1.exports.AGENT_VERSION=`js-libp2p/${eZe}`;x1.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";x1.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0"});var U_=p((Qxt,zue)=>{l();"use strict";var Hue=60*1e3;zue.exports={ADVERTISE_BOOT_DELAY:15*Hue,ADVERTISE_TTL:30*Hue,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var Gue=p(A1=>{l();(function(){var r,e,t,i,n,s,o,a;a=function(c){var u,f,h,d;return u=(c&255<<24)>>>24,f=(c&255<<16)>>>16,h=(c&255<<8)>>>8,d=c&255,[u,f,h,d].join(".")},o=function(c){var u,f,h,d,y,g;for(u=[],h=d=0;d<=3&&c.length!==0;h=++d){if(h>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}g=e(c),y=g[0],f=g[1],c=c.substring(f),u.push(y)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},t=function(c){return c.charCodeAt(0)},i=t("0"),s=t("a"),n=t("A"),e=function(c){var u,f,h,d,y;for(d=0,u=10,f="9",h=0,c.length>1&&c[h]==="0"&&(c[h+1]==="x"||c[h+1]==="X"?(h+=2,u=16):"0"<=c[h+1]&&c[h+1]<="9"&&(h++,u=8,f="7")),y=h;h<c.length;){if("0"<=c[h]&&c[h]<=f)d=d*u+(t(c[h])-i)>>>0;else if(u===16)if("a"<=c[h]&&c[h]<="f")d=d*u+(10+t(c[h])-s)>>>0;else if("A"<=c[h]&&c[h]<="F")d=d*u+(10+t(c[h])-n)>>>0;else break;else break;if(d>4294967295)throw new Error("too large");h++}if(h===y)throw new Error("empty octet");return[d,h]},r=function(){function c(u,f){var h,d,y,g;if(typeof u!="string")throw new Error("Missing `net' parameter");if(f||(g=u.split("/",2),u=g[0],f=g[1]),f||(f=32),typeof f=="string"&&f.indexOf(".")>-1){try{this.maskLong=o(f)}catch(m){throw h=m,new Error("Invalid mask: "+f)}for(d=y=32;y>=0;d=--y)if(this.maskLong===4294967295<<32-d>>>0){this.bitmask=d;break}}else if(f||f===0)this.bitmask=parseInt(f,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(m){throw h=m,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+f);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var f,h,d;for(d=o(this.first),h=o(this.last),f=0;d<=h;)u(a(d),d,f),f++,d++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),A1.ip2long=o,A1.long2ip=a,A1.Netmask=r}).call(A1)});var Yue=p((e6t,$ue)=>{l();var tZe=Gue().Netmask,Wue=Xx(),rZe=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],iZe=rZe.map(r=>new tZe(r));function nZe(r){for(let e of iZe)if(e.contains(r))return!0;return!1}function sZe(r){return/^::$/.test(r)||/^::1$/.test(r)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(r)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(r)||/^ff([0-9a-fA-F]{2,2}):/i.test(r)}$ue.exports=r=>Wue.v6().test(r)?sZe(r):Wue().test(r)||r.startsWith("0")?nZe(r):!1});var OT=p((t6t,Xue)=>{l();"use strict";Xue.exports=Yue()});var Que=p((r6t,Jue)=>{l();"use strict";var oZe=OT();function aZe(r){let{address:e}=r.nodeAddress();return oZe(e)}Jue.exports=aZe});var BT=p((i6t,Zue)=>{l();"use strict";var efe=Que();function cZe(r,e){let t=efe(r.multiaddr),i=efe(e.multiaddr);return t&&!i?1:!t&&i||r.isCertified&&!e.isCertified?-1:!r.isCertified&&e.isCertified?1:0}function uZe(r){return[...r].sort(cZe)}Zue.exports.publicAddressesFirst=uZe});var rfe=p((n6t,NT)=>{l();"use strict";var tfe=async r=>{try{let e=await r;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};NT.exports=tfe;NT.exports.default=tfe});var nfe=p((s6t,DT)=>{l();"use strict";var ife=(r,...e)=>new Promise(t=>{t(r(...e))});DT.exports=ife;DT.exports.default=ife});var ofe=p((o6t,qT)=>{l();"use strict";var fZe=nfe(),sfe=r=>{if(!((Number.isInteger(r)||r===Infinity)&&r>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],t=0,i=()=>{t--,e.length>0&&e.shift()()},n=(a,c,...u)=>{t++;let f=fZe(a,...u);c(f),f.then(i,i)},s=(a,c,...u)=>{t<r?n(a,c,...u):e.push(n.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>t},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};qT.exports=sfe;qT.exports.default=sfe});var cfe=p((a6t,afe)=>{l();"use strict";var MT=rfe(),lZe=ofe();afe.exports=async(r,e={})=>{let{concurrency:t=Infinity}=e,i=lZe(t);return Promise.all(r.map(n=>n&&typeof n.then=="function"?MT(n):typeof n=="function"?MT(i(()=>n())):MT(Promise.resolve(n))))}});var ffe=p((c6t,ufe)=>{l();"use strict";function hZe(r,e){return r.length===e.length&&e.sort()&&r.sort().every((t,i)=>e[i].equals(t))}ufe.exports=hZe});var dfe=p((u6t,lfe)=>{l();"use strict";var th=hi(),K_=th.Reader,hfe=th.Writer,Qr=th.util,lo=th.roots["libp2p-peer-record"]||(th.roots["libp2p-peer-record"]={});lo.PeerRecord=function(){function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.peerId=Qr.newBuffer([]),r.prototype.seq=Qr.Long?Qr.Long.fromBits(0,0,!0):0,r.prototype.addresses=Qr.emptyArray,r.encode=function(t,i){if(i||(i=hfe.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&i.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&i.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var n=0;n<t.addresses.length;++n)lo.PeerRecord.AddressInfo.encode(t.addresses[n],i.uint32(26).fork()).ldelim();return i},r.decode=function(t,i){t instanceof K_||(t=K_.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new lo.PeerRecord;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.peerId=t.bytes();break;case 2:s.seq=t.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(lo.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof lo.PeerRecord)return t;var i=new lo.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?Qr.base64.decode(t.peerId,i.peerId=Qr.newBuffer(Qr.base64.length(t.peerId)),0):t.peerId.length&&(i.peerId=t.peerId)),t.seq!=null&&(Qr.Long?(i.seq=Qr.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?i.seq=parseInt(t.seq,10):typeof t.seq=="number"?i.seq=t.seq:typeof t.seq=="object"&&(i.seq=new Qr.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<t.addresses.length;++n){if(typeof t.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=lo.PeerRecord.AddressInfo.fromObject(t.addresses[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=Qr.newBuffer(n.peerId))),Qr.Long){var s=new Qr.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?Qr.base64.encode(t.peerId,0,t.peerId.length):i.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?n.seq=i.longs===String?String(t.seq):t.seq:n.seq=i.longs===String?Qr.Long.prototype.toString.call(t.seq):i.longs===Number?new Qr.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){n.addresses=[];for(var o=0;o<t.addresses.length;++o)n.addresses[o]=lo.PeerRecord.AddressInfo.toObject(t.addresses[o],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,th.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=Qr.newBuffer([]),e.encode=function(i,n){return n||(n=hfe.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof K_||(i=K_.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new lo.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof lo.PeerRecord.AddressInfo)return i;var n=new lo.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Qr.base64.decode(i.multiaddr,n.multiaddr=Qr.newBuffer(Qr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=Qr.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?Qr.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,th.util.toJSONOptions)},e}(),r}();lfe.exports=lo});var gfe=p((f6t,pfe)=>{l();"use strict";var yfe=$r(),dZe=yfe.getName(yfe.LIBP2P_PEER_RECORD)||"libp2p-peer-record",pZe=Uint8Array.from([3,1]);pfe.exports={ENVELOPE_DOMAIN_PEER_RECORD:dZe,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:pZe}});var j_=p((l6t,bfe)=>{l();"use strict";var{Multiaddr:yZe}=lr(),gZe=dt(),bZe=ffe(),{PeerRecord:mfe}=dfe(),{ENVELOPE_DOMAIN_PEER_RECORD:vfe,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:mZe}=gfe(),rh=class{constructor({peerId:e,multiaddrs:t=[],seqNumber:i=Date.now()}){this.domain=vfe,this.codec=mZe,this.peerId=e,this.multiaddrs=t,this.seqNumber=i,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=mfe.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof rh)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!bZe(this.multiaddrs,e.multiaddrs))}};rh.createFromProtobuf=r=>{let e=mfe.decode(r),t=gZe.createFromBytes(e.peerId),i=(e.addresses||[]).map(s=>new yZe(s.multiaddr)),n=Number(e.seq);return new rh({peerId:t,multiaddrs:i,seqNumber:n})};rh.DOMAIN=vfe;bfe.exports=rh});var LT=p((h6t,wfe)=>{l();"use strict";var vZe=_1(),wZe=j_();async function _Ze(r){let e=new wZe({peerId:r.peerId,multiaddrs:r.multiaddrs}),t=await vZe.seal(e,r.peerId);r.peerStore.addressBook.consumePeerRecord(t)}wfe.exports.updateSelfPeerRecord=_Ze});var UT=p((d6t,_fe)=>{l();"use strict";var Efe=xe(),ih=Object.assign(Efe("libp2p:transports"),{error:Efe("libp2p:transports:err")}),EZe=cfe(),{codes:$p}=yi(),I1=ge(),{updateSelfPeerRecord:Sfe}=LT(),FT=class{constructor({libp2p:e,upgrader:t,faultTolerance:i=V_.FATAL_ALL}){this.libp2p=e,this.upgrader=t,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=i}add(e,t,i={}){if(ih("adding %s",e),!e)throw I1(new Error(`Transport must have a valid key, was given '${e}'`),$p.ERR_INVALID_KEY);if(this._transports.has(e))throw I1(new Error("There is already a transport with this key"),$p.ERR_DUPLICATE_TRANSPORT);let n=new t({...i,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,n),this._listenerOptions.set(e,i.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[t,i]of this._listeners)for(ih("closing listeners for %s",t);i.length;){let n=i.pop();n.removeAllListeners("listening"),n.removeAllListeners("close"),e.push(n.close())}await Promise.all(e),ih("all listeners closed");for(let t of this._listeners.keys())this._listeners.set(t,[])}async dial(e,t){let i=this.transportForMultiaddr(e);if(!i)throw I1(new Error(`No transport available for address ${String(e)}`),$p.ERR_TRANSPORT_UNAVAILABLE);try{return await i.dial(e,t)}catch(n){throw n.code||(n.code=$p.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let t of this._listeners.values())for(let i of t)e=[...e,...i.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let t of this._transports.values())if(t.filter([e]).length)return t;return null}async listen(e){if(!e||e.length===0){ih("no addresses were provided for listening, this node is dial only");return}let t=[];for(let[i,n]of this._transports.entries()){let s=n.filter(e),o=[];for(let u of s){ih("creating listener for %s on %s",i,u);let f=n.createListener(this._listenerOptions.get(i));this._listeners.get(i).push(f),f.on("listening",()=>Sfe(this.libp2p)),f.on("close",()=>Sfe(this.libp2p)),o.push(f.listen(u))}if(o.length===0){t.push(i);continue}if(!(await EZe(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==V_.NO_FATAL)throw I1(new Error(`Transport (${i}) could not listen on any available address`),$p.ERR_NO_VALID_ADDRESSES)}if(t.length===this._transports.size){let i=`no valid addresses were provided for transports [${t}]`;if(this.faultTolerance===V_.FATAL_ALL)throw I1(new Error(i),$p.ERR_NO_VALID_ADDRESSES);ih(`libp2p in dial mode only: ${i}`)}}async remove(e){if(ih("removing %s",e),this._listeners.has(e))for(let t of this._listeners.get(e))t.removeAllListeners("listening"),t.removeAllListeners("close"),await t.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let t of this._transports.keys())e.push(this.remove(t));await Promise.all(e)}},V_={FATAL_ALL:0,NO_FATAL:1};FT.FaultTolerance=V_;_fe.exports=FT});var Ife=p((p6t,xfe)=>{l();"use strict";var SZe=Gr(),{dnsaddrResolver:xZe}=Kue(),KT=F_(),{AGENT_VERSION:AZe}=PT(),Afe=U_(),{publicAddressesFirst:IZe}=BT(),{FaultTolerance:TZe}=UT(),RZe={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:r=>r},connectionManager:{minConnections:25},transportManager:{faultTolerance:TZe.FATAL_ALL},dialer:{maxParallelDials:KT.MAX_PARALLEL_DIALS,maxDialsPerPeer:KT.MAX_PER_PEER_DIALS,dialTimeout:KT.DIAL_TIMEOUT,resolvers:{dnsaddr:xZe},addressSorter:IZe},host:{agentVersion:AZe},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{dht:{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:Afe.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:Afe.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};xfe.exports.validate=r=>{let e=SZe(RZe,r);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var kfe=p((y6t,Tfe)=>{l();"use strict";var{EventEmitter:kZe}=Lr(),{Multiaddr:T1}=lr(),CZe=dt(),Rfe=class extends kZe{constructor(e,{listen:t=[],announce:i=[]}={}){super();this.peerId=e,this.listen=new Set(t.map(n=>n.toString())),this.announce=new Set(i.map(n=>n.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new T1(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new T1(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new T1(e))}addObservedAddr(e){let t=new T1(e),i=t.getPeerId();i&&CZe.createFromB58String(i).equals(this.peerId)&&(t=t.decapsulate(new T1(`/p2p/${this.peerId}`)));let n=t.toString();this.observed.has(n)||(this.observed.add(n),this.emit("change:addresses"))}};Tfe.exports=Rfe});var Ofe=p((g6t,Cfe)=>{l();"use strict";var{EventEmitter:PZe}=Lr(),jT=xe()("latency-monitor:VisibilityChangeEmitter"),Pfe=class extends PZe{constructor(){super();if(typeof document=="undefined"){jT('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,t;typeof document.hidden!="undefined"?(e="hidden",t="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",t="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",t="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",t="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=t}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?jT("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];jT(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};Cfe.exports=Pfe});var Dfe=p((b6t,Bfe)=>{l();"use strict";var{EventEmitter:OZe}=Lr(),BZe=Ofe(),ou=xe()("latency-monitor:LatencyMonitor"),Nfe=class extends OZe{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:t,asyncTestFn:i,latencyRandomPercentage:n}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=n||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=t===null||t===0?void 0:t||5*1e3,ou("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?ou("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):ou("Not emitting summaries"),s.asyncTestFn=i}start(){globalThis.process&&globalThis.process.hrtime?(ou("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let t=this.now(e);return t[0]*1e3+t[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(ou("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(ou("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),NZe()&&(this._visibilityChangeEmitter=new BZe,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),ou("Summary: %O",e),e}_checkLatency(){let e=this,t=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,i={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+t),startTime:e.now()},n=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(i.startTime)-i.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,ou("MS: %s Data: %O",s,e._latencyData)};ou("localData: %O",i),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(i.deltaOffset=0,i.startTime=e.now(),e.asyncTestFn(n)):(i.deltaOffset-=1,n())},i.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function NZe(){return typeof window!="undefined"}Bfe.exports=Nfe});var Mfe=p((m6t,qfe)=>{l();"use strict";qfe.exports=function(){return Date.now()}});var VT=p((v6t,Lfe)=>{l();"use strict";var z_=Mfe(),Ffe=class{constructor(e,t,i){let n=this;this._started=z_(),this._rescheduled=0,this._scheduled=t,this._args=i,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(z_()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);let t=z_();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=z_(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function DZe(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new Ffe(arguments[0],arguments[1],r)}Lfe.exports=DZe});var Hfe=p((w6t,Ufe)=>{l();"use strict";var Kfe=xe(),oa=Object.assign(Kfe("libp2p:connection-manager"),{error:Kfe("libp2p:connection-manager:err")}),jfe=ge(),qZe=Gr(),MZe=Dfe(),H_=VT(),{EventEmitter:LZe}=Lr(),FZe=dt(),{codes:{ERR_INVALID_PARAMETERS:Vfe}}=yi(),UZe={maxConnections:Infinity,minConnections:0,maxData:Infinity,maxSentData:Infinity,maxReceivedData:Infinity,maxEventLoopDelay:Infinity,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},zfe=class extends LZe{constructor(e,t={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=qZe.call({ignoreUndefined:!0},UZe,t),this._options.maxConnections<this._options.minConnections)throw jfe(new Error("Connection Manager maxConnections must be greater than minConnections"),Vfe);oa("options: %j",this._options),this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._autoDialTimeout=null,this._checkMetrics=this._checkMetrics.bind(this),this._autoDial=this._autoDial.bind(this),this._latencyMonitor=new MZe({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval})}get size(){return Array.from(this.connections.values()).reduce((e,t)=>e+t.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||H_(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,oa("started"),this._options.autoDial&&this._autoDial()}async stop(){this._autoDialTimeout&&this._autoDialTimeout.clear(),this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),oa("stopped")}async _close(){let e=[];for(let t of this.connections.values())for(let i of t)e.push(i.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,t){if(t<0||t>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),t)}_checkMetrics(){if(this._libp2p.metrics){let e=this._libp2p.metrics.global.movingAverages,t=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",t);let i=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",i);let n=t+i;this._checkMaxLimit("maxData",n),oa("metrics update",n),this._timer=H_(this._checkMetrics,this._options.pollInterval)}}onConnect(e){let t=e.remotePeer,i=t.toB58String(),n=this.connections.get(i);this.emit("peer:connect",e),n?n.push(e):this.connections.set(i,[e]),this._libp2p.peerStore.keyBook.set(t,t.pubKey),this._peerValues.has(i)||this._peerValues.set(i,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){let t=e.remotePeer.toB58String(),i=this.connections.get(t);i&&i.length>1?(i=i.filter(n=>n.id!==e.id),this.connections.set(t,i)):i&&(this.connections.delete(t),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e))}get(e){let t=this.getAll(e);return t.length?t[0]:null}getAll(e){if(!FZe.isPeerId(e))throw jfe(new Error("peerId must be an instance of peer-id"),Vfe);let t=e.toB58String(),i=this.connections.get(t);return i?i.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs)}_checkMaxLimit(e,t){let i=this._options[e];oa("checking limit of %s. current value: %d of %d",e,t,i),t>i&&(oa("%s: limit exceeded: %s, %d",this._peerId,e,t),this._maybeDisconnectOne())}async _autoDial(){let e=this._options.minConnections;if(this.size>=e){this._autoDialTimeout=H_(this._autoDial,this._options.autoDialInterval);return}let t=Array.from(this._libp2p.peerStore.peers.values()).sort((i,n)=>n.protocols&&n.protocols.length&&(!i.protocols||!i.protocols.length)||n.id.pubKey&&!i.id.pubKey?1:-1);for(let i=0;i<t.length&&this.size<e;i++)if(!this.get(t[i].id)){oa("connecting to a peerStore stored peer %s",t[i].id.toB58String());try{if(await this._libp2p.dialer.connectToPeer(t[i].id),!this._started)return}catch(n){oa.error("could not connect to peerStore stored peer",n)}}this._autoDialTimeout=H_(this._autoDial,this._options.autoDialInterval)}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((i,n)=>i[1]-n[1])));oa("%s: sorted peer values: %j",this._peerId,e);let t=e[0];if(t){let i=t[0];oa("%s: lowest value peer is %s",this._peerId,i),oa("%s: closing a connection to %j",this._peerId,i);for(let n of this.connections.values())if(n[0].remotePeer.toB58String()===i){n[0].close();break}}}}};Ufe.exports=zfe});var Wp=p((_6t,Gfe)=>{l();"use strict";var nh=hi(),G_=nh.Reader,$fe=nh.Writer,ho=nh.util,Yi=nh.roots["libp2p-circuit"]||(nh.roots["libp2p-circuit"]={});Yi.CircuitRelay=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.type=1,r.prototype.srcPeer=null,r.prototype.dstPeer=null,r.prototype.code=100,r.encode=function(t,i){return i||(i=$fe.create()),t.type!=null&&Object.hasOwnProperty.call(t,"type")&&i.uint32(8).int32(t.type),t.srcPeer!=null&&Object.hasOwnProperty.call(t,"srcPeer")&&Yi.CircuitRelay.Peer.encode(t.srcPeer,i.uint32(18).fork()).ldelim(),t.dstPeer!=null&&Object.hasOwnProperty.call(t,"dstPeer")&&Yi.CircuitRelay.Peer.encode(t.dstPeer,i.uint32(26).fork()).ldelim(),t.code!=null&&Object.hasOwnProperty.call(t,"code")&&i.uint32(32).int32(t.code),i},r.decode=function(t,i){t instanceof G_||(t=G_.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Yi.CircuitRelay;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.type=t.int32();break;case 2:s.srcPeer=Yi.CircuitRelay.Peer.decode(t,t.uint32());break;case 3:s.dstPeer=Yi.CircuitRelay.Peer.decode(t,t.uint32());break;case 4:s.code=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Yi.CircuitRelay)return t;var i=new Yi.CircuitRelay;switch(t.type){case"HOP":case 1:i.type=1;break;case"STOP":case 2:i.type=2;break;case"STATUS":case 3:i.type=3;break;case"CAN_HOP":case 4:i.type=4;break}if(t.srcPeer!=null){if(typeof t.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");i.srcPeer=Yi.CircuitRelay.Peer.fromObject(t.srcPeer)}if(t.dstPeer!=null){if(typeof t.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");i.dstPeer=Yi.CircuitRelay.Peer.fromObject(t.dstPeer)}switch(t.code){case"SUCCESS":case 100:i.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:i.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:i.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:i.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:i.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:i.code=260;break;case"HOP_CANT_DIAL_DST":case 261:i.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:i.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:i.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:i.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:i.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:i.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:i.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:i.code=351;break;case"STOP_RELAY_REFUSED":case 390:i.code=390;break;case"MALFORMED_MESSAGE":case 400:i.code=400;break}return i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.type=i.enums===String?"HOP":1,n.srcPeer=null,n.dstPeer=null,n.code=i.enums===String?"SUCCESS":100),t.type!=null&&t.hasOwnProperty("type")&&(n.type=i.enums===String?Yi.CircuitRelay.Type[t.type]:t.type),t.srcPeer!=null&&t.hasOwnProperty("srcPeer")&&(n.srcPeer=Yi.CircuitRelay.Peer.toObject(t.srcPeer,i)),t.dstPeer!=null&&t.hasOwnProperty("dstPeer")&&(n.dstPeer=Yi.CircuitRelay.Peer.toObject(t.dstPeer,i)),t.code!=null&&t.hasOwnProperty("code")&&(n.code=i.enums===String?Yi.CircuitRelay.Status[t.code]:t.code),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,nh.util.toJSONOptions)},r.Status=function(){var e={},t=Object.create(e);return t[e[100]="SUCCESS"]=100,t[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,t[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,t[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,t[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,t[e[260]="HOP_NO_CONN_TO_DST"]=260,t[e[261]="HOP_CANT_DIAL_DST"]=261,t[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,t[e[270]="HOP_CANT_SPEAK_RELAY"]=270,t[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,t[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,t[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,t[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,t[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,t[e[390]="STOP_RELAY_REFUSED"]=390,t[e[400]="MALFORMED_MESSAGE"]=400,t}(),r.Type=function(){var e={},t=Object.create(e);return t[e[1]="HOP"]=1,t[e[2]="STOP"]=2,t[e[3]="STATUS"]=3,t[e[4]="CAN_HOP"]=4,t}(),r.Peer=function(){function e(t){if(this.addrs=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.id=ho.newBuffer([]),e.prototype.addrs=ho.emptyArray,e.encode=function(i,n){if(n||(n=$fe.create()),n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return n},e.decode=function(i,n){i instanceof G_||(i=G_.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Yi.CircuitRelay.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.id=i.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(i.bytes());break;default:i.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw ho.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(i){if(i instanceof Yi.CircuitRelay.Peer)return i;var n=new Yi.CircuitRelay.Peer;if(i.id!=null&&(typeof i.id=="string"?ho.base64.decode(i.id,n.id=ho.newBuffer(ho.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?ho.base64.decode(i.addrs[s],n.addrs[s]=ho.newBuffer(ho.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=ho.newBuffer(s.id)))),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?ho.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var o=0;o<i.addrs.length;++o)s.addrs[o]=n.bytes===String?ho.base64.encode(i.addrs[o],0,i.addrs[o].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[o]):i.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,nh.util.toJSONOptions)},e}(),r}();Gfe.exports=Yi});var Xfe=p((E6t,Wfe)=>{l();"use strict";var{source:Yfe}=cc(),KZe=xe(),jZe=KZe("libp2p:stream:converter");function VZe({stream:r,remoteAddr:e,localAddr:t},i={}){let{sink:n,source:s}=r,o={async sink(c){i.signal&&(c=Yfe(c,i.signal));try{await n(c)}catch(u){u.type!=="aborted"&&jZe(u)}a()},source:i.signal?Yfe(s,i.signal):s,conn:r,localAddr:t,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return n(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}Wfe.exports=VZe});var R1=p((S6t,Jfe)=>{l();"use strict";Jfe.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var Zfe=p((x6t,Qfe)=>{l();"use strict";var{EventEmitter:zZe}=Lr(),{Multiaddr:HZe}=lr();Qfe.exports=r=>{let e=new Map;async function t(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await r.dial(new HZe(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),n.emit("listening")}function i(){let s=[];for(let o of e.values())s.push(o);return s}let n=Object.assign(new zZe,{close:()=>Promise.resolve(),listen:t,getAddrs:i});return r.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&n.emit("close")}),n}});var zT=p((A6t,ele)=>{l();"use strict";var{Multiaddr:tle}=lr(),{CircuitRelay:sh}=Wp();function rle(r,e){r.write({type:sh.Type.STATUS,code:e})}function GZe(r,e){try{r.dstPeer&&r.dstPeer.addrs&&r.dstPeer.addrs.forEach(t=>new tle(t))}catch(t){throw rle(e,r.type===sh.Type.HOP?sh.Status.HOP_DST_MULTIADDR_INVALID:sh.Status.STOP_DST_MULTIADDR_INVALID),t}try{r.srcPeer&&r.srcPeer.addrs&&r.srcPeer.addrs.forEach(t=>new tle(t))}catch(t){throw rle(e,r.type===sh.Type.HOP?sh.Status.HOP_SRC_MULTIADDR_INVALID:sh.Status.STOP_SRC_MULTIADDR_INVALID),t}}ele.exports={validateAddrs:GZe}});var sle=p((I6t,ile)=>{l();"use strict";var{Buffer:aa}=xt(),nle=Symbol.for("BufferList");function Rr(r){if(!(this instanceof Rr))return new Rr(r);Rr._init.call(this,r)}Rr._init=function(e){Object.defineProperty(this,nle,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Rr.prototype._new=function(e){return new Rr(e)};Rr.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};Rr.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};Rr.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};Rr.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};Rr.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||aa.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&t||0,f=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:aa.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,u),u+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-f)return s?this._bufs[o[0]].copy(e,t,f,f+c):this._bufs[o[0]].slice(f,f+c);s||(e=aa.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-f;if(c>d)this._bufs[h].copy(e,u,f),u+=d;else{this._bufs[h].copy(e,u,f,f+c),u+=d;break}c-=d,f&&(f=0)}return e.length>u?e.slice(0,u):e};Rr.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};Rr.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};Rr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Rr.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};Rr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(aa.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(aa.from(e));return this};Rr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Rr.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=aa.from([r]):typeof r=="string"?r=aa.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=aa.from(r.buffer,r.byteOffset,r.byteLength):aa.isBuffer(r)||(r=aa.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};Rr.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?Rr.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:Rr.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();Rr.prototype._isBufferList=function(e){return e instanceof Rr||Rr.isBufferList(e)};Rr.isBufferList=function(e){return e!=null&&e[nle]};ile.exports=Rr});var GT=p((T6t,ole)=>{l();var HT=sle();ole.exports=r=>{let e=async function*(){let t=yield,i=new HT;for await(let n of r){if(!t){t=yield i.append(n),i=new HT;continue}for(i.append(n);i.length>=t;){let s=i.shallowSlice(0,t);if(i.consume(t),t=yield s,!t){i.length&&(t=yield i,i=new HT);break}}}if(t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var k1=p((R6t,ale)=>{l();"use strict";var $Ze=()=>{let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r};ale.exports=$Ze});var Yp=p((k6t,cle)=>{l();"use strict";var WZe=GT(),YZe=Wc(),XZe=k1();cle.exports=r=>{let e=YZe(),t=WZe(r.source),i=XZe(),n,s=r.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(a=>{n=a}),{reader:t,writer:e,stream:{sink:a=>n?Promise.reject(n):(i.resolve(a),s),source:t},rest:()=>e.end(),write:e.push,read:async()=>(await t.next()).value}}});var W_=p((C6t,ule)=>{l();"use strict";var fle=xe(),$_=Object.assign(fle("libp2p:circuit:stream-handler"),{error:fle("libp2p:circuit:stream-handler:err")}),lle=ia(),JZe=Yp(),{CircuitRelay:hle}=Wp(),dle=class{constructor({stream:e,maxLength:t=4096}){this.stream=e,this.shake=JZe(this.stream),this.decoder=lle.decode.fromReader(this.shake.reader,{maxDataLength:t})}async read(){let e=await this.decoder.next();if(e.value){let t=hle.decode(e.value.slice());return $_("read message type",t.type),t}$_("read received no value, closing stream"),this.close()}write(e){$_("write message type %s",e.type),this.shake.write(lle.encode.single(hle.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){$_("closing the stream"),this.rest().sink([])}};ule.exports=dle});var YT=p((P6t,$T)=>{l();"use strict";var ple=xe(),C1=Object.assign(ple("libp2p:circuit:stop"),{error:ple("libp2p:circuit:stop:err")}),{CircuitRelay:WT}=Wp(),QZe=R1(),ZZe=W_(),{validateAddrs:eet}=zT();$T.exports.handleStop=function({connection:e,request:t,streamHandler:i}){try{eet(t,i)}catch(n){return C1.error("invalid stop request via peer %s",e.remotePeer.toB58String(),n)}return C1("stop request is valid"),i.write({type:WT.Type.STATUS,code:WT.Status.SUCCESS}),i.rest()};$T.exports.stop=async function({connection:e,request:t}){let{stream:i}=await e.newStream([QZe.relay]);C1("starting stop request to %s",e.remotePeer.toB58String());let n=new ZZe({stream:i});n.write(t);let s=await n.read();if(!s)return n.close();if(s.code===WT.Status.SUCCESS)return C1("stop request to %s was successful",e.remotePeer.toB58String()),n.rest();C1("stop request failed with code %d",s.code),n.close()}});var XT=p((O6t,yle)=>{l();"use strict";var gle=xe(),au=Object.assign(gle("libp2p:circuit:hop"),{error:gle("libp2p:circuit:hop:err")}),ble=ge(),tet=dt(),{validateAddrs:ret}=zT(),mle=W_(),{CircuitRelay:ks}=Wp(),{pipe:iet}=pi(),{codes:vle}=yi(),{stop:net}=YT(),wle=R1();async function set({connection:r,request:e,streamHandler:t,circuit:i}){if(!i._options.hop.enabled)return au("HOP request received but we are not acting as a relay"),t.end({type:ks.Type.STATUS,code:ks.Status.HOP_CANT_SPEAK_RELAY});try{ret(e,t)}catch(u){return au.error("invalid hop request via peer %s",r.remotePeer.toB58String(),u)}if(!e.dstPeer){au("HOP request received but we do not receive a dstPeer");return}let n=new tet(e.dstPeer.id),s=i._connectionManager.get(n);if(!s&&!i._options.hop.active)return au("HOP request received but we are not connected to the destination peer"),t.end({type:ks.Type.STATUS,code:ks.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:ks.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await net({connection:s,request:o})}catch(u){return au.error(u)}au("hop request from %s is valid",r.remotePeer.toB58String()),t.write({type:ks.Type.STATUS,code:ks.Status.SUCCESS});let c=t.rest();return iet(c,a,c)}async function oet({connection:r,request:e}){let{stream:t}=await r.newStream([wle.relay]),i=new mle({stream:t});i.write(e);let n=await i.read();if(!n)throw ble(new Error("HOP request had no response"),vle.ERR_HOP_REQUEST_FAILED);if(n.code===ks.Status.SUCCESS)return au("hop request was successful"),i.rest();throw au("hop request failed with code %d, closing stream",n.code),i.close(),ble(new Error(`HOP request failed with code ${n.code}`),vle.ERR_HOP_REQUEST_FAILED)}async function aet({connection:r}){let{stream:e}=await r.newStream([wle.relay]),t=new mle({stream:e});t.write({type:ks.Type.CAN_HOP});let i=await t.read();return await t.close(),!(!i||i.code!==ks.Status.SUCCESS)}function cet({connection:r,streamHandler:e,circuit:t}){let i=t._options.hop.enabled;au("can hop (%s) request from %s",i,r.remotePeer.toB58String()),e.end({type:ks.Type.STATUS,code:i?ks.Status.SUCCESS:ks.Status.HOP_CANT_SPEAK_RELAY})}yle.exports={handleHop:set,hop:oet,canHop:aet,handleCanHop:cet}});var Ile=p((B6t,_le)=>{l();"use strict";var Ele=xe(),cu=Object.assign(Ele("libp2p:circuit"),{error:Ele("libp2p:circuit:err")}),uet=ge(),fet=fl(),{Multiaddr:P1}=lr(),Sle=dt(),{CircuitRelay:O1}=Wp(),{codes:het}=yi(),xle=Xfe(),{relay:det}=R1(),pet=Zfe(),{handleCanHop:yet,handleHop:get,hop:bet}=XT(),{handleStop:met}=YT(),vet=W_(),wet=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),Ale=class{constructor({libp2p:e,upgrader:t}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=t,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(det,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:t}){let i=new vet({stream:t}),n=await i.read();if(!n)return;let s=this,o;switch(n.type){case O1.Type.CAN_HOP:{cu("received CAN_HOP request from %s",e.remotePeer.toB58String()),await yet({circuit:s,connection:e,streamHandler:i});break}case O1.Type.HOP:{cu("received HOP request from %s",e.remotePeer.toB58String()),o=await get({connection:e,request:n,streamHandler:i,circuit:s});break}case O1.Type.STOP:{cu("received STOP request from %s",e.remotePeer.toB58String()),o=await met({connection:e,request:n,streamHandler:i});break}default:cu("Request of type %s not supported",n.type)}if(o){let a=new P1(n.dstPeer.addrs[0]),c=new P1(n.srcPeer.addrs[0]),u=xle({stream:o,remoteAddr:a,localAddr:c}),f=n.type===O1.Type.HOP?"relay":"inbound";cu("new %s connection %s",f,u.remoteAddr);let h=await this._upgrader.upgradeInbound(u);cu("%s connection %s upgraded",f,u.remoteAddr),this.handler&&this.handler(h)}}async dial(e,t){let i=e.toString().split("/p2p-circuit"),n=new P1(i[0]),s=new P1(i[i.length-1]),o=n.getPeerId(),a=s.getPeerId();if(!o||!a){let d="Circuit relay dial failed as addresses did not have peer id";throw cu.error(d),uet(new Error(d),het.ERR_RELAYED_DIAL)}let c=Sle.createFromCID(o),u=Sle.createFromCID(a),f=!1,h=this._connectionManager.get(c);h||(h=await this._dialer.connectToPeer(n,t),f=!0);try{let d=await bet({connection:h,request:{type:O1.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(m=>m.bytes)},dstPeer:{id:u.toBytes(),addrs:[new P1(s).bytes]}}}),y=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),g=xle({stream:d,remoteAddr:e,localAddr:y});return cu("new outbound connection %s",g.remoteAddr),this._upgrader.upgradeOutbound(g)}catch(d){throw cu.error("Circuit relay dial failed",d),f&&await h.close(),d}}createListener(e,t){return typeof e=="function"&&(t=e,e={}),this.handler=t,pet(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>fet.Circuit.matches(t))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[wet])}};_le.exports=Ale});var JT=p((N6t,Tle)=>{l();"use strict";var _et=Qe(),Eet=er();Tle.exports.namespaceToCid=async r=>{let e=new TextEncoder().encode(r),t=await Eet(e,"sha2-256");return new _et(t)}});var Nle=p((D6t,Rle)=>{l();"use strict";var kle=xe(),Cle=Object.assign(kle("libp2p:auto-relay"),{error:kle("libp2p:auto-relay:err")}),xet=ct(),Aet=tt(),{Multiaddr:Iet}=lr(),Tet=dt(),{relay:Ret}=R1(),{canHop:ket}=XT(),{namespaceToCid:Cet}=JT(),{CIRCUIT_PROTO_CODE:Pet,HOP_METADATA_KEY:Ple,HOP_METADATA_VALUE:Ole,RELAY_RENDEZVOUS_NS:Oet}=U_(),Ble=class{constructor({libp2p:e,maxListeners:t=1,onError:i}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=t,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(n,s)=>{Cle.error(s||n),i&&i(n,s)}}async _onProtocolChange({peerId:e,protocols:t}){let i=e.toB58String(),n=t.find(s=>s===Ret);if(!n&&this._listenRelays.has(i)){this._removeListenRelay(i);return}else if(!n||this._listenRelays.has(i))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(Pet)){Cle(`relayed connection to ${i} will not be used to hop on`);return}await ket({connection:s})&&(this._peerStore.metadataBook.set(e,Ple,xet(Ole)),await this._addListenRelay(s,i))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let i=e.remotePeer.toB58String();!this._listenRelays.has(i)||this._removeListenRelay(i)}async _addListenRelay(e,t){if(this._listenRelays.size>=this.maxListeners)return;let i=this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);if(!i||!i.length)return;let n=`${i[0].toString()}/p2p-circuit`;this._listenRelays.add(t);try{await this._transportManager.listen([new Iet(n)])}catch(s){this._onError(s),this._listenRelays.delete(t)}}_removeListenRelay(e){this._listenRelays.delete(e)&&this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let t=[];for(let[i,n]of this._peerStore.metadataBook.data.entries()){if(this._listenRelays.has(i)||e.includes(i))continue;let s=n.get(Ple);if(!s||Aet(s)!==Ole)continue;let o=Tet.createFromCID(i),a=this._connectionManager.get(o);if(!a){t.push(o);continue}if(await this._addListenRelay(a,i),this._listenRelays.size>=this.maxListeners)return}for(let i of t)if(await this._tryToListenOnRelay(i),this._listenRelays.size>=this.maxListeners)return;try{let i=await Cet(Oet);for await(let n of this._libp2p.contentRouting.findProviders(i)){if(!n.multiaddrs.length)continue;let s=n.id;if(this._peerStore.addressBook.add(s,n.multiaddrs),await this._tryToListenOnRelay(s),this._listenRelays.size>=this.maxListeners)return}}catch(i){this._onError(i)}}async _tryToListenOnRelay(e){try{let t=await this._libp2p.dial(e);await this._addListenRelay(t,e.toB58String())}catch(t){this._onError(t,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};Rle.exports=Ble});var Fle=p((q6t,Dle)=>{l();"use strict";var qle=xe(),Mle=Object.assign(qle("libp2p:relay"),{error:qle("libp2p:relay:err")}),{setDelayedInterval:Bet,clearDelayedInterval:Net}=IT(),Det=Nle(),{namespaceToCid:qet}=JT(),{RELAY_RENDEZVOUS_NS:Met}=U_(),Lle=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new Det({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=Bet(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){Net(this._timeout)}async _advertiseService(){try{let e=await qet(Met);await this._libp2p.contentRouting.provide(e)}catch(e){e.code==="NO_ROUTERS_AVAILABLE"?(Mle.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):Mle.error(e)}}};Dle.exports=Lle});var Vle=p((L6t,Ule)=>{l();var Kle=oA(),jle=k1();Ule.exports=class{constructor(){this._buffer=new Kle,this._waitingConsumers=new Kle}push(e){let{promise:t,resolve:i}=jle();return this._buffer.push({chunk:e,resolve:i}),this._consume(),t}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){let{promise:e,resolve:t}=jle();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var Hle=p((F6t,zle)=>{l();"use strict";zle.exports=(r,e=1,t)=>{if(t={indent:" ",includeEmptyLines:!1,...t},typeof r!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof r}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof t.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof t.indent}\``);if(e===0)return r;let i=t.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return r.replace(i,t.indent.repeat(e))}});var Gle=p(()=>{l()});var Xle=p((j6t,$le)=>{l();"use strict";var Wle=Gle(),Yle=/\s+at.*(?:\(|\s)(.*)\)?/,Let=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,Fet=typeof Wle.homedir=="undefined"?"":Wle.homedir();$le.exports=(r,e)=>(e=Object.assign({pretty:!1},e),r.replace(/\\/g,"/").split(`
`).filter(t=>{let i=t.match(Yle);if(i===null||!i[1])return!0;let n=i[1];return n.includes(".app/Contents/Resources/electron.asar")||n.includes(".app/Contents/Resources/default_app.asar")?!1:!Let.test(n)}).filter(t=>t.trim()!=="").map(t=>e.pretty?t.replace(Yle,(i,n)=>i.replace(n,n.replace(Fet,"~"))):t).join(`
`))});var QT=p((V6t,Jle)=>{l();"use strict";var Uet=Hle(),Ket=Xle(),jet=r=>r.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),Qle=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let t=e.map(i=>typeof i.stack=="string"?jet(Ket(i.stack)):String(i)).join(`
`);t=`
`+Uet(t,4),super(t),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};Jle.exports=Qle});var Zle=p((z6t,ZT)=>{l();"use strict";var eR=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},B1=class{static fn(e){return(...t)=>new B1((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new eR(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(B1.prototype,Promise.prototype);ZT.exports=B1;ZT.exports.CancelError=eR});var the=p((H6t,Y_)=>{l();"use strict";var ehe=QT(),Vet=Zle(),tR=class extends Error{},zet=(r,e)=>new Vet((t,i,n)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){i(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,f=!1,h=new Set,d=()=>(a.length===s&&(t(a),f=!0),u-c.length<s&&(i(new ehe(c)),f=!0),f),y=()=>{for(let g of r)!h.has(g)&&typeof g.cancel=="function"&&g.cancel()};n(y);for(let g of r)u++,(async()=>{try{let m=await g;if(f)return;if(!o(m))throw new tR("Value does not satisfy filter");a.push(m)}catch(m){c.push(m)}finally{h.add(g),!f&&d()&&y()}})();s>u&&(i(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),y())});Y_.exports=zet;Y_.exports.AggregateError=ehe;Y_.exports.FilterError=tR});var rhe=p((G6t,rR)=>{l();"use strict";var iR=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},N1=class{static fn(e){return(...t)=>new N1((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new iR(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(N1.prototype,Promise.prototype);rR.exports=N1;rR.exports.CancelError=iR});var nhe=p(($6t,nR)=>{l();"use strict";var ihe=the(),Het=rhe();nR.exports=(r,e)=>{let t=ihe(r,{...e,count:1});return Het.fn(async i=>{i(()=>{t.cancel()});let[n]=await t;return n})()};nR.exports.AggregateError=ihe.AggregateError});var ahe=p((W6t,she)=>{l();"use strict";var Get=ge(),$et=Uf().default,{anySignal:Wet}=Bh(),Yet=Vle(),Xet=nhe(),ohe=class{constructor({addrs:e,dialAction:t,dialer:i}){this.addrs=e,this.dialer=i,this.dialAction=t}async run(e={}){let t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw Get(new Error("No dial tokens available"),"ERR_NO_DIAL_TOKENS");let i=new Yet;t.forEach(o=>i.push(o));let n=this.addrs.map(()=>new $et),s=0;try{return await Xet(this.addrs.map(async(o,a)=>{let c=await i.shift(),u;try{let f=n[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?Wet([f,e.signal]):f}),n.splice(a,1)}finally{s++,this.addrs.length-s>=t.length?i.push(c):this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0])}return u}))}finally{n.map(o=>o.abort()),t.forEach(o=>this.dialer.releaseToken(o))}}};she.exports=ohe});var hhe=p((Y6t,che)=>{l();"use strict";var uhe=xe(),Xp=Object.assign(uhe("libp2p:dialer"),{error:uhe("libp2p:dialer:err")}),fhe=ge(),{Multiaddr:sR}=lr(),Jet=T6(),{AbortError:Qet}=cc(),{anySignal:Zet}=Bh(),ett=ahe(),{publicAddressesFirst:ttt}=BT(),rtt=kT(),{codes:oR}=yi(),{DIAL_TIMEOUT:itt,MAX_PARALLEL_DIALS:ntt,MAX_PER_PEER_DIALS:stt}=F_(),lhe=class{constructor({transportManager:e,peerStore:t,addressSorter:i=ttt,maxParallelDials:n=ntt,dialTimeout:s=itt,maxDialsPerPeer:o=stt,resolvers:a={}}){this.transportManager=e,this.peerStore=t,this.addressSorter=i,this.maxParallelDials=n,this.timeout=s,this.maxDialsPerPeer=o,this.tokens=[...new Array(n)].map((c,u)=>u),this._pendingDials=new Map,this._pendingDialTargets=new Map;for(let[c,u]of Object.entries(a))sR.resolvers.set(c,u)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(t){Xp.error(t)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new Qet("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,t={}){let i=await this._createCancellableDialTarget(e);if(!i.addrs.length)throw fhe(new Error("The dial request has no valid addresses"),oR.ERR_NO_VALID_ADDRESSES);let n=this._pendingDials.get(i.id)||this._createPendingDial(i,t);try{let s=await n.promise;return Xp("dial succeeded to %s",i.id),s}catch(s){throw n.controller.signal.aborted&&(s.code=oR.ERR_TIMEOUT),Xp.error(s),s}finally{n.destroy()}}async _createCancellableDialTarget(e){let t=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,i=new Promise((s,o)=>{this._pendingDialTargets.set(t,{resolve:s,reject:o})}),n=await Promise.race([this._createDialTarget(e),i]);return this._pendingDialTargets.delete(t),n}async _createDialTarget(e){let{id:t,multiaddrs:i}=rtt(e);i&&this.peerStore.addressBook.add(t,i);let n=this.peerStore.addressBook.getMultiaddrsForPeer(t,this.addressSorter)||[];sR.isMultiaddr(e)&&(n=n.filter(a=>!e.equals(a)),n.unshift(e));let s=[];for(let a of n)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));return{id:t.toB58String(),addrs:o}}_createPendingDial(e,t={}){let i=(u,f)=>{if(f.signal.aborted)throw fhe(new Error("already aborted"),oR.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,f)},n=new ett({addrs:e.addrs,dialAction:i,dialer:this}),s=new Jet(this.timeout),o=[s.signal];t.signal&&o.push(t.signal);let a=Zet(o),c={dialRequest:n,controller:s,promise:n.run({...t,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),i=this.tokens.splice(0,t);return Xp("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),i}releaseToken(e){this.tokens.indexOf(e)>-1||(Xp("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let i=await this._resolveRecord(e);return(await Promise.all(i.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new sR(e.toString()),await e.resolve()}catch(t){return Xp.error(`multiaddr ${e} could not be resolved`),[]}}};che.exports=lhe});var phe=p((X6t,dhe)=>{l();"use strict";function ott(r){return r>=55296&&r<=56319}function att(r){return r>=56320&&r<=57343}dhe.exports=function(e,t,i){if(typeof t!="string")throw new Error("Input must be string");for(var n=t.length,s=0,o,a,c=0;c<n;c+=1){if(o=t.charCodeAt(c),a=t[c],ott(o)&&att(t.charCodeAt(c+1))&&(c+=1,a+=t[c]),s+=e(a),s===i)return t.slice(0,c+1);if(s>i)return t.slice(0,c-a.length+1)}return t}});var ghe=p((J6t,yhe)=>{l();"use strict";function ctt(r){return r>=55296&&r<=56319}function utt(r){return r>=56320&&r<=57343}yhe.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var t=e.length,i=0,n=null,s=null,o=0;o<t;o++)n=e.charCodeAt(o),utt(n)?s!=null&&ctt(s)?i+=1:i+=3:n<=127?i+=1:n>=128&&n<=2047?i+=2:n>=2048&&n<=65535&&(i+=3),s=n;return i}});var mhe=p((Q6t,bhe)=>{l();"use strict";var ftt=phe(),ltt=ghe();bhe.exports=ftt.bind(null,ltt)});var _he=p((Z6t,vhe)=>{l();"use strict";var htt=mhe(),dtt=/[\/\?<>\\:\*\|"]/g,ptt=/[\x00-\x1f\x80-\x9f]/g,ytt=/^\.+$/,gtt=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,btt=/[\. ]+$/;function whe(r,e){if(typeof r!="string")throw new Error("Input must be string");var t=r.replace(dtt,e).replace(ptt,e).replace(ytt,e).replace(gtt,e).replace(btt,e);return htt(t,255)}vhe.exports=function(r,e){var t=e&&e.replacement||"",i=whe(r,t);return t===""?i:whe(i,"")}});var Ahe=p((e4t,Ehe)=>{l();var Jp=bt();Pc();yr();var Ke=Jp.asn1,Qp=Ehe.exports=Jp.pkcs7asn1=Jp.pkcs7asn1||{};Jp.pkcs7=Jp.pkcs7||{};Jp.pkcs7.asn1=Qp;var She={name:"ContentInfo",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};Qp.contentInfoValidator=She;var xhe={name:"EncryptedContentInfo",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Ke.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};Qp.envelopedDataValidator={name:"EnvelopedData",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(xhe)};Qp.encryptedDataValidator={name:"EncryptedData",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"version"}].concat(xhe)};var mtt={name:"SignerInfo",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Ke.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};Qp.signedDataValidator={name:"SignedData",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},She,{name:"SignedData.Certificates",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SET,capture:"signerInfos",optional:!0,value:[mtt]}]};Qp.recipientInfoValidator={name:"RecipientInfo",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Ke.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var The=p((t4t,Ihe)=>{l();var oh=bt();yr();oh.mgf=oh.mgf||{};var vtt=Ihe.exports=oh.mgf.mgf1=oh.mgf1=oh.mgf1||{};vtt.create=function(r){var e={generate:function(t,i){for(var n=new oh.util.ByteBuffer,s=Math.ceil(i/r.digestLength),o=0;o<s;o++){var a=new oh.util.ByteBuffer;a.putInt32(o),r.start(),r.update(t+a.getBytes()),n.putBuffer(r.digest())}return n.truncate(n.length()-i),n.getBytes()}};return e}});var khe=p((r4t,Rhe)=>{l();var X_=bt();The();Rhe.exports=X_.mgf=X_.mgf||{};X_.mgf.mgf1=X_.mgf1});var Phe=p((i4t,Che)=>{l();var ah=bt();Cu();yr();var wtt=Che.exports=ah.pss=ah.pss||{};wtt.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=r.md,t=r.mgf,i=e.digestLength,n=r.salt||null;typeof n=="string"&&(n=ah.util.createBuffer(n));var s;if("saltLength"in r)s=r.saltLength;else if(n!==null)s=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=r.prng||ah.random,a={};return a.encode=function(c,u){var f,h=u-1,d=Math.ceil(h/8),y=c.digest().getBytes();if(d<i+s+2)throw new Error("Message is too long to encrypt.");var g;n===null?g=o.getBytesSync(s):g=n.bytes();var m=new ah.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(y),m.putBytes(g),e.start(),e.update(m.getBytes());var x=e.digest().getBytes(),_=new ah.util.ByteBuffer;_.fillWithByte(0,d-s-i-2),_.putByte(1),_.putBytes(g);var P=_.getBytes(),q=d-i-1,X=t.generate(x,q),W="";for(f=0;f<q;f++)W+=String.fromCharCode(P.charCodeAt(f)^X.charCodeAt(f));var z=65280>>8*d-h&255;return W=String.fromCharCode(W.charCodeAt(0)&~z)+W.substr(1),W+x+String.fromCharCode(188)},a.verify=function(c,u,f){var h,d=f-1,y=Math.ceil(d/8);if(u=u.substr(-y),y<i+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(y-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=y-i-1,m=u.substr(0,g),x=u.substr(g,i),_=65280>>8*y-d&255;if((m.charCodeAt(0)&_)!=0)throw new Error("Bits beyond keysize not zero as expected.");var P=t.generate(x,g),q="";for(h=0;h<g;h++)q+=String.fromCharCode(m.charCodeAt(h)^P.charCodeAt(h));q=String.fromCharCode(q.charCodeAt(0)&~_)+q.substr(1);var X=y-i-s-2;for(h=0;h<X;h++)if(q.charCodeAt(h)!==0)throw new Error("Leftmost octets not zero as expected");if(q.charCodeAt(X)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var W=q.substr(-s),z=new ah.util.ByteBuffer;z.fillWithByte(0,8),z.putBytes(c),z.putBytes(W),e.start(),e.update(z.getBytes());var Z=e.digest().getBytes();return x===Z},a}});var cR=p((n4t,Ohe)=>{l();var Oe=bt();Kh();Pc();lm();ku();khe();Lh();ym();Phe();fy();yr();var D=Oe.asn1,Re=Ohe.exports=Oe.pki=Oe.pki||{},ut=Re.oids,Zr={};Zr.CN=ut.commonName;Zr.commonName="CN";Zr.C=ut.countryName;Zr.countryName="C";Zr.L=ut.localityName;Zr.localityName="L";Zr.ST=ut.stateOrProvinceName;Zr.stateOrProvinceName="ST";Zr.O=ut.organizationName;Zr.organizationName="O";Zr.OU=ut.organizationalUnitName;Zr.organizationalUnitName="OU";Zr.E=ut.emailAddress;Zr.emailAddress="E";var Bhe=Oe.pki.rsa.publicKeyValidator,_tt={name:"Certificate",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:D.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:D.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:D.Class.UNIVERSAL,type:D.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:D.Class.UNIVERSAL,type:D.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:D.Class.UNIVERSAL,type:D.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:D.Class.UNIVERSAL,type:D.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Bhe,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:D.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:D.Class.UNIVERSAL,type:D.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:D.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:D.Class.UNIVERSAL,type:D.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:D.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:D.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:D.Class.UNIVERSAL,type:D.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},Ett={name:"rsapss",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:D.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:D.Class.UNIVERSAL,type:D.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:D.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:D.Class.UNIVERSAL,type:D.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:D.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:D.Class.UNIVERSAL,type:D.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:D.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:D.Class.UNIVERSAL,type:D.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},Stt={name:"CertificationRequestInfo",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Bhe,{name:"CertificationRequestInfo.attributes",tagClass:D.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:D.Class.UNIVERSAL,type:D.Type.SET,constructed:!0}]}]}]},xtt={name:"CertificationRequest",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[Stt,{name:"CertificationRequest.signatureAlgorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:D.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:D.Class.UNIVERSAL,type:D.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Re.RDNAttributesAsArray=function(r,e){for(var t=[],i,n,s,o=0;o<r.value.length;++o){i=r.value[o];for(var a=0;a<i.value.length;++a)s={},n=i.value[a],s.type=D.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in ut&&(s.name=ut[s.type],s.name in Zr&&(s.shortName=Zr[s.name])),e&&(e.update(s.type),e.update(s.value)),t.push(s)}return t};Re.CRIAttributesAsArray=function(r){for(var e=[],t=0;t<r.length;++t)for(var i=r[t],n=D.derToOid(i.value[0].value),s=i.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=n,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in ut&&(a.name=ut[a.type],a.name in Zr&&(a.shortName=Zr[a.name])),a.type===ut.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(Re.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function Sf(r,e){typeof e=="string"&&(e={shortName:e});for(var t=null,i,n=0;t===null&&n<r.attributes.length;++n)i=r.attributes[n],(e.type&&e.type===i.type||e.name&&e.name===i.name||e.shortName&&e.shortName===i.shortName)&&(t=i);return t}var J_=function(r,e,t){var i={};if(r!==ut["RSASSA-PSS"])return i;t&&(i={hash:{algorithmOid:ut.sha1},mgf:{algorithmOid:ut.mgf1,hash:{algorithmOid:ut.sha1}},saltLength:20});var n={},s=[];if(!D.validate(e,Ett,n,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return n.hashOid!==void 0&&(i.hash=i.hash||{},i.hash.algorithmOid=D.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=D.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=D.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(i.saltLength=n.saltLength.charCodeAt(0)),i};Re.certificateFromPem=function(r,e,t){var i=Oe.pem.decode(r)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=D.fromDer(i.body,t);return Re.certificateFromAsn1(s,e)};Re.certificateToPem=function(r,e){var t={type:"CERTIFICATE",body:D.toDer(Re.certificateToAsn1(r)).getBytes()};return Oe.pem.encode(t,{maxline:e})};Re.publicKeyFromPem=function(r){var e=Oe.pem.decode(r)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var t=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=D.fromDer(e.body);return Re.publicKeyFromAsn1(i)};Re.publicKeyToPem=function(r,e){var t={type:"PUBLIC KEY",body:D.toDer(Re.publicKeyToAsn1(r)).getBytes()};return Oe.pem.encode(t,{maxline:e})};Re.publicKeyToRSAPublicKeyPem=function(r,e){var t={type:"RSA PUBLIC KEY",body:D.toDer(Re.publicKeyToRSAPublicKey(r)).getBytes()};return Oe.pem.encode(t,{maxline:e})};Re.getPublicKeyFingerprint=function(r,e){e=e||{};var t=e.md||Oe.md.sha1.create(),i=e.type||"RSAPublicKey",n;switch(i){case"RSAPublicKey":n=D.toDer(Re.publicKeyToRSAPublicKey(r)).getBytes();break;case"SubjectPublicKeyInfo":n=D.toDer(Re.publicKeyToAsn1(r)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}t.start(),t.update(n);var s=t.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Re.certificationRequestFromPem=function(r,e,t){var i=Oe.pem.decode(r)[0];if(i.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=D.fromDer(i.body,t);return Re.certificationRequestFromAsn1(s,e)};Re.certificationRequestToPem=function(r,e){var t={type:"CERTIFICATE REQUEST",body:D.toDer(Re.certificationRequestToAsn1(r)).getBytes()};return Oe.pem.encode(t,{maxline:e})};Re.createCertificate=function(){var r={};return r.version=2,r.serialNumber="00",r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.validity={},r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.issuer={},r.issuer.getField=function(e){return Sf(r.issuer,e)},r.issuer.addField=function(e){po([e]),r.issuer.attributes.push(e)},r.issuer.attributes=[],r.issuer.hash=null,r.subject={},r.subject.getField=function(e){return Sf(r.subject,e)},r.subject.addField=function(e){po([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.extensions=[],r.publicKey=null,r.md=null,r.setSubject=function(e,t){po(e),r.subject.attributes=e,delete r.subject.uniqueId,t&&(r.subject.uniqueId=t),r.subject.hash=null},r.setIssuer=function(e,t){po(e),r.issuer.attributes=e,delete r.issuer.uniqueId,t&&(r.issuer.uniqueId=t),r.issuer.hash=null},r.setExtensions=function(e){for(var t=0;t<e.length;++t)Nhe(e[t],{cert:r});r.extensions=e},r.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var t=null,i,n=0;t===null&&n<r.extensions.length;++n)i=r.extensions[n],(e.id&&i.id===e.id||e.name&&i.name===e.name)&&(t=i);return t},r.sign=function(e,t){r.md=t||Oe.md.sha1.create();var i=ut[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.tbsCertificate=Re.getTBSCertificate(r);var s=D.toDer(r.tbsCertificate);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(e){var t=!1;if(!r.issued(e)){var i=e.issuer,n=r.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=e.md;if(o===null){if(e.signatureOid in ut){var a=ut[e.signatureOid];switch(a){case"sha1WithRSAEncryption":o=Oe.md.sha1.create();break;case"md5WithRSAEncryption":o=Oe.md.md5.create();break;case"sha256WithRSAEncryption":o=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":o=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":o=Oe.md.sha512.create();break;case"RSASSA-PSS":o=Oe.md.sha256.create();break}}if(o===null){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=e.signatureOid,s}var c=e.tbsCertificate||Re.getTBSCertificate(e),u=D.toDer(c);o.update(u.getBytes())}if(o!==null){var f;switch(e.signatureOid){case ut.sha1WithRSAEncryption:f=void 0;break;case ut["RSASSA-PSS"]:var h,d;if(h=ut[e.signatureParameters.mgf.hash.algorithmOid],h===void 0||Oe.md[h]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=h,s}if(d=ut[e.signatureParameters.mgf.algorithmOid],d===void 0||Oe.mgf[d]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=d,s}if(d=Oe.mgf[d].create(Oe.md[h].create()),h=ut[e.signatureParameters.hash.algorithmOid],h===void 0||Oe.md[h]===void 0)throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:h};f=Oe.pss.create(Oe.md[h].create(),d,e.signatureParameters.saltLength);break}t=r.publicKey.verify(o.digest().getBytes(),e.signature,f)}return t},r.isIssuer=function(e){var t=!1,i=r.issuer,n=e.subject;if(i.hash&&n.hash)t=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){t=!0;for(var s,o,a=0;t&&a<i.attributes.length;++a)s=i.attributes[a],o=n.attributes[a],(s.type!==o.type||s.value!==o.value)&&(t=!1)}return t},r.issued=function(e){return e.isIssuer(r)},r.generateSubjectKeyIdentifier=function(){return Re.getPublicKeyFingerprint(r.publicKey,{type:"RSAPublicKey"})},r.verifySubjectKeyIdentifier=function(){for(var e=ut.subjectKeyIdentifier,t=0;t<r.extensions.length;++t){var i=r.extensions[t];if(i.id===e){var n=r.generateSubjectKeyIdentifier().getBytes();return Oe.util.hexToBytes(i.subjectKeyIdentifier)===n}}return!1},r};Re.certificateFromAsn1=function(r,e){var t={},i=[];if(!D.validate(r,_tt,t,i)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=i,n}var s=D.derToOid(t.publicKeyOid);if(s!==Re.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Re.createCertificate();o.version=t.certVersion?t.certVersion.charCodeAt(0):0;var a=Oe.util.createBuffer(t.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=Oe.asn1.derToOid(t.certSignatureOid),o.signatureParameters=J_(o.signatureOid,t.certSignatureParams,!0),o.siginfo.algorithmOid=Oe.asn1.derToOid(t.certinfoSignatureOid),o.siginfo.parameters=J_(o.siginfo.algorithmOid,t.certinfoSignatureParams,!1),o.signature=t.certSignature;var c=[];if(t.certValidity1UTCTime!==void 0&&c.push(D.utcTimeToDate(t.certValidity1UTCTime)),t.certValidity2GeneralizedTime!==void 0&&c.push(D.generalizedTimeToDate(t.certValidity2GeneralizedTime)),t.certValidity3UTCTime!==void 0&&c.push(D.utcTimeToDate(t.certValidity3UTCTime)),t.certValidity4GeneralizedTime!==void 0&&c.push(D.generalizedTimeToDate(t.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=t.tbsCertificate,e){if(o.md=null,o.signatureOid in ut){var s=ut[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Oe.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Oe.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Oe.md.sha512.create();break;case"RSASSA-PSS":o.md=Oe.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certificate digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var u=D.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var f=Oe.md.sha1.create();o.issuer.getField=function(d){return Sf(o.issuer,d)},o.issuer.addField=function(d){po([d]),o.issuer.attributes.push(d)},o.issuer.attributes=Re.RDNAttributesAsArray(t.certIssuer,f),t.certIssuerUniqueId&&(o.issuer.uniqueId=t.certIssuerUniqueId),o.issuer.hash=f.digest().toHex();var h=Oe.md.sha1.create();return o.subject.getField=function(d){return Sf(o.subject,d)},o.subject.addField=function(d){po([d]),o.subject.attributes.push(d)},o.subject.attributes=Re.RDNAttributesAsArray(t.certSubject,h),t.certSubjectUniqueId&&(o.subject.uniqueId=t.certSubjectUniqueId),o.subject.hash=h.digest().toHex(),t.certExtensions?o.extensions=Re.certificateExtensionsFromAsn1(t.certExtensions):o.extensions=[],o.publicKey=Re.publicKeyFromAsn1(t.subjectPublicKeyInfo),o};Re.certificateExtensionsFromAsn1=function(r){for(var e=[],t=0;t<r.value.length;++t)for(var i=r.value[t],n=0;n<i.value.length;++n)e.push(Re.certificateExtensionFromAsn1(i.value[n]));return e};Re.certificateExtensionFromAsn1=function(r){var e={};if(e.id=D.derToOid(r.value[0].value),e.critical=!1,r.value[1].type===D.Type.BOOLEAN?(e.critical=r.value[1].value.charCodeAt(0)!==0,e.value=r.value[2].value):e.value=r.value[1].value,e.id in ut){if(e.name=ut[e.id],e.name==="keyUsage"){var t=D.fromDer(e.value),i=0,n=0;t.value.length>1&&(i=t.value.charCodeAt(1),n=t.value.length>2?t.value.charCodeAt(2):0),e.digitalSignature=(i&128)==128,e.nonRepudiation=(i&64)==64,e.keyEncipherment=(i&32)==32,e.dataEncipherment=(i&16)==16,e.keyAgreement=(i&8)==8,e.keyCertSign=(i&4)==4,e.cRLSign=(i&2)==2,e.encipherOnly=(i&1)==1,e.decipherOnly=(n&128)==128}else if(e.name==="basicConstraints"){var t=D.fromDer(e.value);t.value.length>0&&t.value[0].type===D.Type.BOOLEAN?e.cA=t.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;t.value.length>0&&t.value[0].type===D.Type.INTEGER?s=t.value[0].value:t.value.length>1&&(s=t.value[1].value),s!==null&&(e.pathLenConstraint=D.derToInteger(s))}else if(e.name==="extKeyUsage")for(var t=D.fromDer(e.value),o=0;o<t.value.length;++o){var a=D.derToOid(t.value[o].value);a in ut?e[ut[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var t=D.fromDer(e.value),i=0;t.value.length>1&&(i=t.value.charCodeAt(1)),e.client=(i&128)==128,e.server=(i&64)==64,e.email=(i&32)==32,e.objsign=(i&16)==16,e.reserved=(i&8)==8,e.sslCA=(i&4)==4,e.emailCA=(i&2)==2,e.objCA=(i&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,t=D.fromDer(e.value),u=0;u<t.value.length;++u){c=t.value[u];var f={type:c.type,value:c.value};switch(e.altNames.push(f),c.type){case 1:case 2:case 6:break;case 7:f.ip=Oe.util.bytesToIP(c.value);break;case 8:f.oid=D.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var t=D.fromDer(e.value);e.subjectKeyIdentifier=Oe.util.bytesToHex(t.value)}}return e};Re.certificationRequestFromAsn1=function(r,e){var t={},i=[];if(!D.validate(r,xtt,t,i)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=i,n}var s=D.derToOid(t.publicKeyOid);if(s!==Re.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Re.createCertificationRequest();if(o.version=t.csrVersion?t.csrVersion.charCodeAt(0):0,o.signatureOid=Oe.asn1.derToOid(t.csrSignatureOid),o.signatureParameters=J_(o.signatureOid,t.csrSignatureParams,!0),o.siginfo.algorithmOid=Oe.asn1.derToOid(t.csrSignatureOid),o.siginfo.parameters=J_(o.siginfo.algorithmOid,t.csrSignatureParams,!1),o.signature=t.csrSignature,o.certificationRequestInfo=t.certificationRequestInfo,e){if(o.md=null,o.signatureOid in ut){var s=ut[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Oe.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Oe.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Oe.md.sha512.create();break;case"RSASSA-PSS":o.md=Oe.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var a=D.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=Oe.md.sha1.create();return o.subject.getField=function(u){return Sf(o.subject,u)},o.subject.addField=function(u){po([u]),o.subject.attributes.push(u)},o.subject.attributes=Re.RDNAttributesAsArray(t.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=Re.publicKeyFromAsn1(t.subjectPublicKeyInfo),o.getAttribute=function(u){return Sf(o,u)},o.addAttribute=function(u){po([u]),o.attributes.push(u)},o.attributes=Re.CRIAttributesAsArray(t.certificationRequestInfoAttributes||[]),o};Re.createCertificationRequest=function(){var r={};return r.version=0,r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.subject={},r.subject.getField=function(e){return Sf(r.subject,e)},r.subject.addField=function(e){po([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.publicKey=null,r.attributes=[],r.getAttribute=function(e){return Sf(r,e)},r.addAttribute=function(e){po([e]),r.attributes.push(e)},r.md=null,r.setSubject=function(e){po(e),r.subject.attributes=e,r.subject.hash=null},r.setAttributes=function(e){po(e),r.attributes=e},r.sign=function(e,t){r.md=t||Oe.md.sha1.create();var i=ut[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.certificationRequestInfo=Re.getCertificationRequestInfo(r);var s=D.toDer(r.certificationRequestInfo);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(){var e=!1,t=r.md;if(t===null){if(r.signatureOid in ut){var i=ut[r.signatureOid];switch(i){case"sha1WithRSAEncryption":t=Oe.md.sha1.create();break;case"md5WithRSAEncryption":t=Oe.md.md5.create();break;case"sha256WithRSAEncryption":t=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":t=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":t=Oe.md.sha512.create();break;case"RSASSA-PSS":t=Oe.md.sha256.create();break}}if(t===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=r.signatureOid,n}var s=r.certificationRequestInfo||Re.getCertificationRequestInfo(r),o=D.toDer(s);t.update(o.getBytes())}if(t!==null){var a;switch(r.signatureOid){case ut.sha1WithRSAEncryption:break;case ut["RSASSA-PSS"]:var c,u;if(c=ut[r.signatureParameters.mgf.hash.algorithmOid],c===void 0||Oe.md[c]===void 0){var n=new Error("Unsupported MGF hash function.");throw n.oid=r.signatureParameters.mgf.hash.algorithmOid,n.name=c,n}if(u=ut[r.signatureParameters.mgf.algorithmOid],u===void 0||Oe.mgf[u]===void 0){var n=new Error("Unsupported MGF function.");throw n.oid=r.signatureParameters.mgf.algorithmOid,n.name=u,n}if(u=Oe.mgf[u].create(Oe.md[c].create()),c=ut[r.signatureParameters.hash.algorithmOid],c===void 0||Oe.md[c]===void 0){var n=new Error("Unsupported RSASSA-PSS hash function.");throw n.oid=r.signatureParameters.hash.algorithmOid,n.name=c,n}a=Oe.pss.create(Oe.md[c].create(),u,r.signatureParameters.saltLength);break}e=r.publicKey.verify(t.digest().getBytes(),r.signature,a)}return e},r};function Zp(r){for(var e=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]),t,i,n=r.attributes,s=0;s<n.length;++s){t=n[s];var o=t.value,a=D.Type.PRINTABLESTRING;"valueTagClass"in t&&(a=t.valueTagClass,a===D.Type.UTF8&&(o=Oe.util.encodeUtf8(o))),i=D.create(D.Class.UNIVERSAL,D.Type.SET,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(t.type).getBytes()),D.create(D.Class.UNIVERSAL,a,!1,o)])]),e.value.push(i)}return e}function po(r){for(var e,t=0;t<r.length;++t){if(e=r[t],typeof e.name=="undefined"&&(e.type&&e.type in Re.oids?e.name=Re.oids[e.type]:e.shortName&&e.shortName in Zr&&(e.name=Re.oids[Zr[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in Re.oids)e.type=Re.oids[e.name];else{var i=new Error("Attribute type not specified.");throw i.attribute=e,i}if(typeof e.shortName=="undefined"&&e.name&&e.name in Zr&&(e.shortName=Zr[e.name]),e.type===ut.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=D.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var n=0;n<e.extensions.length;++n)e.value.push(Re.certificateExtensionToAsn1(Nhe(e.extensions[n])))}if(typeof e.value=="undefined"){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function Nhe(r,e){if(e=e||{},typeof r.name=="undefined"&&r.id&&r.id in Re.oids&&(r.name=Re.oids[r.id]),typeof r.id=="undefined")if(r.name&&r.name in Re.oids)r.id=Re.oids[r.name];else{var t=new Error("Extension ID not specified.");throw t.extension=r,t}if(typeof r.value!="undefined")return r;if(r.name==="keyUsage"){var i=0,n=0,s=0;r.digitalSignature&&(n|=128,i=7),r.nonRepudiation&&(n|=64,i=6),r.keyEncipherment&&(n|=32,i=5),r.dataEncipherment&&(n|=16,i=4),r.keyAgreement&&(n|=8,i=3),r.keyCertSign&&(n|=4,i=2),r.cRLSign&&(n|=2,i=1),r.encipherOnly&&(n|=1,i=0),r.decipherOnly&&(s|=128,i=7);var o=String.fromCharCode(i);s!==0?o+=String.fromCharCode(n)+String.fromCharCode(s):n!==0&&(o+=String.fromCharCode(n)),r.value=D.create(D.Class.UNIVERSAL,D.Type.BITSTRING,!1,o)}else if(r.name==="basicConstraints")r.value=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]),r.cA&&r.value.value.push(D.create(D.Class.UNIVERSAL,D.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in r&&r.value.value.push(D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(r.pathLenConstraint).getBytes()));else if(r.name==="extKeyUsage"){r.value=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]);var a=r.value.value;for(var c in r)r[c]===!0&&(c in ut?a.push(D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(ut[c]).getBytes())):c.indexOf(".")!==-1&&a.push(D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(c).getBytes())))}else if(r.name==="nsCertType"){var i=0,n=0;r.client&&(n|=128,i=7),r.server&&(n|=64,i=6),r.email&&(n|=32,i=5),r.objsign&&(n|=16,i=4),r.reserved&&(n|=8,i=3),r.sslCA&&(n|=4,i=2),r.emailCA&&(n|=2,i=1),r.objCA&&(n|=1,i=0);var o=String.fromCharCode(i);n!==0&&(o+=String.fromCharCode(n)),r.value=D.create(D.Class.UNIVERSAL,D.Type.BITSTRING,!1,o)}else if(r.name==="subjectAltName"||r.name==="issuerAltName"){r.value=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]);for(var u,f=0;f<r.altNames.length;++f){u=r.altNames[f];var o=u.value;if(u.type===7&&u.ip){if(o=Oe.util.bytesFromIP(u.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else u.type===8&&(u.oid?o=D.oidToDer(D.oidToDer(u.oid)):o=D.oidToDer(o));r.value.value.push(D.create(D.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(r.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(r.comment)||r.comment.length<1||r.comment.length>128)throw new Error('Invalid "nsComment" content.');r.value=D.create(D.Class.UNIVERSAL,D.Type.IA5STRING,!1,r.comment)}else if(r.name==="subjectKeyIdentifier"&&e.cert){var h=e.cert.generateSubjectKeyIdentifier();r.subjectKeyIdentifier=h.toHex(),r.value=D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,h.getBytes())}else if(r.name==="authorityKeyIdentifier"&&e.cert){r.value=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]);var a=r.value.value;if(r.keyIdentifier){var d=r.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():r.keyIdentifier;a.push(D.create(D.Class.CONTEXT_SPECIFIC,0,!1,d))}if(r.authorityCertIssuer){var y=[D.create(D.Class.CONTEXT_SPECIFIC,4,!0,[Zp(r.authorityCertIssuer===!0?e.cert.issuer:r.authorityCertIssuer)])];a.push(D.create(D.Class.CONTEXT_SPECIFIC,1,!0,y))}if(r.serialNumber){var g=Oe.util.hexToBytes(r.serialNumber===!0?e.cert.serialNumber:r.serialNumber);a.push(D.create(D.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if(r.name==="cRLDistributionPoints"){r.value=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]);for(var a=r.value.value,m=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]),x=D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[]),u,f=0;f<r.altNames.length;++f){u=r.altNames[f];var o=u.value;if(u.type===7&&u.ip){if(o=Oe.util.bytesFromIP(u.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else u.type===8&&(u.oid?o=D.oidToDer(D.oidToDer(u.oid)):o=D.oidToDer(o));x.value.push(D.create(D.Class.CONTEXT_SPECIFIC,u.type,!1,o))}m.value.push(D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[x])),a.push(m)}if(typeof r.value=="undefined"){var t=new Error("Extension value not specified.");throw t.extension=r,t}return r}function aR(r,e){switch(r){case ut["RSASSA-PSS"]:var t=[];return e.hash.algorithmOid!==void 0&&t.push(D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(e.hash.algorithmOid).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&t.push(D.create(D.Class.CONTEXT_SPECIFIC,1,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(e.mgf.algorithmOid).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(e.mgf.hash.algorithmOid).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&t.push(D.create(D.Class.CONTEXT_SPECIFIC,2,!0,[D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(e.saltLength).getBytes())])),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,t);default:return D.create(D.Class.UNIVERSAL,D.Type.NULL,!1,"")}}function Att(r){var e=D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[]);if(r.attributes.length===0)return e;for(var t=r.attributes,i=0;i<t.length;++i){var n=t[i],s=n.value,o=D.Type.UTF8;"valueTagClass"in n&&(o=n.valueTagClass),o===D.Type.UTF8&&(s=Oe.util.encodeUtf8(s));var a=!1;"valueConstructed"in n&&(a=n.valueConstructed);var c=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(n.type).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SET,!0,[D.create(D.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var Itt=new Date("1950-01-01T00:00:00Z"),Ttt=new Date("2050-01-01T00:00:00Z");function Dhe(r){return r>=Itt&&r<Ttt?D.create(D.Class.UNIVERSAL,D.Type.UTCTIME,!1,D.dateToUtcTime(r)):D.create(D.Class.UNIVERSAL,D.Type.GENERALIZEDTIME,!1,D.dateToGeneralizedTime(r))}Re.getTBSCertificate=function(r){var e=Dhe(r.validity.notBefore),t=Dhe(r.validity.notAfter),i=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(r.version).getBytes())]),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Oe.util.hexToBytes(r.serialNumber)),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.siginfo.algorithmOid).getBytes()),aR(r.siginfo.algorithmOid,r.siginfo.parameters)]),Zp(r.issuer),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[e,t]),Zp(r.subject),Re.publicKeyToAsn1(r.publicKey)]);return r.issuer.uniqueId&&i.value.push(D.create(D.Class.CONTEXT_SPECIFIC,1,!0,[D.create(D.Class.UNIVERSAL,D.Type.BITSTRING,!1,String.fromCharCode(0)+r.issuer.uniqueId)])),r.subject.uniqueId&&i.value.push(D.create(D.Class.CONTEXT_SPECIFIC,2,!0,[D.create(D.Class.UNIVERSAL,D.Type.BITSTRING,!1,String.fromCharCode(0)+r.subject.uniqueId)])),r.extensions.length>0&&i.value.push(Re.certificateExtensionsToAsn1(r.extensions)),i};Re.getCertificationRequestInfo=function(r){var e=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(r.version).getBytes()),Zp(r.subject),Re.publicKeyToAsn1(r.publicKey),Att(r)]);return e};Re.distinguishedNameToAsn1=function(r){return Zp(r)};Re.certificateToAsn1=function(r){var e=r.tbsCertificate||Re.getTBSCertificate(r);return D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[e,D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.signatureOid).getBytes()),aR(r.signatureOid,r.signatureParameters)]),D.create(D.Class.UNIVERSAL,D.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};Re.certificateExtensionsToAsn1=function(r){var e=D.create(D.Class.CONTEXT_SPECIFIC,3,!0,[]),t=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]);e.value.push(t);for(var i=0;i<r.length;++i)t.value.push(Re.certificateExtensionToAsn1(r[i]));return e};Re.certificateExtensionToAsn1=function(r){var e=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]);e.value.push(D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.id).getBytes())),r.critical&&e.value.push(D.create(D.Class.UNIVERSAL,D.Type.BOOLEAN,!1,String.fromCharCode(255)));var t=r.value;return typeof r.value!="string"&&(t=D.toDer(t).getBytes()),e.value.push(D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,t)),e};Re.certificationRequestToAsn1=function(r){var e=r.certificationRequestInfo||Re.getCertificationRequestInfo(r);return D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[e,D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.signatureOid).getBytes()),aR(r.signatureOid,r.signatureParameters)]),D.create(D.Class.UNIVERSAL,D.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};Re.createCaStore=function(r){var e={certs:{}};e.getIssuer=function(o){var a=t(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=Oe.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];Oe.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=Oe.pki.certificateFromPem(o));var a=t(o.subject);if(!a)return!1;Oe.util.isArray(a)||(a=[a]);for(var c=D.toDer(Re.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var f=D.toDer(Re.certificateToAsn1(a[u])).getBytes();if(c===f)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!Oe.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=Oe.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))return null;var c=t(o.subject);if(!Oe.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=D.toDer(Re.certificateToAsn1(o)).getBytes(),f=0;f<c.length;++f){var h=D.toDer(Re.certificateToAsn1(c[f])).getBytes();u===h&&(a=c[f],c.splice(f,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function t(o){return i(o),e.certs[o.hash]||null}function i(o){if(!o.hash){var a=Oe.md.sha1.create();o.attributes=Re.RDNAttributesAsArray(Zp(o),a),o.hash=a.digest().toHex()}}if(r)for(var n=0;n<r.length;++n){var s=r[n];e.addCertificate(s)}return e};Re.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Re.verifyCertificateChain=function(r,e,t){typeof t=="function"&&(t={verify:t}),t=t||{},e=e.slice(0);var i=e.slice(0),n=t.validityCheckDate;typeof n=="undefined"&&(n=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,f=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:Re.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),o===null){if(u=e[0]||r.getIssuer(c),u===null&&c.isIssuer(c)&&(f=!0,u=c),u){var h=u;Oe.util.isArray(h)||(h=[h]);for(var d=!1;!d&&h.length>0;){u=h.shift();try{d=u.verify(c)}catch(W){}}d||(o={message:"Certificate signature is invalid.",error:Re.certificateError.bad_certificate})}o===null&&(!u||f)&&!r.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:Re.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:Re.certificateError.bad_certificate}),o===null)for(var y={keyUsage:!0,basicConstraints:!0},g=0;o===null&&g<c.extensions.length;++g){var m=c.extensions[g];m.critical&&!(m.name in y)&&(o={message:"Certificate has an unsupported critical extension.",error:Re.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||f))){var x=c.getExtension("basicConstraints"),_=c.getExtension("keyUsage");if(_!==null&&(!_.keyCertSign||x===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Re.certificateError.bad_certificate}),o===null&&x!==null&&!x.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Re.certificateError.bad_certificate}),o===null&&_!==null&&"pathLenConstraint"in x){var P=a-1;P>x.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:Re.certificateError.bad_certificate})}}var q=o===null?!0:o.error,X=t.verify?t.verify(q,a,i):q;if(X===!0)o=null;else throw q===!0&&(o={message:"The application rejected the certificate.",error:Re.certificateError.bad_certificate}),(X||X===0)&&(typeof X=="object"&&!Oe.util.isArray(X)?(X.message&&(o.message=X.message),X.error&&(o.error=X.error)):typeof X=="string"&&(o.error=X)),o;s=!1,++a}while(e.length>0);return!0}});var Lhe=p((s4t,qhe)=>{l();var Me=bt();Kh();Pc();lm();Lh();ym();Ahe();Cu();yr();cR();var se=Me.asn1,Dn=qhe.exports=Me.pkcs7=Me.pkcs7||{};Dn.messageFromPem=function(r){var e=Me.pem.decode(r)[0];if(e.type!=="PKCS7"){var t=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=se.fromDer(e.body);return Dn.messageFromAsn1(i)};Dn.messageToPem=function(r,e){var t={type:"PKCS7",body:se.toDer(r.toAsn1()).getBytes()};return Me.pem.encode(t,{maxline:e})};Dn.messageFromAsn1=function(r){var e={},t=[];if(!se.validate(r,Dn.asn1.contentInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=t,i}var n=se.derToOid(e.contentType),s;switch(n){case Me.pki.oids.envelopedData:s=Dn.createEnvelopedData();break;case Me.pki.oids.encryptedData:s=Dn.createEncryptedData();break;case Me.pki.oids.signedData:s=Dn.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Dn.createSignedData=function(){var r=null;return r={type:Me.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(i){if(fR(r,i,Dn.asn1.signedDataValidator),r.certificates=[],r.crls=[],r.digestAlgorithmIdentifiers=[],r.contentInfo=null,r.signerInfos=[],r.rawCapture.certificates)for(var n=r.rawCapture.certificates.value,s=0;s<n.length;++s)r.certificates.push(Me.pki.certificateFromAsn1(n[s]))},toAsn1:function(){r.contentInfo||r.sign();for(var i=[],n=0;n<r.certificates.length;++n)i.push(Me.pki.certificateToAsn1(r.certificates[n]));var s=[],o=se.create(se.Class.CONTEXT_SPECIFIC,0,!0,[se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(r.version).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SET,!0,r.digestAlgorithmIdentifiers),r.contentInfo])]);return i.length>0&&o.value[0].value.push(se.create(se.Class.CONTEXT_SPECIFIC,0,!0,i)),s.length>0&&o.value[0].value.push(se.create(se.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(se.create(se.Class.UNIVERSAL,se.Type.SET,!0,r.signerInfos)),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(r.type).getBytes()),o])},addSigner:function(i){var n=i.issuer,s=i.serialNumber;if(i.certificate){var o=i.certificate;typeof o=="string"&&(o=Me.pki.certificateFromPem(o)),n=o.issuer.attributes,s=o.serialNumber}var a=i.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=Me.pki.privateKeyFromPem(a));var c=i.digestAlgorithm||Me.pki.oids.sha1;switch(c){case Me.pki.oids.sha1:case Me.pki.oids.sha256:case Me.pki.oids.sha384:case Me.pki.oids.sha512:case Me.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=i.authenticatedAttributes||[];if(u.length>0){for(var f=!1,h=!1,d=0;d<u.length;++d){var y=u[d];if(!f&&y.type===Me.pki.oids.contentType){if(f=!0,h)break;continue}if(!h&&y.type===Me.pki.oids.messageDigest){if(h=!0,f)break;continue}}if(!f||!h)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}r.signers.push({key:a,version:1,issuer:n,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:Me.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(i){if(i=i||{},(typeof r.content!="object"||r.contentInfo===null)&&(r.contentInfo=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(Me.pki.oids.data).getBytes())]),"content"in r)){var n;r.content instanceof Me.util.ByteBuffer?n=r.content.bytes():typeof r.content=="string"&&(n=Me.util.encodeUtf8(r.content)),i.detached?r.detachedContent=se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,n):r.contentInfo.value.push(se.create(se.Class.CONTEXT_SPECIFIC,0,!0,[se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,n)]))}if(r.signers.length!==0){var s=e();t(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(i){typeof i=="string"&&(i=Me.pki.certificateFromPem(i)),r.certificates.push(i)},addCertificateRevokationList:function(i){throw new Error("PKCS#7 CRL support not yet implemented.")}},r;function e(){for(var i={},n=0;n<r.signers.length;++n){var s=r.signers[n],o=s.digestAlgorithm;o in i||(i[o]=Me.md[Me.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=i[o]:s.md=Me.md[Me.pki.oids[o]].create()}r.digestAlgorithmIdentifiers=[];for(var o in i)r.digestAlgorithmIdentifiers.push(se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(o).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]));return i}function t(i){var n;if(r.detachedContent?n=r.detachedContent:(n=r.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=se.derToOid(r.contentInfo.value[0].value),o=se.toDer(n);o.getByte(),se.getBerValueLength(o),o=o.getBytes();for(var a in i)i[a].start().update(o);for(var c=new Date,u=0;u<r.signers.length;++u){var f=r.signers[u];if(f.authenticatedAttributes.length===0){if(s!==Me.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{f.authenticatedAttributesAsn1=se.create(se.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=se.create(se.Class.UNIVERSAL,se.Type.SET,!0,[]),d=0;d<f.authenticatedAttributes.length;++d){var y=f.authenticatedAttributes[d];y.type===Me.pki.oids.messageDigest?y.value=i[f.digestAlgorithm].digest():y.type===Me.pki.oids.signingTime&&(y.value||(y.value=c)),h.value.push(uR(y)),f.authenticatedAttributesAsn1.value.push(uR(y))}o=se.toDer(h).getBytes(),f.md.start().update(o)}f.signature=f.key.sign(f.md,"RSASSA-PKCS1-V1_5")}r.signerInfos=Rtt(r.signers)}};Dn.createEncryptedData=function(){var r=null;return r={type:Me.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Me.pki.oids["aes256-CBC"]},fromAsn1:function(e){fR(r,e,Dn.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(r.encryptedContent.key=e),Mhe(r)}},r};Dn.createEnvelopedData=function(){var r=null;return r={type:Me.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Me.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=fR(r,e,Dn.asn1.envelopedDataValidator);r.recipients=ktt(t.recipientInfos.value)},toAsn1:function(){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(r.type).getBytes()),se.create(se.Class.CONTEXT_SPECIFIC,0,!0,[se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(r.version).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SET,!0,Ctt(r.recipients)),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,Ptt(r.encryptedContent))])])])},findRecipient:function(e){for(var t=e.issuer.attributes,i=0;i<r.recipients.length;++i){var n=r.recipients[i],s=n.issuer;if(n.serialNumber===e.serialNumber&&s.length===t.length){for(var o=!0,a=0;a<t.length;++a)if(s[a].type!==t[a].type||s[a].value!==t[a].value){o=!1;break}if(o)return n}}return null},decrypt:function(e,t){if(r.encryptedContent.key===void 0&&e!==void 0&&t!==void 0)switch(e.encryptedContent.algorithm){case Me.pki.oids.rsaEncryption:case Me.pki.oids.desCBC:var i=t.decrypt(e.encryptedContent.content);r.encryptedContent.key=Me.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}Mhe(r)},addRecipient:function(e){r.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:Me.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,t){if(r.encryptedContent.content===void 0){t=t||r.encryptedContent.algorithm,e=e||r.encryptedContent.key;var i,n,s;switch(t){case Me.pki.oids["aes128-CBC"]:i=16,n=16,s=Me.aes.createEncryptionCipher;break;case Me.pki.oids["aes192-CBC"]:i=24,n=16,s=Me.aes.createEncryptionCipher;break;case Me.pki.oids["aes256-CBC"]:i=32,n=16,s=Me.aes.createEncryptionCipher;break;case Me.pki.oids["des-EDE3-CBC"]:i=24,n=8,s=Me.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+t)}if(e===void 0)e=Me.util.createBuffer(Me.random.getBytes(i));else if(e.length()!=i)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+i+".");r.encryptedContent.algorithm=t,r.encryptedContent.key=e,r.encryptedContent.parameter=Me.util.createBuffer(Me.random.getBytes(n));var o=s(e);if(o.start(r.encryptedContent.parameter.copy()),o.update(r.content),!o.finish())throw new Error("Symmetric encryption failed.");r.encryptedContent.content=o.output}for(var a=0;a<r.recipients.length;++a){var c=r.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case Me.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(r.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},r};function Ott(r){var e={},t=[];if(!se.validate(r,Dn.asn1.recipientInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=t,i}return{version:e.version.charCodeAt(0),issuer:Me.pki.RDNAttributesAsArray(e.issuer),serialNumber:Me.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:se.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}}function Btt(r){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(r.version).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[Me.pki.distinguishedNameToAsn1({attributes:r.issuer}),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Me.util.hexToBytes(r.serialNumber))]),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(r.encryptedContent.algorithm).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,r.encryptedContent.content)])}function ktt(r){for(var e=[],t=0;t<r.length;++t)e.push(Ott(r[t]));return e}function Ctt(r){for(var e=[],t=0;t<r.length;++t)e.push(Btt(r[t]));return e}function Ntt(r){var e=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(r.version).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[Me.pki.distinguishedNameToAsn1({attributes:r.issuer}),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Me.util.hexToBytes(r.serialNumber))]),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(r.digestAlgorithm).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")])]);if(r.authenticatedAttributesAsn1&&e.value.push(r.authenticatedAttributesAsn1),e.value.push(se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(r.signatureAlgorithm).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")])),e.value.push(se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,r.signature)),r.unauthenticatedAttributes.length>0){for(var t=se.create(se.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<r.unauthenticatedAttributes.length;++i){var n=r.unauthenticatedAttributes[i];t.values.push(uR(n))}e.value.push(t)}return e}function Rtt(r){for(var e=[],t=0;t<r.length;++t)e.push(Ntt(r[t]));return e}function uR(r){var e;if(r.type===Me.pki.oids.contentType)e=se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(r.value).getBytes());else if(r.type===Me.pki.oids.messageDigest)e=se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,r.value.bytes());else if(r.type===Me.pki.oids.signingTime){var t=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),n=r.value;if(typeof n=="string"){var s=Date.parse(n);isNaN(s)?n.length===13?n=se.utcTimeToDate(n):n=se.generalizedTimeToDate(n):n=new Date(s)}n>=t&&n<i?e=se.create(se.Class.UNIVERSAL,se.Type.UTCTIME,!1,se.dateToUtcTime(n)):e=se.create(se.Class.UNIVERSAL,se.Type.GENERALIZEDTIME,!1,se.dateToGeneralizedTime(n))}return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(r.type).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SET,!0,[e])])}function Ptt(r){return[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(Me.pki.oids.data).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(r.algorithm).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,r.parameter.getBytes())]),se.create(se.Class.CONTEXT_SPECIFIC,0,!0,[se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,r.content.getBytes())])]}function fR(r,e,t){var i={},n=[];if(!se.validate(e,t,i,n)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=se.derToOid(i.contentType);if(o!==Me.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(Me.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==se.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[c].value}else a=i.encryptedContent;r.encryptedContent={algorithm:se.derToOid(i.encAlgorithm),parameter:Me.util.createBuffer(i.encParameter.value),content:Me.util.createBuffer(a)}}if(i.content){var a="";if(Me.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==se.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[c].value}else a=i.content;r.content=Me.util.createBuffer(a)}return r.version=i.version.charCodeAt(0),r.rawCapture=i,i}function Mhe(r){if(r.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(r.content===void 0){var e;switch(r.encryptedContent.algorithm){case Me.pki.oids["aes128-CBC"]:case Me.pki.oids["aes192-CBC"]:case Me.pki.oids["aes256-CBC"]:e=Me.aes.createDecryptionCipher(r.encryptedContent.key);break;case Me.pki.oids.desCBC:case Me.pki.oids["des-EDE3-CBC"]:e=Me.des.createDecryptionCipher(r.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+r.encryptedContent.algorithm)}if(e.start(r.encryptedContent.parameter),e.update(r.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");r.content=e.output}}});var Khe=p((o4t,Fhe)=>{l();"use strict";cR();var Dtt=bt(),Uhe=Dtt.pki,qtt=(r,e)=>{let t=Uhe.setRsaPublicKey(e.n,e.e),i=Uhe.createCertificate();i.publicKey=t,i.serialNumber="01",i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.validity.notAfter.setFullYear(i.validity.notBefore.getFullYear()+10);let n=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:r.id}];return i.setSubject(n),i.setIssuer(n),i.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),i.sign(e),i};async function Mtt(r,e){let t=r.map(e),n=(await Promise.all(t)).findIndex(s=>s);return r[n]}Fhe.exports={certificateForKey:qtt,findAsync:Mtt}});var Hhe=p((a4t,jhe)=>{l();"use strict";Lhe();rx();var xf=bt(),{certificateForKey:Ltt,findAsync:Ftt}=Khe(),e0=ge(),Vhe=ct(),Utt=tt(),lR=new WeakMap,zhe=class{constructor(e,t){if(!e)throw e0(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=e,lR.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw e0(new Error("Plain data must be a Uint8Array"),"ERR_INVALID_PARAMS");let i=await this.keychain.findKeyByName(e),n=await this.keychain._getPrivateKey(e),s=lR.get(this).dek,o=xf.pki.decryptRsaPrivateKey(n,s),a=await Ltt(i,o),c=xf.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=xf.util.createBuffer(t),c.encrypt();let u=xf.asn1.toDer(c.toAsn1()).getBytes();return Vhe(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw e0(new Error("CMS data is required"),"ERR_INVALID_PARAMS");let t;try{let u=xf.util.createBuffer(Utt(e,"ascii")),f=xf.asn1.fromDer(u);t=xf.pkcs7.messageFromAsn1(f)}catch(u){throw e0(new Error("Invalid CMS: "+u.message),"ERR_INVALID_CMS")}let i=t.recipients.filter(u=>u.issuer.find(f=>f.shortName==="O"&&f.value==="ipfs")).filter(u=>u.issuer.find(f=>f.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(f=>f.shortName==="CN").value})),n=await Ftt(i,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(f){return!1}return!1});if(!n){let u=i.map(f=>f.keyId);throw e0(new Error("Decryption needs one of the key(s): "+u.join(", ")),"ERR_MISSING_KEYS",{missingKeys:u})}let s=await this.keychain.findKeyById(n.keyId);if(!s)throw e0(new Error("No key available to decrypto"),"ERR_NO_KEY");let o=await this.keychain._getPrivateKey(s.name),a=lR.get(this).dek,c=xf.pki.decryptRsaPrivateKey(o,a);return t.decrypt(n.recipient,c),Vhe(t.content.getBytes(),"ascii")}};jhe.exports=zhe});var Qhe=p((c4t,Ghe)=>{l();"use strict";var $he=xe(),Whe=Object.assign($he("libp2p:keychain"),{error:$he("libp2p:keychain:err")}),Ktt=_he(),jtt=Gr(),ch=za(),{Key:Yhe}=ir(),Vtt=Hhe(),zr=ge(),uh=tt(),uu=ct();_m();var ztt="/pkcs8/",Xhe="/info/",Af=new WeakMap,fh={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},hR={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function fu(r){return!r||typeof r!="string"?!1:r===Ktt(r.trim())}async function nr(r){let e=200,t=1e3,i=Math.random()*(t-e)+e;throw await new Promise(n=>setTimeout(n,i)),r}function lc(r){return new Yhe(ztt+r)}function If(r){return new Yhe(Xhe+r)}var Jhe=class{constructor(e,t){if(!e)throw new Error("store is required");if(this.store=e,this.opts=jtt(hR,t),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<fh.minKeyLength)throw new Error(`dek.keyLength must be least ${fh.minKeyLength} bytes`);if(this.opts.dek.salt.length<fh.minSaltLength)throw new Error(`dek.saltLength must be least ${fh.minSaltLength} bytes`);if(this.opts.dek.iterationCount<fh.minIterationCount)throw new Error(`dek.iterationCount must be least ${fh.minIterationCount}`);let i=this.opts.pass?ch.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Af.set(this,{dek:i})}get cms(){return new Vtt(this,Af.get(this).dek)}static generateOptions(){let e=Object.assign({},hR),t=Math.ceil(fh.minSaltLength/3)*3;return e.dek.salt=uh(ch.randomBytes(t),"base64"),e}static get options(){return hR}async createKey(e,t,i=2048){let n=this;if(!fu(e)||e==="self")return nr(zr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(typeof t!="string")return nr(zr(new Error(`Invalid key type '${t}'`),"ERR_INVALID_KEY_TYPE"));let s=lc(e);if(await n.store.has(s))return nr(zr(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));switch(t.toLowerCase()){case"rsa":if(!Number.isSafeInteger(i)||i<2048)return nr(zr(new Error(`Invalid RSA key size ${i}`),"ERR_INVALID_KEY_SIZE"));break;default:break}let a;try{let c=await ch.keys.generateKeyPair(t,i),u=await c.id(),f=Af.get(this).dek,h=await c.export(f);a={name:e,id:u};let d=n.store.batch();d.put(s,uu(h)),d.put(If(e),uu(JSON.stringify(a))),await d.commit()}catch(c){return nr(c)}return a}async listKeys(){let e=this,t={prefix:Xhe},i=[];for await(let n of e.store.query(t))i.push(JSON.parse(uh(n.value)));return i}async findKeyById(e){try{return(await this.listKeys()).find(i=>i.id===e)}catch(t){return nr(t)}}async findKeyByName(e){if(!fu(e))return nr(zr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let t=If(e);try{let i=await this.store.get(t);return JSON.parse(uh(i))}catch(i){return nr(zr(new Error(`Key '${e}' does not exist. ${i.message}`),"ERR_KEY_NOT_FOUND"))}}async removeKey(e){let t=this;if(!fu(e)||e==="self")return nr(zr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let i=lc(e),n=await t.findKeyByName(e),s=t.store.batch();return s.delete(i),s.delete(If(e)),await s.commit(),n}async renameKey(e,t){let i=this;if(!fu(e)||e==="self")return nr(zr(new Error(`Invalid old key name '${e}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!fu(t)||t==="self")return nr(zr(new Error(`Invalid new key name '${t}'`),"ERR_NEW_KEY_NAME_INVALID"));let n=lc(e),s=lc(t),o=If(e),a=If(t);if(await i.store.has(s))return nr(zr(new Error(`Key '${t}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let u=await i.store.get(n),f=await i.store.get(o),h=JSON.parse(uh(f));h.name=t;let d=i.store.batch();return d.put(s,u),d.put(a,uu(JSON.stringify(h))),d.delete(n),d.delete(o),await d.commit(),h}catch(u){return nr(u)}}async exportKey(e,t){if(!fu(e))return nr(zr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return nr(zr(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));let i=lc(e);try{let n=await this.store.get(i),s=uh(n),o=Af.get(this).dek;return(await ch.keys.import(s,o)).export(t)}catch(n){return nr(n)}}async importKey(e,t,i){let n=this;if(!fu(e)||e==="self")return nr(zr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return nr(zr(new Error("PEM encoded key is required"),"ERR_PEM_REQUIRED"));let s=lc(e);if(await n.store.has(s))return nr(zr(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));let a;try{a=await ch.keys.import(t,i)}catch(h){return nr(zr(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"))}let c;try{c=await a.id();let h=Af.get(this).dek;t=await a.export(h)}catch(h){return nr(h)}let u={name:e,id:c},f=n.store.batch();return f.put(s,uu(t)),f.put(If(e),uu(JSON.stringify(u))),await f.commit(),u}async importPeer(e,t){let i=this;if(!fu(e))return nr(zr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t||!t.privKey)return nr(zr(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));let n=t.privKey,s=lc(e);if(await i.store.has(s))return nr(zr(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let a=await n.id(),c=Af.get(this).dek,u=await n.export(c),f={name:e,id:a},h=i.store.batch();return h.put(s,uu(u)),h.put(If(e),uu(JSON.stringify(f))),await h.commit(),f}catch(a){return nr(a)}}async _getPrivateKey(e){if(!fu(e))return nr(zr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));try{let t=lc(e),i=await this.store.get(t);return uh(i)}catch(t){return nr(zr(new Error(`Key '${e}' does not exist. ${t.message}`),"ERR_KEY_NOT_FOUND"))}}async rotateKeychainPass(e,t){if(typeof e!="string")return nr(zr(new Error(`Invalid old pass type '${typeof e}'`),"ERR_INVALID_OLD_PASS_TYPE"));if(typeof t!="string")return nr(zr(new Error(`Invalid new pass type '${typeof t}'`),"ERR_INVALID_NEW_PASS_TYPE"));if(t.length<20)return nr(zr(new Error(`Invalid pass length ${t.length}`),"ERR_INVALID_PASS_LENGTH"));Whe("recreating keychain");let i=Af.get(this).dek;this.opts.pass=t;let n=t?ch.pbkdf2(t,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Af.set(this,{dek:n});let s=await this.listKeys();for(let o of s){let a=await this.store.get(lc(o.name)),c=uh(a),u=await ch.keys.import(c,i),f=n.toString(),h=await u.export(f),d=this.store.batch(),y={name:o.name,id:o.id};d.put(lc(o.name),uu(h)),d.put(If(o.name),uu(JSON.stringify(y))),await d.commit()}Whe("keychain reconstructed")}};Ghe.exports=Jhe});var ede=p((u4t,Zhe)=>{l();"use strict";var Htt=Qy();Zhe.exports=r=>{let e=Htt(r);return e.delete=e.remove,e}});var dR=p((tde,rde)=>{l();"use strict";var Gtt=Math.exp;tde=rde.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,i=0,n=0,s=0,o,a={};function c(u,f){return 1-Gtt(-(u-f)/e)}return a.push=function(f,h){if(o){let d=c(f,o),y=h-t,g=d*y;t=d*h+(1-d)*t,i=(1-d)*(i+y*g),n=Math.sqrt(i),s=t+d*y}else t=h;o=f},a.movingAverage=function(){return t},a.variance=function(){return i},a.deviation=function(){return n},a.forecast=function(){return s},a}});var ode=p((f4t,ide)=>{l();"use strict";var{EventEmitter:$tt}=Lr(),{BigNumber:Q_}=Ya(),nde=dR(),Wtt=VT(),sde=class extends $tt{constructor(e,t){super();this._options=t,this._queue=[],this._stats={dataReceived:Q_(0),dataSent:Q_(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let i=this._options.movingAverageIntervals;for(let n=0;n<e.length;n++){let s=e[n];this._stats[s]=Q_(0),this._movingAverages[s]={};for(let o=0;o<i.length;o++){let a=i[o];(this._movingAverages[s][a]=nde(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,t=this.movingAverages,i={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},n=Object.keys(t);for(let s of n){i.movingAverages[s]={};for(let o of Object.keys(t[s]))i.movingAverages[s][o]=t[s][o].movingAverage()}return i}push(e,t){this._queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=Wtt(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=n/(t||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let f=c[u],h=a[f];h||(h=a[f]=nde(f)),h.push(i,o)}}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);let n;Object.prototype.hasOwnProperty.call(this._stats,t)?n=this._stats[t]:n=this._stats[t]=Q_(0),this._stats[t]=n.plus(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};ide.exports=sde});var ude=p((l4t,ade)=>{l();"use strict";var Ytt=Gr(),{pipe:Xtt}=pi(),{tap:cde}=Al(),Jtt=ede(),{METRICS:Qtt}=F_(),pR=ode(),yR=["dataReceived","dataSent"],Ztt={in:"dataReceived",out:"dataSent"},Z_=class{constructor(e){this._options=Ytt(Qtt,e),this._globalStats=new pR(yR,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=Jtt(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._connectionManager=e.connectionManager,this._connectionManager.on("peer:disconnect",t=>{this.onPeerDisconnected(t.remotePeer)})}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}forPeer(e){let t=e.toB58String();return this._peerStats.get(t)||this._oldPeers.get(t)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let t=e.toB58String(),i=this._peerStats.get(t);i&&(i.stop(),this._peerStats.delete(t),this._oldPeers.set(t,i))}_onMessage({remotePeer:e,protocol:t,direction:i,dataLength:n}){if(!this._running)return;let s=Ztt[i],o=this.forPeer(e);if(o||(o=new pR(yR,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,n),this._globalStats.push(s,n),t){let a=this.forProtocol(t);a||(a=new pR(yR,this._options),this._protocolStats.set(t,a)),a.push(s,n)}}updatePlaceholder(e,t){if(!this._running)return;let i=this.forPeer(e),n=t.toB58String(),s=this.forPeer(t),o=i;s&&(o=Z_.mergeStats(s,o),this._oldPeers.delete(n)),this._peerStats.delete(e.toB58String()),this._peerStats.set(n,o),o.start()}trackStream({stream:e,remotePeer:t,protocol:i}){let n=this,s=e.source;e.source=cde(a=>n._onMessage({remotePeer:t,protocol:i,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>Xtt(a,cde(c=>n._onMessage({remotePeer:t,protocol:i,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,t){return e.stop(),t.stop(),e._queue=[...e._queue,...t._queue],e}};ade.exports=Z_});var gR=p((h4t,fde)=>{l();"use strict";var{Buffer:ca}=xt(),lde=Symbol.for("BufferList");function kr(r){if(!(this instanceof kr))return new kr(r);kr._init.call(this,r)}kr._init=function(e){Object.defineProperty(this,lde,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};kr.prototype._new=function(e){return new kr(e)};kr.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};kr.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};kr.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};kr.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};kr.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||ca.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&t||0,f=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:ca.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,u),u+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-f)return s?this._bufs[o[0]].copy(e,t,f,f+c):this._bufs[o[0]].slice(f,f+c);s||(e=ca.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-f;if(c>d)this._bufs[h].copy(e,u,f),u+=d;else{this._bufs[h].copy(e,u,f,f+c),u+=d;break}c-=d,f&&(f=0)}return e.length>u?e.slice(0,u):e};kr.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};kr.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};kr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};kr.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};kr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(ca.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(ca.from(e));return this};kr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};kr.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=ca.from([r]):typeof r=="string"?r=ca.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=ca.from(r.buffer,r.byteOffset,r.byteLength):ca.isBuffer(r)||(r=ca.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};kr.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?kr.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:kr.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();kr.prototype._isBufferList=function(e){return e instanceof kr||kr.isBufferList(e)};kr.isBufferList=function(e){return e!=null&&e[lde]};fde.exports=kr});var eE=p(lh=>{l();"use strict";var hde=gR(),dde=ia(),ert=pi(),trt=ge(),rrt=ct(),irt=qd(),pde=rrt(`
`);lh.encode=r=>dde.encode.single(new hde([r,pde]));lh.write=(r,e)=>r.push(lh.encode(e));lh.writeAll=(r,e)=>{r.push(e.reduce((t,i)=>t.append(lh.encode(i)),new hde))};lh.read=async r=>{let e=1,t={[Symbol.asyncIterator](){return this},next:()=>r.next(e)},i=s=>{e=s},n=await ert(t,dde.decode({onLength:i}),irt);if(n.get(n.length-1)!==pde[0])throw trt(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return n.shallowSlice(0,-1)}});var gde=p((p4t,yde)=>{l();"use strict";var t0=xe()("mss:select"),nrt=ge(),r0=eE(),srt=Yp();yde.exports=async(r,e,t)=>{e=Array.isArray(e)?[...e]:[e];let{reader:i,writer:n,rest:s,stream:o}=srt(r),a=e.shift();t?(t0('select: write ["%s", "%s"]',t,a),r0.writeAll(n,[t,a])):(t0('select: write "%s"',a),r0.write(n,a));let c=(await r0.read(i)).toString();if(t0('select: read "%s"',c),c===t&&(c=(await r0.read(i)).toString(),t0('select: read "%s"',c)),c===a)return s(),{stream:o,protocol:a};for(let u of e){t0('select: write "%s"',u),r0.write(n,u);let f=(await r0.read(i)).toString();if(t0('select: read "%s" for "%s"',f,u),f===u)return s(),{stream:o,protocol:u}}throw s(),nrt(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var bR=p(bde=>{l();"use strict";bde.PROTOCOL_ID="/multistream/1.0.0"});var vde=p((g4t,mde)=>{l();"use strict";var D1=xe()("mss:handle"),ort=gR(),i0=eE(),art=Yp(),{PROTOCOL_ID:mR}=bR();mde.exports=async(r,e)=>{e=Array.isArray(e)?e:[e];let{writer:t,reader:i,rest:n,stream:s}=art(r);for(;;){let o=(await i0.read(i)).toString();if(D1('read "%s"',o),o===mR){D1('respond with "%s" for "%s"',mR,o),i0.write(t,mR);continue}if(e.includes(o))return i0.write(t,o),D1('respond with "%s" for "%s"',o,o),n(),{stream:s,protocol:o};if(o==="ls"){i0.write(t,new ort(e.map(a=>i0.encode(a)))),D1('respond with "%s" for %s',e,o);continue}i0.write(t,"na"),D1('respond with "na" for "%s"',o)}}});var Ede=p((b4t,wde)=>{l();"use strict";var crt=GT(),urt=xe()("it-multistream-select:ls"),_de=eE(),frt=Yp(),lrt=ia(),hrt=pi();wde.exports=async r=>{let{reader:e,writer:t,rest:i,stream:n}=frt(r);urt('write "ls"'),_de.write(t,"ls"),i();let s=await _de.read(e),o=crt([s]),a=[];return await hrt(o,lrt.decode(),async c=>{for await(let u of c)a.push(u.shallowSlice(0,-1).toString())}),{stream:n,protocols:a}}});var Ide=p(tE=>{l();"use strict";var Sde=gde(),drt=vde(),prt=Ede(),{PROTOCOL_ID:vR}=bR();tE.PROTOCOL_ID=vR;var wR=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(){if(this._shaken)return;let{stream:e}=await Sde(this._stream,vR);this._stream=e,this._shaken=!0}},xde=class extends wR{select(e){return Sde(this._stream,e,this._shaken?null:vR)}async ls(){await this._handshake();let{stream:e,protocols:t}=await prt(this._stream);return this._stream=e,t}};tE.Dialer=xde;var Ade=class extends wR{handle(e){return drt(this._stream,e)}};tE.Listener=Ade});var Rde=p((v4t,Tde)=>{l();"use strict";var yrt={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};Tde.exports=yrt});var Nde=p((w4t,kde)=>{l();"use strict";var Cde=dt(),{Multiaddr:grt}=lr(),Cs=ge(),{OPEN:brt,CLOSING:Pde,CLOSED:_R}=Rde(),Ode=Symbol.for("@libp2p/interface-connection/connection"),Bde=class{constructor({localAddr:e,remoteAddr:t,localPeer:i,remotePeer:n,newStream:s,close:o,getStreams:a,stat:c}){mrt(e,i,n,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=t,this.localPeer=i,this.remotePeer=n,this._stat={...c,status:brt},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[Ode](){return!0}static isConnection(e){return Boolean(e&&e[Ode])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===Pde)throw Cs(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===_R)throw Cs(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:t,protocol:i}=await this._newStream(e);return this.addStream(t,{protocol:i}),{stream:t,protocol:i}}addStream(e,{protocol:t,metadata:i={}}){this.registry.set(e.id,{protocol:t,...i})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==_R){if(this._closing)return this._closing;this.stat.status=Pde,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=_R}}};kde.exports=Bde;function mrt(r,e,t,i,n,s,o){if(r&&!grt.isMultiaddr(r))throw Cs(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!Cde.isPeerId(e))throw Cs(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!Cde.isPeerId(t))throw Cs(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw Cs(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw Cs(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw Cs(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw Cs(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw Cs(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw Cs(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw Cs(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw Cs(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var qde=p(Dde=>{l();"use strict";Dde.Connection=Nde()});var Lde=p((E4t,Mde)=>{l();"use strict";function vrt(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}else return Array.from(r)}Mde.exports=function(e){var t=void 0,i=void 0;function n(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');i=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),t=a}n(function(){}),e&&n(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var f=arguments.length,h=Array(f),d=0;d<f;d++)h[d]=arguments[d];return t[u].apply(null,[i].concat(vrt(h.slice(1))))}}});return{setTarget:n,setHandler:s,getTarget:function(){return i},getHandler:function(){return t},proxy:new Proxy(i,o)}}});var Vde=p((S4t,Fde)=>{l();"use strict";var Ude=xe(),ki=Object.assign(Ude("libp2p:upgrader"),{error:Ude("libp2p:upgrader:err")}),hh=ge(),n0=Ide(),{Connection:wrt}=qde(),_rt=dt(),{pipe:Ert}=pi(),Kde=Lde(),{codes:s0}=yi(),jde=class{constructor({localPeer:e,metrics:t,cryptos:i=new Map,muxers:n=new Map,onConnectionEnd:s=()=>{},onConnection:o=()=>{}}){this.localPeer=e,this.metrics=t,this.cryptos=i,this.muxers=n,this.protector=null,this.protocols=new Map,this.onConnection=o,this.onConnectionEnd=s}async upgradeInbound(e){let t,i,n,s,o,a,c;if(this.metrics){({setTarget:a,proxy:c}=Kde());let f=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>f}),e=this.metrics.trackStream({stream:e,remotePeer:c})}ki("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{({conn:t,remotePeer:i,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos)),this.muxers.size?{stream:n,Muxer:s}=await this._multiplexInbound(t,this.muxers):n=t}catch(f){throw ki.error("Failed to upgrade inbound connection",f),await e.close(f),f}return this.metrics&&(this.metrics.updatePlaceholder(c,i),a(i)),ki("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:n,Muxer:s,remotePeer:i})}async upgradeOutbound(e){let t=e.remoteAddr.getPeerId();if(!t)throw hh(new Error("outbound connection must have a peer id"),s0.ERR_INVALID_MULTIADDR);let i=_rt.createFromB58String(t),n,s,o,a,c,u,f;if(this.metrics){({setTarget:u,proxy:f}=Kde());let d=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>d}),e=this.metrics.trackStream({stream:e,remotePeer:f})}ki("Starting the outbound connection upgrade");let h=e;this.protector&&(h=await this.protector.protect(e));try{({conn:n,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,h,i,this.cryptos)),this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(n,this.muxers):o=n}catch(d){throw ki.error("Failed to upgrade outbound connection",d),await e.close(d),d}return this.metrics&&(this.metrics.updatePlaceholder(f,s),u(s)),ki("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:t,maConn:i,upgradedConn:n,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async d=>{if(!u)return;let y=new n0.Listener(d);try{let{stream:g,protocol:m}=await y.handle(Array.from(this.protocols.keys()));ki("%s: incoming stream opened on %s",t,m),this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:m}),u.addStream(d,{protocol:m}),this._onStream({connection:u,stream:{...d,...g},protocol:m})}catch(g){ki.error(g)}},onStreamEnd:d=>{u.removeStream(d.id)}}),c=async d=>{ki("%s: starting new stream on %s",t,d);let y=a.newStream(),g=new n0.Dialer(y);try{let{stream:m,protocol:x}=await g.select(d);return this.metrics&&this.metrics.trackStream({stream:m,remotePeer:o,protocol:x}),{stream:{...y,...m},protocol:x}}catch(m){throw ki.error("could not create new stream",m),hh(m,s0.ERR_UNSUPPORTED_PROTOCOL)}},Ert(n,a,n).catch(ki.error));let f=i.timeline;i.timeline=new Proxy(f,{set:(...d)=>(u&&d[1]==="close"&&d[2]&&!f.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(y){ki.error(y)}finally{this.onConnectionEnd(u)}})(),Reflect.set(...d))}),i.timeline.upgraded=Date.now();let h=()=>{throw hh(new Error("connection is not multiplexed"),"ERR_CONNECTION_NOT_MULTIPLEXED")};return u=new wrt({localAddr:i.localAddr,remoteAddr:i.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:t,timeline:i.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||h,getStreams:()=>a?a.streams:h(),close:async()=>{await i.close(),a&&a.streams.map(d=>d.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:t,protocol:i}){this.protocols.get(i)({connection:e,stream:t,protocol:i})}async _encryptInbound(e,t,i){let n=new n0.Listener(t),s=Array.from(i.keys());ki("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await n.handle(s),c=i.get(a);if(ki("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw hh(o,s0.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t,i,n){let s=new n0.Dialer(t),o=Array.from(n.keys());ki("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=n.get(c);if(ki("encrypting outbound connection to %j",i),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,i),protocol:c}}catch(a){throw hh(a,s0.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){let i=new n0.Dialer(e),n=Array.from(t.keys());ki("outbound selecting muxer %s",n);try{let{stream:s,protocol:o}=await i.select(n);ki("%s selected as muxer protocol",o);let a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw hh(s,s0.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){let i=new n0.Listener(e),n=Array.from(t.keys());ki("inbound handling muxers %s",n);try{let{stream:s,protocol:o}=await i.handle(n),a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw hh(s,s0.ERR_MUXER_UNAVAILABLE)}}};Fde.exports=jde});var q1=p((x4t,zde)=>{l();"use strict";var ER=ge(),Hde=dt(),{codes:{ERR_INVALID_PARAMETERS:Gde}}=yi(),Srt=r=>r,$de=class{constructor({peerStore:e,eventName:t,eventProperty:i,eventTransformer:n=Srt}){this._ps=e,this.eventName=t,this.eventProperty=i,this.eventTransformer=n,this.data=new Map}set(e,t){throw ER(new Error("set must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}_setData(e,t,{emit:i=!0}={}){let n=e.toB58String();this.data.set(n,t),i&&this._emit(e,t)}_emit(e,t){this._ps.emit(this.eventName,{peerId:e,[this.eventProperty]:this.eventTransformer(t)})}get(e){if(!Hde.isPeerId(e))throw ER(new Error("peerId must be an instance of peer-id"),Gde);let t=this.data.get(e.toB58String());return t?[...t]:void 0}delete(e){if(!Hde.isPeerId(e))throw ER(new Error("peerId must be an instance of peer-id"),Gde);return this.data.delete(e.toB58String())?(this._emit(e,[]),!0):!1}};zde.exports=$de});var Jde=p((A4t,Wde)=>{l();"use strict";var Yde=xe(),ua=Object.assign(Yde("libp2p:peer-store:address-book"),{error:Yde("libp2p:peer-store:address-book:err")}),o0=ge(),{Multiaddr:xrt}=lr(),rE=dt(),Art=q1(),Irt=j_(),{codes:{ERR_INVALID_PARAMETERS:a0}}=yi(),Trt=_1(),Xde=class extends Art{constructor(e){super({peerStore:e,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:t=>t.addresses?t.addresses.map(i=>i.multiaddr):[]});this.data=new Map}consumePeerRecord(e){let t;try{t=Irt.createFromProtobuf(e.payload)}catch(c){return ua.error("invalid peer record received"),!1}if(!t.peerId.equals(e.peerId))return ua("signing key does not match PeerId in the PeerRecord"),!1;if(!t.multiaddrs||!t.multiaddrs.length)return!1;let i=t.peerId,n=i.toB58String(),o=(this.data.get(n)||{record:void 0}).record;if(o&&o.seqNumber>=t.seqNumber)return!1;let a=this._toAddresses(t.multiaddrs,!0);return this._setData(i,{addresses:a,record:{raw:e.marshal(),seqNumber:t.seqNumber}}),ua(`stored provided peer record for ${n}`),!0}getRawEnvelope(e){let t=this.data.get(e.toB58String());if(!(!t||!t.record||!t.record.raw))return t.record.raw}getPeerRecord(e){let t=this.getRawEnvelope(e);if(!!t)return Trt.createFromProtobuf(t)}set(e,t){if(!rE.isPeerId(e))throw ua.error("peerId must be an instance of peer-id to store data"),o0(new Error("peerId must be an instance of peer-id"),a0);let i=this._toAddresses(t);if(!i.length)return this;let n=e.toB58String(),s=this.data.get(n);return s&&s.addresses&&s.addresses.length===i.length&&s.addresses.filter(a=>i.some(c=>a.multiaddr.equals(c.multiaddr))).length===s.addresses.length?(ua(`the addresses provided to store are equal to the already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),ua(`stored provided multiaddrs for ${n}`),s||this._ps.emit("peer",e),this)}add(e,t){if(!rE.isPeerId(e))throw ua.error("peerId must be an instance of peer-id to store data"),o0(new Error("peerId must be an instance of peer-id"),a0);let i=this._toAddresses(t),n=e.toB58String();if(!i.length)return this;let s=this.data.get(n);return s&&s.addresses&&(s.addresses.forEach(o=>{i.find(a=>a.multiaddr.equals(o.multiaddr))||i.push(o)}),s.addresses.length===i.length)?(ua(`the addresses provided to store are already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),ua(`added provided multiaddrs for ${n}`),s&&s.addresses||this._ps.emit("peer",e),this)}get(e){if(!rE.isPeerId(e))throw o0(new Error("peerId must be an instance of peer-id"),a0);let t=this.data.get(e.toB58String());return t&&t.addresses?[...t.addresses]:void 0}_toAddresses(e,t=!1){if(!e)throw ua.error("multiaddrs must be provided to store data"),o0(new Error("multiaddrs must be provided"),a0);let i=[];return e.forEach(n=>{if(!xrt.isMultiaddr(n))throw ua.error(`multiaddr ${n} must be an instance of multiaddr`),o0(new Error(`multiaddr ${n} must be an instance of multiaddr`),a0);i.find(s=>s.multiaddr.equals(n))||i.push({multiaddr:n,isCertified:t})}),i}getMultiaddrsForPeer(e,t=i=>i){if(!rE.isPeerId(e))throw o0(new Error("peerId must be an instance of peer-id"),a0);let i=this.data.get(e.toB58String());if(!(!i||!i.addresses))return t(i.addresses||[]).map(n=>{let s=n.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};Wde.exports=Xde});var spe=p((I4t,Qde)=>{l();"use strict";var Zde=xe(),epe=Object.assign(Zde("libp2p:peer-store:key-book"),{error:Zde("libp2p:peer-store:key-book:err")}),tpe=ge(),rpe=dt(),Rrt=q1(),{codes:{ERR_INVALID_PARAMETERS:ipe}}=yi(),npe=class extends Rrt{constructor(e){super({peerStore:e,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:t=>t.pubKey});this.data=new Map}set(e,t){if(!rpe.isPeerId(e))throw epe.error("peerId must be an instance of peer-id to store data"),tpe(new Error("peerId must be an instance of peer-id"),ipe);let i=e.toB58String();return!this.data.get(i)&&t&&(e.pubKey=t,this._setData(e,e),epe(`stored provided public key for ${i}`)),this}get(e){if(!rpe.isPeerId(e))throw tpe(new Error("peerId must be an instance of peer-id"),ipe);let t=this.data.get(e.toB58String());return t?t.pubKey:void 0}};Qde.exports=npe});var upe=p((T4t,ope)=>{l();"use strict";var ape=xe(),SR=Object.assign(ape("libp2p:peer-store:proto-book"),{error:ape("libp2p:peer-store:proto-book:err")}),c0=ge(),krt=Dr(),M1=dt(),Crt=q1(),{codes:{ERR_INVALID_PARAMETERS:u0}}=yi(),cpe=class extends Crt{constructor(e){super({peerStore:e,eventName:"change:metadata",eventProperty:"metadata"});this.data=new Map}set(e,t,i){if(!M1.isPeerId(e))throw SR.error("peerId must be an instance of peer-id to store data"),c0(new Error("peerId must be an instance of peer-id"),u0);if(typeof t!="string"||!(i instanceof Uint8Array))throw SR.error("valid key and value must be provided to store data"),c0(new Error("valid key and value must be provided"),u0);return this._setValue(e,t,i),this}_setValue(e,t,i,{emit:n=!0}={}){let s=e.toB58String(),o=this.data.get(s)||new Map,a=o.get(t);if(a&&krt(i,a)){SR(`the metadata provided to store is equal to the already stored for ${s} on ${t}`);return}o.set(t,i),this.data.set(s,o),n&&this._emit(e,t)}get(e){if(!M1.isPeerId(e))throw c0(new Error("peerId must be an instance of peer-id"),u0);return this.data.get(e.toB58String())}getValue(e,t){if(!M1.isPeerId(e))throw c0(new Error("peerId must be an instance of peer-id"),u0);let i=this.data.get(e.toB58String());return i&&i.get(t)}delete(e){if(!M1.isPeerId(e))throw c0(new Error("peerId must be an instance of peer-id"),u0);return this.data.delete(e.toB58String())?(this._emit(e),!0):!1}deleteValue(e,t){if(!M1.isPeerId(e))throw c0(new Error("peerId must be an instance of peer-id"),u0);let i=this.data.get(e.toB58String());return!i||!i.delete(t)?!1:(this._emit(e,t),!0)}};ope.exports=cpe});var dpe=p((R4t,fpe)=>{l();"use strict";var lpe=xe(),fa=Object.assign(lpe("libp2p:peer-store:proto-book"),{error:lpe("libp2p:peer-store:proto-book:err")}),f0=ge(),xR=dt(),Prt=q1(),{codes:{ERR_INVALID_PARAMETERS:l0}}=yi(),hpe=class extends Prt{constructor(e){super({peerStore:e,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:t=>Array.from(t)});this.data=new Map}set(e,t){if(!xR.isPeerId(e))throw fa.error("peerId must be an instance of peer-id to store data"),f0(new Error("peerId must be an instance of peer-id"),l0);if(!t)throw fa.error("protocols must be provided to store data"),f0(new Error("protocols must be provided"),l0);let i=e.toB58String(),n=this.data.get(i),s=new Set(t);return n&&((a,c)=>a.size===c.size&&[...a].every(u=>c.has(u)))(n,s)?(fa(`the protocols provided to store are equal to the already stored for ${i}`),this):(this._setData(e,s),fa(`stored provided protocols for ${i}`),this)}add(e,t){if(!xR.isPeerId(e))throw fa.error("peerId must be an instance of peer-id to store data"),f0(new Error("peerId must be an instance of peer-id"),l0);if(!t)throw fa.error("protocols must be provided to store data"),f0(new Error("protocols must be provided"),l0);let i=e.toB58String(),n=this.data.get(i)||new Set,s=new Set([...n,...t]);return n.size===s.size?(fa(`the protocols provided to store are already stored for ${i}`),this):(this._setData(e,s),fa(`added provided protocols for ${i}`),this)}remove(e,t){if(!xR.isPeerId(e))throw fa.error("peerId must be an instance of peer-id to store data"),f0(new Error("peerId must be an instance of peer-id"),l0);if(!t)throw fa.error("protocols must be provided to store data"),f0(new Error("protocols must be provided"),l0);let i=e.toB58String(),n=this.data.get(i);if(n){let s=new Set([...n].filter(o=>!t.includes(o)));if(n.size===s.size)return this;this._setData(e,s),fa(`removed provided protocols for ${i}`)}return this}};fpe.exports=hpe});var AR=p((k4t,ppe)=>{l();"use strict";var Ort=ge(),{EventEmitter:Brt}=Lr(),ype=dt(),Nrt=Jde(),Drt=spe(),qrt=upe(),Mrt=dpe(),{codes:{ERR_INVALID_PARAMETERS:Lrt}}=yi(),gpe=class extends Brt{constructor({peerId:e}){super();this._peerId=e,this.addressBook=new Nrt(this),this.keyBook=new Drt(this),this.metadataBook=new qrt(this),this.protoBook=new Mrt(this)}start(){}stop(){}get peers(){let e=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&e.delete(this._peerId.toB58String());let t=new Map;return e.forEach(i=>{t.set(i,this.get(ype.createFromCID(i)))}),t}delete(e){let t=this.addressBook.delete(e),i=this.keyBook.delete(e),n=this.protoBook.delete(e),s=this.metadataBook.delete(e);return t||i||n||s}get(e){if(!ype.isPeerId(e))throw Ort(new Error("peerId must be an instance of peer-id"),Lrt);let t=this.keyBook.data.get(e.toB58String()),i=this.addressBook.get(e),n=this.metadataBook.get(e),s=this.protoBook.get(e);if(!(!t&&!i&&!n&&!s))return{id:t||e,addresses:i||[],protocols:s||[],metadata:n}}};ppe.exports=gpe});var mpe=p((C4t,bpe)=>{l();"use strict";function Frt(r,e,t){let i=new r(e,t);i._subscribeAdapter=i.subscribe,i._unsubscribeAdapter=i.unsubscribe;function n(o,a){a&&i.on(o,a),i._subscribeAdapter(o)}function s(o,a){a?i.removeListener(o,a):i.removeAllListeners(o),i.listenerCount(o)===0&&i._unsubscribeAdapter(o)}return i.subscribe=n,i.unsubscribe=s,i}bpe.exports=Frt});var vpe=p((P4t,h0)=>{l();"use strict";h0.exports.NAMESPACE_COMMON="/peers/";h0.exports.NAMESPACE_ADDRESS="/peers/addrs/";h0.exports.NAMESPACE_KEYS="/peers/keys/";h0.exports.NAMESPACE_METADATA="/peers/metadata/";h0.exports.NAMESPACE_PROTOCOL="/peers/protos/"});var _pe=p((O4t,wpe)=>{l();"use strict";var Tf=hi(),d0=Tf.Reader,IR=Tf.Writer,ei=Tf.util,Ci=Tf.roots["libp2p-address-book"]||(Tf.roots["libp2p-address-book"]={});Ci.Addresses=function(){function r(e){if(this.addrs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.addrs=ei.emptyArray,r.prototype.certifiedRecord=null,r.encode=function(t,i){if(i||(i=IR.create()),t.addrs!=null&&t.addrs.length)for(var n=0;n<t.addrs.length;++n)Ci.Addresses.Address.encode(t.addrs[n],i.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&Ci.Addresses.CertifiedRecord.encode(t.certifiedRecord,i.uint32(18).fork()).ldelim(),i},r.decode=function(t,i){t instanceof d0||(t=d0.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ci.Addresses;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(Ci.Addresses.Address.decode(t,t.uint32()));break;case 2:s.certifiedRecord=Ci.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Ci.Addresses)return t;var i=new Ci.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");i.addrs=[];for(var n=0;n<t.addrs.length;++n){if(typeof t.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");i.addrs[n]=Ci.Addresses.Address.fromObject(t.addrs[n])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");i.certifiedRecord=Ci.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addrs=[]),i.defaults&&(n.certifiedRecord=null),t.addrs&&t.addrs.length){n.addrs=[];for(var s=0;s<t.addrs.length;++s)n.addrs[s]=Ci.Addresses.Address.toObject(t.addrs[s],i)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=Ci.Addresses.CertifiedRecord.toObject(t.certifiedRecord,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Tf.util.toJSONOptions)},r.Address=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=ei.newBuffer([]),e.prototype.isCertified=!1,e.encode=function(i,n){return n||(n=IR.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},e.decode=function(i,n){i instanceof d0||(i=d0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ci.Addresses.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ci.Addresses.Address)return i;var n=new Ci.Addresses.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?ei.base64.decode(i.multiaddr,n.multiaddr=ei.newBuffer(ei.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=ei.newBuffer(s.multiaddr))),s.isCertified=!1),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?ei.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Tf.util.toJSONOptions)},e}(),r.CertifiedRecord=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.seq=ei.Long?ei.Long.fromBits(0,0,!0):0,e.prototype.raw=ei.newBuffer([]),e.encode=function(i,n){return n||(n=IR.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&n.uint32(8).uint64(i.seq),i.raw!=null&&Object.hasOwnProperty.call(i,"raw")&&n.uint32(18).bytes(i.raw),n},e.decode=function(i,n){i instanceof d0||(i=d0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ci.Addresses.CertifiedRecord;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.seq=i.uint64();break;case 2:o.raw=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ci.Addresses.CertifiedRecord)return i;var n=new Ci.Addresses.CertifiedRecord;return i.seq!=null&&(ei.Long?(n.seq=ei.Long.fromValue(i.seq)).unsigned=!0:typeof i.seq=="string"?n.seq=parseInt(i.seq,10):typeof i.seq=="number"?n.seq=i.seq:typeof i.seq=="object"&&(n.seq=new ei.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0))),i.raw!=null&&(typeof i.raw=="string"?ei.base64.decode(i.raw,n.raw=ei.newBuffer(ei.base64.length(i.raw)),0):i.raw.length&&(n.raw=i.raw)),n},e.toObject=function(i,n){n||(n={});var s={};if(n.defaults){if(ei.Long){var o=new ei.Long(0,0,!0);s.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else s.seq=n.longs===String?"0":0;n.bytes===String?s.raw="":(s.raw=[],n.bytes!==Array&&(s.raw=ei.newBuffer(s.raw)))}return i.seq!=null&&i.hasOwnProperty("seq")&&(typeof i.seq=="number"?s.seq=n.longs===String?String(i.seq):i.seq:s.seq=n.longs===String?ei.Long.prototype.toString.call(i.seq):n.longs===Number?new ei.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0):i.seq),i.raw!=null&&i.hasOwnProperty("raw")&&(s.raw=n.bytes===String?ei.base64.encode(i.raw,0,i.raw.length):n.bytes===Array?Array.prototype.slice.call(i.raw):i.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Tf.util.toJSONOptions)},e}(),r}();wpe.exports=Ci});var xpe=p((B4t,Epe)=>{l();"use strict";var p0=hi(),Spe=p0.Reader,Urt=p0.Writer,Krt=p0.util,L1=p0.roots["libp2p-proto-book"]||(p0.roots["libp2p-proto-book"]={});L1.Protocols=function(){function r(e){if(this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocols=Krt.emptyArray,r.encode=function(t,i){if(i||(i=Urt.create()),t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(10).string(t.protocols[n]);return i},r.decode=function(t,i){t instanceof Spe||(t=Spe.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new L1.Protocols;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof L1.Protocols)return t;var i=new L1.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.protocols=[]),t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,p0.util.toJSONOptions)},r}();Epe.exports=L1});var Cpe=p((N4t,Ape)=>{l();"use strict";var Ipe=xe(),Xi=Object.assign(Ipe("libp2p:persistent-peer-store"),{error:Ipe("libp2p:persistent-peer-store:err")}),{Key:iE}=ir(),{Multiaddr:jrt}=lr(),TR=dt(),Vrt=AR(),{NAMESPACE_ADDRESS:zrt,NAMESPACE_COMMON:Hrt,NAMESPACE_KEYS:Grt,NAMESPACE_METADATA:$rt,NAMESPACE_PROTOCOL:Wrt}=vpe(),{Addresses:Tpe}=_pe(),{Protocols:Rpe}=xpe(),kpe=class extends Vrt{constructor({peerId:e,datastore:t,threshold:i=5}){super({peerId:e});this._datastore=t,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=i,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){Xi("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(let e of this._datastore.query({prefix:Hrt}))await this._processDatastoreEntry(e);Xi("PeerStore started")}async stop(){Xi("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),Xi("PeerStore stopped")}_addDirtyPeer({peerId:e}){let t=e.toB58String();Xi("add dirty peer",t),this._dirtyPeers.add(t),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{Xi.error("error committing data",i)})}_addDirtyPeerKey({peerId:e}){if(e.hasInlinePublicKey())return;let t=e.toB58String();Xi("add dirty peer key",t),this._dirtyPeers.add(t),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{Xi.error("error committing data",i)})}_addDirtyPeerMetadata({peerId:e,metadata:t}){let i=e.toB58String();Xi("add dirty metadata peer",i),this._dirtyPeers.add(i);let n=this._dirtyMetadata.get(i)||new Set;n.add(t),this._dirtyMetadata.set(i,n),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(s=>{Xi.error("error committing data",s)})}async _commitData(){let e=Array.from(this._dirtyPeers);if(!e.length)return;this._dirtyPeers.clear(),Xi("create batch commit");let t=this._datastore.batch();for(let i of e){let n=this.keyBook.data.get(i)||TR.createFromCID(i);this._batchAddressBook(n,t),!n.hasInlinePublicKey()&&this._batchKeyBook(n,t),this._batchMetadataBook(n,t),this._batchProtoBook(n,t)}await t.commit(),Xi("batch committed")}_batchAddressBook(e,t){let i=e.toString(),n=new iE(`${zrt}${i}`),s=this.addressBook.data.get(e.toB58String());try{if(!s){t.delete(n);return}let o=Tpe.encode({addrs:s.addresses.map(a=>({multiaddr:a.multiaddr.bytes,isCertified:a.isCertified})),certifiedRecord:s.record?{seq:s.record.seqNumber,raw:s.record.raw}:void 0}).finish();t.put(n,o)}catch(o){Xi.error(o)}}_batchKeyBook(e,t){let i=e.toString(),n=new iE(`${Grt}${i}`);try{if(!e.pubKey){t.delete(n);return}let s=e.marshalPubKey();t.put(n,s)}catch(s){Xi.error(s)}}_batchMetadataBook(e,t){let i=e.toString(),n=this._dirtyMetadata.get(e.toB58String())||[];try{n.forEach(s=>{let o=new iE(`${$rt}${i}/${s}`),a=this.metadataBook.getValue(e,s);a?t.put(o,a):t.delete(o)})}catch(s){Xi.error(s)}}_batchProtoBook(e,t){let i=e.toString(),n=new iE(`${Wrt}${i}`),s=this.protoBook.get(e);try{if(!s){t.delete(n);return}let o=Rpe.encode({protocols:s}).finish();t.put(n,o)}catch(o){Xi.error(o)}}async _processDatastoreEntry({key:e,value:t}){try{let i=e.toString().split("/"),n=TR.createFromCID(i[3]),s;switch(i[2]){case"addrs":s=Tpe.decode(t),this.addressBook._setData(n,{addresses:s.addrs.map(o=>({multiaddr:new jrt(o.multiaddr),isCertified:Boolean(o.isCertified)})),record:s.certifiedRecord?{raw:s.certifiedRecord.raw,seqNumber:s.certifiedRecord.seq}:void 0},{emit:!1});break;case"keys":s=await TR.createFromPubKey(t),this.keyBook._setData(s,s,{emit:!1});break;case"metadata":this.metadataBook._setValue(n,i[4],t,{emit:!1});break;case"protos":s=Rpe.decode(t),this.protoBook._setData(n,new Set(s.protocols),{emit:!1});break;default:Xi("invalid data persisted for: ",e.toString())}}catch(i){Xi.error(i)}}};Ape.exports=kpe});var Npe=p((D4t,Ppe)=>{l();"use strict";var Ope=xe(),Yrt=Object.assign(Ope("libp2p:registrar"),{error:Ope("libp2p:registrar:err")}),Xrt=ge(),{codes:{ERR_INVALID_PARAMETERS:Jrt}}=yi(),Qrt=V8(),Bpe=class{constructor({peerStore:e,connectionManager:t}){this.peerStore=e,this.connectionManager=t,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}register(e){if(!Qrt.isTopology(e))throw Yrt.error("topology must be an instance of interfaces/topology"),Xrt(new Error("topology must be an instance of interfaces/topology"),Jrt);let t=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(t,e),e.registrar=this,t}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,t]of this.topologies)t.disconnect(e.remotePeer)}};Ppe.exports=Bpe});var Mpe=p((q4t,Dpe)=>{l();"use strict";var{Buffer:la}=xt(),qpe=Symbol.for("BufferList");function Cr(r){if(!(this instanceof Cr))return new Cr(r);Cr._init.call(this,r)}Cr._init=function(e){Object.defineProperty(this,qpe,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Cr.prototype._new=function(e){return new Cr(e)};Cr.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};Cr.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};Cr.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};Cr.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};Cr.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||la.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&t||0,f=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:la.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,u),u+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-f)return s?this._bufs[o[0]].copy(e,t,f,f+c):this._bufs[o[0]].slice(f,f+c);s||(e=la.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-f;if(c>d)this._bufs[h].copy(e,u,f),u+=d;else{this._bufs[h].copy(e,u,f,f+c),u+=d;break}c-=d,f&&(f=0)}return e.length>u?e.slice(0,u):e};Cr.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};Cr.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};Cr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Cr.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};Cr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(la.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(la.from(e));return this};Cr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Cr.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=la.from([r]):typeof r=="string"?r=la.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=la.from(r.buffer,r.byteOffset,r.byteLength):la.isBuffer(r)||(r=la.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};Cr.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?Cr.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:Cr.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();Cr.prototype._isBufferList=function(e){return e instanceof Cr||Cr.isBufferList(e)};Cr.isBufferList=function(e){return e!=null&&e[qpe]};Dpe.exports=Cr});var oE=p((M4t,F1)=>{l();"use strict";var{Buffer:nE}=xt(),sE=Mpe();F1.exports=async function*(r){for await(let e of r)nE.isBuffer(e)?yield e:sE.isBufferList(e)?yield e.slice():yield nE.from(e)};F1.exports.toBuffer=F1.exports;F1.exports.toList=async function*(r){for await(let e of r)nE.isBuffer(e)?yield new sE().append(e):sE.isBufferList(e)?yield e:yield new sE().append(nE.from(e))}});var Fpe=p((L4t,Lpe)=>{l();"use strict";Lpe.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32}});var Vpe=p((aE,Upe)=>{l();"use strict";var Kpe=xe(),Zrt=Object.assign(Kpe("libp2p:ping"),{error:Kpe("libp2p:ping:err")}),eit=ge(),tit=za(),{pipe:jpe}=pi(),{toBuffer:rit}=oE(),{collect:iit,take:nit}=Al(),sit=Dr(),{PROTOCOL:cE,PING_LENGTH:oit}=Fpe();async function ait(r,e){Zrt("dialing %s to %s",cE,e.toB58String?e.toB58String():e);let t=await r.dial(e),{stream:i}=await t.newStream(cE),n=Date.now(),s=tit.randomBytes(oit),[o]=await jpe([s],i,c=>nit(1,c),rit,iit),a=Date.now();if(!sit(s,o))throw eit(new Error("Received wrong ping ack"),"ERR_WRONG_PING_ACK");return a-n}function cit(r){r.handle(cE,({stream:e})=>jpe(e,e))}function uit(r){r.unhandle(cE)}aE=Upe.exports=ait;aE.mount=cit;aE.unmount=uit});var Gpe=p((F4t,zpe)=>{l();"use strict";var y0=hi(),Hpe=y0.Reader,fit=y0.Writer,Hr=y0.util,U1=y0.roots["libp2p-identify"]||(y0.roots["libp2p-identify"]={});U1.Identify=function(){function r(e){if(this.listenAddrs=[],this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocolVersion="",r.prototype.agentVersion="",r.prototype.publicKey=Hr.newBuffer([]),r.prototype.listenAddrs=Hr.emptyArray,r.prototype.observedAddr=Hr.newBuffer([]),r.prototype.protocols=Hr.emptyArray,r.prototype.signedPeerRecord=Hr.newBuffer([]),r.encode=function(t,i){if(i||(i=fit.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.listenAddrs!=null&&t.listenAddrs.length)for(var n=0;n<t.listenAddrs.length;++n)i.uint32(18).bytes(t.listenAddrs[n]);if(t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(26).string(t.protocols[n]);return t.observedAddr!=null&&Object.hasOwnProperty.call(t,"observedAddr")&&i.uint32(34).bytes(t.observedAddr),t.protocolVersion!=null&&Object.hasOwnProperty.call(t,"protocolVersion")&&i.uint32(42).string(t.protocolVersion),t.agentVersion!=null&&Object.hasOwnProperty.call(t,"agentVersion")&&i.uint32(50).string(t.agentVersion),t.signedPeerRecord!=null&&Object.hasOwnProperty.call(t,"signedPeerRecord")&&i.uint32(66).bytes(t.signedPeerRecord),i},r.decode=function(t,i){t instanceof Hpe||(t=Hpe.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new U1.Identify;t.pos<n;){var o=t.uint32();switch(o>>>3){case 5:s.protocolVersion=t.string();break;case 6:s.agentVersion=t.string();break;case 1:s.publicKey=t.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(t.bytes());break;case 4:s.observedAddr=t.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;case 8:s.signedPeerRecord=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof U1.Identify)return t;var i=new U1.Identify;if(t.protocolVersion!=null&&(i.protocolVersion=String(t.protocolVersion)),t.agentVersion!=null&&(i.agentVersion=String(t.agentVersion)),t.publicKey!=null&&(typeof t.publicKey=="string"?Hr.base64.decode(t.publicKey,i.publicKey=Hr.newBuffer(Hr.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.listenAddrs){if(!Array.isArray(t.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");i.listenAddrs=[];for(var n=0;n<t.listenAddrs.length;++n)typeof t.listenAddrs[n]=="string"?Hr.base64.decode(t.listenAddrs[n],i.listenAddrs[n]=Hr.newBuffer(Hr.base64.length(t.listenAddrs[n])),0):t.listenAddrs[n].length&&(i.listenAddrs[n]=t.listenAddrs[n])}if(t.observedAddr!=null&&(typeof t.observedAddr=="string"?Hr.base64.decode(t.observedAddr,i.observedAddr=Hr.newBuffer(Hr.base64.length(t.observedAddr)),0):t.observedAddr.length&&(i.observedAddr=t.observedAddr)),t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Identify.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return t.signedPeerRecord!=null&&(typeof t.signedPeerRecord=="string"?Hr.base64.decode(t.signedPeerRecord,i.signedPeerRecord=Hr.newBuffer(Hr.base64.length(t.signedPeerRecord)),0):t.signedPeerRecord.length&&(i.signedPeerRecord=t.signedPeerRecord)),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.listenAddrs=[],n.protocols=[]),i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Hr.newBuffer(n.publicKey))),i.bytes===String?n.observedAddr="":(n.observedAddr=[],i.bytes!==Array&&(n.observedAddr=Hr.newBuffer(n.observedAddr))),n.protocolVersion="",n.agentVersion="",i.bytes===String?n.signedPeerRecord="":(n.signedPeerRecord=[],i.bytes!==Array&&(n.signedPeerRecord=Hr.newBuffer(n.signedPeerRecord)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Hr.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.listenAddrs&&t.listenAddrs.length){n.listenAddrs=[];for(var s=0;s<t.listenAddrs.length;++s)n.listenAddrs[s]=i.bytes===String?Hr.base64.encode(t.listenAddrs[s],0,t.listenAddrs[s].length):i.bytes===Array?Array.prototype.slice.call(t.listenAddrs[s]):t.listenAddrs[s]}if(t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return t.observedAddr!=null&&t.hasOwnProperty("observedAddr")&&(n.observedAddr=i.bytes===String?Hr.base64.encode(t.observedAddr,0,t.observedAddr.length):i.bytes===Array?Array.prototype.slice.call(t.observedAddr):t.observedAddr),t.protocolVersion!=null&&t.hasOwnProperty("protocolVersion")&&(n.protocolVersion=t.protocolVersion),t.agentVersion!=null&&t.hasOwnProperty("agentVersion")&&(n.agentVersion=t.agentVersion),t.signedPeerRecord!=null&&t.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=i.bytes===String?Hr.base64.encode(t.signedPeerRecord,0,t.signedPeerRecord.length):i.bytes===Array?Array.prototype.slice.call(t.signedPeerRecord):t.signedPeerRecord),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,y0.util.toJSONOptions)},r}();zpe.exports=U1});var t0e=p((U4t,$pe)=>{l();"use strict";var Wpe=xe(),hc=Object.assign(Wpe("libp2p:identify"),{error:Wpe("libp2p:identify:err")}),RR=ge(),uE=ia(),{pipe:fE}=pi(),{collect:Ype,take:Xpe,consume:Jpe}=Al(),g0=ct(),lit=dt(),{Multiaddr:kR}=lr(),{toBuffer:Qpe}=oE(),K1=Gpe(),Zpe=_1(),e0e=j_(),{MULTICODEC_IDENTIFY:CR,MULTICODEC_IDENTIFY_PUSH:lE,PROTOCOL_VERSION:hit}=PT(),{codes:PR}=yi(),b0=class{constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this),this._host={protocolVersion:hit,...e._options.host},this.peerStore.metadataBook.set(this.peerId,"AgentVersion",g0(this._host.agentVersion)),this.peerStore.metadataBook.set(this.peerId,"ProtocolVersion",g0(this._host.protocolVersion)),this.connectionManager.on("peer:connect",t=>{this.identify(t).catch(hc.error)}),this.peerStore.on("change:multiaddrs",({peerId:t})=>{t.toString()===this.peerId.toString()&&this.pushToPeerStore()}),this.peerStore.on("change:protocols",({peerId:t})=>{t.toString()===this.peerId.toString()&&this.pushToPeerStore()})}async push(e){let t=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this._libp2p.multiaddrs.map(o=>o.bytes),n=this.peerStore.protoBook.get(this.peerId)||[],s=e.map(async o=>{try{let{stream:a}=await o.newStream(lE);await fE([K1.Identify.encode({listenAddrs:i,signedPeerRecord:t,protocols:n}).finish()],uE.encode(),a,Jpe)}catch(a){hc.error("could not push identify update to peer",a)}});return Promise.all(s)}pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],t;for(let i of this.peerStore.peers.values())i.protocols.includes(lE)&&(t=this.connectionManager.get(i.id))&&e.push(t);this.push(e)}async identify(e){let{stream:t}=await e.newStream(CR),[i]=await fE([],t,uE.decode(),Xpe(1),Qpe,Ype);if(!i)throw RR(new Error("No data could be retrieved"),PR.ERR_CONNECTION_ENDED);let n;try{n=K1.Identify.decode(i)}catch(d){throw RR(d,PR.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=n,f=await lit.createFromPubKey(s);if(e.remotePeer.toB58String()!==f.toB58String())throw RR(new Error("identified peer does not match the expected peer"),PR.ERR_INVALID_PEER);let h=b0.getCleanMultiaddr(c);try{let d=await Zpe.openAndCertify(u,e0e.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(d)){this.peerStore.protoBook.set(f,a),this.peerStore.metadataBook.set(f,"AgentVersion",g0(n.agentVersion)),this.peerStore.metadataBook.set(f,"ProtocolVersion",g0(n.protocolVersion));return}}catch(d){hc("received invalid envelope, discard it and fallback to listenAddrs is available",d)}try{this.peerStore.addressBook.set(f,o.map(d=>new kR(d)))}catch(d){hc.error("received invalid addrs",d)}this.peerStore.protoBook.set(f,a),this.peerStore.metadataBook.set(f,"AgentVersion",g0(n.agentVersion)),this.peerStore.metadataBook.set(f,"ProtocolVersion",g0(n.protocolVersion)),hc("received observed address of %s",h)}handleMessage({connection:e,stream:t,protocol:i}){switch(i){case CR:return this._handleIdentify({connection:e,stream:t});case lE:return this._handlePush({connection:e,stream:t});default:hc.error("cannot handle unknown protocol %s",i)}}async _handleIdentify({connection:e,stream:t}){let i=new Uint8Array(0);this.peerId.pubKey&&(i=this.peerId.pubKey.bytes);let n=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=this.peerStore.protoBook.get(this.peerId)||[],o=K1.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:i,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:n,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();try{await fE([o],uE.encode(),t,Jpe)}catch(a){hc.error("could not respond to identify request",a)}}async _handlePush({connection:e,stream:t}){let i;try{let[s]=await fE([],t,uE.decode(),Xpe(1),Qpe,Ype);i=K1.Identify.decode(s)}catch(s){return hc.error("received invalid message",s)}let n=e.remotePeer;try{let s=await Zpe.openAndCertify(i.signedPeerRecord,e0e.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(s)){this.peerStore.protoBook.set(n,i.protocols);return}}catch(s){hc("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{this.peerStore.addressBook.set(n,i.listenAddrs.map(s=>new kR(s)))}catch(s){hc.error("received invalid addrs",s)}this.peerStore.protoBook.set(n,i.protocols)}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new kR(e)}catch(t){return null}return null}},dit={IDENTIFY:CR,IDENTIFY_PUSH:lE};b0.multicodecs=dit;b0.Messsage=K1;$pe.exports=b0});var r0e=p(()=>{l()});var n0e=p(OR=>{l();"use strict";Object.defineProperty(OR,"__esModule",{value:!0});OR.promisify=hE;var i0e="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function hE(r){if(typeof r!="function")throw new TypeError("Argument to promisify must be a function");var e=r[i0e],t=hE.Promise||Promise;if(typeof t!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var i=this,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return new t(function(a,c){s.push(function(f){if(f)return c(f);for(var h=arguments.length,d=new Array(h>1?h-1:0),y=1;y<h;y++)d[y-1]=arguments[y];if(d.length===1||!e)return a(d[0]);var g={};d.forEach(function(m,x){var _=e[x];_&&(g[_]=m)}),a(g)}),r.apply(i,s)})}}hE.argumentNames=i0e;hE.Promise=void 0});var o0e=p((z4t,s0e)=>{l();"use strict";var pit=nS(),dE=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,j1=pit(),yit=dE&&!j1,git=j1&&!dE,bit=j1&&dE,mit=typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!j1,vit=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,wit=typeof process!="undefined"&&typeof process.env!="undefined"&&process.env.NODE_ENV==="test";s0e.exports={isTest:wit,isElectron:j1,isElectronMain:git,isElectronRenderer:bit,isNode:mit,isBrowser:yit,isWebWorker:vit,isEnvWithDom:dE}});var c0e=p((H4t,a0e)=>{l();function yo(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||Infinity,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}a0e.exports=yo;yo.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts};yo.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null};yo.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),t=this._timeouts.shift();else return!1;var i=this,n=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},t);return this._options.unref&&n.unref(),!0};yo.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};yo.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};yo.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};yo.prototype.start=yo.prototype.try;yo.prototype.errors=function(){return this._errors};yo.prototype.attempts=function(){return this._attempts};yo.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,i=0;i<this._errors.length;i++){var n=this._errors[i],s=n.message,o=(r[s]||0)+1;r[s]=o,o>=t&&(e=n,t=o)}return e}});var u0e=p(dh=>{l();var _it=c0e();dh.operation=function(r){var e=dh.timeouts(r);return new _it(e,{forever:r&&r.forever,unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})};dh.timeouts=function(r){if(r instanceof Array)return[].concat(r);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:Infinity,randomize:!1};for(var t in r)e[t]=r[t];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],n=0;n<e.retries;n++)i.push(this.createTimeout(n,e));return r&&r.forever&&!i.length&&i.push(this.createTimeout(n,e)),i.sort(function(s,o){return s-o}),i};dh.createTimeout=function(r,e){var t=e.randomize?Math.random()+1:1,i=Math.round(t*e.minTimeout*Math.pow(e.factor,r));return i=Math.min(i,e.maxTimeout),i};dh.wrap=function(r,e,t){if(e instanceof Array&&(t=e,e=null),!t){t=[];for(var i in r)typeof r[i]=="function"&&t.push(i)}for(var n=0;n<t.length;n++){var s=t[n],o=r[s];r[s]=function(c){var u=dh.operation(e),f=Array.prototype.slice.call(arguments,1),h=f.pop();f.push(function(d){u.retry(d)||(d&&(arguments[0]=u.mainError()),h.apply(this,arguments))}),u.attempt(function(){c.apply(r,f)})}.bind(r,o),r[s].options=e}}});var l0e=p(($4t,f0e)=>{l();f0e.exports=u0e()});var d0e=p((W4t,pE)=>{l();"use strict";var Eit=l0e(),Sit=["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Network request failed"],BR=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},xit=(r,e,t)=>{let i=t.retries-(e-1);return r.attemptNumber=e,r.retriesLeft=i,r},Ait=r=>Sit.includes(r),h0e=(r,e)=>new Promise((t,i)=>{e={onFailedAttempt:()=>{},retries:10,...e};let n=Eit.operation(e);n.attempt(async s=>{try{t(await r(s))}catch(o){if(!(o instanceof Error)){i(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof BR)n.stop(),i(o.originalError);else if(o instanceof TypeError&&!Ait(o.message))n.stop(),i(o);else{xit(o,s,e);try{await e.onFailedAttempt(o)}catch(a){i(a);return}n.retry(o)||i(n.mainError())}}})});pE.exports=h0e;pE.exports.default=h0e;pE.exports.AbortError=BR});var y0e=p((Y4t,p0e)=>{l();"use strict";function Iit(r){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r)||/^::1$/.test(r)}p0e.exports=Iit});var b0e=p((X4t,g0e)=>{l();"use strict";var Tit=y0e();function Rit(r){let{address:e}=r.nodeAddress();return Tit(e)}g0e.exports=Rit});var S0e=p((J4t,m0e)=>{l();"use strict";var kit=r0e(),v0e=xe(),{promisify:NR}=n0e(),{Multiaddr:Cit}=lr(),m0=Object.assign(v0e("libp2p:nat"),{error:v0e("libp2p:nat:err")}),{isBrowser:w0e}=o0e(),DR=d0e(),Pit=OT(),_0e=CT(),Oit=ge(),{codes:{ERR_INVALID_PARAMETERS:Bit}}=yi(),Nit=b0e(),qR=7200;function Dit(r=1024,e=65535){return Math.floor(Math.random()*(e-r+1)+r)}var E0e=class{constructor({peerId:e,addressManager:t,transportManager:i,...n}){if(this._peerId=e,this._addressManager=t,this._transportManager=i,this._enabled=n.enabled,this._externalIp=n.externalIp,this._options={description:n.description||`${_0e.name}@${_0e.version} ${this._peerId}`,ttl:n.ttl||qR,autoUpdate:n.keepAlive||!0,gateway:n.gateway,enablePMP:Boolean(n.pmp&&n.pmp.enabled)},this._options.ttl<qR)throw Oit(new Error(`NatManager ttl should be at least ${qR} seconds`),Bit)}start(){w0e||!this._enabled||this._start().catch(e=>{m0.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let t of e){let{family:i,host:n,port:s,transport:o}=t.toOptions();if(!t.isThinWaistAddress()||o!=="tcp"||Nit(t)||i!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(Pit(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=Dit();m0(`opening uPnP connection from ${c}:${u} to ${n}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(Cit.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new kit(this._options),t=NR(e.map.bind(e)),i=NR(e.destroy.bind(e)),n=NR(e.externalIp.bind(e));return this._client={map:(...s)=>DR(()=>t(...s),{onFailedAttempt:m0.error,unref:!0}),destroy:(...s)=>DR(()=>i(...s),{onFailedAttempt:m0.error,unref:!0}),externalIp:(...s)=>DR(()=>n(...s),{onFailedAttempt:m0.error,unref:!0})},this._client}async stop(){if(!(w0e||!this._client))try{await this._client.destroy(),this._client=null}catch(e){m0.error(e)}}};m0e.exports=E0e});var k0e=p((Q4t,x0e)=>{l();"use strict";var A0e=xe(),Ps=Object.assign(A0e("libp2p"),{error:A0e("libp2p:err")}),{EventEmitter:qit}=Lr(),MR=ge(),Mit=dt(),{Multiaddr:Lit}=lr(),Fit=wue(),Uit=Sue(),LR=kT(),{validate:Kit}=Ife(),{codes:yE,messages:jit}=yi(),Vit=kfe(),zit=Hfe(),I0e=Ile(),Hit=Fle(),Git=hhe(),T0e=Qhe(),$it=ude(),Wit=UT(),Yit=Vde(),Xit=AR(),Jit=mpe(),Qit=Cpe(),Zit=Npe(),gE=Vpe(),R0e=t0e(),ent=R0e.multicodecs,tnt=S0e(),{updateSelfPeerRecord:rnt}=LT(),V1=class extends qit{static async create(e){if(e.peerId)return new V1(e);let t=await Mit.create();return e.peerId=t,new V1(e)}constructor(e){super();if(this._options=Kit(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new Qit({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new Xit({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new Vit(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{rnt(this).catch(i=>{Ps.error("Error updating self peer record",i)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new zit(this,{autoDial:this._config.peerDiscovery.autoDial,...this._options.connectionManager}),this._options.metrics.enabled&&(this.metrics=new $it({...this._options.metrics,connectionManager:this.connectionManager})),this._options.keychain&&this._options.keychain.datastore){Ps("creating keychain");let i=T0e.generateOptions();this.keychain=new T0e(this._options.keychain.datastore,{...i,...this._options.keychain}),Ps("keychain constructed")}if(this.upgrader=new Yit({localPeer:this.peerId,metrics:this.metrics,onConnection:i=>this.connectionManager.onConnect(i),onConnectionEnd:i=>this.connectionManager.onDisconnect(i)}),this.transportManager=new Wit({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new tnt({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new Zit({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw MR(new Error(jit.CONN_ENCRYPTION_REQUIRED),yE.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(i=>{this.upgrader.cryptos.set(i.protocol,i)}),this.dialer=new Git({transportManager:this.transportManager,peerStore:this.peerStore,...this._options.dialer}),this._modules.transport.forEach(i=>{let n=i.prototype[Symbol.toStringTag],s=this._config.transport[n];this.transportManager.add(n,i,s)}),this._config.relay.enabled&&(this.transportManager.add(I0e.prototype[Symbol.toStringTag],I0e),this.relay=new Hit(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new R0e({libp2p:this}),this.handle(Object.values(ent),this.identifyService.handleMessage)),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let i=this._modules.dht;this._dht=new i({libp2p:this,dialer:this.dialer,peerId:this.peerId,peerStore:this.peerStore,registrar:this.registrar,datastore:this.datastore,...this._config.dht})}if(this._modules.pubsub){let i=this._modules.pubsub;this.pubsub=Jit(i,this,this._config.pubsub)}this.peerRouting=new Fit(this),this.contentRouting=new Uit(this),gE.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(e,...t){return e==="error"&&!this._events.error?(Ps.error(t),!1):super.emit(e,...t)}async start(){Ps("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),Ps("libp2p has started")}catch(e){throw this.emit("error",e),Ps.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){Ps("libp2p is stopping");try{this._isStarted=!1,this.relay&&this.relay.stop(),this.peerRouting.stop();for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this._dht&&this._dht.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),gE.unmount(this),this.dialer.destroy()}catch(e){e&&(Ps.error(e),this.emit("error",e))}Ps("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,t){return this._dial(e,t)}async dialProtocol(e,t,i){if(!t||!t.length)throw MR(new Error("no protocols were provided to open a stream"),yE.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,i)).newStream(t)}async _dial(e,t){let{id:i,multiaddrs:n}=LR(e);if(i.equals(this.peerId))throw MR(new Error("Cannot dial self"),yE.ERR_DIALED_SELF);let s=this.connectionManager.get(i);return s?n&&this.peerStore.addressBook.add(i,n):s=await this.dialer.connectToPeer(e,t),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(n=>n.toString());e.length||(e=this.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(n=>n.toString()));let t=this._options.addresses.announceFilter,i=new Set(e);return t(Array.from(i).map(n=>new Lit(n)))}async hangUp(e){let{id:t}=LR(e),i=this.connectionManager.connections.get(t.toB58String());!i||await Promise.all(i.map(n=>n.close()))}ping(e){let{id:t,multiaddrs:i}=LR(e);return i?gE(this,i[0]):gE(this,t)}handle(e,t){e=Array.isArray(e)?e:[e],e.forEach(i=>{this.upgrader.protocols.set(i,t)}),this.peerStore.protoBook.add(this.peerId,e)}unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(t=>{this.upgrader.protocols.delete(t)}),this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),await this.peerStore.start(),this._config.pubsub.enabled&&this.pubsub&&this.pubsub.start(),this._config.dht.enabled&&(this._dht&&this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e)});for(let e of this.peerStore.peers.values())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){Ps.error(new Error(yE.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols)}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){Ps("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(i){Ps.error(`could not connect to discovered peer ${e.toB58String()} with ${i}`)}}}async _setupPeerDiscovery(){let e=t=>{let i={enabled:!0};if(t.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[t.tag]&&(i={...i,...this._config.peerDiscovery[t.tag]}),i.enabled&&!this._discovery.has(t.tag)){let n;typeof t=="function"?n=new t(Object.assign({},i,{peerId:this.peerId,libp2p:this})):n=t,n.on("peer",this._onDiscoveryPeer),this._discovery.set(t.tag,n)}};for(let t of this._modules.peerDiscovery||[])e(t);for(let t of this.transportManager.getTransports())t.discovery&&e(t.discovery);await Promise.all(Array.from(this._discovery.values(),t=>t.start()))}};x0e.exports=V1});var C0e=p(()=>{l()});var O0e=p((tAt,P0e)=>{l();P0e.exports=typeof WebSocket=="undefined"?C0e():WebSocket});var N0e=p(bE=>{l();"use strict";Object.defineProperty(bE,"__esModule",{value:!0});var B0e=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let t={value:e,done:!1};if(this.pullQueue.length){let i=this.pullQueue.shift();i&&i.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{let t=Promise.reject(e);t.catch(()=>{}),this.pushQueue.push(t)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let t=this.pushQueue.shift();return t?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((i,n)=>{this.pullQueue.push({resolve:i,reject:n})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},FR=class{constructor(e,{highWaterMark:t=100,lowWaterMark:i=1}={}){let n=new B0e;n.highWaterMark=t,n.lowWaterMark=i,n.removeCallback=e({push:s=>n.push(s),stop:()=>n.stop(),fail:s=>n.fail(s),on:(s,o)=>{n.eventHandlers[s]=o}})||(()=>{}),this[Symbol.asyncIterator]=()=>n[Symbol.asyncIterator](),Object.freeze(this)}};bE.EventIterator=FR;bE.default=FR});var D0e=p(z1=>{l();"use strict";Object.defineProperty(z1,"__esModule",{value:!0});var UR=N0e();z1.EventIterator=UR.EventIterator;function int(r,e,t){return new UR.EventIterator(({push:i})=>(this.addEventListener(r,i,e),()=>this.removeEventListener(r,i,e)),t)}z1.subscribe=int;z1.default=UR.EventIterator});var M0e=p((nAt,q0e)=>{l();var{Buffer:nnt}=xt(),{EventIterator:snt}=D0e();function ont(r){return r instanceof ArrayBuffer||r!=null&&r.constructor!=null&&r.constructor.name==="ArrayBuffer"&&typeof r.byteLength=="number"}q0e.exports=r=>{let e=r.removeEventListener||r.removeListener,t=async function*(){let s=new snt(({push:o,stop:a,fail:c})=>(r.addEventListener("message",o),r.addEventListener("error",c),r.addEventListener("close",a),()=>{e.call(r,"message",o),e.call(r,"error",c),e.call(r,"close",a)}),{highWaterMark:Infinity});for await(let{data:o}of s)yield ont(o)?nnt.from(o):o}(),i=r.readyState===1,n;return r.addEventListener("open",()=>{i=!0,n=null}),r.addEventListener("close",()=>{i=!1,n=null}),r.addEventListener("error",s=>{i||(n=s)}),t.connected=()=>new Promise((s,o)=>{if(i)return s();if(n)return o(n);let a=f=>{e.call(r,"open",c),e.call(r,"error",u),f()},c=()=>a(s),u=f=>a(()=>o(f));r.addEventListener("open",c),r.addEventListener("error",u)}),t}});var F0e=p((sAt,L0e)=>{l();L0e.exports=async r=>{if(r.readyState>=2)throw new Error("socket closed");if(r.readyState!==1)return new Promise((e,t)=>{let i=r&&(r.removeEventListener||r.removeListener);function n(){typeof i=="function"&&(i.call(r,"open",s),i.call(r,"error",o))}function s(){n(),e()}function o(a){n(),t(a)}r.addEventListener("open",s),r.addEventListener("error",o)})}});var K0e=p((oAt,U0e)=>{l();var ant=F0e();U0e.exports=(r,e)=>(e=e||{},e.closeOnEnd=e.closeOnEnd!==!1,async t=>{for await(let i of t){try{await ant(r)}catch(n){if(n.message==="socket closed")break;throw n}r.send(i)}if(e.closeOnEnd&&r.readyState<=1)return new Promise((i,n)=>{r.addEventListener("close",s=>{if(s.wasClean||s.code===1006)i();else{let o=Object.assign(new Error("ws error"),{event:s});n(o)}}),setTimeout(()=>r.close())})})});var V0e=p((aAt,j0e)=>{l();var cnt=M0e(),unt=K0e();j0e.exports=(r,e)=>{e=e||{},e.binaryType?r.binaryType=e.binaryType:e.binary&&(r.binaryType="arraybuffer");let t={sink:unt(r,e),source:cnt(r,e),connected:()=>t.source.connected()};return t}});var H0e=p((cAt,z0e)=>{l();var{relative:fnt}=Oh(),lnt={http:"ws",https:"wss"},hnt="ws";z0e.exports=(r,e)=>fnt(r,e,lnt,hnt)});var G0e=p((uAt,mE)=>{l();"use strict";var dnt=O0e(),pnt=V0e(),ynt=H0e();mE.exports=function(r,e={}){let t=typeof window=="undefined"?{}:window.location,i=ynt(r,t),n=new dnt(i,e.websocket),s=pnt(n,e);return s.remoteAddress=i,s.close=()=>new Promise((o,a)=>{n.addEventListener("close",o),n.close()}),s.destroy=()=>{n.terminate?n.terminate():n.close()},s.socket=n,s};mE.exports.connect=mE.exports});var W0e=p((fAt,$0e)=>{l();"use strict";$0e.exports=function(){throw new Error("WebSocket Servers can not be created in the browser!")}});var KR=p(ph=>{l();"use strict";ph.CODE_P2P=421;ph.CODE_CIRCUIT=290;ph.CODE_TCP=6;ph.CODE_WS=477;ph.CODE_WSS=478;ph.CLOSE_TIMEOUT=2e3});var jR=p(v0=>{l();"use strict";Object.defineProperty(v0,"__esModule",{value:!0});v0.isCorrect=v0.isInSubnet=void 0;function gnt(r){return this.subnetMask<r.subnetMask?!1:this.mask(r.subnetMask)===r.mask()}v0.isInSubnet=gnt;function bnt(r){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===r&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}v0.isCorrect=bnt});var VR=p(dc=>{l();"use strict";Object.defineProperty(dc,"__esModule",{value:!0});dc.RE_SUBNET_STRING=dc.RE_ADDRESS=dc.GROUPS=dc.BITS=void 0;dc.BITS=32;dc.GROUPS=4;dc.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;dc.RE_SUBNET_STRING=/\/\d{1,2}$/});var zR=p(w0=>{l();"use strict";var mnt=w0&&w0.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(w0,"__esModule",{value:!0});w0.AddressError=void 0;var vnt=function(r){mnt(e,r);function e(t,i){var n=r.call(this,t)||this;return n.name="AddressError",i!==null&&(n.parseMessage=i),n}return e}(Error);w0.AddressError=vnt});var HR=p((vE,Y0e)=>{l();(function(){var r,e=244837814094590,t=(e&16777215)==15715070;function i(C,O,$){C!=null&&(typeof C=="number"?this.fromNumber(C,O,$):O==null&&typeof C!="string"?this.fromString(C,256):this.fromString(C,O))}function n(){return new i(null)}function s(C,O,$,ce,_e,Se){for(;--Se>=0;){var Fe=O*this[C++]+$[ce]+_e;_e=Math.floor(Fe/67108864),$[ce++]=Fe&67108863}return _e}function o(C,O,$,ce,_e,Se){for(var Fe=O&32767,$e=O>>15;--Se>=0;){var Nr=this[C]&32767,Bi=this[C++]>>15,Ds=$e*Nr+Bi*Fe;Nr=Fe*Nr+((Ds&32767)<<15)+$[ce]+(_e&1073741823),_e=(Nr>>>30)+(Ds>>>15)+$e*Bi+(_e>>>30),$[ce++]=Nr&1073741823}return _e}function a(C,O,$,ce,_e,Se){for(var Fe=O&16383,$e=O>>14;--Se>=0;){var Nr=this[C]&16383,Bi=this[C++]>>14,Ds=$e*Nr+Bi*Fe;Nr=Fe*Nr+((Ds&16383)<<14)+$[ce]+_e,_e=(Nr>>28)+(Ds>>14)+$e*Bi,$[ce++]=Nr&268435455}return _e}var c=typeof navigator!="undefined";c&&t&&navigator.appName=="Microsoft Internet Explorer"?(i.prototype.am=o,r=30):c&&t&&navigator.appName!="Netscape"?(i.prototype.am=s,r=26):(i.prototype.am=a,r=28),i.prototype.DB=r,i.prototype.DM=(1<<r)-1,i.prototype.DV=1<<r;var u=52;i.prototype.FV=Math.pow(2,u),i.prototype.F1=u-r,i.prototype.F2=2*r-u;var f="0123456789abcdefghijklmnopqrstuvwxyz",h=new Array,d,y;for(d="0".charCodeAt(0),y=0;y<=9;++y)h[d++]=y;for(d="a".charCodeAt(0),y=10;y<36;++y)h[d++]=y;for(d="A".charCodeAt(0),y=10;y<36;++y)h[d++]=y;function g(C){return f.charAt(C)}function m(C,O){var $=h[C.charCodeAt(O)];return $??-1}function x(C){for(var O=this.t-1;O>=0;--O)C[O]=this[O];C.t=this.t,C.s=this.s}function _(C){this.t=1,this.s=C<0?-1:0,C>0?this[0]=C:C<-1?this[0]=C+this.DV:this.t=0}function P(C){var O=n();return O.fromInt(C),O}function q(C,O){var $;if(O==16)$=4;else if(O==8)$=3;else if(O==256)$=8;else if(O==2)$=1;else if(O==32)$=5;else if(O==4)$=2;else{this.fromRadix(C,O);return}this.t=0,this.s=0;for(var ce=C.length,_e=!1,Se=0;--ce>=0;){var Fe=$==8?C[ce]&255:m(C,ce);if(Fe<0){C.charAt(ce)=="-"&&(_e=!0);continue}_e=!1,Se==0?this[this.t++]=Fe:Se+$>this.DB?(this[this.t-1]|=(Fe&(1<<this.DB-Se)-1)<<Se,this[this.t++]=Fe>>this.DB-Se):this[this.t-1]|=Fe<<Se,Se+=$,Se>=this.DB&&(Se-=this.DB)}$==8&&(C[0]&128)!=0&&(this.s=-1,Se>0&&(this[this.t-1]|=(1<<this.DB-Se)-1<<Se)),this.clamp(),_e&&i.ZERO.subTo(this,this)}function X(){for(var C=this.s&this.DM;this.t>0&&this[this.t-1]==C;)--this.t}function W(C){if(this.s<0)return"-"+this.negate().toString(C);var O;if(C==16)O=4;else if(C==8)O=3;else if(C==2)O=1;else if(C==32)O=5;else if(C==4)O=2;else return this.toRadix(C);var $=(1<<O)-1,ce,_e=!1,Se="",Fe=this.t,$e=this.DB-Fe*this.DB%O;if(Fe-- >0)for($e<this.DB&&(ce=this[Fe]>>$e)>0&&(_e=!0,Se=g(ce));Fe>=0;)$e<O?(ce=(this[Fe]&(1<<$e)-1)<<O-$e,ce|=this[--Fe]>>($e+=this.DB-O)):(ce=this[Fe]>>($e-=O)&$,$e<=0&&($e+=this.DB,--Fe)),ce>0&&(_e=!0),_e&&(Se+=g(ce));return _e?Se:"0"}function z(){var C=n();return i.ZERO.subTo(this,C),C}function Z(){return this.s<0?this.negate():this}function ee(C){var O=this.s-C.s;if(O!=0)return O;var $=this.t;if(O=$-C.t,O!=0)return this.s<0?-O:O;for(;--$>=0;)if((O=this[$]-C[$])!=0)return O;return 0}function re(C){var O=1,$;return($=C>>>16)!=0&&(C=$,O+=16),($=C>>8)!=0&&(C=$,O+=8),($=C>>4)!=0&&(C=$,O+=4),($=C>>2)!=0&&(C=$,O+=2),($=C>>1)!=0&&(C=$,O+=1),O}function L(){return this.t<=0?0:this.DB*(this.t-1)+re(this[this.t-1]^this.s&this.DM)}function b(C,O){var $;for($=this.t-1;$>=0;--$)O[$+C]=this[$];for($=C-1;$>=0;--$)O[$]=0;O.t=this.t+C,O.s=this.s}function w(C,O){for(var $=C;$<this.t;++$)O[$-C]=this[$];O.t=Math.max(this.t-C,0),O.s=this.s}function R(C,O){var $=C%this.DB,ce=this.DB-$,_e=(1<<ce)-1,Se=Math.floor(C/this.DB),Fe=this.s<<$&this.DM,$e;for($e=this.t-1;$e>=0;--$e)O[$e+Se+1]=this[$e]>>ce|Fe,Fe=(this[$e]&_e)<<$;for($e=Se-1;$e>=0;--$e)O[$e]=0;O[Se]=Fe,O.t=this.t+Se+1,O.s=this.s,O.clamp()}function B(C,O){O.s=this.s;var $=Math.floor(C/this.DB);if($>=this.t){O.t=0;return}var ce=C%this.DB,_e=this.DB-ce,Se=(1<<ce)-1;O[0]=this[$]>>ce;for(var Fe=$+1;Fe<this.t;++Fe)O[Fe-$-1]|=(this[Fe]&Se)<<_e,O[Fe-$]=this[Fe]>>ce;ce>0&&(O[this.t-$-1]|=(this.s&Se)<<_e),O.t=this.t-$,O.clamp()}function U(C,O){for(var $=0,ce=0,_e=Math.min(C.t,this.t);$<_e;)ce+=this[$]-C[$],O[$++]=ce&this.DM,ce>>=this.DB;if(C.t<this.t){for(ce-=C.s;$<this.t;)ce+=this[$],O[$++]=ce&this.DM,ce>>=this.DB;ce+=this.s}else{for(ce+=this.s;$<C.t;)ce-=C[$],O[$++]=ce&this.DM,ce>>=this.DB;ce-=C.s}O.s=ce<0?-1:0,ce<-1?O[$++]=this.DV+ce:ce>0&&(O[$++]=ce),O.t=$,O.clamp()}function Q(C,O){var $=this.abs(),ce=C.abs(),_e=$.t;for(O.t=_e+ce.t;--_e>=0;)O[_e]=0;for(_e=0;_e<ce.t;++_e)O[_e+$.t]=$.am(0,ce[_e],O,_e,0,$.t);O.s=0,O.clamp(),this.s!=C.s&&i.ZERO.subTo(O,O)}function G(C){for(var O=this.abs(),$=C.t=2*O.t;--$>=0;)C[$]=0;for($=0;$<O.t-1;++$){var ce=O.am($,O[$],C,2*$,0,1);(C[$+O.t]+=O.am($+1,2*O[$],C,2*$+1,ce,O.t-$-1))>=O.DV&&(C[$+O.t]-=O.DV,C[$+O.t+1]=1)}C.t>0&&(C[C.t-1]+=O.am($,O[$],C,2*$,0,1)),C.s=0,C.clamp()}function M(C,O,$){var ce=C.abs();if(!(ce.t<=0)){var _e=this.abs();if(_e.t<ce.t){O!=null&&O.fromInt(0),$!=null&&this.copyTo($);return}$==null&&($=n());var Se=n(),Fe=this.s,$e=C.s,Nr=this.DB-re(ce[ce.t-1]);Nr>0?(ce.lShiftTo(Nr,Se),_e.lShiftTo(Nr,$)):(ce.copyTo(Se),_e.copyTo($));var Bi=Se.t,Ds=Se[Bi-1];if(Ds!=0){var ds=Ds*(1<<this.F1)+(Bi>1?Se[Bi-2]>>this.F2:0),Ac=this.FV/ds,Cb=(1<<this.F1)/ds,To=1<<this.F2,Ro=$.t,Pb=Ro-Bi,Eu=O??n();for(Se.dlShiftTo(Pb,Eu),$.compareTo(Eu)>=0&&($[$.t++]=1,$.subTo(Eu,$)),i.ONE.dlShiftTo(Bi,Eu),Eu.subTo(Se,Se);Se.t<Bi;)Se[Se.t++]=0;for(;--Pb>=0;){var V3=$[--Ro]==Ds?this.DM:Math.floor($[Ro]*Ac+($[Ro-1]+To)*Cb);if(($[Ro]+=Se.am(0,V3,$,Pb,0,Bi))<V3)for(Se.dlShiftTo(Pb,Eu),$.subTo(Eu,$);$[Ro]<--V3;)$.subTo(Eu,$)}O!=null&&($.drShiftTo(Bi,O),Fe!=$e&&i.ZERO.subTo(O,O)),$.t=Bi,$.clamp(),Nr>0&&$.rShiftTo(Nr,$),Fe<0&&i.ZERO.subTo($,$)}}}function v(C){var O=n();return this.abs().divRemTo(C,null,O),this.s<0&&O.compareTo(i.ZERO)>0&&C.subTo(O,O),O}function V(C){this.m=C}function de(C){return C.s<0||C.compareTo(this.m)>=0?C.mod(this.m):C}function J(C){return C}function ue(C){C.divRemTo(this.m,null,C)}function S(C,O,$){C.multiplyTo(O,$),this.reduce($)}function A(C,O){C.squareTo(O),this.reduce(O)}V.prototype.convert=de,V.prototype.revert=J,V.prototype.reduce=ue,V.prototype.mulTo=S,V.prototype.sqrTo=A;function ie(){if(this.t<1)return 0;var C=this[0];if((C&1)==0)return 0;var O=C&3;return O=O*(2-(C&15)*O)&15,O=O*(2-(C&255)*O)&255,O=O*(2-((C&65535)*O&65535))&65535,O=O*(2-C*O%this.DV)%this.DV,O>0?this.DV-O:-O}function ae(C){this.m=C,this.mp=C.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<C.DB-15)-1,this.mt2=2*C.t}function E(C){var O=n();return C.abs().dlShiftTo(this.m.t,O),O.divRemTo(this.m,null,O),C.s<0&&O.compareTo(i.ZERO)>0&&this.m.subTo(O,O),O}function I(C){var O=n();return C.copyTo(O),this.reduce(O),O}function j(C){for(;C.t<=this.mt2;)C[C.t++]=0;for(var O=0;O<this.m.t;++O){var $=C[O]&32767,ce=$*this.mpl+(($*this.mph+(C[O]>>15)*this.mpl&this.um)<<15)&C.DM;for($=O+this.m.t,C[$]+=this.m.am(0,ce,C,O,0,this.m.t);C[$]>=C.DV;)C[$]-=C.DV,C[++$]++}C.clamp(),C.drShiftTo(this.m.t,C),C.compareTo(this.m)>=0&&C.subTo(this.m,C)}function H(C,O){C.squareTo(O),this.reduce(O)}function T(C,O,$){C.multiplyTo(O,$),this.reduce($)}ae.prototype.convert=E,ae.prototype.revert=I,ae.prototype.reduce=j,ae.prototype.mulTo=T,ae.prototype.sqrTo=H;function K(){return(this.t>0?this[0]&1:this.s)==0}function F(C,O){if(C>4294967295||C<1)return i.ONE;var $=n(),ce=n(),_e=O.convert(this),Se=re(C)-1;for(_e.copyTo($);--Se>=0;)if(O.sqrTo($,ce),(C&1<<Se)>0)O.mulTo(ce,_e,$);else{var Fe=$;$=ce,ce=Fe}return O.revert($)}function N(C,O){var $;return C<256||O.isEven()?$=new V(O):$=new ae(O),this.exp(C,$)}i.prototype.copyTo=x,i.prototype.fromInt=_,i.prototype.fromString=q,i.prototype.clamp=X,i.prototype.dlShiftTo=b,i.prototype.drShiftTo=w,i.prototype.lShiftTo=R,i.prototype.rShiftTo=B,i.prototype.subTo=U,i.prototype.multiplyTo=Q,i.prototype.squareTo=G,i.prototype.divRemTo=M,i.prototype.invDigit=ie,i.prototype.isEven=K,i.prototype.exp=F,i.prototype.toString=W,i.prototype.negate=z,i.prototype.abs=Z,i.prototype.compareTo=ee,i.prototype.bitLength=L,i.prototype.mod=v,i.prototype.modPowInt=N,i.ZERO=P(0),i.ONE=P(1);function Y(){var C=n();return this.copyTo(C),C}function ne(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function te(){return this.t==0?this.s:this[0]<<24>>24}function he(){return this.t==0?this.s:this[0]<<16>>16}function me(C){return Math.floor(Math.LN2*this.DB/Math.log(C))}function fe(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function je(C){if(C==null&&(C=10),this.signum()==0||C<2||C>36)return"0";var O=this.chunkSize(C),$=Math.pow(C,O),ce=P($),_e=n(),Se=n(),Fe="";for(this.divRemTo(ce,_e,Se);_e.signum()>0;)Fe=($+Se.intValue()).toString(C).substr(1)+Fe,_e.divRemTo(ce,_e,Se);return Se.intValue().toString(C)+Fe}function Ae(C,O){this.fromInt(0),O==null&&(O=10);for(var $=this.chunkSize(O),ce=Math.pow(O,$),_e=!1,Se=0,Fe=0,$e=0;$e<C.length;++$e){var Nr=m(C,$e);if(Nr<0){C.charAt($e)=="-"&&this.signum()==0&&(_e=!0);continue}Fe=O*Fe+Nr,++Se>=$&&(this.dMultiply(ce),this.dAddOffset(Fe,0),Se=0,Fe=0)}Se>0&&(this.dMultiply(Math.pow(O,Se)),this.dAddOffset(Fe,0)),_e&&i.ZERO.subTo(this,this)}function Ve(C,O,$){if(typeof O=="number")if(C<2)this.fromInt(1);else for(this.fromNumber(C,$),this.testBit(C-1)||this.bitwiseTo(i.ONE.shiftLeft(C-1),mt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(O);)this.dAddOffset(2,0),this.bitLength()>C&&this.subTo(i.ONE.shiftLeft(C-1),this);else{var ce=new Array,_e=C&7;ce.length=(C>>3)+1,O.nextBytes(ce),_e>0?ce[0]&=(1<<_e)-1:ce[0]=0,this.fromString(ce,256)}}function Xe(){var C=this.t,O=new Array;O[0]=this.s;var $=this.DB-C*this.DB%8,ce,_e=0;if(C-- >0)for($<this.DB&&(ce=this[C]>>$)!=(this.s&this.DM)>>$&&(O[_e++]=ce|this.s<<this.DB-$);C>=0;)$<8?(ce=(this[C]&(1<<$)-1)<<8-$,ce|=this[--C]>>($+=this.DB-8)):(ce=this[C]>>($-=8)&255,$<=0&&($+=this.DB,--C)),(ce&128)!=0&&(ce|=-256),_e==0&&(this.s&128)!=(ce&128)&&++_e,(_e>0||ce!=this.s)&&(O[_e++]=ce);return O}function Ge(C){return this.compareTo(C)==0}function ve(C){return this.compareTo(C)<0?this:C}function at(C){return this.compareTo(C)>0?this:C}function St(C,O,$){var ce,_e,Se=Math.min(C.t,this.t);for(ce=0;ce<Se;++ce)$[ce]=O(this[ce],C[ce]);if(C.t<this.t){for(_e=C.s&this.DM,ce=Se;ce<this.t;++ce)$[ce]=O(this[ce],_e);$.t=this.t}else{for(_e=this.s&this.DM,ce=Se;ce<C.t;++ce)$[ce]=O(_e,C[ce]);$.t=C.t}$.s=O(this.s,C.s),$.clamp()}function kt(C,O){return C&O}function Fr(C){var O=n();return this.bitwiseTo(C,kt,O),O}function mt(C,O){return C|O}function Ie(C){var O=n();return this.bitwiseTo(C,mt,O),O}function tr(C,O){return C^O}function Ze(C){var O=n();return this.bitwiseTo(C,tr,O),O}function Kt(C,O){return C&~O}function cs(C){var O=n();return this.bitwiseTo(C,Kt,O),O}function Gt(){for(var C=n(),O=0;O<this.t;++O)C[O]=this.DM&~this[O];return C.t=this.t,C.s=~this.s,C}function De(C){var O=n();return C<0?this.rShiftTo(-C,O):this.lShiftTo(C,O),O}function us(C){var O=n();return C<0?this.lShiftTo(-C,O):this.rShiftTo(C,O),O}function $t(C){if(C==0)return-1;var O=0;return(C&65535)==0&&(C>>=16,O+=16),(C&255)==0&&(C>>=8,O+=8),(C&15)==0&&(C>>=4,O+=4),(C&3)==0&&(C>>=2,O+=2),(C&1)==0&&++O,O}function Wt(){for(var C=0;C<this.t;++C)if(this[C]!=0)return C*this.DB+$t(this[C]);return this.s<0?this.t*this.DB:-1}function fs(C){for(var O=0;C!=0;)C&=C-1,++O;return O}function Yt(){for(var C=0,O=this.s&this.DM,$=0;$<this.t;++$)C+=fs(this[$]^O);return C}function yt(C){var O=Math.floor(C/this.DB);return O>=this.t?this.s!=0:(this[O]&1<<C%this.DB)!=0}function So(C,O){var $=i.ONE.shiftLeft(C);return this.bitwiseTo($,O,$),$}function ar(C){return this.changeBit(C,mt)}function cr(C){return this.changeBit(C,Kt)}function xo(C){return this.changeBit(C,tr)}function Ye(C,O){for(var $=0,ce=0,_e=Math.min(C.t,this.t);$<_e;)ce+=this[$]+C[$],O[$++]=ce&this.DM,ce>>=this.DB;if(C.t<this.t){for(ce+=C.s;$<this.t;)ce+=this[$],O[$++]=ce&this.DM,ce>>=this.DB;ce+=this.s}else{for(ce+=this.s;$<C.t;)ce+=C[$],O[$++]=ce&this.DM,ce>>=this.DB;ce+=C.s}O.s=ce<0?-1:0,ce>0?O[$++]=ce:ce<-1&&(O[$++]=this.DV+ce),O.t=$,O.clamp()}function ur(C){var O=n();return this.addTo(C,O),O}function Ao(C){var O=n();return this.subTo(C,O),O}function fr(C){var O=n();return this.multiplyTo(C,O),O}function Xt(){var C=n();return this.squareTo(C),C}function ls(C){var O=n();return this.divRemTo(C,O,null),O}function Jt(C){var O=n();return this.divRemTo(C,null,O),O}function Qt(C){var O=n(),$=n();return this.divRemTo(C,O,$),new Array(O,$)}function rt(C){this[this.t]=this.am(0,C-1,this,0,0,this.t),++this.t,this.clamp()}function Zt(C,O){if(C!=0){for(;this.t<=O;)this[this.t++]=0;for(this[O]+=C;this[O]>=this.DV;)this[O]-=this.DV,++O>=this.t&&(this[this.t++]=0),++this[O]}}function Ct(){}function xn(C){return C}function Fn(C,O,$){C.multiplyTo(O,$)}function Un(C,O){C.squareTo(O)}Ct.prototype.convert=xn,Ct.prototype.revert=xn,Ct.prototype.mulTo=Fn,Ct.prototype.sqrTo=Un;function Kn(C){return this.exp(C,new Ct)}function jn(C,O,$){var ce=Math.min(this.t+C.t,O);for($.s=0,$.t=ce;ce>0;)$[--ce]=0;var _e;for(_e=$.t-this.t;ce<_e;++ce)$[ce+this.t]=this.am(0,C[ce],$,ce,0,this.t);for(_e=Math.min(C.t,O);ce<_e;++ce)this.am(0,C[ce],$,ce,0,O-ce);$.clamp()}function Vn(C,O,$){--O;var ce=$.t=this.t+C.t-O;for($.s=0;--ce>=0;)$[ce]=0;for(ce=Math.max(O-this.t,0);ce<C.t;++ce)$[this.t+ce-O]=this.am(O-ce,C[ce],$,0,0,this.t+ce-O);$.clamp(),$.drShiftTo(1,$)}function ze(C){this.r2=n(),this.q3=n(),i.ONE.dlShiftTo(2*C.t,this.r2),this.mu=this.r2.divide(C),this.m=C}function zn(C){if(C.s<0||C.t>2*this.m.t)return C.mod(this.m);if(C.compareTo(this.m)<0)return C;var O=n();return C.copyTo(O),this.reduce(O),O}function xc(C){return C}function k(C){for(C.drShiftTo(this.m.t-1,this.r2),C.t>this.m.t+1&&(C.t=this.m.t+1,C.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);C.compareTo(this.r2)<0;)C.dAddOffset(1,this.m.t+1);for(C.subTo(this.r2,C);C.compareTo(this.m)>=0;)C.subTo(this.m,C)}function qe(C,O){C.squareTo(O),this.reduce(O)}function Le(C,O,$){C.multiplyTo(O,$),this.reduce($)}ze.prototype.convert=zn,ze.prototype.revert=xc,ze.prototype.reduce=k,ze.prototype.mulTo=Le,ze.prototype.sqrTo=qe;function Pe(C,O){var $=C.bitLength(),ce,_e=P(1),Se;if($<=0)return _e;$<18?ce=1:$<48?ce=3:$<144?ce=4:$<768?ce=5:ce=6,$<8?Se=new V(O):O.isEven()?Se=new ze(O):Se=new ae(O);var Fe=new Array,$e=3,Nr=ce-1,Bi=(1<<ce)-1;if(Fe[1]=Se.convert(this),ce>1){var Ds=n();for(Se.sqrTo(Fe[1],Ds);$e<=Bi;)Fe[$e]=n(),Se.mulTo(Ds,Fe[$e-2],Fe[$e]),$e+=2}var ds=C.t-1,Ac,Cb=!0,To=n(),Ro;for($=re(C[ds])-1;ds>=0;){for($>=Nr?Ac=C[ds]>>$-Nr&Bi:(Ac=(C[ds]&(1<<$+1)-1)<<Nr-$,ds>0&&(Ac|=C[ds-1]>>this.DB+$-Nr)),$e=ce;(Ac&1)==0;)Ac>>=1,--$e;if(($-=$e)<0&&($+=this.DB,--ds),Cb)Fe[Ac].copyTo(_e),Cb=!1;else{for(;$e>1;)Se.sqrTo(_e,To),Se.sqrTo(To,_e),$e-=2;$e>0?Se.sqrTo(_e,To):(Ro=_e,_e=To,To=Ro),Se.mulTo(To,Fe[Ac],_e)}for(;ds>=0&&(C[ds]&1<<$)==0;)Se.sqrTo(_e,To),Ro=_e,_e=To,To=Ro,--$<0&&($=this.DB-1,--ds)}return Se.revert(_e)}function An(C){var O=this.s<0?this.negate():this.clone(),$=C.s<0?C.negate():C.clone();if(O.compareTo($)<0){var ce=O;O=$,$=ce}var _e=O.getLowestSetBit(),Se=$.getLowestSetBit();if(Se<0)return O;for(_e<Se&&(Se=_e),Se>0&&(O.rShiftTo(Se,O),$.rShiftTo(Se,$));O.signum()>0;)(_e=O.getLowestSetBit())>0&&O.rShiftTo(_e,O),(_e=$.getLowestSetBit())>0&&$.rShiftTo(_e,$),O.compareTo($)>=0?(O.subTo($,O),O.rShiftTo(1,O)):($.subTo(O,$),$.rShiftTo(1,$));return Se>0&&$.lShiftTo(Se,$),$}function Qi(C){if(C<=0)return 0;var O=this.DV%C,$=this.s<0?C-1:0;if(this.t>0)if(O==0)$=this[0]%C;else for(var ce=this.t-1;ce>=0;--ce)$=(O*$+this[ce])%C;return $}function Mf(C){var O=C.isEven();if(this.isEven()&&O||C.signum()==0)return i.ZERO;for(var $=C.clone(),ce=this.clone(),_e=P(1),Se=P(0),Fe=P(0),$e=P(1);$.signum()!=0;){for(;$.isEven();)$.rShiftTo(1,$),O?((!_e.isEven()||!Se.isEven())&&(_e.addTo(this,_e),Se.subTo(C,Se)),_e.rShiftTo(1,_e)):Se.isEven()||Se.subTo(C,Se),Se.rShiftTo(1,Se);for(;ce.isEven();)ce.rShiftTo(1,ce),O?((!Fe.isEven()||!$e.isEven())&&(Fe.addTo(this,Fe),$e.subTo(C,$e)),Fe.rShiftTo(1,Fe)):$e.isEven()||$e.subTo(C,$e),$e.rShiftTo(1,$e);$.compareTo(ce)>=0?($.subTo(ce,$),O&&_e.subTo(Fe,_e),Se.subTo($e,Se)):(ce.subTo($,ce),O&&Fe.subTo(_e,Fe),$e.subTo(Se,$e))}if(ce.compareTo(i.ONE)!=0)return i.ZERO;if($e.compareTo(C)>=0)return $e.subtract(C);if($e.signum()<0)$e.addTo(C,$e);else return $e;return $e.signum()<0?$e.add(C):$e}var mi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],H0=(1<<26)/mi[mi.length-1];function G0(C){var O,$=this.abs();if($.t==1&&$[0]<=mi[mi.length-1]){for(O=0;O<mi.length;++O)if($[0]==mi[O])return!0;return!1}if($.isEven())return!1;for(O=1;O<mi.length;){for(var ce=mi[O],_e=O+1;_e<mi.length&&ce<H0;)ce*=mi[_e++];for(ce=$.modInt(ce);O<_e;)if(ce%mi[O++]==0)return!1}return $.millerRabin(C)}function I_e(C){var O=this.subtract(i.ONE),$=O.getLowestSetBit();if($<=0)return!1;var ce=O.shiftRight($);C=C+1>>1,C>mi.length&&(C=mi.length);for(var _e=n(),Se=0;Se<C;++Se){_e.fromInt(mi[Math.floor(Math.random()*mi.length)]);var Fe=_e.modPow(ce,this);if(Fe.compareTo(i.ONE)!=0&&Fe.compareTo(O)!=0){for(var $e=1;$e++<$&&Fe.compareTo(O)!=0;)if(Fe=Fe.modPowInt(2,this),Fe.compareTo(i.ONE)==0)return!1;if(Fe.compareTo(O)!=0)return!1}}return!0}i.prototype.chunkSize=me,i.prototype.toRadix=je,i.prototype.fromRadix=Ae,i.prototype.fromNumber=Ve,i.prototype.bitwiseTo=St,i.prototype.changeBit=So,i.prototype.addTo=Ye,i.prototype.dMultiply=rt,i.prototype.dAddOffset=Zt,i.prototype.multiplyLowerTo=jn,i.prototype.multiplyUpperTo=Vn,i.prototype.modInt=Qi,i.prototype.millerRabin=I_e,i.prototype.clone=Y,i.prototype.intValue=ne,i.prototype.byteValue=te,i.prototype.shortValue=he,i.prototype.signum=fe,i.prototype.toByteArray=Xe,i.prototype.equals=Ge,i.prototype.min=ve,i.prototype.max=at,i.prototype.and=Fr,i.prototype.or=Ie,i.prototype.xor=Ze,i.prototype.andNot=cs,i.prototype.not=Gt,i.prototype.shiftLeft=De,i.prototype.shiftRight=us,i.prototype.getLowestSetBit=Wt,i.prototype.bitCount=Yt,i.prototype.testBit=yt,i.prototype.setBit=ar,i.prototype.clearBit=cr,i.prototype.flipBit=xo,i.prototype.add=ur,i.prototype.subtract=Ao,i.prototype.multiply=fr,i.prototype.divide=ls,i.prototype.remainder=Jt,i.prototype.divideAndRemainder=Qt,i.prototype.modPow=Pe,i.prototype.modInverse=Mf,i.prototype.pow=Kn,i.prototype.gcd=An,i.prototype.isProbablePrime=G0,i.prototype.square=Xt,i.prototype.Barrett=ze;var kb,hs,Oi;function T_e(C){hs[Oi++]^=C&255,hs[Oi++]^=C>>8&255,hs[Oi++]^=C>>16&255,hs[Oi++]^=C>>24&255,Oi>=j3&&(Oi-=j3)}function iP(){T_e(new Date().getTime())}if(hs==null){hs=new Array,Oi=0;var Io;if(typeof window!="undefined"&&window.crypto){if(window.crypto.getRandomValues){var nP=new Uint8Array(32);for(window.crypto.getRandomValues(nP),Io=0;Io<32;++Io)hs[Oi++]=nP[Io]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var sP=window.crypto.random(32);for(Io=0;Io<sP.length;++Io)hs[Oi++]=sP.charCodeAt(Io)&255}}for(;Oi<j3;)Io=Math.floor(65536*Math.random()),hs[Oi++]=Io>>>8,hs[Oi++]=Io&255;Oi=0,iP()}function R_e(){if(kb==null){for(iP(),kb=O_e(),kb.init(hs),Oi=0;Oi<hs.length;++Oi)hs[Oi]=0;Oi=0}return kb.next()}function k_e(C){var O;for(O=0;O<C.length;++O)C[O]=R_e()}function U3(){}U3.prototype.nextBytes=k_e;function K3(){this.i=0,this.j=0,this.S=new Array}function C_e(C){var O,$,ce;for(O=0;O<256;++O)this.S[O]=O;for($=0,O=0;O<256;++O)$=$+this.S[O]+C[O%C.length]&255,ce=this.S[O],this.S[O]=this.S[$],this.S[$]=ce;this.i=0,this.j=0}function P_e(){var C;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,C=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=C,this.S[C+this.S[this.i]&255]}K3.prototype.init=C_e,K3.prototype.next=P_e;function O_e(){return new K3}var j3=256;typeof vE!="undefined"?vE=Y0e.exports={default:i,BigInteger:i,SecureRandom:U3}:this.jsbn={BigInteger:i,SecureRandom:U3}}).call(vE)});var H1=p(wE=>{l();(function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return i(s(o),arguments)}function t(o,a){return e.apply(null,[o].concat(a||[]))}function i(o,a){var c=1,u=o.length,f,h="",d,y,g,m,x,_,P,q;for(d=0;d<u;d++)if(typeof o[d]=="string")h+=o[d];else if(typeof o[d]=="object"){if(g=o[d],g.keys)for(f=a[c],y=0;y<g.keys.length;y++){if(f==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',g.keys[y],g.keys[y-1]));f=f[g.keys[y]]}else g.param_no?f=a[g.param_no]:f=a[c++];if(r.not_type.test(g.type)&&r.not_primitive.test(g.type)&&f instanceof Function&&(f=f()),r.numeric_arg.test(g.type)&&typeof f!="number"&&isNaN(f))throw new TypeError(e("[sprintf] expecting number but found %T",f));switch(r.number.test(g.type)&&(P=f>=0),g.type){case"b":f=parseInt(f,10).toString(2);break;case"c":f=String.fromCharCode(parseInt(f,10));break;case"d":case"i":f=parseInt(f,10);break;case"j":f=JSON.stringify(f,null,g.width?parseInt(g.width):0);break;case"e":f=g.precision?parseFloat(f).toExponential(g.precision):parseFloat(f).toExponential();break;case"f":f=g.precision?parseFloat(f).toFixed(g.precision):parseFloat(f);break;case"g":f=g.precision?String(Number(f.toPrecision(g.precision))):parseFloat(f);break;case"o":f=(parseInt(f,10)>>>0).toString(8);break;case"s":f=String(f),f=g.precision?f.substring(0,g.precision):f;break;case"t":f=String(!!f),f=g.precision?f.substring(0,g.precision):f;break;case"T":f=Object.prototype.toString.call(f).slice(8,-1).toLowerCase(),f=g.precision?f.substring(0,g.precision):f;break;case"u":f=parseInt(f,10)>>>0;break;case"v":f=f.valueOf(),f=g.precision?f.substring(0,g.precision):f;break;case"x":f=(parseInt(f,10)>>>0).toString(16);break;case"X":f=(parseInt(f,10)>>>0).toString(16).toUpperCase();break}r.json.test(g.type)?h+=f:(r.number.test(g.type)&&(!P||g.sign)?(q=P?"+":"-",f=f.toString().replace(r.sign,"")):q="",x=g.pad_char?g.pad_char==="0"?"0":g.pad_char.charAt(1):" ",_=g.width-(q+f).length,m=g.width&&_>0?x.repeat(_):"",h+=g.align?q+f+m:x==="0"?q+m+f:m+q+f)}return h}var n=Object.create(null);function s(o){if(n[o])return n[o];for(var a=o,c,u=[],f=0;a;){if((c=r.text.exec(a))!==null)u.push(c[0]);else if((c=r.modulo.exec(a))!==null)u.push("%");else if((c=r.placeholder.exec(a))!==null){if(c[2]){f|=1;var h=[],d=c[2],y=[];if((y=r.key.exec(d))!==null)for(h.push(y[1]);(d=d.substring(y[0].length))!=="";)if((y=r.key_access.exec(d))!==null)h.push(y[1]);else if((y=r.index_access.exec(d))!==null)h.push(y[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=h}else f|=2;if(f===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");u.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(c[0].length)}return n[o]=u}typeof wE!="undefined"&&(wE.sprintf=e,wE.vsprintf=t),typeof window!="undefined"&&(window.sprintf=e,window.vsprintf=t,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:t}}))})()});var GR=p(pc=>{l();"use strict";var wnt=pc&&pc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),_nt=pc&&pc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),X0e=pc&&pc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&wnt(e,r,t);return _nt(e,r),e};Object.defineProperty(pc,"__esModule",{value:!0});pc.Address4=void 0;var J0e=X0e(jR()),ha=X0e(VR()),Q0e=zR(),G1=HR(),$1=H1(),Ent=function(){function r(e){this.groups=ha.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=J0e.isCorrect(ha.BITS),this.isInSubnet=J0e.isInSubnet,this.address=e;var t=ha.RE_SUBNET_STRING.exec(e);if(t){if(this.parsedSubnet=t[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>ha.BITS)throw new Q0e.AddressError("Invalid subnet mask.");e=e.replace(ha.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.prototype.parse=function(e){var t=e.split(".");if(!e.match(ha.RE_ADDRESS))throw new Q0e.AddressError("Invalid IPv4 address.");return t},r.prototype.correctForm=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)}).join(".")},r.fromHex=function(e){var t=e.replace(/:/g,"").padStart(8,"0"),i=[],n;for(n=0;n<8;n+=2){var s=t.slice(n,n+2);i.push(parseInt(s,16))}return new r(i.join("."))},r.fromInteger=function(e){return r.fromHex(e.toString(16))},r.prototype.toHex=function(){return this.parsedAddress.map(function(e){return $1.sprintf("%02x",parseInt(e,10))}).join(":")},r.prototype.toArray=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)})},r.prototype.toGroup6=function(){var e=[],t;for(t=0;t<ha.GROUPS;t+=2){var i=$1.sprintf("%02x%02x",parseInt(this.parsedAddress[t],10),parseInt(this.parsedAddress[t+1],10));e.push($1.sprintf("%x",parseInt(i,16)))}return e.join(":")},r.prototype.bigInteger=function(){return new G1.BigInteger(this.parsedAddress.map(function(e){return $1.sprintf("%02x",parseInt(e,10))}).join(""),16)},r.prototype._startAddress=function(){return new G1.BigInteger(this.mask()+"0".repeat(ha.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new G1.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new G1.BigInteger(this.mask()+"1".repeat(ha.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new G1.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.fromBigInteger=function(e){return r.fromInteger(parseInt(e.toString(),10))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.isMulticast=function(){return this.isInSubnet(new r("224.0.0.0/4"))},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(ha.BITS,"0")},r.prototype.groupForV6=function(){var e=this.parsedAddress;return this.address.replace(ha.RE_ADDRESS,$1.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))},r}();pc.Address4=Ent});var $R=p(ti=>{l();"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.RE_URL_WITH_PORT=ti.RE_URL=ti.RE_ZONE_STRING=ti.RE_SUBNET_STRING=ti.RE_BAD_ADDRESS=ti.RE_BAD_CHARACTERS=ti.TYPES=ti.SCOPES=ti.GROUPS=ti.BITS=void 0;ti.BITS=128;ti.GROUPS=8;ti.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};ti.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};ti.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;ti.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;ti.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;ti.RE_ZONE_STRING=/%.*$/;ti.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);ti.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var WR=p(yc=>{l();"use strict";Object.defineProperty(yc,"__esModule",{value:!0});yc.simpleGroup=yc.spanLeadingZeroes=yc.spanAll=yc.spanAllZeroes=void 0;var Z0e=H1();function eye(r){return r.replace(/(0+)/g,'<span class="zero">$1</span>')}yc.spanAllZeroes=eye;function Snt(r,e){e===void 0&&(e=0);var t=r.split("");return t.map(function(i,n){return Z0e.sprintf('<span class="digit value-%s position-%d">%s</span>',i,n+e,eye(i))}).join("")}yc.spanAll=Snt;function tye(r){return r.replace(/^(0+)/,'<span class="zero">$1</span>')}function xnt(r){var e=r.split(":");return e.map(function(t){return tye(t)}).join(":")}yc.spanLeadingZeroes=xnt;function Ant(r,e){e===void 0&&(e=0);var t=r.split(":");return t.map(function(i,n){return/group-v4/.test(i)?i:Z0e.sprintf('<span class="hover-group group-%d">%s</span>',n+e,tye(i))})}yc.simpleGroup=Ant});var rye=p(Ji=>{l();"use strict";var Int=Ji&&Ji.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Tnt=Ji&&Ji.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Rnt=Ji&&Ji.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Int(e,r,t);return Tnt(e,r),e};Object.defineProperty(Ji,"__esModule",{value:!0});Ji.possibleElisions=Ji.simpleRegularExpression=Ji.ADDRESS_BOUNDARY=Ji.padGroup=Ji.groupPossibilities=void 0;var knt=Rnt($R()),_0=H1();function _E(r){return _0.sprintf("(%s)",r.join("|"))}Ji.groupPossibilities=_E;function EE(r){return r.length<4?_0.sprintf("0{0,%d}%s",4-r.length,r):r}Ji.padGroup=EE;Ji.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function Cnt(r){var e=[];r.forEach(function(i,n){var s=parseInt(i,16);s===0&&e.push(n)});var t=e.map(function(i){return r.map(function(n,s){if(s===i){var o=s===0||s===knt.GROUPS-1?":":"";return _E([EE(n),o])}return EE(n)}).join(":")});return t.push(r.map(EE).join(":")),_E(t)}Ji.simpleRegularExpression=Cnt;function Pnt(r,e,t){var i=e?"":":",n=t?"":":",s=[];!e&&!t&&s.push("::"),e&&t&&s.push(""),(t&&!e||!t&&e)&&s.push(":"),s.push(_0.sprintf("%s(:0{1,4}){1,%d}",i,r-1)),s.push(_0.sprintf("(0{1,4}:){1,%d}%s",r-1,n)),s.push(_0.sprintf("(0{1,4}:){%d}0{1,4}",r-1));for(var o=1;o<r-1;o++)for(var a=1;a<r-o;a++)s.push(_0.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",a,r-a-o-1));return _E(s)}Ji.possibleElisions=Pnt});var oye=p(go=>{l();"use strict";var Ont=go&&go.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Bnt=go&&go.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),SE=go&&go.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ont(e,r,t);return Bnt(e,r),e},Nnt=go&&go.__spreadArrays||function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),n=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i};Object.defineProperty(go,"__esModule",{value:!0});go.Address6=void 0;var iye=SE(jR()),YR=SE(VR()),Pr=SE($R()),XR=SE(WR()),yh=GR(),gh=rye(),lu=zR(),qn=HR(),Mn=H1();function xE(r){if(!r)throw new Error("Assertion failed.")}function Dnt(r){for(var e=/(\d+)(\d{3})/;e.test(r);)r=r.replace(e,"$1,$2");return r}function qnt(r){return r=r.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),r=r.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),r}function Mnt(r,e){var t=[],i=[],n;for(n=0;n<r.length;n++)n<e[0]?t.push(r[n]):n>e[1]&&i.push(r[n]);return t.concat(["compact"]).concat(i)}function nye(r){return Mn.sprintf("%04x",parseInt(r,16))}function sye(r){return r&255}var Lnt=function(){function r(e,t){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=iye.isInSubnet,this.isCorrect=iye.isCorrect(Pr.BITS),t===void 0?this.groups=Pr.GROUPS:this.groups=t,this.address=e;var i=Pr.RE_SUBNET_STRING.exec(e);if(i){if(this.parsedSubnet=i[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>Pr.BITS)throw new lu.AddressError("Invalid subnet mask.");e=e.replace(Pr.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new lu.AddressError("Invalid subnet mask.");var n=Pr.RE_ZONE_STRING.exec(e);n&&(this.zone=n[0],e=e.replace(Pr.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.fromBigInteger=function(e){var t=e.toString(16).padStart(32,"0"),i=[],n;for(n=0;n<Pr.GROUPS;n++)i.push(t.slice(n*4,(n+1)*4));return new r(i.join(":"))},r.fromURL=function(e){var t,i=null,n;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(n=Pr.RE_URL_WITH_PORT.exec(e),n===null)return{error:"failed to parse address with port",address:null,port:null};t=n[1],i=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),n=Pr.RE_URL.exec(e),n===null)return{error:"failed to parse address from URL",address:null,port:null};t=n[1]}else t=e;return i?(i=parseInt(i,10),(i<0||i>65536)&&(i=null)):i=null,{address:new r(t),port:i}},r.fromAddress4=function(e){var t=new yh.Address4(e),i=Pr.BITS-(YR.BITS-t.subnetMask);return new r("::ffff:"+t.correctForm()+"/"+i)},r.fromArpa=function(e){var t=e.replace(/(\.ip6\.arpa)?\.$/,""),i=7;if(t.length!==63)throw new lu.AddressError("Invalid 'ip6.arpa' form.");for(var n=t.split(".").reverse(),s=i;s>0;s--){var o=s*4;n.splice(o,0,":")}return t=n.join(""),new r(t)},r.prototype.microsoftTranscription=function(){return Mn.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.possibleSubnets=function(e){e===void 0&&(e=128);var t=Pr.BITS-this.subnetMask,i=Math.abs(e-Pr.BITS),n=t-i;return n<0?"0":Dnt(new qn.BigInteger("2",10).pow(n).toString(10))},r.prototype._startAddress=function(){return new qn.BigInteger(this.mask()+"0".repeat(Pr.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new qn.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new qn.BigInteger(this.mask()+"1".repeat(Pr.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new qn.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.prototype.getScope=function(){var e=Pr.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"},r.prototype.getType=function(){for(var e=0,t=Object.keys(Pr.TYPES);e<t.length;e++){var i=t[e];if(this.isInSubnet(new r(i)))return Pr.TYPES[i]}return"Global unicast"},r.prototype.getBits=function(e,t){return new qn.BigInteger(this.getBitsBase2(e,t),2)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.getBitsBase16=function(e,t){var i=t-e;if(i%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,t).toString(16).padStart(i/4,"0")},r.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,Pr.BITS)},r.prototype.reverseForm=function(e){e||(e={});var t=Math.floor(this.subnetMask/4),i=this.canonicalForm().replace(/:/g,"").split("").slice(0,t).reverse().join(".");return t>0?e.omitSuffix?i:Mn.sprintf("%s.ip6.arpa.",i):e.omitSuffix?"":"ip6.arpa."},r.prototype.correctForm=function(){var e,t=[],i=0,n=[];for(e=0;e<this.parsedAddress.length;e++){var s=parseInt(this.parsedAddress[e],16);s===0&&i++,s!==0&&i>0&&(i>1&&n.push([e-i,e-1]),i=0)}i>1&&n.push([this.parsedAddress.length-i,this.parsedAddress.length-1]);var o=n.map(function(u){return u[1]-u[0]+1});if(n.length>0){var a=o.indexOf(Math.max.apply(Math,o));t=Mnt(this.parsedAddress,n[a])}else t=this.parsedAddress;for(e=0;e<t.length;e++)t[e]!=="compact"&&(t[e]=parseInt(t[e],16).toString(16));var c=t.join(":");return c=c.replace(/^compact$/,"::"),c=c.replace(/^compact|compact$/,":"),c=c.replace(/compact/,""),c},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(Pr.BITS,"0")},r.prototype.parse4in6=function(e){var t=e.split(":"),i=t.slice(-1)[0],n=i.match(YR.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new yh.Address4(this.parsedAddress4);for(var s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new lu.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(YR.RE_ADDRESS,this.address4.parsedAddress.map(qnt).join(".")));this.v4=!0,t[t.length-1]=this.address4.toGroup6(),e=t.join(":")}return e},r.prototype.parse=function(e){e=this.parse4in6(e);var t=e.match(Pr.RE_BAD_CHARACTERS);if(t)throw new lu.AddressError(Mn.sprintf("Bad character%s detected in address: %s",t.length>1?"s":"",t.join("")),e.replace(Pr.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var i=e.match(Pr.RE_BAD_ADDRESS);if(i)throw new lu.AddressError(Mn.sprintf("Address failed regex: %s",i.join("")),e.replace(Pr.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],s=e.split("::");if(s.length===2){var o=s[0].split(":"),a=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),a.length===1&&a[0]===""&&(a=[]);var c=this.groups-(o.length+a.length);if(!c)throw new lu.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,n=n.concat(o);for(var u=0;u<c;u++)n.push("0");n=n.concat(a)}else if(s.length===1)n=e.split(":"),this.elidedGroups=0;else throw new lu.AddressError("Too many :: groups found");if(n=n.map(function(f){return Mn.sprintf("%x",parseInt(f,16))}),n.length!==this.groups)throw new lu.AddressError("Incorrect number of groups found");return n},r.prototype.canonicalForm=function(){return this.parsedAddress.map(nye).join(":")},r.prototype.decimal=function(){return this.parsedAddress.map(function(e){return Mn.sprintf("%05d",parseInt(e,16))}).join(":")},r.prototype.bigInteger=function(){return new qn.BigInteger(this.parsedAddress.map(nye).join(""),16)},r.prototype.to4=function(){var e=this.binaryZeroPad().split("");return yh.Address4.fromHex(new qn.BigInteger(e.slice(96,128).join(""),2).toString(16))},r.prototype.to4in6=function(){var e=this.to4(),t=new r(this.parsedAddress.slice(0,6).join(":"),6),i=t.correctForm(),n="";return/:$/.test(i)||(n=":"),i+n+e.address},r.prototype.inspectTeredo=function(){var e=this.getBitsBase16(0,32),t=this.getBits(80,96).xor(new qn.BigInteger("ffff",16)).toString(),i=yh.Address4.fromHex(this.getBitsBase16(32,64)),n=yh.Address4.fromHex(this.getBits(96,128).xor(new qn.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),a=s.testBit(15),c=s.testBit(14),u=s.testBit(8),f=s.testBit(9),h=new qn.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:Mn.sprintf("%s:%s",e.slice(0,4),e.slice(4,8)),server4:i.address,client4:n.address,flags:o,coneNat:a,microsoft:{reserved:c,universalLocal:f,groupIndividual:u,nonce:h},udpPort:t}},r.prototype.inspect6to4=function(){var e=this.getBitsBase16(0,16),t=yh.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Mn.sprintf("%s",e.slice(0,4)),gateway:t.address}},r.prototype.to6to4=function(){if(!this.is4())return null;var e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new r(e)},r.prototype.toByteArray=function(){var e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e},r.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(sye)},r.fromByteArray=function(e){return this.fromUnsignedByteArray(e.map(sye))},r.fromUnsignedByteArray=function(e){for(var t=new qn.BigInteger("256",10),i=new qn.BigInteger("0",10),n=new qn.BigInteger("1",10),s=e.length-1;s>=0;s--)i=i.add(n.multiply(new qn.BigInteger(e[s].toString(10),10))),n=n.multiply(t);return r.fromBigInteger(i)},r.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},r.prototype.isLinkLocal=function(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"},r.prototype.isMulticast=function(){return this.getType()==="Multicast"},r.prototype.is4=function(){return this.v4},r.prototype.isTeredo=function(){return this.isInSubnet(new r("2001::/32"))},r.prototype.is6to4=function(){return this.isInSubnet(new r("2002::/16"))},r.prototype.isLoopback=function(){return this.getType()==="Loopback"},r.prototype.href=function(e){return e===void 0?e="":e=Mn.sprintf(":%s",e),Mn.sprintf("http://[%s]%s/",this.correctForm(),e)},r.prototype.link=function(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);var t=this.correctForm;return e.v4&&(t=this.to4in6),e.className?Mn.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,t.call(this),e.className):Mn.sprintf('<a href="%1$s%2$s">%2$s</a>',e.prefix,t.call(this))},r.prototype.group=function(){if(this.elidedGroups===0)return XR.simpleGroup(this.address).join(":");xE(typeof this.elidedGroups=="number"),xE(typeof this.elisionBegin=="number");var e=[],t=this.address.split("::"),i=t[0],n=t[1];i.length?e.push.apply(e,XR.simpleGroup(i)):e.push("");for(var s=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)s.push(Mn.sprintf("group-%d",o));return e.push(Mn.sprintf('<span class="%s"></span>',s.join(" "))),n.length?e.push.apply(e,XR.simpleGroup(n,this.elisionEnd)):e.push(""),this.is4()&&(xE(this.address4 instanceof yh.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")},r.prototype.regularExpressionString=function(e){e===void 0&&(e=!1);var t=[],i=new r(this.correctForm());if(i.elidedGroups===0)t.push(gh.simpleRegularExpression(i.parsedAddress));else if(i.elidedGroups===Pr.GROUPS)t.push(gh.possibleElisions(Pr.GROUPS));else{var n=i.address.split("::");n[0].length&&t.push(gh.simpleRegularExpression(n[0].split(":"))),xE(typeof i.elidedGroups=="number"),t.push(gh.possibleElisions(i.elidedGroups,n[0].length!==0,n[1].length!==0)),n[1].length&&t.push(gh.simpleRegularExpression(n[1].split(":"))),t=[t.join(":")]}return e||(t=Nnt(["(?=^|",gh.ADDRESS_BOUNDARY,"|[^\\w\\:])("],t,[")(?=[^\\w\\:]|",gh.ADDRESS_BOUNDARY,"|$)"])),t.join("")},r.prototype.regularExpression=function(e){return e===void 0&&(e=!1),new RegExp(this.regularExpressionString(e),"i")},r}();go.Address6=Lnt});var aye=p(ns=>{l();"use strict";var Fnt=ns&&ns.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Unt=ns&&ns.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Knt=ns&&ns.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Fnt(e,r,t);return Unt(e,r),e};Object.defineProperty(ns,"__esModule",{value:!0});ns.v6=ns.Address6=ns.Address4=void 0;var jnt=GR();Object.defineProperty(ns,"Address4",{enumerable:!0,get:function(){return jnt.Address4}});var Vnt=oye();Object.defineProperty(ns,"Address6",{enumerable:!0,get:function(){return Vnt.Address6}});var znt=Knt(WR());ns.v6={helpers:znt}});var ek=p((EAt,JR)=>{l();"use strict";var cye=xe(),Hnt=Object.assign(cye("libp2p:ip-port-to-multiaddr"),{error:cye("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:QR}=lr(),ZR=ge(),{Address4:Gnt,Address6:$nt}=aye(),AE={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function Wnt(r,e){if(typeof r!="string")throw ZR(new Error(`invalid ip provided: ${r}`),AE.ERR_INVALID_IP_PARAMETER);if(typeof e=="string"&&(e=parseInt(e)),isNaN(e))throw ZR(new Error(`invalid port provided: ${e}`),AE.ERR_INVALID_PORT_PARAMETER);try{return new Gnt(r),new QR(`/ip4/${r}/tcp/${e}`)}catch{}try{let t=new $nt(r);return t.is4()?new QR(`/ip4/${t.to4().correctForm()}/tcp/${e}`):new QR(`/ip6/${r}/tcp/${e}`)}catch(t){let i=`invalid ip:port for creating a multiaddr: ${r}:${e}`;throw Hnt.error(i),ZR(new Error(i),AE.ERR_INVALID_IP)}}JR.exports=Wnt;JR.exports.Errors=AE});var fye=p((SAt,IE)=>{l();"use strict";var tk=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},uye=(r,e,t,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===Infinity){o(r);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{o(t())}catch(f){a(f)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,u=t instanceof Error?t:new tk(c);typeof r.cancel=="function"&&r.cancel(),a(u)},e),(async()=>{try{o(await r)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};IE.exports=uye;IE.exports.default=uye;IE.exports.TimeoutError=tk});var yye=p((xAt,lye)=>{l();"use strict";var hye=cc(),{CLOSE_TIMEOUT:Ynt}=KR(),dye=ek(),Xnt=fye(),pye=xe(),rk=pye("libp2p:websockets:socket");rk.error=pye("libp2p:websockets:socket:error");lye.exports=(r,e={})=>{let t={async sink(i){e.signal&&(i=hye(i,e.signal));try{await r.sink(async function*(){for await(let n of i)yield n instanceof Uint8Array?n:n.slice()}())}catch(n){n.type!=="aborted"&&rk.error(n)}},source:e.signal?hye(r.source,e.signal):r.source,conn:r,localAddr:e.localAddr||(r.localAddress&&r.localPort?dye(r.localAddress,r.localPort):void 0),remoteAddr:e.remoteAddr||dye(r.remoteAddress,r.remotePort),timeline:{open:Date.now()},async close(){let i=Date.now();try{await Xnt(r.close(),Ynt)}catch(n){let{host:s,port:o}=t.remoteAddr.toOptions();rk("timeout closing stream to %s:%s after %dms, destroying it manually",s,o,Date.now()-i),r.destroy()}finally{t.timeline.close=Date.now()}}};return r.socket.once&&r.socket.once("close",()=>{t.timeline.close||(t.timeline.close=Date.now())}),t}});var mye=p((AAt,gye)=>{l();"use strict";var Rf=fl(),{CODE_CIRCUIT:ik,CODE_P2P:nk,CODE_TCP:sk,CODE_WS:Jnt,CODE_WSS:bye}=KR();gye.exports={all:r=>r.filter(e=>{if(e.protoCodes().includes(ik))return!1;let t=e.decapsulateCode(nk);return Rf.WebSockets.matches(t)||Rf.WebSocketsSecure.matches(t)}),dnsWss:r=>r.filter(e=>{if(e.protoCodes().includes(ik))return!1;let t=e.decapsulateCode(nk);return Rf.WebSocketsSecure.matches(t)&&Rf.DNS.matches(t.decapsulateCode(sk).decapsulateCode(bye))}),dnsWsOrWss:r=>r.filter(e=>{if(e.protoCodes().includes(ik))return!1;let t=e.decapsulateCode(nk);return Rf.WebSockets.matches(t)?Rf.DNS.matches(t.decapsulateCode(sk).decapsulateCode(Jnt)):Rf.WebSocketsSecure.matches(t)&&Rf.DNS.matches(t.decapsulateCode(sk).decapsulateCode(bye))})}});var Aye=p((IAt,vye)=>{l();"use strict";var Qnt=G0e(),Znt=Xm(),est=i5(),{AbortError:wye}=cc(),tst=k1(),_ye=xe(),kf=_ye("libp2p:websockets");kf.error=_ye("libp2p:websockets:error");var Eye=Lb(),rst=W0e(),ist=yye(),Sye=mye(),xye=class{constructor({upgrader:e,filter:t}){if(!e)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e,this._filter=t}async dial(e,t={}){kf("dialing %s",e);let i=await this._connect(e,t),n=ist(i,{remoteAddr:e,signal:t.signal});kf("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return kf("outbound connection %s upgraded",n.remoteAddr),s}async _connect(e,t={}){if(t.signal&&t.signal.aborted)throw new wye;let i=e.toOptions();kf("dialing %s:%s",i.host,i.port);let n=tst(),s=u=>{let f=`connection error: ${u.message}`;kf.error(f),n.reject(u)},o=Qnt(est(e),Object.assign({binary:!0},t));if(o.socket.on?o.socket.on("error",s):o.socket.onerror=s,!t.signal)return await Promise.race([o.connected(),n.promise]),kf("connected %s",e),o;let a,c=new Promise((u,f)=>{if(a=()=>{f(new wye),setTimeout(()=>{o.close()})},t.signal.aborted)return a();t.signal.addEventListener("abort",a)});try{await Promise.race([c,n.promise,o.connected()])}finally{t.signal.removeEventListener("abort",a)}return kf("connected %s",e),o}createListener(e={},t){return typeof e=="function"&&(t=e,e={}),rst({handler:t,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],this._filter?this._filter(e):Eye.isBrowser||Eye.isWebWorker?Sye.dnsWss(e):Sye.all(e)}};vye.exports=Znt(xye,{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})});var Tye=p((TAt,Iye)=>{l();Iye.exports=function(){if(typeof globalThis=="undefined")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var ck=p((RAt,ok)=>{l();"use strict";var ak=65536,nst=4294967295;function sst(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var ost=zI().Buffer,TE=globalThis.crypto||globalThis.msCrypto;TE&&TE.getRandomValues?ok.exports=ast:ok.exports=sst;function ast(r,e){if(r>nst)throw new RangeError("requested too many random bytes");var t=ost.allocUnsafe(r);if(r>0)if(r>ak)for(var i=0;i<r;i+=ak)TE.getRandomValues(t.slice(i,i+ak));else TE.getRandomValues(t);return typeof e=="function"?process.nextTick(function(){e(null,t)}):t}});var Cye=p((kAt,Rye)=>{l();"use strict";function kye(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function cst(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=void 0),e!=null&&(t.code=e);try{return kye(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),kye(new n,t)}}Rye.exports=cst});var lk=p((CAt,Pye)=>{l();var ust=xe()("simple-peer"),Oye=Tye(),Bye=ck(),fst=o8(),uk=Rw(),Or=Cye(),fk=64*1024,lst=5*1e3,hst=5*1e3;function Nye(r){return r.replace(/a=ice-options:trickle\s\n/g,"")}function dst(r){console.warn(r)}var Cf=class extends fst.Duplex{constructor(e){if(e=Object.assign({allowHalfOpen:!1},e),super(e),this._id=Bye(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||Bye(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||Cf.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},Cf.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(t=>t),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||lst,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:Oye(),!this._wrtc)throw typeof window=="undefined"?Or(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):Or(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=this.negotiated?!1:!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){uk(()=>this.destroy(Or(t,"ERR_PC_CONSTRUCTOR")));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=t=>{this._onIceCandidate(t)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=t=>{this._setupData(t)},this.streams&&this.streams.forEach(t=>{this.addStream(t)}),this._pc.ontrack=t=>{this._onTrack(t)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw Or(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof e=="string")try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(t=>{this._addIceCandidate(t)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(t=>{this.destroy(Or(t,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(Or(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(i=>{!t.address||t.address.endsWith(".local")?dst("Ignoring unsupported ICE candidate."):this.destroy(Or(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(i){this.destroy(Or(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:t}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}addTrack(e,t){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,n=i.get(t);if(!n)n=this._pc.addTrack(e,t),i.set(t,n),this._senderMap.set(e,i),this._needsNegotiation();else throw n.removed?Or(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):Or(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,t,i){this._debug("replaceTrack()");var n=this._senderMap.get(e),s=n?n.get(i):null;if(!s)throw Or(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,n),s.replaceTrack!=null?s.replaceTrack(t):this.destroy(Or(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){this._debug("removeSender()");var i=this._senderMap.get(e),n=i?i.get(t):null;if(!n)throw Or(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(n):this.destroy(Or(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,uk(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(e,t){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(i){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(i){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,t(e)}_setupData(e){if(!e.channel)return this.destroy(Or(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=fk),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{this.destroy(Or(i,"ERR_DATA_CHANNEL"))};var t=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(t&&this._onChannelClose(),t=!0):t=!1},hst)}_read(){}_write(e,t,i){if(this.destroyed)return i(Or(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(n){return this.destroy(Or(n,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>fk?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Nye(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})}},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(Or(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(Or(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Nye(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()}},i=()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(Or(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(Or(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(Or(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(Or(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(Or(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){let t=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(n=>{Object.assign(i,n)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var n=[];i.forEach(s=>{n.push(t(s))}),e(null,n)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var n=[];i.result().forEach(s=>{var o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,n.push(t(o))}),e(null,n)}},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((t,i)=>{if(this.destroyed)return;t&&(i=[]);var n={},s={},o={},a=!1;i.forEach(f=>{(f.type==="remotecandidate"||f.type==="remote-candidate")&&(n[f.id]=f),(f.type==="localcandidate"||f.type==="local-candidate")&&(s[f.id]=f),(f.type==="candidatepair"||f.type==="candidate-pair")&&(o[f.id]=f)});let c=f=>{a=!0;var h=s[f.localCandidateId];h&&(h.ip||h.address)?(this.localAddress=h.ip||h.address,this.localPort=Number(h.port)):h&&h.ipAddress?(this.localAddress=h.ipAddress,this.localPort=Number(h.portNumber)):typeof f.googLocalAddress=="string"&&(h=f.googLocalAddress.split(":"),this.localAddress=h[0],this.localPort=Number(h[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var d=n[f.remoteCandidateId];d&&(d.ip||d.address)?(this.remoteAddress=d.ip||d.address,this.remotePort=Number(d.port)):d&&d.ipAddress?(this.remoteAddress=d.ipAddress,this.remotePort=Number(d.portNumber)):typeof f.googRemoteAddress=="string"&&(d=f.googRemoteAddress.split(":"),this.remoteAddress=d[0],this.remotePort=Number(d[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(f=>{f.type==="transport"&&f.selectedCandidatePairId&&c(o[f.selectedCandidatePairId]),(f.type==="googCandidatePair"&&f.googActiveConnection==="true"||(f.type==="candidatepair"||f.type==="candidate-pair")&&f.selected)&&c(f)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(f){return this.destroy(Or(f,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var u=this._cb;this._cb=null,u(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>fk||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&!this._firstStable&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),this.push(t)}}_onChannelBufferedAmountLow(){if(!(this.destroyed||!this._cb)){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),!this._remoteStreams.some(i=>i.id===t.id)&&(this._remoteStreams.push(t),uk(()=>{this.emit("stream",t)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],ust.apply(null,e)}};Cf.WEBRTC_SUPPORT=!!Oye();Cf.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};Cf.channelConfig={};Pye.exports=Cf});var qye=p((PAt,Dye)=>{l();"use strict";Dye.exports={supportsFileReader:typeof self!="undefined"&&"FileReader"in self,supportsWebRTC:"RTCPeerConnection"in globalThis&&typeof navigator!="undefined"&&typeof navigator.mediaDevices!="undefined"&&"getUserMedia"in navigator.mediaDevices,supportsWebRTCDataChannels:"RTCPeerConnection"in globalThis}});var kE=p(RE=>{l();"use strict";RE.CODE_P2P=421;RE.CODE_CIRCUIT=290;RE.CLOSE_TIMEOUT=2e3});var hk=p((BAt,Mye)=>{l();var pst=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,yst=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];Mye.exports=function(e){var t=e,i=e.indexOf("["),n=e.indexOf("]");i!=-1&&n!=-1&&(e=e.substring(0,i)+e.substring(i,n).replace(/:/g,";")+e.substring(n,e.length));for(var s=pst.exec(e||""),o={},a=14;a--;)o[yst[a]]=s[a]||"";return i!=-1&&n!=-1&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=gst(o,o.path),o.queryKey=bst(o,o.query),o};function gst(r,e){var t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&i.splice(0,1),e.substr(e.length-1,1)=="/"&&i.splice(i.length-1,1),i}function bst(r,e){var t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(t[n]=s)}),t}});var Fye=p(CE=>{l();"use strict";Object.defineProperty(CE,"__esModule",{value:!0});CE.url=void 0;var mst=hk(),Lye=xe()("socket.io-client:url");function vst(r,e="",t){let i=r;t=t||typeof location!="undefined"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(Lye("protocol-less url %s",r),typeof t!="undefined"?r=t.protocol+"//"+r:r="https://"+r),Lye("parse %s",r),i=mst(r)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(t&&t.port===i.port?"":":"+i.port),i}CE.url=vst});var Uye=p((DAt,dk)=>{l();try{dk.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(r){dk.exports=!1}});var W1=p((qAt,Kye)=>{l();Kye.exports=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())()});var pk=p((MAt,jye)=>{l();var wst=Uye(),_st=W1();jye.exports=function(r){let e=r.xdomain,t=r.xscheme,i=r.enablesXDR;try{if(typeof XMLHttpRequest!="undefined"&&(!e||wst))return new XMLHttpRequest}catch(n){}try{if(typeof XDomainRequest!="undefined"&&!t&&i)return new XDomainRequest}catch(n){}if(!e)try{return new _st[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(n){}}});var yk=p((LAt,Vye)=>{l();var gc=Object.create(null);gc.open="0";gc.close="1";gc.ping="2";gc.pong="3";gc.message="4";gc.upgrade="5";gc.noop="6";var zye=Object.create(null);Object.keys(gc).forEach(r=>{zye[gc[r]]=r});var Est={type:"error",data:"parser error"};Vye.exports={PACKET_TYPES:gc,PACKET_TYPES_REVERSE:zye,ERROR_PACKET:Est}});var $ye=p((FAt,Hye)=>{l();var{PACKET_TYPES:Sst}=yk(),xst=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ast=typeof ArrayBuffer=="function",Ist=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,Tst=({type:r,data:e},t,i)=>xst&&e instanceof Blob?t?i(e):Gye(e,i):Ast&&(e instanceof ArrayBuffer||Ist(e))?t?i(e instanceof ArrayBuffer?e:e.buffer):Gye(new Blob([e]),i):i(Sst[r]+(e||"")),Gye=(r,e)=>{let t=new FileReader;return t.onload=function(){let i=t.result.split(",")[1];e("b"+i)},t.readAsDataURL(r)};Hye.exports=Tst});var Wye=p(gk=>{l();(function(r){"use strict";gk.encode=function(e){var t=new Uint8Array(e),i,n=t.length,s="";for(i=0;i<n;i+=3)s+=r[t[i]>>2],s+=r[(t[i]&3)<<4|t[i+1]>>4],s+=r[(t[i+1]&15)<<2|t[i+2]>>6],s+=r[t[i+2]&63];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},gk.decode=function(e){var t=e.length*.75,i=e.length,n,s=0,o,a,c,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=new ArrayBuffer(t),h=new Uint8Array(f);for(n=0;n<i;n+=4)o=r.indexOf(e[n]),a=r.indexOf(e[n+1]),c=r.indexOf(e[n+2]),u=r.indexOf(e[n+3]),h[s++]=o<<2|a>>4,h[s++]=(a&15)<<4|c>>2,h[s++]=(c&3)<<6|u&63;return f}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")});var Jye=p((KAt,Yye)=>{l();var{PACKET_TYPES_REVERSE:bk,ERROR_PACKET:Rst}=yk(),kst=typeof ArrayBuffer=="function",mk;kst&&(mk=Wye());var Pst=(r,e)=>{if(typeof r!="string")return{type:"message",data:Xye(r,e)};let t=r.charAt(0);return t==="b"?{type:"message",data:Cst(r.substring(1),e)}:bk[t]?r.length>1?{type:bk[t],data:r.substring(1)}:{type:bk[t]}:Rst},Cst=(r,e)=>{if(mk){let t=mk.decode(r);return Xye(t,e)}else return{base64:!0,data:r}},Xye=(r,e)=>{switch(e){case"blob":return r instanceof ArrayBuffer?new Blob([r]):r;case"arraybuffer":default:return r}};Yye.exports=Pst});var E0=p((jAt,Qye)=>{l();var Zye=$ye(),ege=Jye(),tge=String.fromCharCode(30),Ost=(r,e)=>{let t=r.length,i=new Array(t),n=0;r.forEach((s,o)=>{Zye(s,!1,a=>{i[o]=a,++n===t&&e(i.join(tge))})})},Bst=(r,e)=>{let t=r.split(tge),i=[];for(let n=0;n<t.length;n++){let s=ege(t[n],e);if(i.push(s),s.type==="error")break}return i};Qye.exports={protocol:4,encodePacket:Zye,encodePayload:Ost,decodePacket:ege,decodePayload:Bst}});var S0=p((VAt,vk)=>{l();typeof vk!="undefined"&&(vk.exports=Os);function Os(r){if(r)return Nst(r)}function Nst(r){for(var e in Os.prototype)r[e]=Os.prototype[e];return r}Os.prototype.on=Os.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};Os.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};Os.prototype.off=Os.prototype.removeListener=Os.prototype.removeAllListeners=Os.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var i,n=0;n<t.length;n++)if(i=t[n],i===e||i.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+r],this};Os.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,n=t.length;i<n;++i)t[i].apply(this,e)}return this};Os.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};Os.prototype.hasListeners=function(r){return!!this.listeners(r).length}});var PE=p((zAt,rge)=>{l();var Dst=E0(),qst=S0(),Mst=xe()("engine.io-client:transport"),ige=class extends qst{constructor(e){super();this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t){let i=new Error(e);return i.type="TransportError",i.description=t,this.emit("error",i),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):Mst("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(e){let t=Dst.decodePacket(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){this.emit("packet",e)}onClose(){this.readyState="closed",this.emit("close")}};rge.exports=ige});var OE=p(wk=>{l();wk.encode=function(r){var e="";for(var t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e};wk.decode=function(r){for(var e={},t=r.split("&"),i=0,n=t.length;i<n;i++){var s=t[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}});var Sk=p((GAt,nge)=>{l();"use strict";var sge="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),BE=64,oge={},age=0,Pf=0,cge;function _k(r){var e="";do e=sge[r%BE]+e,r=Math.floor(r/BE);while(r>0);return e}function Lst(r){var e=0;for(Pf=0;Pf<r.length;Pf++)e=e*BE+oge[r.charAt(Pf)];return e}function Ek(){var r=_k(+new Date);return r!==cge?(age=0,cge=r):r+"."+_k(age++)}for(;Pf<BE;Pf++)oge[sge[Pf]]=Pf;Ek.encode=_k;Ek.decode=Lst;nge.exports=Ek});var xk=p(($At,uge)=>{l();var Fst=PE(),Ust=OE(),fge=E0(),Kst=Sk(),da=xe()("engine.io-client:polling"),lge=class extends Fst{get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{da("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(da("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){da("pre-pause polling complete"),--i||t()})),this.writable||(da("we are currently writing - waiting to pause"),i++,this.once("drain",function(){da("pre-pause writing complete"),--i||t()}))}else t()}poll(){da("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){da("polling got data %s",e);let t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose(),!1;this.onPacket(i)};fge.decodePayload(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():da('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{da("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(da("transport open - closing"),e()):(da("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,fge.encodePayload(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emit("drain")})})}uri(){let e=this.query||{},t=this.opts.secure?"https":"http",i="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Kst()),!this.supportsBinary&&!e.sid&&(e.b64=1),e=Ust.encode(e),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}};uge.exports=lge});var Ak=p((WAt,hge)=>{l();hge.exports.pick=(r,...e)=>e.reduce((t,i)=>(r.hasOwnProperty(i)&&(t[i]=r[i]),t),{})});var bge=p((YAt,Ik)=>{l();var dge=pk(),jst=xk(),Vst=S0(),{pick:zst}=Ak(),Hst=W1(),Tk=xe()("engine.io-client:polling-xhr");function pge(){}var Gst=function(){return new dge({xdomain:!1}).responseType!=null}(),yge=class extends jst{constructor(e){super(e);if(typeof location!="undefined"){let i=location.protocol==="https:",n=location.port;n||(n=i?443:80),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==i}let t=e&&e.forceBase64;this.supportsBinary=Gst&&!t}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new bo(this.uri(),e)}doWrite(e,t){let i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",n=>{this.onError("xhr post error",n)})}doPoll(){Tk("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",t=>{this.onError("xhr poll error",t)}),this.pollXhr=e}},bo=class extends Vst{constructor(e,t){super();this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){let e=zst(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let t=this.xhr=new dge(e);try{Tk("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.opts.extraHeaders[i])}}catch(i){}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{t.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),this.hasXDR()?(t.onload=()=>{this.onLoad()},t.onerror=()=>{this.onError(t.responseText)}):t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():setTimeout(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},Tk("xhr data %s",this.data),t.send(this.data)}catch(i){setTimeout(()=>{this.onError(i)},0);return}typeof document!="undefined"&&(this.index=bo.requestsCount++,bo.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=pge:this.xhr.onreadystatechange=pge,e)try{this.xhr.abort()}catch(t){}typeof document!="undefined"&&delete bo.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&this.onData(e)}hasXDR(){return typeof XDomainRequest!="undefined"&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}};bo.requestsCount=0;bo.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",gge);else if(typeof addEventListener=="function"){let r="onpagehide"in Hst?"pagehide":"unload";addEventListener(r,gge,!1)}}function gge(){for(let r in bo.requests)bo.requests.hasOwnProperty(r)&&bo.requests[r].abort()}Ik.exports=yge;Ik.exports.Request=bo});var _ge=p((XAt,mge)=>{l();var $st=xk(),vge=W1(),Wst=/\n/g,Yst=/\\n/g,NE,wge=class extends $st{constructor(e){super(e);this.query=this.query||{},NE||(NE=vge.___eio=vge.___eio||[]),this.index=NE.length,NE.push(this.onData.bind(this)),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){let e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=n=>{this.onError("jsonp poll error",n)};let t=document.getElementsByTagName("script")[0];t?t.parentNode.insertBefore(e,t):(document.head||document.body).appendChild(e),this.script=e,typeof navigator!="undefined"&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){let n=document.createElement("iframe");document.body.appendChild(n),document.body.removeChild(n)},100)}doWrite(e,t){let i;if(!this.form){let o=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),a.name="d",o.appendChild(a),document.body.appendChild(o),this.form=o,this.area=a}this.form.action=this.uri();function n(){s(),t()}let s=()=>{if(this.iframe)try{this.form.removeChild(this.iframe)}catch(o){this.onError("jsonp polling iframe removal error",o)}try{let o='<iframe src="javascript:0" name="'+this.iframeId+'">';i=document.createElement(o)}catch(o){i=document.createElement("iframe"),i.name=this.iframeId,i.src="javascript:0"}i.id=this.iframeId,this.form.appendChild(i),this.iframe=i};s(),e=e.replace(Yst,`\\
`),this.area.value=e.replace(Wst,"\\n");try{this.form.submit()}catch(o){}this.iframe.attachEvent?this.iframe.onreadystatechange=()=>{this.iframe.readyState==="complete"&&n()}:this.iframe.onload=n}};mge.exports=wge});var xge=p((JAt,Ege)=>{l();var Sge=W1();Ege.exports={WebSocket:Sge.WebSocket||Sge.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer"}});var Rge=p((QAt,Age)=>{l();var Ige=PE(),Xst=E0(),Jst=OE(),Qst=Sk(),{pick:Zst}=Ak(),{WebSocket:Y1,usingBrowserWebSocket:Rk,defaultBinaryType:eot}=xge(),tot=xe()("engine.io-client:websocket"),Tge=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",DE=class extends Ige{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,i=Tge?{}:Zst(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=Rk&&!Tge?t?new Y1(e,t):new Y1(e):new Y1(e,t,i)}catch(n){return this.emit("error",n)}this.ws.binaryType=this.socket.binaryType||eot,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let i=e[t],n=t===e.length-1;Xst.encodePacket(i,this.supportsBinary,s=>{let o={};Rk||(i.options&&(o.compress=i.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{Rk?this.ws.send(s):this.ws.send(s,o)}catch(a){tot("websocket closed before onclose event")}n&&setTimeout(()=>{this.writable=!0,this.emit("drain")},0)})}}onClose(){Ige.prototype.onClose.call(this)}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},t=this.opts.secure?"wss":"ws",i="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=Qst()),this.supportsBinary||(e.b64=1),e=Jst.encode(e),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}check(){return!!Y1&&!("__initialize"in Y1&&this.name===DE.prototype.name)}};Age.exports=DE});var Ck=p(kk=>{l();var rot=pk(),iot=bge(),not=_ge(),sot=Rge();kk.polling=oot;kk.websocket=sot;function oot(r){let e,t=!1,i=!1,n=r.jsonp!==!1;if(typeof location!="undefined"){let s=location.protocol==="https:",o=location.port;o||(o=s?443:80),t=r.hostname!==location.hostname||o!==r.port,i=r.secure!==s}if(r.xdomain=t,r.xscheme=i,e=new rot(r),"open"in e&&!r.forceJSONP)return new iot(r);if(!n)throw new Error("JSONP disabled");return new not(r)}});var Oge=p((e5t,kge)=>{l();var aot=Ck(),cot=S0(),ai=xe()("engine.io-client:socket"),Cge=E0(),Pge=hk(),uot=OE(),bc=class extends cot{constructor(e,t={}){super();e&&typeof e=="object"&&(t=e,e=null),e?(e=Pge(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=Pge(t.host).host),this.secure=t.secure!=null?t.secure:typeof location!="undefined"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=t.port||(typeof location!="undefined"&&location.port?location.port:this.secure?443:80),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=uot.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){ai('creating transport "%s"',e);let t=fot(this.opts.query);t.EIO=Cge.protocol,t.transport=e,this.id&&(t.sid=this.id);let i=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return ai("options: %j",i),new aot[e](i)}open(){let e;if(this.opts.rememberUpgrade&&bc.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){setTimeout(()=>{this.emit("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(t){ai("error while creating transport: %s",t),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){ai("setting transport %s",e.name),this.transport&&(ai("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(e){ai('probing transport "%s"',e);let t=this.createTransport(e,{probe:1}),i=!1;bc.priorWebsocketSuccess=!1;let n=()=>{i||(ai('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",h=>{if(!i)if(h.type==="pong"&&h.data==="probe"){if(ai('probe transport "%s" pong',e),this.upgrading=!0,this.emit("upgrading",t),!t)return;bc.priorWebsocketSuccess=t.name==="websocket",ai('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{i||this.readyState!=="closed"&&(ai("changing transport and sending upgrade packet"),f(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emit("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{ai('probe transport "%s" failed',e);let d=new Error("probe error");d.transport=t.name,this.emit("upgradeError",d)}}))};function s(){i||(i=!0,f(),t.close(),t=null)}let o=h=>{let d=new Error("probe error: "+h);d.transport=t.name,s(),ai('probe transport "%s" failed because of error: %s',e,h),this.emit("upgradeError",d)};function a(){o("transport closed")}function c(){o("socket closed")}function u(h){t&&h.name!==t.name&&(ai('"%s" works - aborting "%s"',h.name,t.name),s())}let f=()=>{t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),this.removeListener("close",c),this.removeListener("upgrading",u)};t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",c),this.once("upgrading",u),t.open()}onOpen(){if(ai("socket open"),this.readyState="open",bc.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){ai("starting upgrade probes");let e=0,t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(ai('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("pong");break;case"error":let t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data);break}else ai('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(ai("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(e,t,i){return this.sendPacket("message",e,t,i),this}send(e,t,i){return this.sendPacket("message",e,t,i),this}sendPacket(e,t,i,n){if(typeof t=="function"&&(n=t,t=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:e,data:t,options:i};this.emit("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),ai("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.removeListener("upgrade",t),this.removeListener("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){ai("socket error %j",e),bc.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(ai('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let t=[],i=0,n=e.length;for(;i<n;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}};bc.priorWebsocketSuccess=!1;bc.protocol=Cge.protocol;function fot(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e}kge.exports=bc});var Bge=p((t5t,bh)=>{l();var Pk=Oge();bh.exports=(r,e)=>new Pk(r,e);bh.exports.Socket=Pk;bh.exports.protocol=Pk.protocol;bh.exports.Transport=PE();bh.exports.transports=Ck();bh.exports.parser=E0()});var Ok=p(x0=>{l();"use strict";Object.defineProperty(x0,"__esModule",{value:!0});x0.hasBinary=x0.isBinary=void 0;var lot=typeof ArrayBuffer=="function",hot=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Nge=Object.prototype.toString,dot=typeof Blob=="function"||typeof Blob!="undefined"&&Nge.call(Blob)==="[object BlobConstructor]",pot=typeof File=="function"||typeof File!="undefined"&&Nge.call(File)==="[object FileConstructor]";function Dge(r){return lot&&(r instanceof ArrayBuffer||hot(r))||dot&&r instanceof Blob||pot&&r instanceof File}x0.isBinary=Dge;function qE(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,i=r.length;t<i;t++)if(qE(r[t]))return!0;return!1}if(Dge(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return qE(r.toJSON(),!0);for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&qE(r[t]))return!0;return!1}x0.hasBinary=qE});var qge=p(A0=>{l();"use strict";Object.defineProperty(A0,"__esModule",{value:!0});A0.reconstructPacket=A0.deconstructPacket=void 0;var yot=Ok();function got(r){let e=[],t=r.data,i=r;return i.data=Bk(t,e),i.attachments=e.length,{packet:i,buffers:e}}A0.deconstructPacket=got;function Bk(r,e){if(!r)return r;if(yot.isBinary(r)){let t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){let t=new Array(r.length);for(let i=0;i<r.length;i++)t[i]=Bk(r[i],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){let t={};for(let i in r)r.hasOwnProperty(i)&&(t[i]=Bk(r[i],e));return t}return r}function bot(r,e){return r.data=Nk(r.data,e),r.attachments=void 0,r}A0.reconstructPacket=bot;function Nk(r,e){if(!r)return r;if(r&&r._placeholder)return e[r.num];if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=Nk(r[t],e);else if(typeof r=="object")for(let t in r)r.hasOwnProperty(t)&&(r[t]=Nk(r[t],e));return r}});var LE=p(pa=>{l();"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.Decoder=pa.Encoder=pa.PacketType=pa.protocol=void 0;var mot=S0(),Mge=qge(),Lge=Ok(),Dk=xe()("socket.io-parser");pa.protocol=5;var gi;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(gi=pa.PacketType||(pa.PacketType={}));var Fge=class{encode(e){return Dk("encoding packet %j",e),(e.type===gi.EVENT||e.type===gi.ACK)&&Lge.hasBinary(e)?(e.type=e.type===gi.EVENT?gi.BINARY_EVENT:gi.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===gi.BINARY_EVENT||e.type===gi.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data)),Dk("encoded %j as %s",e,t),t}encodeAsBinary(e){let t=Mge.deconstructPacket(e),i=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(i),n}};pa.Encoder=Fge;var ME=class extends mot{constructor(){super()}add(e){let t;if(typeof e=="string")t=this.decodeString(e),t.type===gi.BINARY_EVENT||t.type===gi.BINARY_ACK?(this.reconstructor=new Uge(t),t.attachments===0&&super.emit("decoded",t)):super.emit("decoded",t);else if(Lge.isBinary(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emit("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,i={type:Number(e.charAt(0))};if(gi[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===gi.BINARY_EVENT||i.type===gi.BINARY_ACK){let s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(t+1)==="/"){let s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(s,t)}else i.nsp="/";let n=e.charAt(t+1);if(n!==""&&Number(n)==n){let s=t+1;for(;++t;){let o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}i.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){let s=vot(e.substr(t));if(ME.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return Dk("decoded %s as %j",e,i),i}static isPayloadValid(e,t){switch(e){case gi.CONNECT:return typeof t=="object";case gi.DISCONNECT:return t===void 0;case gi.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case gi.EVENT:case gi.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case gi.ACK:case gi.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}};pa.Decoder=ME;function vot(r){try{return JSON.parse(r)}catch(e){return!1}}var Uge=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=Mge.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var qk=p(FE=>{l();"use strict";Object.defineProperty(FE,"__esModule",{value:!0});FE.on=void 0;function wot(r,e,t){return r.on(e,t),function(){r.off(e,t)}}FE.on=wot});var Mk=p(UE=>{l();"use strict";Object.defineProperty(UE,"__esModule",{value:!0});UE.StrictEventEmitter=void 0;var _ot=S0(),Kge=class extends _ot{on(e,t){return super.on(e,t),this}once(e,t){return super.once(e,t),this}emit(e,...t){return super.emit(e,...t),this}emitReserved(e,...t){return super.emit(e,...t),this}listeners(e){return super.listeners(e)}};UE.StrictEventEmitter=Kge});var Lk=p(KE=>{l();"use strict";Object.defineProperty(KE,"__esModule",{value:!0});KE.Socket=void 0;var mo=LE(),jE=qk(),Eot=Mk(),vo=xe()("socket.io-client:socket"),Sot=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),jge=class extends Eot.StrictEventEmitter{constructor(e,t,i){super();this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;let e=this.io;this.subs=[jE.on(e,"open",this.onopen.bind(this)),jE.on(e,"packet",this.onpacket.bind(this)),jE.on(e,"error",this.onerror.bind(this)),jE.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Sot.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);let i={type:mo.PacketType.EVENT,data:t};i.options={},i.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"&&(vo("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++);let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)?vo("discard packet as the transport is not currently writable"):this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){vo("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:mo.PacketType.CONNECT,data:e})}):this.packet({type:mo.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){vo("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case mo.PacketType.CONNECT:if(e.data&&e.data.sid){let n=e.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case mo.PacketType.EVENT:this.onevent(e);break;case mo.PacketType.BINARY_EVENT:this.onevent(e);break;case mo.PacketType.ACK:this.onack(e);break;case mo.PacketType.BINARY_ACK:this.onack(e);break;case mo.PacketType.DISCONNECT:this.ondisconnect();break;case mo.PacketType.CONNECT_ERROR:let i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){let t=e.data||[];vo("emitting event %j",t),e.id!=null&&(vo("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let i of t)i.apply(this,e)}super.emit.apply(this,e)}ack(e){let t=this,i=!1;return function(...n){i||(i=!0,vo("sending ack %j",n),t.packet({type:mo.PacketType.ACK,id:e,data:n}))}}onack(e){let t=this.acks[e.id];typeof t=="function"?(vo("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):vo("bad ack %s",e.id)}onconnect(e){vo("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>this.packet(e)),this.sendBuffer=[]}ondisconnect(){vo("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(vo("performing disconnect (%s)",this.nsp),this.packet({type:mo.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}};KE.Socket=jge});var zge=p((c5t,Vge)=>{l();Vge.exports=I0;function I0(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}I0.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=(Math.floor(e*10)&1)==0?r-t:r+t}return Math.min(r,this.max)|0};I0.prototype.reset=function(){this.attempts=0};I0.prototype.setMin=function(r){this.ms=r};I0.prototype.setMax=function(r){this.max=r};I0.prototype.setJitter=function(r){this.jitter=r}});var Fk=p(VE=>{l();"use strict";Object.defineProperty(VE,"__esModule",{value:!0});VE.Manager=void 0;var xot=Bge(),Aot=Lk(),Iot=LE(),mh=qk(),Tot=zge(),Rot=Mk(),cn=xe()("socket.io-client:manager"),Hge=class extends Rot.StrictEventEmitter{constructor(e,t){super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||Infinity),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new Tot({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let i=t.parser||Iot;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(cn("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;cn("opening %s",this.uri),this.engine=xot(this.uri,this.opts);let t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=mh.on(t,"open",function(){i.onopen(),e&&e()}),s=mh.on(t,"error",o=>{cn("error"),i.cleanup(),i._readyState="closed",this.emitReserved("error",o),e?e(o):i.maybeReconnectOnOpen()});if(this._timeout!==!1){let o=this._timeout;cn("connect attempt will timeout after %d",o),o===0&&n();let a=setTimeout(()=>{cn("connect attempt timed out after %d",o),n(),t.close(),t.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){cn("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(mh.on(e,"ping",this.onping.bind(this)),mh.on(e,"data",this.ondata.bind(this)),mh.on(e,"error",this.onerror.bind(this)),mh.on(e,"close",this.onclose.bind(this)),mh.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){cn("error",e),this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i||(i=new Aot.Socket(this,e,t),this.nsps[e]=i),i}_destroy(e){let t=Object.keys(this.nsps);for(let i of t)if(this.nsps[i].active){cn("socket %s is still active, skipping close",i);return}this._close()}_packet(e){cn("writing packet %j",e);let t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){cn("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){cn("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this._readyState==="opening"&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){cn("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)cn("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();cn("will wait %dms before reconnect attempt",t),this._reconnecting=!0;let i=setTimeout(()=>{e.skipReconnect||(cn("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(cn("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):(cn("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};VE.Manager=Hge});var Yge=p((ss,Gge)=>{l();"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.io=ss.Socket=ss.Manager=ss.protocol=void 0;var kot=Fye(),$ge=Fk(),Wge=xe()("socket.io-client");Gge.exports=ss=zE;var X1=ss.managers={};function zE(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};let t=kot.url(r,e.path||"/socket.io"),i=t.source,n=t.id,s=t.path,o=X1[n]&&s in X1[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(Wge("ignoring socket cache for %s",i),c=new $ge.Manager(i,e)):(X1[n]||(Wge("new io instance for %s",i),X1[n]=new $ge.Manager(i,e)),c=X1[n]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}ss.io=zE;var Cot=LE();Object.defineProperty(ss,"protocol",{enumerable:!0,get:function(){return Cot.protocol}});ss.connect=zE;var Pot=Fk();Object.defineProperty(ss,"Manager",{enumerable:!0,get:function(){return Pot.Manager}});var Oot=Lk();Object.defineProperty(ss,"Socket",{enumerable:!0,get:function(){return Oot.Socket}});ss.default=zE});var HE=p((f5t,Xge)=>{l();Xge.exports=r=>{if(r[Symbol.asyncIterator])return r;if(r.getReader)return async function*(){let e=r.getReader();try{for(;;){let{done:t,value:i}=await e.read();if(t)return;yield i}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var Uk=p((l5t,Jge)=>{l();var Bot=v_();Jge.exports=r=>async e=>{e=Bot(e);let t=_=>{typeof _.return=="function"&&_.return()},i=null,n=null,s=_=>{i=_,n&&n(_),t(e)},o=null,a=!1,c=()=>{a=!0,o&&o()},u=null,f=!1,h=()=>{f=!0,u&&u()},d=null,y=()=>{d&&d()},g=()=>new Promise((_,P)=>{o=d=_,n=P,r.once("drain",y)}),m=()=>(t(e),new Promise((_,P)=>{if(a||f||i)return _();u=o=_,n=P})),x=()=>{r.removeListener("error",s),r.removeListener("close",c),r.removeListener("finish",h),r.removeListener("drain",y)};r.once("error",s),r.once("close",c),r.once("finish",h);try{for await(let _ of e){if(!r.writable||r.destroyed||i)break;r.write(_)===!1&&await g()}}catch(_){i||r.destroy(),i=_}try{if(r.writable&&r.end(),await m(),i)throw i}finally{x()}}});var Kk=p((h5t,Qge)=>{l();var Not=Uk(),Dot=HE();Qge.exports=r=>({sink:Not(r),source:Dot(r)})});var e1e=p((d5t,Zge)=>{l();var qot=Kk();Zge.exports=r=>async function*(e){let t=qot(r);t.sink(e).catch(i=>{}),yield*t.source}});var t1e=p((p5t,T0)=>{l();T0.exports=HE();T0.exports.source=HE();T0.exports.sink=Uk();T0.exports.transform=e1e();T0.exports.duplex=Kk()});var jk=p((y5t,r1e)=>{l();"use strict";var i1e=cc(),Mot=t1e(),{CLOSE_TIMEOUT:Lot}=kE(),n1e=ek(),s1e=xe(),GE=s1e("libp2p:webrtc-star:socket");GE.error=s1e("libp2p:webrtc-star:socket:error");var o1e=(r,e)=>{if(!(!r||!e))try{return n1e(r,e)}catch(t){return GE.error(t),n1e("0.0.0.0",e)}};r1e.exports=(r,e={})=>{let{sink:t,source:i}=Mot.duplex(r),n=e.remoteAddr||o1e(r.remoteAddress,r.remotePort),s=o1e(r.localAddress,r.localPort),o={async sink(a){e.signal&&(a=i1e(a,e.signal));try{await t(async function*(){for await(let c of a)yield c instanceof Uint8Array?c:c.slice()}())}catch(c){c.type!=="aborted"&&GE.error(c)}},source:e.signal?i1e(i,e.signal):i,conn:r,localAddr:s,remoteAddr:n,timeline:{open:Date.now()},close(){if(!r.destroyed)return new Promise((a,c)=>{let u=Date.now(),f=setTimeout(()=>{if(o.remoteAddr){let{host:h,port:d}=o.remoteAddr.toOptions();GE("timeout closing socket to %s:%s after %dms, destroying it manually",h,d,Date.now()-u)}r.destroyed||r.destroy()},Lot);r.once("close",()=>{a()}),r.end(h=>{if(clearTimeout(f),o.timeline.close=Date.now(),h)return c(h)})})}};return r.once("close",()=>{o.timeline.close||(o.timeline.close=Date.now())}),o}});var Vk=p((g5t,a1e)=>{l();"use strict";var{Multiaddr:c1e}=lr();function Fot(r){let e=r.toString().split("/"),t=r.protos()[1].name,i=r.protos()[2].name,n=r.stringTuples()[1][1];if(t!=="tcp"||i!=="ws"&&i!=="wss")throw new Error("invalid multiaddr: "+r.toString());if(!c1e.isName(r))return"http://"+e[2]+":"+e[4];if(i==="ws")return"http://"+e[2]+(n==="80"?"":":"+n);if(i==="wss")return"https://"+e[2]+(n==="443"?"":":"+n)}function Uot(r){let e="/libp2p-webrtc-star";if(r.indexOf(e)!==-1){r=r.substring(e.length,r.length);let t=new c1e(r),i=t.stringTuples().filter(n=>n[0]===421)[0];t=t.decapsulate("p2p"),t=t.encapsulate("/p2p-webrtc-star"),t=t.encapsulate(`/p2p/${i[1]}`),r=t.toString()}return r}a1e.exports={cleanUrlSIO:Fot,cleanMultiaddr:Uot}});var h1e=p((b5t,u1e)=>{l();"use strict";var Kot=Lr(),f1e=xe(),vh=f1e("libp2p:webrtc-star:listener");vh.error=f1e("libp2p:webrtc-star:listener:error");var jot=ge(),Vot=Yge(),zot=lk(),Hot=k1(),Got=jk(),{cleanUrlSIO:$ot}=Vk(),{CODE_P2P:l1e}=kE(),Wot={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};u1e.exports=({handler:r,upgrader:e},t,i={})=>{let n=new Kot,s,o;return n.__connections=[],n.__spChannels=new Map,n.__pendingIntents=new Map,n.listen=a=>{if(s)throw jot(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let c=Hot();s=a;let u;!a.protoCodes().includes(l1e)&&e.localPeer?u=a.encapsulate(`/p2p/${e.localPeer.toB58String()}`):u=a,n.on("error",()=>c.reject()),o=$ot(a),vh("Dialing to Signalling Server on: "+o),n.io=Vot.connect(o,Wot);let f=h=>{if(h.answer||h.err||!h.intentId)return;let d=h.intentId,y=n.__pendingIntents.get(d);y||(y=[],n.__pendingIntents.set(d,y));let g=n.__spChannels.get(d);if(g){g.signal(h.signal);return}else if(h.signal.type!=="offer"){y.push(h);return}let m={trickle:!1,...i};t.wrtc&&(m.wrtc=t.wrtc),g=new zot(m);let x=_=>{vh.error("incoming connection errored",_)};g.on("error",x),g.once("close",(..._)=>{g.removeListener("error",x)}),g.on("signal",_=>{h.signal=_,h.answer=!0,n.io.emit("ss-handshake",h)}),g.signal(h.signal);for(let _ of y)g.signal(_.signal);n.__pendingIntents.set(d,[]),g.once("connect",async()=>{let _=Got(g);vh("new inbound connection %s",_.remoteAddr);let P;try{P=await e.upgradeInbound(_)}catch(q){return vh.error("inbound connection failed to upgrade",q),_.close()}if(!P.remoteAddr)try{P.remoteAddr=a.decapsulateCode(l1e).encapsulate(`/p2p/${P.remotePeer.toB58String()}`)}catch(q){vh.error("could not determine remote address",q)}vh("inbound connection %s upgraded",_.remoteAddr),Yot(n,_,d),n.emit("connection",P),r(P)}),n.__spChannels.set(d,g)};return n.io.once("connect_error",h=>c.reject(h)),n.io.once("error",h=>{n.emit("error",h),n.emit("close")}),n.io.on("ws-handshake",f),n.io.on("ws-peer",t._peerDiscovered),n.io.on("connect",()=>{n.io.emit("ss-join",u.toString())}),n.io.once("connect",()=>{n.emit("listening"),c.resolve()}),t.sigReferences.set(o,{listener:n,signallingAddr:u}),c.promise},n.close=async()=>{let a=t.sigReferences.get(o);a&&a.listener.io&&(a.listener.io.emit("ss-leave"),a.listener.io.close()),await Promise.all(n.__connections.map(c=>c.close())),n.emit("close"),n.removeAllListeners(),s=void 0,t.sigReferences.delete(o)},n.getAddrs=()=>[s],n};function Yot(r,e,t){r.__connections.push(e);let i=()=>{r.__connections=r.__connections.filter(n=>n!==e),r.__spChannels.delete(t),r.__pendingIntents.delete(t)};e.conn.once("close",i)}});var b1e=p((m5t,d1e)=>{l();"use strict";var p1e=xe(),hu=p1e("libp2p:webrtc-star");hu.error=p1e("libp2p:webrtc-star:error");var{EventEmitter:Xot}=Lr(),$E=ge(),Jot=Xm(),{AbortError:y1e}=cc(),Qot=lk(),{supportsWebRTCDataChannels:Zot}=qye(),{Multiaddr:eat}=lr(),tat=fl(),rat=dt(),{CODE_CIRCUIT:iat}=kE(),nat=h1e(),sat=jk(),{cleanMultiaddr:oat,cleanUrlSIO:aat}=Vk();function cat(){}var g1e=class{constructor(e={}){if(!e.upgrader)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e.upgrader,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.sigReferences=new Map,this.discovery=new Xot,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=()=>{this.discovery._isStarted=!0},this.discovery.stop=()=>{this.discovery._isStarted=!1},this._peerDiscovered=this._peerDiscovered.bind(this)}async dial(e,t={}){let i=await this._connect(e,t),n=sat(i,{remoteAddr:e,signal:t.signal});hu("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return hu("outbound connection %s upgraded",n.remoteAddr),s}_connect(e,t={}){if(t.signal&&t.signal.aborted)throw new y1e;let i={initiator:!0,trickle:!1,...t.spOptions||{}};this.wrtc&&(i.wrtc=this.wrtc);let n=e.toOptions(),s=(~~(Math.random()*1e9)).toString(36)+Date.now();return new Promise((o,a)=>{let c=this.sigReferences.get(aat(e));if(!c||!c.listener)return a($E(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let u=c.listener.io,f=Date.now(),h;hu("dialing %s:%s",n.host,n.port);let d=new Qot(i),y=P=>{if(!h){let q=`connection error ${n.host}:${n.port}: ${P.message}`;hu.error(q),_(P)}},g=()=>{hu("connnection timeout %s:%s",n.host,n.port);let P=$E(new Error(`connection timeout after ${Date.now()-f}ms`),"ERR_CONNECT_TIMEOUT");d.emit("error",P)},m=()=>{h=!0,hu("connection opened %s:%s",n.host,n.port),_(null)},x=()=>{hu.error("connection aborted %s:%s",n.host,n.port),d.destroy(),_(new y1e)},_=P=>{d.removeListener("timeout",g),d.removeListener("connect",m),t.signal&&t.signal.removeEventListener("abort",x),P?a(P):o(d)};d.on("error",y),d.once("timeout",g),d.once("connect",m),d.on("close",()=>{d.removeListener("error",y)}),t.signal&&t.signal.addEventListener("abort",x),d.on("signal",P=>{u.emit("ss-handshake",{intentId:s,srcMultiaddr:c.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:P})}),u.on("ws-handshake",P=>{P.intentId===s&&P.err&&(d.destroy(),a($E(P.err instanceof Error?P.err:new Error(P.err),"ERR_SIGNALLING_FAILED"))),!(P.intentId!==s||!P.answer||d.destroyed)&&d.signal(P.signal)})})}createListener(e={},t){if(!Zot&&!this.wrtc)throw $E(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return typeof e=="function"&&(t=e,e={}),t=t||cat,nat({handler:t,upgrader:this._upgrader},this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>t.protoCodes().includes(iat)?!1:tat.WebRTCStar.matches(t))}_peerDiscovered(e){if(!this.discovery._isStarted)return;hu("Peer Discovered:",e),e=oat(e);let t=new eat(e),i=rat.createFromB58String(t.getPeerId());this.discovery.emit("peer",{id:i,multiaddrs:[t]})}};d1e.exports=Jot(g1e,{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})});var w1e=p((v5t,m1e)=>{l();m1e.exports=zk;var v1e=128,uat=127,fat=~uat,lat=Math.pow(2,31);function zk(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw zk.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=lat;)e[t++]=r&255|v1e,r/=128;for(;r&fat;)e[t++]=r&255|v1e,r>>>=7;return e[t]=r|0,zk.bytes=t-i+1,e}});var S1e=p((w5t,_1e)=>{l();_1e.exports=Hk;var hat=128,E1e=127;function Hk(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw Hk.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&E1e)<<i:(s&E1e)*Math.pow(2,i),i+=7}while(s>=hat);return Hk.bytes=n-e,t}});var A1e=p((_5t,x1e)=>{l();var dat=Math.pow(2,7),pat=Math.pow(2,14),yat=Math.pow(2,21),gat=Math.pow(2,28),bat=Math.pow(2,35),mat=Math.pow(2,42),vat=Math.pow(2,49),wat=Math.pow(2,56),_at=Math.pow(2,63);x1e.exports=function(r){return r<dat?1:r<pat?2:r<yat?3:r<gat?4:r<bat?5:r<mat?6:r<vat?7:r<wat?8:r<_at?9:10}});var Gk=p((E5t,I1e)=>{l();I1e.exports={encode:w1e(),decode:S1e(),encodingLength:A1e()}});var WE=p((S5t,T1e)=>{l();"use strict";var{Buffer:ya}=xt(),R1e=Symbol.for("BufferList");function Br(r){if(!(this instanceof Br))return new Br(r);Br._init.call(this,r)}Br._init=function(e){Object.defineProperty(this,R1e,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Br.prototype._new=function(e){return new Br(e)};Br.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};Br.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};Br.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};Br.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};Br.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||ya.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&t||0,f=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:ya.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,u),u+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-f)return s?this._bufs[o[0]].copy(e,t,f,f+c):this._bufs[o[0]].slice(f,f+c);s||(e=ya.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-f;if(c>d)this._bufs[h].copy(e,u,f),u+=d;else{this._bufs[h].copy(e,u,f,f+c),u+=d;break}c-=d,f&&(f=0)}return e.length>u?e.slice(0,u):e};Br.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};Br.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};Br.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Br.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};Br.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(ya.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(ya.from(e));return this};Br.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Br.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=ya.from([r]):typeof r=="string"?r=ya.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=ya.from(r.buffer,r.byteOffset,r.byteLength):ya.isBuffer(r)||(r=ya.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};Br.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?Br.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:Br.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();Br.prototype._isBufferList=function(e){return e instanceof Br||Br.isBufferList(e)};Br.isBufferList=function(e){return e!=null&&e[R1e]};T1e.exports=Br});var B1e=p((x5t,k1e)=>{l();"use strict";var YE=Gk(),C1e=WE(),$k=10*1024,P1e=class{constructor(){this._pool=new Uint8Array($k),this._poolOffset=0}write(e){let t=this._pool,i=this._poolOffset;YE.encode(e.id<<3|e.type,t,i),i+=YE.encode.bytes,YE.encode(e.data?e.data.length:0,t,i),i+=YE.encode.bytes;let n=t.subarray(this._poolOffset,i);return $k-i<100?(this._pool=new Uint8Array($k),this._poolOffset=0):this._poolOffset=i,e.data?[n,e.data]:n}},O1e=new P1e;k1e.exports=r=>async function*(){for await(let t of r)Array.isArray(t)?yield new C1e(t.map(i=>O1e.write(i))):yield new C1e(O1e.write(t))}()});var q1e=p((A5t,N1e)=>{l();"use strict";var XE=Gk(),Eat=WE();N1e.exports=r=>async function*(){let t=new D1e;for await(let i of r){let n=t.write(i);n.length&&(yield n)}}();var D1e=class{constructor(){this._buffer=new Eat,this._bufferProxy=new Proxy({},{get:(e,t)=>t[0]==="l"?this._buffer[t]:this._buffer.get(parseInt(t))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let t=[];for(;;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(c){break}let{id:i,type:n,length:s,offset:o}=this._headerInfo;if(this._buffer.length-o<s)break;t.push({id:i,type:n,data:this._buffer.shallowSlice(o,o+s)}),this._buffer.consume(o+s),this._headerInfo=null}return t}_decodeHeader(e){let t=XE.decode(e),i=XE.decode.bytes,n=XE.decode(e,i);return i+=XE.decode.bytes,{id:t>>3,type:t&7,offset:i,length:n}}}});var M1e=p(Wk=>{l();"use strict";Wk.encode=B1e();Wk.decode=q1e()});var Xk=p((T5t,Yk)=>{l();"use strict";var L1e=1<<20;Yk.exports=r=>{r=r||L1e;let e=t=>{if(t.data&&t.data.length>r)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return t=>async function*(){for await(let n of t)Array.isArray(n)?n.forEach(e):e(n),yield n}()};Yk.exports.MAX_MSG_SIZE=L1e});var Jk=p(J1=>{l();"use strict";var du=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});J1.MessageTypes=du;J1.InitiatorMessageTypes=Object.freeze({NEW_STREAM:du.NEW_STREAM,MESSAGE:du.MESSAGE_INITIATOR,CLOSE:du.CLOSE_INITIATOR,RESET:du.RESET_INITIATOR});J1.ReceiverMessageTypes=Object.freeze({MESSAGE:du.MESSAGE_RECEIVER,CLOSE:du.CLOSE_RECEIVER,RESET:du.RESET_RECEIVER});J1.MessageTypeNames=Object.freeze(Object.entries(du).reduce((r,e)=>(r[e[1]]=e[0],r),{}))});var j1e=p((k5t,F1e)=>{l();"use strict";var Sat=cc(),U1e=Uf(),Q1=xe()("libp2p:mplex:stream"),xat=Wc(),K1e=WE(),Aat=ge(),{MAX_MSG_SIZE:Iat}=Xk(),{InitiatorMessageTypes:Tat,ReceiverMessageTypes:Rat}=Jk(),Qk="ERR_MPLEX_STREAM_RESET",kat="ERR_MPLEX_STREAM_ABORT";F1e.exports=({id:r,name:e,send:t,onEnd:i=()=>{},type:n="initiator",maxMsgSize:s=Iat})=>{let o=new U1e,a=new U1e,c=n==="initiator"?Tat:Rat,u=n==="initiator"?`i${r}`:`r${r}`;e=String(e??r);let f=!1,h=!1,d,y=x=>{f||(f=!0,Q1("%s stream %s source end",n,e,x),x&&!d&&(d=x),h&&(m.timeline.close=Date.now(),i(d)))},g=x=>{h||(h=!0,Q1("%s stream %s sink end",n,e,x),x&&!d&&(d=x),f&&(m.timeline.close=Date.now(),i(d)))},m={close:()=>m.source.end(),abort:x=>{Q1("%s stream %s abort",n,e,x),m.source.end(x),o.abort(),g(x)},reset:()=>{let x=Aat(new Error("stream reset"),Qk);a.abort(),m.source.end(x),g(x)},sink:async x=>{x=Sat(x,[{signal:o.signal,options:{abortMessage:"stream aborted",abortCode:kat}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:Qk}}]),n==="initiator"&&t({id:r,type:c.NEW_STREAM,data:e});try{for await(let _ of x)for(;_.length;){if(_.length<=s){t({id:r,type:c.MESSAGE,data:_});break}_=K1e.isBufferList(_)?_:new K1e(_),t({id:r,type:c.MESSAGE,data:_.shallowSlice(0,s)}),_.consume(s)}}catch(_){return _.code===Qk?Q1("%s stream %s reset",n,e):(Q1("%s stream %s error",n,e,_),t({id:r,type:c.RESET})),m.source.end(_),g(_)}t({id:r,type:c.CLOSE}),g()},source:xat(y),timeline:{open:Date.now(),close:null},id:u};return m}});var G1e=p((C5t,V1e)=>{l();"use strict";var Cat=pi(),Pat=Wc(),pu=xe()("libp2p:mplex"),Oat=cc(),z1e=M1e(),Bat=Xk(),{MessageTypes:wh,MessageTypeNames:H1e}=Jk(),Nat=j1e(),Zk=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(t=>{e.push(t)}),this._streams.receivers.forEach(t=>{e.push(t)}),e}newStream(e){let t=this._streamId++;e=e==null?t.toString():String(e);let i=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:i})}_newReceiverStream({id:e,name:t}){let i=this._streams.receivers;return this._newStream({id:e,name:t,type:"receiver",registry:i})}_newStream({id:e,name:t,type:i,registry:n}){if(n.has(e))throw new Error(`${i} stream ${e} already exists!`);pu("new %s stream %s %s",i,e,t);let a=Nat({id:e,name:t,send:c=>(pu.enabled&&pu("%s stream %s %s send",i,e,t,{...c,type:H1e[c.type],data:c.data&&c.data.slice()}),this.source.push(c)),type:i,onEnd:()=>{pu("%s stream %s %s ended",i,e,t),n.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return n.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=Oat(e,this._options.signal));try{await Cat(e,z1e.decode,Bat(this._options.maxMsgSize),async t=>{for await(let i of t)for(let n of i)this._handleIncoming(n)})}catch(t){return pu("error in sink",t),this.source.end(t)}this.source.end()}}_createSource(){let t=Pat({onEnd:i=>{let{initiators:n,receivers:s}=this._streams;for(let o of n.values())o.abort(i);for(let o of s.values())o.abort(i)},writev:!0});return Object.assign(z1e.encode(t),{push:t.push,end:t.end,return:t.return})}_handleIncoming({id:e,type:t,data:i}){if(pu.enabled&&pu("incoming message",{id:e,type:H1e[t],data:i.slice()}),t===wh.NEW_STREAM&&this.onStream){let o=this._newReceiverStream({id:e,name:i.toString()});return this.onStream(o)}let s=(t&1?this._streams.initiators:this._streams.receivers).get(e);if(!s)return pu("missing stream %s",e);switch(t){case wh.MESSAGE_INITIATOR:case wh.MESSAGE_RECEIVER:s.source.push(i);break;case wh.CLOSE_INITIATOR:case wh.CLOSE_RECEIVER:s.close();break;case wh.RESET_INITIATOR:case wh.RESET_RECEIVER:s.reset();break;default:pu("unknown message type %s",t)}}};Zk.multicodec="/mplex/6.7.0";V1e.exports=Zk});var W1e=p((P5t,$1e)=>{l();"use strict";$1e.exports=G1e()});var X1e=p(eC=>{l();"use strict";Object.defineProperty(eC,"__esModule",{value:!0});var Y1e=65536,Dat=function(){function r(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var t=new Uint8Array(e),i=0;i<t.length;i+=Y1e)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,Y1e)));return t},r}();eC.BrowserRandomSource=Dat});var mc=p(tC=>{l();"use strict";Object.defineProperty(tC,"__esModule",{value:!0});function qat(r){for(var e=0;e<r.length;e++)r[e]=0;return r}tC.wipe=qat});var J1e=p(rC=>{l();"use strict";Object.defineProperty(rC,"__esModule",{value:!0});var Mat=mc(),Lat=function(){function r(){this.isAvailable=!1,this.isInstantiated=!1;var e=jh();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=t[n];return Mat.wipe(t),i},r}();rC.NodeRandomSource=Lat});var Q1e=p(iC=>{l();"use strict";Object.defineProperty(iC,"__esModule",{value:!0});var Fat=X1e(),Uat=J1e(),Kat=function(){function r(){if(this.isAvailable=!1,this.name="",this._source=new Fat.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Uat.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return r.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},r}();iC.SystemRandomSource=Kat});var Z1e=p(Bs=>{l();"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});function jat(r,e){var t=r>>>16&65535,i=r&65535,n=e>>>16&65535,s=e&65535;return i*s+(t*s+i*n<<16>>>0)|0}Bs.mul=Math.imul||jat;function Vat(r,e){return r+e|0}Bs.add=Vat;function zat(r,e){return r-e|0}Bs.sub=zat;function Hat(r,e){return r<<e|r>>>32-e}Bs.rotl=Hat;function Gat(r,e){return r<<32-e|r>>>e}Bs.rotr=Gat;function $at(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}Bs.isInteger=Number.isInteger||$at;Bs.MAX_SAFE_INTEGER=9007199254740991;Bs.isSafeInteger=function(r){return Bs.isInteger(r)&&r>=-Bs.MAX_SAFE_INTEGER&&r<=Bs.MAX_SAFE_INTEGER}});var Z1=p(Et=>{l();"use strict";Object.defineProperty(Et,"__esModule",{value:!0});var ebe=Z1e();function Wat(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}Et.readInt16BE=Wat;function Yat(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}Et.readUint16BE=Yat;function Xat(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}Et.readInt16LE=Xat;function Jat(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}Et.readUint16LE=Jat;function tbe(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}Et.writeUint16BE=tbe;Et.writeInt16BE=tbe;function rbe(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}Et.writeUint16LE=rbe;Et.writeInt16LE=rbe;function nC(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}Et.readInt32BE=nC;function sC(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}Et.readUint32BE=sC;function oC(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}Et.readInt32LE=oC;function aC(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}Et.readUint32LE=aC;function JE(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}Et.writeUint32BE=JE;Et.writeInt32BE=JE;function QE(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}Et.writeUint32LE=QE;Et.writeInt32LE=QE;function Qat(r,e){e===void 0&&(e=0);var t=nC(r,e),i=nC(r,e+4);return t*4294967296+i-(i>>31)*4294967296}Et.readInt64BE=Qat;function Zat(r,e){e===void 0&&(e=0);var t=sC(r,e),i=sC(r,e+4);return t*4294967296+i}Et.readUint64BE=Zat;function ect(r,e){e===void 0&&(e=0);var t=oC(r,e),i=oC(r,e+4);return i*4294967296+t-(t>>31)*4294967296}Et.readInt64LE=ect;function tct(r,e){e===void 0&&(e=0);var t=aC(r,e),i=aC(r,e+4);return i*4294967296+t}Et.readUint64LE=tct;function ibe(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),JE(r/4294967296>>>0,e,t),JE(r>>>0,e,t+4),e}Et.writeUint64BE=ibe;Et.writeInt64BE=ibe;function nbe(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),QE(r>>>0,e,t),QE(r/4294967296>>>0,e,t+4),e}Et.writeUint64LE=nbe;Et.writeInt64LE=nbe;function rct(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=r/8+t-1;s>=t;s--)i+=e[s]*n,n*=256;return i}Et.readUintBE=rct;function ict(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=t;s<t+r/8;s++)i+=e[s]*n,n*=256;return i}Et.readUintLE=ict;function nct(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ebe.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=r/8+i-1;s>=i;s--)t[s]=e/n&255,n*=256;return t}Et.writeUintBE=nct;function sct(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ebe.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+r/8;s++)t[s]=e/n&255,n*=256;return t}Et.writeUintLE=sct;function oct(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}Et.readFloat32BE=oct;function act(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}Et.readFloat32LE=act;function cct(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}Et.readFloat64BE=cct;function uct(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}Et.readFloat64LE=uct;function fct(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}Et.writeFloat32BE=fct;function lct(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}Et.writeFloat32LE=lct;function hct(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}Et.writeFloat64BE=hct;function dct(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}Et.writeFloat64LE=dct});var cbe=p(ga=>{l();"use strict";Object.defineProperty(ga,"__esModule",{value:!0});var pct=Q1e(),yct=Z1(),sbe=mc();ga.defaultRandomSource=new pct.SystemRandomSource;function cC(r,e){return e===void 0&&(e=ga.defaultRandomSource),e.randomBytes(r)}ga.randomBytes=cC;function gct(r){r===void 0&&(r=ga.defaultRandomSource);var e=cC(4,r),t=yct.readUint32LE(e);return sbe.wipe(e),t}ga.randomUint32=gct;var obe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function abe(r,e,t){if(e===void 0&&(e=obe),t===void 0&&(t=ga.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var i="",n=e.length,s=256-256%n;r>0;){for(var o=cC(Math.ceil(r*256/s),t),a=0;a<o.length&&r>0;a++){var c=o[a];c<s&&(i+=e.charAt(c%n),r--)}sbe.wipe(o)}return i}ga.randomString=abe;function bct(r,e,t){e===void 0&&(e=obe),t===void 0&&(t=ga.defaultRandomSource);var i=Math.ceil(r/(Math.log(e.length)/Math.LN2));return abe(i,e,t)}ga.randomStringForEntropy=bct});var t3=p(os=>{l();"use strict";Object.defineProperty(os,"__esModule",{value:!0});var mct=cbe(),vct=mc();os.PUBLIC_KEY_LENGTH=32;os.SECRET_KEY_LENGTH=32;os.SHARED_KEY_LENGTH=32;function vc(r){var e=new Float64Array(16);if(r)for(var t=0;t<r.length;t++)e[t]=r[t];return e}var ube=new Uint8Array(32);ube[0]=9;var wct=vc([56129,1]);function uC(r){for(var e=1,t=0;t<16;t++){var i=r[t]+e+65535;e=Math.floor(i/65536),r[t]=i-e*65536}r[0]+=e-1+37*(e-1)}function eb(r,e,t){for(var i=~(t-1),n=0;n<16;n++){var s=i&(r[n]^e[n]);r[n]^=s,e[n]^=s}}function _ct(r,e){for(var t=vc(),i=vc(),n=0;n<16;n++)i[n]=e[n];uC(i),uC(i),uC(i);for(var s=0;s<2;s++){t[0]=i[0]-65517;for(var n=1;n<15;n++)t[n]=i[n]-65535-(t[n-1]>>16&1),t[n-1]&=65535;t[15]=i[15]-32767-(t[14]>>16&1);var o=t[15]>>16&1;t[14]&=65535,eb(i,t,1-o)}for(var n=0;n<16;n++)r[2*n]=i[n]&255,r[2*n+1]=i[n]>>8}function Ect(r,e){for(var t=0;t<16;t++)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function ZE(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]+t[i]}function e3(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]-t[i]}function yu(r,e,t){var i,n,s=0,o=0,a=0,c=0,u=0,f=0,h=0,d=0,y=0,g=0,m=0,x=0,_=0,P=0,q=0,X=0,W=0,z=0,Z=0,ee=0,re=0,L=0,b=0,w=0,R=0,B=0,U=0,Q=0,G=0,M=0,v=0,V=t[0],de=t[1],J=t[2],ue=t[3],S=t[4],A=t[5],ie=t[6],ae=t[7],E=t[8],I=t[9],j=t[10],H=t[11],T=t[12],K=t[13],F=t[14],N=t[15];i=e[0],s+=i*V,o+=i*de,a+=i*J,c+=i*ue,u+=i*S,f+=i*A,h+=i*ie,d+=i*ae,y+=i*E,g+=i*I,m+=i*j,x+=i*H,_+=i*T,P+=i*K,q+=i*F,X+=i*N,i=e[1],o+=i*V,a+=i*de,c+=i*J,u+=i*ue,f+=i*S,h+=i*A,d+=i*ie,y+=i*ae,g+=i*E,m+=i*I,x+=i*j,_+=i*H,P+=i*T,q+=i*K,X+=i*F,W+=i*N,i=e[2],a+=i*V,c+=i*de,u+=i*J,f+=i*ue,h+=i*S,d+=i*A,y+=i*ie,g+=i*ae,m+=i*E,x+=i*I,_+=i*j,P+=i*H,q+=i*T,X+=i*K,W+=i*F,z+=i*N,i=e[3],c+=i*V,u+=i*de,f+=i*J,h+=i*ue,d+=i*S,y+=i*A,g+=i*ie,m+=i*ae,x+=i*E,_+=i*I,P+=i*j,q+=i*H,X+=i*T,W+=i*K,z+=i*F,Z+=i*N,i=e[4],u+=i*V,f+=i*de,h+=i*J,d+=i*ue,y+=i*S,g+=i*A,m+=i*ie,x+=i*ae,_+=i*E,P+=i*I,q+=i*j,X+=i*H,W+=i*T,z+=i*K,Z+=i*F,ee+=i*N,i=e[5],f+=i*V,h+=i*de,d+=i*J,y+=i*ue,g+=i*S,m+=i*A,x+=i*ie,_+=i*ae,P+=i*E,q+=i*I,X+=i*j,W+=i*H,z+=i*T,Z+=i*K,ee+=i*F,re+=i*N,i=e[6],h+=i*V,d+=i*de,y+=i*J,g+=i*ue,m+=i*S,x+=i*A,_+=i*ie,P+=i*ae,q+=i*E,X+=i*I,W+=i*j,z+=i*H,Z+=i*T,ee+=i*K,re+=i*F,L+=i*N,i=e[7],d+=i*V,y+=i*de,g+=i*J,m+=i*ue,x+=i*S,_+=i*A,P+=i*ie,q+=i*ae,X+=i*E,W+=i*I,z+=i*j,Z+=i*H,ee+=i*T,re+=i*K,L+=i*F,b+=i*N,i=e[8],y+=i*V,g+=i*de,m+=i*J,x+=i*ue,_+=i*S,P+=i*A,q+=i*ie,X+=i*ae,W+=i*E,z+=i*I,Z+=i*j,ee+=i*H,re+=i*T,L+=i*K,b+=i*F,w+=i*N,i=e[9],g+=i*V,m+=i*de,x+=i*J,_+=i*ue,P+=i*S,q+=i*A,X+=i*ie,W+=i*ae,z+=i*E,Z+=i*I,ee+=i*j,re+=i*H,L+=i*T,b+=i*K,w+=i*F,R+=i*N,i=e[10],m+=i*V,x+=i*de,_+=i*J,P+=i*ue,q+=i*S,X+=i*A,W+=i*ie,z+=i*ae,Z+=i*E,ee+=i*I,re+=i*j,L+=i*H,b+=i*T,w+=i*K,R+=i*F,B+=i*N,i=e[11],x+=i*V,_+=i*de,P+=i*J,q+=i*ue,X+=i*S,W+=i*A,z+=i*ie,Z+=i*ae,ee+=i*E,re+=i*I,L+=i*j,b+=i*H,w+=i*T,R+=i*K,B+=i*F,U+=i*N,i=e[12],_+=i*V,P+=i*de,q+=i*J,X+=i*ue,W+=i*S,z+=i*A,Z+=i*ie,ee+=i*ae,re+=i*E,L+=i*I,b+=i*j,w+=i*H,R+=i*T,B+=i*K,U+=i*F,Q+=i*N,i=e[13],P+=i*V,q+=i*de,X+=i*J,W+=i*ue,z+=i*S,Z+=i*A,ee+=i*ie,re+=i*ae,L+=i*E,b+=i*I,w+=i*j,R+=i*H,B+=i*T,U+=i*K,Q+=i*F,G+=i*N,i=e[14],q+=i*V,X+=i*de,W+=i*J,z+=i*ue,Z+=i*S,ee+=i*A,re+=i*ie,L+=i*ae,b+=i*E,w+=i*I,R+=i*j,B+=i*H,U+=i*T,Q+=i*K,G+=i*F,M+=i*N,i=e[15],X+=i*V,W+=i*de,z+=i*J,Z+=i*ue,ee+=i*S,re+=i*A,L+=i*ie,b+=i*ae,w+=i*E,R+=i*I,B+=i*j,U+=i*H,Q+=i*T,G+=i*K,M+=i*F,v+=i*N,s+=38*W,o+=38*z,a+=38*Z,c+=38*ee,u+=38*re,f+=38*L,h+=38*b,d+=38*w,y+=38*R,g+=38*B,m+=38*U,x+=38*Q,_+=38*G,P+=38*M,q+=38*v,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=x+n+65535,n=Math.floor(i/65536),x=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,i=P+n+65535,n=Math.floor(i/65536),P=i-n*65536,i=q+n+65535,n=Math.floor(i/65536),q=i-n*65536,i=X+n+65535,n=Math.floor(i/65536),X=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=x+n+65535,n=Math.floor(i/65536),x=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,i=P+n+65535,n=Math.floor(i/65536),P=i-n*65536,i=q+n+65535,n=Math.floor(i/65536),q=i-n*65536,i=X+n+65535,n=Math.floor(i/65536),X=i-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=o,r[2]=a,r[3]=c,r[4]=u,r[5]=f,r[6]=h,r[7]=d,r[8]=y,r[9]=g,r[10]=m,r[11]=x,r[12]=_,r[13]=P,r[14]=q,r[15]=X}function tb(r,e){yu(r,e,e)}function Sct(r,e){for(var t=vc(),i=0;i<16;i++)t[i]=e[i];for(var i=253;i>=0;i--)tb(t,t),i!==2&&i!==4&&yu(t,t,e);for(var i=0;i<16;i++)r[i]=t[i]}function fC(r,e){for(var t=new Uint8Array(32),i=new Float64Array(80),n=vc(),s=vc(),o=vc(),a=vc(),c=vc(),u=vc(),f=0;f<31;f++)t[f]=r[f];t[31]=r[31]&127|64,t[0]&=248,Ect(i,e);for(var f=0;f<16;f++)s[f]=i[f];n[0]=a[0]=1;for(var f=254;f>=0;--f){var h=t[f>>>3]>>>(f&7)&1;eb(n,s,h),eb(o,a,h),ZE(c,n,o),e3(n,n,o),ZE(o,s,a),e3(s,s,a),tb(a,c),tb(u,n),yu(n,o,n),yu(o,s,c),ZE(c,n,o),e3(n,n,o),tb(s,n),e3(o,a,u),yu(n,o,wct),ZE(n,n,a),yu(o,o,n),yu(n,a,u),yu(a,s,i),tb(s,c),eb(n,s,h),eb(o,a,h)}for(var f=0;f<16;f++)i[f+16]=n[f],i[f+32]=o[f],i[f+48]=s[f],i[f+64]=a[f];var d=i.subarray(32),y=i.subarray(16);Sct(d,d),yu(y,y,d);var g=new Uint8Array(32);return _ct(g,y),g}os.scalarMult=fC;function fbe(r){return fC(r,ube)}os.scalarMultBase=fbe;function lbe(r){if(r.length!==os.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+os.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(r),t=fbe(e);return{publicKey:t,secretKey:e}}os.generateKeyPairFromSeed=lbe;function xct(r){var e=mct.randomBytes(32,r),t=lbe(e);return vct.wipe(e),t}os.generateKeyPair=xct;function Act(r,e,t){if(t===void 0&&(t=!1),r.length!==os.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==os.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var i=fC(r,e);if(t){for(var n=0,s=0;s<i.length;s++)n|=i[s];if(n===0)throw new Error("X25519: invalid shared key")}return i}os.sharedKey=Act});var dbe=p((U5t,hbe)=>{l();hbe.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var gbe=p((K5t,pbe)=>{l();"use strict";var Ict=dbe(),Tct=Yp(),ybe=ia();pbe.exports=(r,e={})=>{let t=Tct(r),i=ybe.decode.fromReader(t.reader,e),n=!1,s={read:async o=>{let{value:a,done:c}=await t.reader.next(o);if(c&&a.length<o)throw new Error("Couldn't read enough bytes");if(n=c,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:o,done:a}=await i.next();if(n=a,!o)throw new Error("Value is null");return o},readPB:async o=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let c=Ict(a)?a:a.slice();return o.decode(c)},write:o=>{t.writer.push(o)},writeLP:o=>{s.write(ybe.encode.single(o,e))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:()=>s.readPB(o),write:a=>s.writePB(a,o)}),unwrap:()=>(t.rest(),t.stream)};return s}});var mbe=p((j5t,bbe)=>{l();"use strict";var Rct=v_();bbe.exports=function(){let e,t,i=async s=>{if(e)throw new Error("already piped");e=Rct(s),t&&t(e)},n={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{t=o=>{t=null,s(o.next())}})}};return{sink:i,source:n}}});var _be=p((V5t,vbe)=>{l();var wbe=mbe();vbe.exports=function(){var r=wbe(),e=wbe();return[{source:r.source,sink:e.sink},{source:e.source,sink:r.sink}]}});var Ebe=p(lC=>{l();"use strict";Object.defineProperty(lC,"__esModule",{value:!0});function kct(r){return typeof r.saveState!="undefined"&&typeof r.restoreState!="undefined"&&typeof r.cleanSavedState!="undefined"}lC.isSerializableHash=kct});var r3=p(R0=>{l();"use strict";Object.defineProperty(R0,"__esModule",{value:!0});function Cct(r,e,t){return~(r-1)&e|r-1&t}R0.select=Cct;function Pct(r,e){return(r|0)-(e|0)-1>>>31&1}R0.lessOrEqual=Pct;function Sbe(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}R0.compare=Sbe;function Oct(r,e){return r.length===0||e.length===0?!1:Sbe(r,e)!==0}R0.equal=Oct});var Abe=p(rb=>{l();"use strict";Object.defineProperty(rb,"__esModule",{value:!0});var wc=Ebe(),Bct=r3(),Nct=mc(),xbe=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=54^92;this._outer.update(i),wc.isSerializableHash(this._inner)&&wc.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Nct.wipe(i)}return r.prototype.reset=function(){if(!wc.isSerializableHash(this._inner)||!wc.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){wc.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),wc.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!wc.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!wc.isSerializableHash(this._inner)||!wc.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!wc.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();rb.HMAC=xbe;function Dct(r,e,t){var i=new xbe(r,e);i.update(t);var n=i.digest();return i.clean(),n}rb.hmac=Dct;rb.equal=Bct.equal});var Rbe=p(hC=>{l();"use strict";Object.defineProperty(hC,"__esModule",{value:!0});var Ibe=Abe(),Tbe=mc(),qct=function(){function r(e,t,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=Ibe.hmac(this._hash,i,t);this._hmac=new Ibe.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),Tbe.wipe(this._buffer),Tbe.wipe(this._counter),this._bufpos=0},r}();hC.HKDF=qct});var pC=p(Of=>{l();"use strict";Object.defineProperty(Of,"__esModule",{value:!0});var i3=Z1(),n3=mc();Of.DIGEST_LENGTH=32;Of.BLOCK_SIZE=64;var kbe=function(){function r(){this.digestLength=Of.DIGEST_LENGTH,this.blockSize=Of.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return r.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},r.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},r.prototype.clean=function(){n3.wipe(this._buffer),n3.wipe(this._temp),this.reset()},r.prototype.update=function(e,t){if(t===void 0&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var i=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[i++],t--;this._bufferLength===this.blockSize&&(dC(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(i=dC(this._temp,this._state,e,i,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[i++],t--;return this},r.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,i=this._bufferLength,n=t/536870912|0,s=t<<3,o=t%64<56?64:128;this._buffer[i]=128;for(var a=i+1;a<o-8;a++)this._buffer[a]=0;i3.writeUint32BE(n,this._buffer,o-8),i3.writeUint32BE(s,this._buffer,o-4),dC(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)i3.writeUint32BE(this._state[a],e,a*4);return this},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},r.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},r.prototype.cleanSavedState=function(e){n3.wipe(e.state),e.buffer&&n3.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},r}();Of.SHA256=kbe;var Mct=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function dC(r,e,t,i,n){for(;n>=64;){for(var s=e[0],o=e[1],a=e[2],c=e[3],u=e[4],f=e[5],h=e[6],d=e[7],y=0;y<16;y++){var g=i+y*4;r[y]=i3.readUint32BE(t,g)}for(var y=16;y<64;y++){var m=r[y-2],x=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=r[y-15];var _=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;r[y]=(x+r[y-7]|0)+(_+r[y-16]|0)}for(var y=0;y<64;y++){var x=(((u>>>6|u<<32-6)^(u>>>11|u<<32-11)^(u>>>25|u<<32-25))+(u&f^~u&h)|0)+(d+(Mct[y]+r[y]|0)|0)|0,_=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&o^s&a^o&a)|0;d=h,h=f,f=u,u=c+x|0,c=a,a=o,o=s,s=x+_|0}e[0]+=s,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=u,e[5]+=f,e[6]+=h,e[7]+=d,i+=64,n-=64}return i}function Lct(r){var e=new kbe;e.update(r);var t=e.digest();return e.clean(),t}Of.hash=Lct});var Pbe=p((Cbe,ib)=>{l();"use strict";(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof ib=="object"&&ib&&ib.exports&&(ib.exports=e(hi()))})(Cbe,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots["libp2p-noise"]||(r.roots["libp2p-noise"]={});return n.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function o(a){if(a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}return o.prototype.identityKey=i.newBuffer([]),o.prototype.identitySig=i.newBuffer([]),o.prototype.data=i.newBuffer([]),o.create=function(c){return new o(c)},o.encode=function(c,u){return u||(u=t.create()),c.identityKey!=null&&Object.hasOwnProperty.call(c,"identityKey")&&u.uint32(10).bytes(c.identityKey),c.identitySig!=null&&Object.hasOwnProperty.call(c,"identitySig")&&u.uint32(18).bytes(c.identitySig),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&u.uint32(26).bytes(c.data),u},o.encodeDelimited=function(c,u){return this.encode(c,u).ldelim()},o.decode=function(c,u){c instanceof e||(c=e.create(c));for(var f=u===void 0?c.len:c.pos+u,h=new n.pb.NoiseHandshakePayload;c.pos<f;){var d=c.uint32();switch(d>>>3){case 1:h.identityKey=c.bytes();break;case 2:h.identitySig=c.bytes();break;case 3:h.data=c.bytes();break;default:c.skipType(d&7);break}}return h},o.decodeDelimited=function(c){return c instanceof e||(c=new e(c)),this.decode(c,c.uint32())},o.verify=function(c){return typeof c!="object"||c===null?"object expected":c.identityKey!=null&&c.hasOwnProperty("identityKey")&&!(c.identityKey&&typeof c.identityKey.length=="number"||i.isString(c.identityKey))?"identityKey: buffer expected":c.identitySig!=null&&c.hasOwnProperty("identitySig")&&!(c.identitySig&&typeof c.identitySig.length=="number"||i.isString(c.identitySig))?"identitySig: buffer expected":c.data!=null&&c.hasOwnProperty("data")&&!(c.data&&typeof c.data.length=="number"||i.isString(c.data))?"data: buffer expected":null},o.fromObject=function(c){if(c instanceof n.pb.NoiseHandshakePayload)return c;var u=new n.pb.NoiseHandshakePayload;return c.identityKey!=null&&(typeof c.identityKey=="string"?i.base64.decode(c.identityKey,u.identityKey=i.newBuffer(i.base64.length(c.identityKey)),0):c.identityKey.length&&(u.identityKey=c.identityKey)),c.identitySig!=null&&(typeof c.identitySig=="string"?i.base64.decode(c.identitySig,u.identitySig=i.newBuffer(i.base64.length(c.identitySig)),0):c.identitySig.length&&(u.identitySig=c.identitySig)),c.data!=null&&(typeof c.data=="string"?i.base64.decode(c.data,u.data=i.newBuffer(i.base64.length(c.data)),0):c.data.length&&(u.data=c.data)),u},o.toObject=function(c,u){u||(u={});var f={};return u.defaults&&(u.bytes===String?f.identityKey="":(f.identityKey=[],u.bytes!==Array&&(f.identityKey=i.newBuffer(f.identityKey))),u.bytes===String?f.identitySig="":(f.identitySig=[],u.bytes!==Array&&(f.identitySig=i.newBuffer(f.identitySig))),u.bytes===String?f.data="":(f.data=[],u.bytes!==Array&&(f.data=i.newBuffer(f.data)))),c.identityKey!=null&&c.hasOwnProperty("identityKey")&&(f.identityKey=u.bytes===String?i.base64.encode(c.identityKey,0,c.identityKey.length):u.bytes===Array?Array.prototype.slice.call(c.identityKey):c.identityKey),c.identitySig!=null&&c.hasOwnProperty("identitySig")&&(f.identitySig=u.bytes===String?i.base64.encode(c.identitySig,0,c.identitySig.length):u.bytes===Array?Array.prototype.slice.call(c.identitySig):c.identitySig),c.data!=null&&c.hasOwnProperty("data")&&(f.data=u.bytes===String?i.base64.encode(c.data,0,c.data.length):u.bytes===Array?Array.prototype.slice.call(c.data):c.data),f},o.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},o}(),s}(),n})});var Bf=p(sr=>{l();"use strict";var Fct=sr&&sr.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Uct=sr&&sr.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Kct=sr&&sr.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Fct(e,r,t);return Uct(e,r),e},Obe=sr&&sr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(sr,"__esModule",{value:!0});sr.isValidPublicKey=sr.getHkdf=sr.verifySignedPayload=sr.getHandshakePayload=sr.decodePayload=sr.getPeerIdFromPayload=sr.signPayload=sr.createHandshakePayload=sr.getPayload=sr.generateKeypair=void 0;var jct=Rbe(),Vct=pC(),zct=Kct(t3()),as=xt(),yC=Obe(dt()),Hct=za(),Gct=Pbe(),$ct=Obe(Dr()),s3=Gct.pb.NoiseHandshakePayload;function Wct(){let r=zct.generateKeyPair();return{publicKey:as.Buffer.from(r.publicKey.buffer,r.publicKey.byteOffset,r.publicKey.length),privateKey:as.Buffer.from(r.secretKey.buffer,r.secretKey.byteOffset,r.secretKey.length)}}sr.generateKeypair=Wct;async function Yct(r,e,t){let i=await Nbe(r,gC(e)),n=t??as.Buffer.alloc(0);return Bbe(r.marshalPubKey(),i,n)}sr.getPayload=Yct;function Bbe(r,e,t){let i=s3.create({identityKey:as.Buffer.from(r),identitySig:e,data:t??null});return as.Buffer.from(s3.encode(i).finish())}sr.createHandshakePayload=Bbe;async function Nbe(r,e){return as.Buffer.from(await r.privKey.sign(e))}sr.signPayload=Nbe;async function Xct(r){return await yC.default.createFromPubKey(as.Buffer.from(r.identityKey))}sr.getPeerIdFromPayload=Xct;function Jct(r){return s3.toObject(s3.decode(as.Buffer.from(r)))}sr.decodePayload=Jct;function gC(r){return as.Buffer.concat([as.Buffer.from("noise-libp2p-static-key:"),r])}sr.getHandshakePayload=gC;async function Qct(r,e){let t=await yC.default.createFromPubKey(e);return $ct.default(t.id,r)}async function Zct(r,e,t){let i=as.Buffer.from(e.identityKey);if(!await Qct(t.id,i))throw new Error("Peer ID doesn't match libp2p public key.");let n=gC(r),s=Hct.keys.unmarshalPublicKey(i);if(!e.identitySig||!s.verify(n,as.Buffer.from(e.identitySig)))throw new Error("Static key doesn't match to peer that signed payload!");return await yC.default.createFromPubKey(i)}sr.verifySignedPayload=Zct;function eut(r,e){let i=new jct.HKDF(Vct.SHA256,e,r).expand(96),n=as.Buffer.from(i.buffer,i.byteOffset,i.length),s=n.slice(0,32),o=n.slice(32,64),a=n.slice(64,96);return[s,o,a]}sr.getHkdf=eut;function tut(r){return!(!as.Buffer.isBuffer(r)||r.length!==32)}sr.isValidPublicKey=tut});var qbe=p(o3=>{l();"use strict";Object.defineProperty(o3,"__esModule",{value:!0});var En=Z1(),bC=mc(),rut=20;function iut(r,e,t){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=t[3]<<24|t[2]<<16|t[1]<<8|t[0],c=t[7]<<24|t[6]<<16|t[5]<<8|t[4],u=t[11]<<24|t[10]<<16|t[9]<<8|t[8],f=t[15]<<24|t[14]<<16|t[13]<<8|t[12],h=t[19]<<24|t[18]<<16|t[17]<<8|t[16],d=t[23]<<24|t[22]<<16|t[21]<<8|t[20],y=t[27]<<24|t[26]<<16|t[25]<<8|t[24],g=t[31]<<24|t[30]<<16|t[29]<<8|t[28],m=e[3]<<24|e[2]<<16|e[1]<<8|e[0],x=e[7]<<24|e[6]<<16|e[5]<<8|e[4],_=e[11]<<24|e[10]<<16|e[9]<<8|e[8],P=e[15]<<24|e[14]<<16|e[13]<<8|e[12],q=i,X=n,W=s,z=o,Z=a,ee=c,re=u,L=f,b=h,w=d,R=y,B=g,U=m,Q=x,G=_,M=P,v=0;v<rut;v+=2)q=q+Z|0,U^=q,U=U>>>32-16|U<<16,b=b+U|0,Z^=b,Z=Z>>>32-12|Z<<12,X=X+ee|0,Q^=X,Q=Q>>>32-16|Q<<16,w=w+Q|0,ee^=w,ee=ee>>>32-12|ee<<12,W=W+re|0,G^=W,G=G>>>32-16|G<<16,R=R+G|0,re^=R,re=re>>>32-12|re<<12,z=z+L|0,M^=z,M=M>>>32-16|M<<16,B=B+M|0,L^=B,L=L>>>32-12|L<<12,W=W+re|0,G^=W,G=G>>>32-8|G<<8,R=R+G|0,re^=R,re=re>>>32-7|re<<7,z=z+L|0,M^=z,M=M>>>32-8|M<<8,B=B+M|0,L^=B,L=L>>>32-7|L<<7,X=X+ee|0,Q^=X,Q=Q>>>32-8|Q<<8,w=w+Q|0,ee^=w,ee=ee>>>32-7|ee<<7,q=q+Z|0,U^=q,U=U>>>32-8|U<<8,b=b+U|0,Z^=b,Z=Z>>>32-7|Z<<7,q=q+ee|0,M^=q,M=M>>>32-16|M<<16,R=R+M|0,ee^=R,ee=ee>>>32-12|ee<<12,X=X+re|0,U^=X,U=U>>>32-16|U<<16,B=B+U|0,re^=B,re=re>>>32-12|re<<12,W=W+L|0,Q^=W,Q=Q>>>32-16|Q<<16,b=b+Q|0,L^=b,L=L>>>32-12|L<<12,z=z+Z|0,G^=z,G=G>>>32-16|G<<16,w=w+G|0,Z^=w,Z=Z>>>32-12|Z<<12,W=W+L|0,Q^=W,Q=Q>>>32-8|Q<<8,b=b+Q|0,L^=b,L=L>>>32-7|L<<7,z=z+Z|0,G^=z,G=G>>>32-8|G<<8,w=w+G|0,Z^=w,Z=Z>>>32-7|Z<<7,X=X+re|0,U^=X,U=U>>>32-8|U<<8,B=B+U|0,re^=B,re=re>>>32-7|re<<7,q=q+ee|0,M^=q,M=M>>>32-8|M<<8,R=R+M|0,ee^=R,ee=ee>>>32-7|ee<<7;En.writeUint32LE(q+i|0,r,0),En.writeUint32LE(X+n|0,r,4),En.writeUint32LE(W+s|0,r,8),En.writeUint32LE(z+o|0,r,12),En.writeUint32LE(Z+a|0,r,16),En.writeUint32LE(ee+c|0,r,20),En.writeUint32LE(re+u|0,r,24),En.writeUint32LE(L+f|0,r,28),En.writeUint32LE(b+h|0,r,32),En.writeUint32LE(w+d|0,r,36),En.writeUint32LE(R+y|0,r,40),En.writeUint32LE(B+g|0,r,44),En.writeUint32LE(U+m|0,r,48),En.writeUint32LE(Q+x|0,r,52),En.writeUint32LE(G+_|0,r,56),En.writeUint32LE(M+P|0,r,60)}function Dbe(r,e,t,i,n){if(n===void 0&&(n=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),c=0;c<t.length;c+=64){iut(a,s,r);for(var u=c;u<c+64&&u<t.length;u++)i[u]=t[u]^a[u-c];nut(s,0,o)}return bC.wipe(a),n===0&&bC.wipe(s),i}o3.streamXOR=Dbe;function sut(r,e,t,i){return i===void 0&&(i=0),bC.wipe(t),Dbe(r,e,t,t,i)}o3.stream=sut;function nut(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}});var Lbe=p(gu=>{l();"use strict";Object.defineProperty(gu,"__esModule",{value:!0});var out=r3(),a3=mc();gu.DIGEST_LENGTH=16;var Mbe=function(){function r(e){this.digestLength=gu.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var t=e[0]|e[1]<<8;this._r[0]=t&8191;var i=e[2]|e[3]<<8;this._r[1]=(t>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(n>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return r.prototype._blocks=function(e,t,i){for(var n=this._fin?0:1<<11,s=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],u=this._h[4],f=this._h[5],h=this._h[6],d=this._h[7],y=this._h[8],g=this._h[9],m=this._r[0],x=this._r[1],_=this._r[2],P=this._r[3],q=this._r[4],X=this._r[5],W=this._r[6],z=this._r[7],Z=this._r[8],ee=this._r[9];i>=16;){var re=e[t+0]|e[t+1]<<8;s+=re&8191;var L=e[t+2]|e[t+3]<<8;o+=(re>>>13|L<<3)&8191;var b=e[t+4]|e[t+5]<<8;a+=(L>>>10|b<<6)&8191;var w=e[t+6]|e[t+7]<<8;c+=(b>>>7|w<<9)&8191;var R=e[t+8]|e[t+9]<<8;u+=(w>>>4|R<<12)&8191,f+=R>>>1&8191;var B=e[t+10]|e[t+11]<<8;h+=(R>>>14|B<<2)&8191;var U=e[t+12]|e[t+13]<<8;d+=(B>>>11|U<<5)&8191;var Q=e[t+14]|e[t+15]<<8;y+=(U>>>8|Q<<8)&8191,g+=Q>>>5|n;var G=0,M=G;M+=s*m,M+=o*(5*ee),M+=a*(5*Z),M+=c*(5*z),M+=u*(5*W),G=M>>>13,M&=8191,M+=f*(5*X),M+=h*(5*q),M+=d*(5*P),M+=y*(5*_),M+=g*(5*x),G+=M>>>13,M&=8191;var v=G;v+=s*x,v+=o*m,v+=a*(5*ee),v+=c*(5*Z),v+=u*(5*z),G=v>>>13,v&=8191,v+=f*(5*W),v+=h*(5*X),v+=d*(5*q),v+=y*(5*P),v+=g*(5*_),G+=v>>>13,v&=8191;var V=G;V+=s*_,V+=o*x,V+=a*m,V+=c*(5*ee),V+=u*(5*Z),G=V>>>13,V&=8191,V+=f*(5*z),V+=h*(5*W),V+=d*(5*X),V+=y*(5*q),V+=g*(5*P),G+=V>>>13,V&=8191;var de=G;de+=s*P,de+=o*_,de+=a*x,de+=c*m,de+=u*(5*ee),G=de>>>13,de&=8191,de+=f*(5*Z),de+=h*(5*z),de+=d*(5*W),de+=y*(5*X),de+=g*(5*q),G+=de>>>13,de&=8191;var J=G;J+=s*q,J+=o*P,J+=a*_,J+=c*x,J+=u*m,G=J>>>13,J&=8191,J+=f*(5*ee),J+=h*(5*Z),J+=d*(5*z),J+=y*(5*W),J+=g*(5*X),G+=J>>>13,J&=8191;var ue=G;ue+=s*X,ue+=o*q,ue+=a*P,ue+=c*_,ue+=u*x,G=ue>>>13,ue&=8191,ue+=f*m,ue+=h*(5*ee),ue+=d*(5*Z),ue+=y*(5*z),ue+=g*(5*W),G+=ue>>>13,ue&=8191;var S=G;S+=s*W,S+=o*X,S+=a*q,S+=c*P,S+=u*_,G=S>>>13,S&=8191,S+=f*x,S+=h*m,S+=d*(5*ee),S+=y*(5*Z),S+=g*(5*z),G+=S>>>13,S&=8191;var A=G;A+=s*z,A+=o*W,A+=a*X,A+=c*q,A+=u*P,G=A>>>13,A&=8191,A+=f*_,A+=h*x,A+=d*m,A+=y*(5*ee),A+=g*(5*Z),G+=A>>>13,A&=8191;var ie=G;ie+=s*Z,ie+=o*z,ie+=a*W,ie+=c*X,ie+=u*q,G=ie>>>13,ie&=8191,ie+=f*P,ie+=h*_,ie+=d*x,ie+=y*m,ie+=g*(5*ee),G+=ie>>>13,ie&=8191;var ae=G;ae+=s*ee,ae+=o*Z,ae+=a*z,ae+=c*W,ae+=u*X,G=ae>>>13,ae&=8191,ae+=f*q,ae+=h*P,ae+=d*_,ae+=y*x,ae+=g*m,G+=ae>>>13,ae&=8191,G=(G<<2)+G|0,G=G+M|0,M=G&8191,G=G>>>13,v+=G,s=M,o=v,a=V,c=de,u=J,f=ue,h=S,d=A,y=ie,g=ae,t+=16,i-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=u,this._h[5]=f,this._h[6]=h,this._h[7]=d,this._h[8]=y,this._h[9]=g},r.prototype.finish=function(e,t){t===void 0&&(t=0);var i=new Uint16Array(10),n,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=n,n=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,i[0]=this._h[0]+5,n=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this._h[a]+n,n=i[a]>>>13,i[a]&=8191;for(i[9]-=1<<13,s=(n^1)-1,a=0;a<10;a++)i[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|i[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},r.prototype.update=function(e){var t=0,i=e.length,n;if(this._leftover){n=16-this._leftover,n>i&&(n=i);for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[t+s];if(i-=n,t+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(n=i-i%16,this._blocks(e,t,n),t+=n,i-=n),i){for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[t+s];this._leftover+=i}return this},r.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},r.prototype.clean=function(){return a3.wipe(this._buffer),a3.wipe(this._r),a3.wipe(this._h),a3.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},r}();gu.Poly1305=Mbe;function aut(r,e){var t=new Mbe(r);t.update(e);var i=t.digest();return t.clean(),i}gu.oneTimeAuth=aut;function cut(r,e){return r.length!==gu.DIGEST_LENGTH||e.length!==gu.DIGEST_LENGTH?!1:out.equal(r,e)}gu.equal=cut});var Kbe=p(bu=>{l();"use strict";Object.defineProperty(bu,"__esModule",{value:!0});var c3=qbe(),uut=Lbe(),nb=mc(),Fbe=Z1(),fut=r3();bu.KEY_LENGTH=32;bu.NONCE_LENGTH=12;bu.TAG_LENGTH=16;var Ube=new Uint8Array(16),lut=function(){function r(e){if(this.nonceLength=bu.NONCE_LENGTH,this.tagLength=bu.TAG_LENGTH,e.length!==bu.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return r.prototype.seal=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);c3.stream(this._key,s,o,4);var a=t.length+this.tagLength,c;if(n){if(n.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=n}else c=new Uint8Array(a);return c3.streamXOR(this._key,s,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),i),nb.wipe(s),c},r.prototype.open=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);c3.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,t.subarray(0,t.length-this.tagLength),i),!fut.equal(a,t.subarray(t.length-this.tagLength,t.length)))return null;var c=t.length-this.tagLength,u;if(n){if(n.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=n}else u=new Uint8Array(c);return c3.streamXOR(this._key,s,t.subarray(0,t.length-this.tagLength),u,4),nb.wipe(s),u},r.prototype.clean=function(){return nb.wipe(this._key),this},r.prototype._authenticate=function(e,t,i,n){var s=new uut.Poly1305(t);n&&(s.update(n),n.length%16>0&&s.update(Ube.subarray(n.length%16))),s.update(i),i.length%16>0&&s.update(Ube.subarray(i.length%16));var o=new Uint8Array(8);n&&Fbe.writeUint64LE(n.length,o),s.update(o),Fbe.writeUint64LE(i.length,o),s.update(o);for(var a=s.digest(),c=0;c<a.length;c++)e[c]=a[c];s.clean(),nb.wipe(a),nb.wipe(o)},r}();bu.ChaCha20Poly1305=lut});var u3=p(mu=>{l();"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.DUMP_SESSION_KEYS=mu.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=mu.NOISE_MSG_MAX_LENGTH_BYTES=void 0;mu.NOISE_MSG_MAX_LENGTH_BYTES=65535;mu.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=mu.NOISE_MSG_MAX_LENGTH_BYTES-16;mu.DUMP_SESSION_KEYS=process.env.DUMP_SESSION_KEYS});var k0=p(un=>{l();"use strict";var hut=un&&un.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(un,"__esModule",{value:!0});un.logCipherState=un.logRemoteEphemeralKey=un.logRemoteStaticKey=un.logLocalEphemeralKeys=un.logLocalStaticKeys=un.logger=void 0;var dut=hut(xe()),put=u3();un.logger=dut.default("libp2p:noise");var wo;put.DUMP_SESSION_KEYS?wo=un.logger:wo=()=>{};function yut(r){wo(`LOCAL_STATIC_PUBLIC_KEY ${r.publicKey.toString("hex")}`),wo(`LOCAL_STATIC_PRIVATE_KEY ${r.privateKey.toString("hex")}`)}un.logLocalStaticKeys=yut;function gut(r){r?(wo(`LOCAL_PUBLIC_EPHEMERAL_KEY ${r.publicKey.toString("hex")}`),wo(`LOCAL_PRIVATE_EPHEMERAL_KEY ${r.privateKey.toString("hex")}`)):wo("Missing local ephemeral keys.")}un.logLocalEphemeralKeys=gut;function but(r){wo(`REMOTE_STATIC_PUBLIC_KEY ${r.toString("hex")}`)}un.logRemoteStaticKey=but;function mut(r){wo(`REMOTE_EPHEMERAL_PUBLIC_KEY ${r.toString("hex")}`)}un.logRemoteEphemeralKey=mut;function vut(r){r.cs1&&r.cs2?(wo(`CIPHER_STATE_1 ${r.cs1.n} ${r.cs1.k.toString("hex")}`),wo(`CIPHER_STATE_2 ${r.cs2.n} ${r.cs2.k.toString("hex")}`)):wo("Missing cipher state.")}un.logCipherState=vut});var mC=p(Ns=>{l();"use strict";var wut=Ns&&Ns.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),_ut=Ns&&Ns.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jbe=Ns&&Ns.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&wut(e,r,t);return _ut(e,r),e};Object.defineProperty(Ns,"__esModule",{value:!0});Ns.AbstractHandshake=Ns.MIN_NONCE=void 0;var fn=xt(),Eut=jbe(t3()),Sut=jbe(pC()),Vbe=Kbe(),zbe=Bf(),xut=k0();Ns.MIN_NONCE=0;var Hbe=class{encryptWithAd(e,t,i){let n=this.encrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,t,i){let{plaintext:n,valid:s}=this.decrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,t){e.n=t}createEmptyKey(){return fn.Buffer.alloc(32)}isEmptyKey(e){return this.createEmptyKey().equals(e)}incrementNonce(e){return e+1}nonceToBytes(e){let t=fn.Buffer.alloc(12);return t.writeUInt32LE(e,4),t}encrypt(e,t,i,n){let s=this.nonceToBytes(t),a=new Vbe.ChaCha20Poly1305(e).seal(s,n,i);return fn.Buffer.from(a.buffer,a.byteOffset,a.length)}encryptAndHash(e,t){let i;return this.hasKey(e.cs)?i=this.encryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,i),i}decrypt(e,t,i,n){let s=this.nonceToBytes(t),a=new Vbe.ChaCha20Poly1305(e).open(s,n,i);return a?{plaintext:fn.Buffer.from(a.buffer,a.byteOffset,a.length),valid:!0}:{plaintext:fn.Buffer.from(""),valid:!1}}decryptAndHash(e,t){let i,n=!0;return this.hasKey(e.cs)?{plaintext:i,valid:n}=this.decryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,t),{plaintext:i,valid:n}}dh(e,t){try{let i=Eut.sharedKey(e,t),n=fn.Buffer.from(i.buffer,i.byteOffset,i.length),s=fn.Buffer.alloc(32);return n.copy(s),s}catch(i){return xut.logger(i.message),fn.Buffer.alloc(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){let i=Sut.hash(fn.Buffer.from([...e,...t]));return fn.Buffer.from(i.buffer,i.byteOffset,i.length)}mixKey(e,t){let[i,n]=zbe.getHkdf(e.ck,t);e.cs=this.initializeKey(n),e.ck=i}initializeKey(e){let t=Ns.MIN_NONCE;return{k:e,n:t}}initializeSymmetric(e){let t=fn.Buffer.from(e,"utf-8"),i=this.hashProtocolName(t),n=i,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:i}}hashProtocolName(e){if(e.length<=32){let t=fn.Buffer.alloc(32);return e.copy(t),t}else return this.getHash(e,fn.Buffer.alloc(0))}split(e){let[t,i]=zbe.getHkdf(e.ck,fn.Buffer.alloc(0)),n=this.initializeKey(t),s=this.initializeKey(i);return{cs1:n,cs2:s}}writeMessageRegular(e,t){let i=this.encryptWithAd(e,fn.Buffer.alloc(0),t),n=this.createEmptyKey(),s=fn.Buffer.alloc(0);return{ne:n,ns:s,ciphertext:i}}readMessageRegular(e,t){return this.decryptWithAd(e,fn.Buffer.alloc(0),t.ciphertext)}};Ns.AbstractHandshake=Hbe});var $be=p(f3=>{l();"use strict";Object.defineProperty(f3,"__esModule",{value:!0});f3.XX=void 0;var _h=xt(),C0=Bf(),Aut=mC(),Gbe=class extends Aut.AbstractHandshake{initializeInitiator(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=_h.Buffer.alloc(32);return{ss:o,s:t,rs:i,psk:n,re:a}}initializeResponder(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=_h.Buffer.alloc(32);return{ss:o,s:t,rs:i,psk:n,re:a}}writeMessageA(e,t,i){let n=_h.Buffer.alloc(0);i!==void 0?e.e=i:e.e=C0.generateKeypair();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,t);return{ne:s,ns:n,ciphertext:o}}writeMessageB(e,t){e.e=C0.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=_h.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageC(e,t){let i=_h.Buffer.from(e.s.publicKey),n=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,t),a={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:c,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:u}}readMessageA(e,t){return C0.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(C0.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&C0.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageC(e,t){let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&i.length===32&&C0.isValidPublicKey(i)&&(e.rs=i),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&o,cs1:a,cs2:c}}initSession(e,t,i){let n=this.createEmptyKey(),s=_h.Buffer.alloc(32),o;return e?o=this.initializeInitiator(t,i,s,n):o=this.initializeResponder(t,i,s,n),{hs:o,i:e,mc:0}}sendMessage(e,t,i){let n;if(e.mc===0)n=this.writeMessageA(e.hs,t,i);else if(e.mc===1)n=this.writeMessageB(e.hs,t);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,t);n=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,t){let i=_h.Buffer.alloc(0),n=!1;if(e.mc===0)({plaintext:i,valid:n}=this.readMessageA(e.hs,t));else if(e.mc===1)({plaintext:i,valid:n}=this.readMessageB(e.hs,t));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:u}=this.readMessageC(e.hs,t);i=o,n=a,e.h=s,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}};f3.XX=Gbe});var sb=p(bi=>{l();"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.decode2=bi.decode1=bi.decode0=bi.encode2=bi.encode1=bi.encode0=bi.uint16BEDecode=bi.uint16BEEncode=void 0;var P0=xt(),Iut=(r,e,t)=>(e=e||P0.Buffer.allocUnsafe(2),e.writeUInt16BE(r,t),e);bi.uint16BEEncode=Iut;bi.uint16BEEncode.bytes=2;var Tut=r=>{if(r.length<2)throw RangeError("Could not decode int16BE");return r.readUInt16BE(0)};bi.uint16BEDecode=Tut;bi.uint16BEDecode.bytes=2;function Rut(r){return P0.Buffer.concat([r.ne,r.ciphertext])}bi.encode0=Rut;function kut(r){return P0.Buffer.concat([r.ne,r.ns,r.ciphertext])}bi.encode1=kut;function Cut(r){return P0.Buffer.concat([r.ns,r.ciphertext])}bi.encode2=Cut;function Put(r){if(r.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:r.slice(0,32),ciphertext:r.slice(32,r.length),ns:P0.Buffer.alloc(0)}}bi.decode0=Put;function Out(r){if(r.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:r.slice(0,32),ns:r.slice(32,80),ciphertext:r.slice(80,r.length)}}bi.decode1=Out;function But(r){if(r.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:P0.Buffer.alloc(0),ns:r.slice(0,48),ciphertext:r.slice(48,r.length)}}bi.decode2=But});var vC=p(l3=>{l();"use strict";Object.defineProperty(l3,"__esModule",{value:!0});l3.XXHandshake=void 0;var ob=xt(),Nut=$be(),O0=Bf(),ci=k0(),B0=sb(),Wbe=class{constructor(e,t,i,n,s,o,a){this.isInitiator=e,this.payload=t,this.prologue=i,this.staticKeypair=n,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new Nut.XX,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=ob.Buffer.alloc(0)}async propose(){if(ci.logLocalStaticKeys(this.session.hs.s),this.isInitiator){ci.logger("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,ob.Buffer.alloc(0));this.connection.writeLP(B0.encode0(e)),ci.logger("Stage 0 - Initiator finished sending first message."),ci.logLocalEphemeralKeys(this.session.hs.e)}else{ci.logger("Stage 0 - Responder waiting to receive first message...");let e=B0.decode0((await this.connection.readLP()).slice()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new Error("xx handshake stage 0 validation fail");ci.logger("Stage 0 - Responder received first message."),ci.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){ci.logger("Stage 1 - Initiator waiting to receive first message from responder...");let e=B0.decode1((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 1 validation fail");ci.logger("Stage 1 - Initiator received the message."),ci.logRemoteEphemeralKey(this.session.hs.re),ci.logRemoteStaticKey(this.session.hs.rs),ci.logger("Initiator going to check remote's signature...");try{let n=await O0.decodePayload(t);this.remotePeer=this.remotePeer||await O0.getPeerIdFromPayload(n),this.remotePeer=await O0.verifySignedPayload(e.ns,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}ci.logger("All good with the signature!")}else{ci.logger("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(B0.encode1(e)),ci.logger("Stage 1 - Responder sent the second handshake message with signed payload."),ci.logLocalEphemeralKeys(this.session.hs.e)}}async finish(){if(this.isInitiator){ci.logger("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(B0.encode2(e)),ci.logger("Stage 2 - Initiator sent message with signed payload.")}else{ci.logger("Stage 2 - Responder waiting for third handshake message...");let e=B0.decode2((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 2 validation fail");ci.logger("Stage 2 - Responder received the message, finished handshake.");try{let n=await O0.decodePayload(t);this.remotePeer=this.remotePeer||await O0.getPeerIdFromPayload(n),await O0.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}ci.logCipherState(this.session)}encrypt(e,t){let i=this.getCS(t);return this.xx.encryptWithAd(i,ob.Buffer.alloc(0),e)}decrypt(e,t){let i=this.getCS(t,!1);return this.xx.decryptWithAd(i,ob.Buffer.alloc(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=ob.Buffer.from(e.buffer,e.byteOffset,e.length))}};l3.XXHandshake=Wbe});var Xbe=p(h3=>{l();"use strict";Object.defineProperty(h3,"__esModule",{value:!0});h3.IK=void 0;var d3=xt(),ab=Bf(),Dut=mC(),Ybe=class extends Dut.AbstractHandshake{initSession(e,t,i,n){let s=this.createEmptyKey(),o;return e?o=this.initializeInitiator(t,i,n,s):o=this.initializeResponder(t,i,n,s),{hs:o,i:e,mc:0}}sendMessage(e,t){let i;if(e.mc===0)i=this.writeMessageA(e.hs,t);else if(e.mc===1){let{messageBuffer:n,h:s,cs1:o,cs2:a}=this.writeMessageB(e.hs,t);i=n,e.h=s,e.cs1=o,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,t){let i=d3.Buffer.alloc(0),n=!1;if(e.mc===0&&({plaintext:i,valid:n}=this.readMessageA(e.hs,t)),e.mc===1){let{plaintext:s,valid:o,h:a,cs1:c,cs2:u}=this.readMessageB(e.hs,t);i=s,n=o,e.h=a,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}writeMessageA(e,t){e.e=ab.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=d3.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageB(e,t){e.e=ab.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,t),s=this.createEmptyKey(),o={ne:i,ns:s,ciphertext:n},{cs1:a,cs2:c}=this.split(e.ss);return{messageBuffer:o,cs1:a,cs2:c,h:e.ss.h}}readMessageA(e,t){ab.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&ab.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageB(e,t){if(ab.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:o}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:i,cs1:s,cs2:o}}initializeInitiator(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,i);let a=d3.Buffer.alloc(32);return{ss:o,s:t,rs:i,re:a,psk:n}}initializeResponder(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,t.publicKey);let a=d3.Buffer.alloc(32);return{ss:o,s:t,rs:i,re:a,psk:n}}};h3.IK=Ybe});var Qbe=p(p3=>{l();"use strict";Object.defineProperty(p3,"__esModule",{value:!0});p3.FailedIKError=void 0;var Jbe=class extends Error{constructor(e,t){super(t);this.initialMsg=e,this.name="FailedIKhandshake"}};p3.FailedIKError=Jbe});var tme=p(y3=>{l();"use strict";Object.defineProperty(y3,"__esModule",{value:!0});y3.IKHandshake=void 0;var qut=Xbe(),N0=xt(),g3=sb(),D0=Bf(),Zbe=Qbe(),Pi=k0(),eme=class{constructor(e,t,i,n,s,o,a,c){this.isInitiator=e,this.payload=N0.Buffer.from(t),this.prologue=i,this.staticKeypair=n,this.connection=s,a&&(this.remotePeer=a),this.ik=c??new qut.IK,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,o),this.remoteEarlyData=N0.Buffer.alloc(0)}async stage0(){if(Pi.logLocalStaticKeys(this.session.hs.s),Pi.logRemoteStaticKey(this.session.hs.rs),this.isInitiator){Pi.logger("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(g3.encode1(e)),Pi.logger("IK Stage 0 - Initiator sent message."),Pi.logLocalEphemeralKeys(this.session.hs.e)}else{Pi.logger("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let t=g3.decode1(e.slice()),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");Pi.logger("IK Stage 0 - Responder got message, going to verify payload.");let s=await D0.decodePayload(i);this.remotePeer=this.remotePeer||await D0.getPeerIdFromPayload(s),await D0.verifySignedPayload(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),Pi.logger("IK Stage 0 - Responder successfully verified payload!"),Pi.logRemoteEphemeralKey(this.session.hs.re)}catch(t){let i=t;throw Pi.logger("Responder breaking up with IK handshake in stage 0."),new Zbe.FailedIKError(e,`Error occurred while verifying initiator's signed payload: ${i.message}`)}}}async stage1(){if(this.isInitiator){Pi.logger("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),t=g3.decode0(N0.Buffer.from(e)),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);Pi.logger("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let s=await D0.decodePayload(i);this.remotePeer=this.remotePeer||await D0.getPeerIdFromPayload(s),await D0.verifySignedPayload(t.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),Pi.logger("IK Stage 1 - Initiator successfully verified payload!"),Pi.logRemoteEphemeralKey(this.session.hs.re)}catch(s){let o=s;throw Pi.logger("Initiator breaking up with IK handshake in stage 1."),new Zbe.FailedIKError(e,`Error occurred while verifying responder's signed payload: ${o.message}`)}}else{Pi.logger("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(g3.encode0(e)),Pi.logger("IK Stage 1 - Responder sent message..."),Pi.logLocalEphemeralKeys(this.session.hs.e)}Pi.logCipherState(this.session)}decrypt(e,t){let i=this.getCS(t,!1);return this.ik.decryptWithAd(i,N0.Buffer.alloc(0),e)}encrypt(e,t){let i=this.getCS(t);return this.ik.encryptWithAd(i,N0.Buffer.alloc(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=N0.Buffer.from(e.buffer,e.byteOffset,e.length))}};y3.IKHandshake=eme});var nme=p(b3=>{l();"use strict";Object.defineProperty(b3,"__esModule",{value:!0});b3.XXFallbackHandshake=void 0;var wC=xt(),Mut=vC(),_C=Bf(),_o=k0(),rme=sb(),ime=class extends Mut.XXHandshake{constructor(e,t,i,n,s,o,a,c,u){super(e,t,i,n,s,a,u);c&&(this.ephemeralKeys=c),this.initialMsg=o}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,wC.Buffer.alloc(0),this.ephemeralKeys),_o.logger("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),_o.logLocalEphemeralKeys(this.session.hs.e);else{_o.logger("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=rme.decode0(this.initialMsg),{valid:t}=this.xx.recvMessage(this.session,{ne:e.ne,ns:wC.Buffer.alloc(0),ciphertext:wC.Buffer.alloc(0)});if(!t)throw new Error("xx fallback stage 0 decryption validation fail");_o.logger("XX Fallback Stage 0 - Responder used received message from IK."),_o.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=rme.decode1(this.initialMsg),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx fallback stage 1 decryption validation fail");_o.logger("XX Fallback Stage 1 - Initiator used received message from IK."),_o.logRemoteEphemeralKey(this.session.hs.re),_o.logRemoteStaticKey(this.session.hs.rs),_o.logger("Initiator going to check remote's signature...");try{let n=await _C.decodePayload(t);this.remotePeer=this.remotePeer||await _C.getPeerIdFromPayload(n),await _C.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}_o.logger("All good with the signature!")}else _o.logger("XX Fallback Stage 1 - Responder start"),await super.exchange(),_o.logger("XX Fallback Stage 1 - Responder end")}};b3.XXFallbackHandshake=ime});var ome=p(q0=>{l();"use strict";Object.defineProperty(q0,"__esModule",{value:!0});q0.decryptStream=q0.encryptStream=void 0;var sme=xt(),m3=u3();function Lut(r){return async function*(e){for await(let t of e){let i=sme.Buffer.from(t.buffer,t.byteOffset,t.length);for(let n=0;n<i.length;n+=m3.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let s=n+m3.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;s>i.length&&(s=i.length),yield r.encrypt(i.slice(n,s),r.session)}}}}q0.encryptStream=Lut;function Fut(r){return async function*(e){for await(let t of e){let i=sme.Buffer.from(t.buffer,t.byteOffset,t.length);for(let n=0;n<i.length;n+=m3.NOISE_MSG_MAX_LENGTH_BYTES){let s=n+m3.NOISE_MSG_MAX_LENGTH_BYTES;s>i.length&&(s=i.length);let o=i.slice(n,s),{plaintext:a,valid:c}=await r.decrypt(o,r.session);if(!c)throw new Error("Failed to validate decrypted chunk");yield a}}}}q0.decryptStream=Fut});var cme=p(v3=>{l();"use strict";Object.defineProperty(v3,"__esModule",{value:!0});v3.KeyCache=void 0;var ame=class{constructor(){this.storage=new Map}store(e,t){this.storage.set(e.id,t)}load(e){var t;return e&&(t=this.storage.get(e.id))!==null&&t!==void 0?t:null}resetStorage(){this.storage.clear()}},Uut=new ame;v3.KeyCache=Uut});var SC=p(Eo=>{l();"use strict";var Kut=Eo&&Eo.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),jut=Eo&&Eo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Vut=Eo&&Eo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Kut(e,r,t);return jut(e,r),e},w3=Eo&&Eo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Eo,"__esModule",{value:!0});Eo.Noise=void 0;var zut=Vut(t3()),cb=xt(),ume=w3(gbe()),Hut=w3(_be()),fme=w3(oE()),Gut=w3(pi()),lme=ia(),$ut=vC(),Wut=tme(),Yut=nme(),hme=Bf(),M0=sb(),dme=ome(),EC=cme(),Xut=k0(),pme=u3(),yme=class{constructor(e,t){if(this.protocol="/noise",this.prologue=cb.Buffer.alloc(0),this.earlyData=t??cb.Buffer.alloc(0),this.useNoisePipes=!1,e){let i=zut.generateKeyPairFromSeed(e);this.staticKeys={privateKey:cb.Buffer.from(i.secretKey.buffer,i.secretKey.byteOffset,i.secretKey.length),publicKey:cb.Buffer.from(i.publicKey.buffer,i.publicKey.byteOffset,i.publicKey.length)}}else this.staticKeys=hme.generateKeypair()}async secureOutbound(e,t,i){let n=ume.default(t,{lengthEncoder:M0.uint16BEEncode,lengthDecoder:M0.uint16BEDecode,maxDataLength:pme.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,t,i){let n=ume.default(t,{lengthEncoder:M0.uint16BEEncode,lengthDecoder:M0.uint16BEDecode,maxDataLength:pme.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){var t;let i=await hme.getPayload(e.localPeer,this.staticKeys.publicKey,this.earlyData),n=this.useNoisePipes;if(e.isInitiator&&EC.KeyCache.load(e.remotePeer)===null&&(n=!1),n){let{remotePeer:s,connection:o,isInitiator:a}=e,c=new Wut.IKHandshake(a,i,this.prologue,this.staticKeys,o,(t=EC.KeyCache.load(e.remotePeer))!==null&&t!==void 0?t:cb.Buffer.alloc(32),s);try{return await this.performIKHandshake(c)}catch(u){let f;return e.isInitiator&&(f=c.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,i,u.initialMsg,f)}}else return await this.performXXHandshake(e,i)}async performXXFallbackHandshake(e,t,i,n){let{isInitiator:s,remotePeer:o,connection:a}=e,c=new Yut.XXFallbackHandshake(s,t,this.prologue,this.staticKeys,a,i,o,n);try{await c.propose(),await c.exchange(),await c.finish()}catch(u){Xut.logger(u);let f=u;throw new Error(`Error occurred during XX Fallback handshake: ${f.message}`)}return c}async performXXHandshake(e,t){let{isInitiator:i,remotePeer:n,connection:s}=e,o=new $ut.XXHandshake(i,t,this.prologue,this.staticKeys,s,n);try{await o.propose(),await o.exchange(),await o.finish(),this.useNoisePipes&&o.remotePeer&&EC.KeyCache.store(o.remotePeer,o.getRemoteStaticKey())}catch(a){let c=a;throw new Error(`Error occurred during XX handshake: ${c.message}`)}return o}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,t){let[i,n]=Hut.default(),s=e.unwrap();return await Gut.default(i,fme.default,dme.encryptStream(t),lme.encode({lengthEncoder:M0.uint16BEEncode}),s,lme.decode({lengthDecoder:M0.uint16BEDecode}),fme.default,dme.decryptStream(t),i),n}};Eo.Noise=yme});var gme=p(vu=>{l();"use strict";var Jut=vu&&vu.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Qut=vu&&vu.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Jut(e,r,t)};Object.defineProperty(vu,"__esModule",{value:!0});vu.NOISE=void 0;var Zut=SC();Qut(SC(),vu);vu.NOISE=new Zut.Noise});var vme=p((dIt,bme)=>{l();"use strict";var eft=ck(),{EventEmitter:tft}=Lr();function mme(r,e){if(r===e)return!0;if(r.length!==e.length)return!1;for(let t=0,i=r.length;t<i;++t)if(r[t]!==e[t])return!1;return!0}function xC(){return{contacts:[],dontSplit:!1,left:null,right:null}}function ub(r,e){if(!(e instanceof Uint8Array))throw new TypeError(r+" is not a Uint8Array")}var fb=class extends tft{constructor(e={}){super();this.localNodeId=e.localNodeId||eft(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||fb.distance,this.arbiter=e.arbiter||fb.arbiter,this.metadata=Object.assign({},e.metadata),ub("option.localNodeId as parameter 1",this.localNodeId),this.root=xC()}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let i=0,n=0,s=Math.min(e.length,t.length),o=Math.max(e.length,t.length);for(;n<s;++n)i=i*256+(e[n]^t[n]);for(;n<o;++n)i=i*256+255;return i}add(e){ub("contact.id",(e||{}).id);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e.id,t++);let n=this._indexOf(i,e.id);return n>=0?(this._update(i,n,e),this):i.contacts.length<this.numberOfNodesPerKBucket?(i.contacts.push(e),this.emit("added",e),this):i.dontSplit?(this.emit("ping",i.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(i,t),this.add(e))}closest(e,t=Infinity){if(ub("id",e),!Number.isInteger(t)&&t!==Infinity||t<=0)throw new TypeError("n is not positive number");let i=[];for(let n=[this.root],s=0;n.length>0&&i.length<t;){let o=n.pop();if(o.contacts===null){let a=this._determineNode(o,e,s++);n.push(o.left===a?o.right:o.left),n.push(a)}else i=i.concat(o.contacts)}return i.map(n=>[this.distance(n.id,e),n]).sort((n,s)=>n[0]-s[0]).slice(0,t).map(n=>n[1])}count(){let e=0;for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e+=i.contacts.length}return e}_determineNode(e,t,i){let n=i>>3,s=i%8;return t.length<=n&&s!==0?e.left:t[n]&1<<7-s?e.right:e.left}get(e){ub("id",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);return n>=0?i.contacts[n]:null}_indexOf(e,t){for(let i=0;i<e.contacts.length;++i)if(mme(e.contacts[i].id,t))return i;return-1}remove(e){ub("the id as parameter 1",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);if(n>=0){let s=i.contacts.splice(n,1)[0];this.emit("removed",s)}return this}_split(e,t){e.left=xC(),e.right=xC();for(let s of e.contacts)this._determineNode(e,s.id,t).contacts.push(s);e.contacts=null;let i=this._determineNode(e,this.localNodeId,t),n=e.left===i?e.right:e.left;n.dontSplit=!0}toArray(){let e=[];for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e=e.concat(i.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let t=e.pop();t.contacts===null?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,i){if(!mme(e.contacts[t].id,i.id))throw new Error("wrong index for _update");let n=e.contacts[t],s=this.arbiter(n,i);s===n&&n!==i||(e.contacts.splice(t,1),e.contacts.push(s),this.emit("updated",n,s))}};bme.exports=fb});var _3=p((pIt,wme)=>{l();wme.exports=Nf;function Nf(r,e){if(r.length!==e.length)throw new Error("Inputs should have the same length");for(var t=Buffer.allocUnsafe(r.length),i=0;i<r.length;i++)t[i]=r[i]^e[i];return t}Nf.compare=function(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");for(var i=0;i<e.length;i++)if(e[i]!==t[i])return e[i]<t[i]?-1:1;return 0};Nf.gt=function(e,t){return Nf.compare(e,t)===1};Nf.lt=function(e,t){return Nf.compare(e,t)===-1};Nf.eq=function(e,t){return Nf.compare(e,t)===0}});var E3=p((yIt,_me)=>{l();"use strict";var rft=QT();_me.exports=async(r,e,{concurrency:t=Infinity,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(t)||t===Infinity)&&t>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${t}\` (${typeof t})`);let o=[],a=[],c=r[Symbol.iterator](),u=!1,f=!1,h=0,d=0,y=()=>{if(u)return;let g=c.next(),m=d;if(d++,g.done){f=!0,h===0&&(!i&&a.length!==0?s(new rft(a)):n(o));return}h++,(async()=>{try{let x=await g.value;o[m]=await e(x,m),h--,y()}catch(x){i?(u=!0,s(x)):(a.push(x),h--,y())}})()};for(let g=0;g<t&&(y(),!f);g++);})});var fi=p(ui=>{l();"use strict";var AC=xe(),IC=er(),ift=IC.multihash,{Key:nft}=ir(),Eme=_3(),sft=E3(),{Record:oft}=Sl(),aft=dt(),cft=ge(),uft=vi(),Sme=ct(),xme=tt();ui.convertBuffer=r=>IC.digest(r,"sha2-256");ui.convertPeerId=r=>IC.digest(r.id,"sha2-256");ui.bufferToKey=r=>new nft("/"+ui.encodeBase32(r),!1);ui.keyForPublicKey=r=>uft([Sme("/pk/"),r.id]);ui.isPublicKeyKey=r=>xme(r.slice(0,4))==="/pk/";ui.fromPublicKeyKey=r=>new aft(r.slice(4));ui.now=()=>Date.now();ui.encodeBase32=r=>xme(r,"base32");ui.decodeBase32=r=>Sme(r,"base32");ui.sortClosestPeers=async(r,e)=>(await sft(r,async i=>{let n=await ui.convertPeerId(i);return{peer:i,distance:Eme(n,e)}})).sort(ui.xorCompare).map(i=>i.peer);ui.xorCompare=(r,e)=>Eme.compare(r.distance,e.distance);ui.pathSize=(r,e)=>Math.ceil(r/e);ui.createPutRecord=(r,e)=>{let t=new Date;return new oft(r,e,t).serialize()};ui.logger=(r,e)=>{let t=["libp2p","dht"];return e&&t.push(e),r&&t.push(`${r.toB58String().slice(0,8)}`),AC.formatters.b=n=>ift.toB58String(n),Object.assign(AC(t.join(":")),{error:AC(t.concat(["error"]).join(":"))})};ui.TimeoutError=class extends Error{get code(){return"ETIMEDOUT"}};ui.withTimeout=(r,e)=>{function t(...i){return Promise.race([r(...i),new Promise((n,s)=>{setTimeout(()=>{s(cft(new Error("Async function did not complete before timeout"),"ETIMEDOUT"))},e)})])}return t};ui.mapParallel=async function(r,e){let t=[];for await(let i of r)t.push(e(i));return Promise.all(t)}});var Tme=p((mIt,Ame)=>{l();"use strict";var fft=vme(),S3=fi(),Ime=class{constructor(e,t){this.self=e,this._onPing=this._onPing.bind(this),this._onInit(t)}async _onInit(e){let t=await S3.convertPeerId(this.self);this.kb=new fft({localNodeId:t,numberOfNodesPerKBucket:e,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}_onPing(e,t){let i=e[0];i&&this.kb.remove(i.id),this.kb.add(t)}get size(){return this.kb.count()}async find(e){let t=await S3.convertPeerId(e),i=this.closestPeer(t);if(i&&e.equals(i))return i}closestPeer(e){let t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t){return this.kb.closest(e,t).map(n=>n.peer)}async add(e){let t=await S3.convertPeerId(e);this.kb.add({id:t,peer:e})}async remove(e){let t=await S3.convertPeerId(e);this.kb.remove(t)}};Ame.exports=Ime});var Df=p(Ln=>{l();"use strict";var x3=Ln.second=1e3,Rme=Ln.minute=60*x3,TC=Ln.hour=60*Rme;Ln.MAX_RECORD_AGE=36*TC;Ln.PROTOCOL_DHT="/kad/1.0.0";Ln.PROVIDERS_KEY_PREFIX="/providers/";Ln.PROVIDERS_LRU_CACHE_SIZE=256;Ln.PROVIDERS_VALIDITY=24*TC;Ln.PROVIDERS_CLEANUP_INTERVAL=TC;Ln.READ_MESSAGE_TIMEOUT=10*x3;Ln.GET_MANY_RECORD_COUNT=16;Ln.K=20;Ln.ALPHA=3;Ln.defaultRandomWalk={enabled:!0,queriesPerPeriod:1,interval:5*Rme,timeout:10*x3,delay:10*x3}});var lb=p((wIt,A3)=>{l();"use strict";var RC=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},kme=(r,e,t,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===Infinity){o(r);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{o(t())}catch(f){a(f)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,u=t instanceof Error?t:new RC(c);typeof r.cancel=="function"&&r.cancel(),a(u)},e),(async()=>{try{o(await r)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};A3.exports=kme;A3.exports.default=kme;A3.exports.TimeoutError=RC});var Pme=p((_It,Cme)=>{l();"use strict";var qf=hi(),L0=qf.Reader,kC=qf.Writer,ot=qf.util,ri=qf.roots["libp2p-dht-message"]||(qf.roots["libp2p-dht-message"]={});ri.Record=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key=ot.newBuffer([]),r.prototype.value=ot.newBuffer([]),r.prototype.author=ot.newBuffer([]),r.prototype.signature=ot.newBuffer([]),r.prototype.timeReceived="",r.encode=function(t,i){return i||(i=kC.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).bytes(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),t.author!=null&&Object.hasOwnProperty.call(t,"author")&&i.uint32(26).bytes(t.author),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(34).bytes(t.signature),t.timeReceived!=null&&Object.hasOwnProperty.call(t,"timeReceived")&&i.uint32(42).string(t.timeReceived),i},r.decode=function(t,i){t instanceof L0||(t=L0.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new ri.Record;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.bytes();break;case 2:s.value=t.bytes();break;case 3:s.author=t.bytes();break;case 4:s.signature=t.bytes();break;case 5:s.timeReceived=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof ri.Record)return t;var i=new ri.Record;return t.key!=null&&(typeof t.key=="string"?ot.base64.decode(t.key,i.key=ot.newBuffer(ot.base64.length(t.key)),0):t.key.length&&(i.key=t.key)),t.value!=null&&(typeof t.value=="string"?ot.base64.decode(t.value,i.value=ot.newBuffer(ot.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.author!=null&&(typeof t.author=="string"?ot.base64.decode(t.author,i.author=ot.newBuffer(ot.base64.length(t.author)),0):t.author.length&&(i.author=t.author)),t.signature!=null&&(typeof t.signature=="string"?ot.base64.decode(t.signature,i.signature=ot.newBuffer(ot.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),t.timeReceived!=null&&(i.timeReceived=String(t.timeReceived)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=ot.newBuffer(n.key))),i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=ot.newBuffer(n.value))),i.bytes===String?n.author="":(n.author=[],i.bytes!==Array&&(n.author=ot.newBuffer(n.author))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=ot.newBuffer(n.signature))),n.timeReceived=""),t.key!=null&&t.hasOwnProperty("key")&&(n.key=i.bytes===String?ot.base64.encode(t.key,0,t.key.length):i.bytes===Array?Array.prototype.slice.call(t.key):t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?ot.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.author!=null&&t.hasOwnProperty("author")&&(n.author=i.bytes===String?ot.base64.encode(t.author,0,t.author.length):i.bytes===Array?Array.prototype.slice.call(t.author):t.author),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?ot.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),t.timeReceived!=null&&t.hasOwnProperty("timeReceived")&&(n.timeReceived=t.timeReceived),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,qf.util.toJSONOptions)},r}();ri.Message=function(){function r(e){if(this.closerPeers=[],this.providerPeers=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.type=0,r.prototype.clusterLevelRaw=0,r.prototype.key=ot.newBuffer([]),r.prototype.record=ot.newBuffer([]),r.prototype.closerPeers=ot.emptyArray,r.prototype.providerPeers=ot.emptyArray,r.encode=function(t,i){if(i||(i=kC.create()),t.type!=null&&Object.hasOwnProperty.call(t,"type")&&i.uint32(8).int32(t.type),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(18).bytes(t.key),t.record!=null&&Object.hasOwnProperty.call(t,"record")&&i.uint32(26).bytes(t.record),t.closerPeers!=null&&t.closerPeers.length)for(var n=0;n<t.closerPeers.length;++n)ri.Message.Peer.encode(t.closerPeers[n],i.uint32(66).fork()).ldelim();if(t.providerPeers!=null&&t.providerPeers.length)for(var n=0;n<t.providerPeers.length;++n)ri.Message.Peer.encode(t.providerPeers[n],i.uint32(74).fork()).ldelim();return t.clusterLevelRaw!=null&&Object.hasOwnProperty.call(t,"clusterLevelRaw")&&i.uint32(80).int32(t.clusterLevelRaw),i},r.decode=function(t,i){t instanceof L0||(t=L0.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new ri.Message;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.type=t.int32();break;case 10:s.clusterLevelRaw=t.int32();break;case 2:s.key=t.bytes();break;case 3:s.record=t.bytes();break;case 8:s.closerPeers&&s.closerPeers.length||(s.closerPeers=[]),s.closerPeers.push(ri.Message.Peer.decode(t,t.uint32()));break;case 9:s.providerPeers&&s.providerPeers.length||(s.providerPeers=[]),s.providerPeers.push(ri.Message.Peer.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof ri.Message)return t;var i=new ri.Message;switch(t.type){case"PUT_VALUE":case 0:i.type=0;break;case"GET_VALUE":case 1:i.type=1;break;case"ADD_PROVIDER":case 2:i.type=2;break;case"GET_PROVIDERS":case 3:i.type=3;break;case"FIND_NODE":case 4:i.type=4;break;case"PING":case 5:i.type=5;break}if(t.clusterLevelRaw!=null&&(i.clusterLevelRaw=t.clusterLevelRaw|0),t.key!=null&&(typeof t.key=="string"?ot.base64.decode(t.key,i.key=ot.newBuffer(ot.base64.length(t.key)),0):t.key.length&&(i.key=t.key)),t.record!=null&&(typeof t.record=="string"?ot.base64.decode(t.record,i.record=ot.newBuffer(ot.base64.length(t.record)),0):t.record.length&&(i.record=t.record)),t.closerPeers){if(!Array.isArray(t.closerPeers))throw TypeError(".Message.closerPeers: array expected");i.closerPeers=[];for(var n=0;n<t.closerPeers.length;++n){if(typeof t.closerPeers[n]!="object")throw TypeError(".Message.closerPeers: object expected");i.closerPeers[n]=ri.Message.Peer.fromObject(t.closerPeers[n])}}if(t.providerPeers){if(!Array.isArray(t.providerPeers))throw TypeError(".Message.providerPeers: array expected");i.providerPeers=[];for(var n=0;n<t.providerPeers.length;++n){if(typeof t.providerPeers[n]!="object")throw TypeError(".Message.providerPeers: object expected");i.providerPeers[n]=ri.Message.Peer.fromObject(t.providerPeers[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.closerPeers=[],n.providerPeers=[]),i.defaults&&(n.type=i.enums===String?"PUT_VALUE":0,i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=ot.newBuffer(n.key))),i.bytes===String?n.record="":(n.record=[],i.bytes!==Array&&(n.record=ot.newBuffer(n.record))),n.clusterLevelRaw=0),t.type!=null&&t.hasOwnProperty("type")&&(n.type=i.enums===String?ri.Message.MessageType[t.type]:t.type),t.key!=null&&t.hasOwnProperty("key")&&(n.key=i.bytes===String?ot.base64.encode(t.key,0,t.key.length):i.bytes===Array?Array.prototype.slice.call(t.key):t.key),t.record!=null&&t.hasOwnProperty("record")&&(n.record=i.bytes===String?ot.base64.encode(t.record,0,t.record.length):i.bytes===Array?Array.prototype.slice.call(t.record):t.record),t.closerPeers&&t.closerPeers.length){n.closerPeers=[];for(var s=0;s<t.closerPeers.length;++s)n.closerPeers[s]=ri.Message.Peer.toObject(t.closerPeers[s],i)}if(t.providerPeers&&t.providerPeers.length){n.providerPeers=[];for(var s=0;s<t.providerPeers.length;++s)n.providerPeers[s]=ri.Message.Peer.toObject(t.providerPeers[s],i)}return t.clusterLevelRaw!=null&&t.hasOwnProperty("clusterLevelRaw")&&(n.clusterLevelRaw=t.clusterLevelRaw),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,qf.util.toJSONOptions)},r.MessageType=function(){var e={},t=Object.create(e);return t[e[0]="PUT_VALUE"]=0,t[e[1]="GET_VALUE"]=1,t[e[2]="ADD_PROVIDER"]=2,t[e[3]="GET_PROVIDERS"]=3,t[e[4]="FIND_NODE"]=4,t[e[5]="PING"]=5,t}(),r.ConnectionType=function(){var e={},t=Object.create(e);return t[e[0]="NOT_CONNECTED"]=0,t[e[1]="CONNECTED"]=1,t[e[2]="CAN_CONNECT"]=2,t[e[3]="CANNOT_CONNECT"]=3,t}(),r.Peer=function(){function e(t){if(this.addrs=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.id=ot.newBuffer([]),e.prototype.addrs=ot.emptyArray,e.prototype.connection=0,e.encode=function(i,n){if(n||(n=kC.create()),i.id!=null&&Object.hasOwnProperty.call(i,"id")&&n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return i.connection!=null&&Object.hasOwnProperty.call(i,"connection")&&n.uint32(24).int32(i.connection),n},e.decode=function(i,n){i instanceof L0||(i=L0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new ri.Message.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.id=i.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(i.bytes());break;case 3:o.connection=i.int32();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof ri.Message.Peer)return i;var n=new ri.Message.Peer;if(i.id!=null&&(typeof i.id=="string"?ot.base64.decode(i.id,n.id=ot.newBuffer(ot.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".Message.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?ot.base64.decode(i.addrs[s],n.addrs[s]=ot.newBuffer(ot.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}switch(i.connection){case"NOT_CONNECTED":case 0:n.connection=0;break;case"CONNECTED":case 1:n.connection=1;break;case"CAN_CONNECT":case 2:n.connection=2;break;case"CANNOT_CONNECT":case 3:n.connection=3;break}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=ot.newBuffer(s.id))),s.connection=n.enums===String?"NOT_CONNECTED":0),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?ot.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var o=0;o<i.addrs.length;++o)s.addrs[o]=n.bytes===String?ot.base64.encode(i.addrs[o],0,i.addrs[o].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[o]):i.addrs[o]}return i.connection!=null&&i.hasOwnProperty("connection")&&(s.connection=n.enums===String?ri.Message.ConnectionType[i.connection]:i.connection),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,qf.util.toJSONOptions)},e}(),r}();Cme.exports=ri});var _c=p((EIt,Ome)=>{l();"use strict";var lft=dt(),{Multiaddr:hft}=lr(),{Record:dft}=Sl(),I3=Pme(),pft=I3.Message.MessageType,Bme=I3.Message.ConnectionType,F0=class{constructor(e,t,i){if(t&&!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this._clusterLevelRaw=i,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){let e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(Nme),providerPeers:this.providerPeers.map(Nme),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),I3.Message.encode(e).finish()}static deserialize(e){let t=I3.Message.decode(e),i=new F0(t.type,t.key,t.clusterLevelRaw);return i.closerPeers=t.closerPeers.map(Dme),i.providerPeers=t.providerPeers.map(Dme),t.record&&t.record.length&&(i.record=dft.deserialize(t.record)),i}};F0.TYPES=pft;F0.CONNECTION_TYPES=Bme;function Nme(r){return{id:r.id.id,addrs:(r.multiaddrs||[]).map(t=>t.bytes),connection:Bme.CONNECTED}}function Dme(r){return{id:new lft(r.id),multiaddrs:(r.addrs||[]).map(e=>new hft(e))}}Ome.exports=F0});var Lme=p((SIt,qme)=>{l();"use strict";var{Record:yft}=Sl(),gft=ge(),Mme=_c(),CC=fi();qme.exports=r=>{let e=CC.logger(r.peerId,"rpc:get-value");async function t(i,n){let s=n.key;if(e("key: %b",s),!s||s.length===0)throw gft(new Error("Invalid key"),"ERR_INVALID_KEY");let o=new Mme(Mme.TYPES.GET_VALUE,s,n.clusterLevel);if(CC.isPublicKeyKey(s)){e("is public key");let u=CC.fromPublicKeyKey(s),f;if(r._isSelf(u))f=r.peerId;else{let h=r.peerStore.get(u);f=h&&h.id}if(f&&f.pubKey)return e("returning found public key"),o.record=new yft(s,f.pubKey.bytes),o}let[a,c]=await Promise.all([r._checkLocalDatastore(s),r._betterPeersToQuery(n,i)]);return a&&(e("got record"),o.record=a),c.length>0&&(e("got closer %s",c.length),o.closerPeers=c),o}return t}});var Kme=p((xIt,Fme)=>{l();"use strict";var Ume=fi(),bft=ge();Fme.exports=r=>{let e=Ume.logger(r.peerId,"rpc:put-value");async function t(i,n){let s=n.key;e("key: %b",s);let o=n.record;if(!o){let c=`Empty record from: ${i.toB58String()}`;throw e.error(c),bft(new Error(c),"ERR_EMPTY_RECORD")}await r._verifyRecordLocally(o),o.timeReceived=new Date;let a=Ume.bufferToKey(o.key);return await r.datastore.put(a,o.serialize()),r.onPut(o,i),n}return t}});var Vme=p((AIt,jme)=>{l();"use strict";var mft=Dr(),vft=_c(),wft=fi();jme.exports=r=>{let e=wft.logger(r.peerId,"rpc:find-node");async function t(i,n){e("start");let s;mft(n.key,r.peerId.id)?s=[{id:r.peerId,multiaddrs:r.libp2p.multiaddrs}]:s=await r._betterPeersToQuery(n,i);let o=new vft(n.type,new Uint8Array(0),n.clusterLevel);return s.length>0?o.closerPeers=s:e("handle FindNode %s: could not find anything",i.toB58String()),o}return t}});var Gme=p((IIt,zme)=>{l();"use strict";var _ft=Qe(),Hme=ge(),Eft=fi();zme.exports=r=>{let e=Eft.logger(r.peerId,"rpc:add-provider");async function t(i,n){if(e("start"),!n.key||n.key.length===0)throw Hme(new Error("Missing key"),"ERR_MISSING_KEY");let s;try{s=new _ft(n.key)}catch(o){let a=`Invalid CID: ${o.message}`;throw Hme(new Error(a),"ERR_INVALID_CID")}return n.providerPeers.forEach(o=>{if(!o.id.isEqual(i)){e("invalid provider peer %s from %s",o.id.toB58String(),i.toB58String());return}if(o.multiaddrs.length<1){e("no valid addresses for provider %s. Ignore",i.toB58String());return}if(e("received provider %s for %s (addrs %s)",i.toB58String(),s.toBaseEncodedString(),o.multiaddrs.map(a=>a.toString())),!r._isSelf(o.id))return r.peerStore.addressBook.add(o.id,o.multiaddrs),r.providers.addProvider(s,o.id)}),r.providers.addProvider(s,i)}return t}});var Yme=p((TIt,$me)=>{l();"use strict";var Sft=Qe(),xft=ge(),Aft=_c(),Wme=fi();$me.exports=r=>{let e=Wme.logger(r.peerId,"rpc:get-providers");async function t(i,n){let s;try{s=new Sft(n.key)}catch(y){throw xft(new Error(`Invalid CID: ${y.message}`),"ERR_INVALID_CID")}e("%s",s.toBaseEncodedString());let o=Wme.bufferToKey(s.bytes),[a,c,u]=await Promise.all([r.datastore.has(o),r.providers.getProviders(s),r._betterPeersToQuery(n,i)]),f=c.map(y=>({id:y,multiaddrs:[]})),h=u.map(y=>({id:y.id,multiaddrs:[]}));a&&f.push({id:r.peerId,multiaddrs:[]});let d=new Aft(n.type,n.key,n.clusterLevel);return f.length>0&&(d.providerPeers=f),h.length>0&&(d.closerPeers=h),e("got %s providers %s closerPeers",f.length,h.length),d}return t}});var Jme=p((RIt,Xme)=>{l();"use strict";var Ift=fi();Xme.exports=r=>{let e=Ift.logger(r.peerId,"rpc:ping");function t(i,n){return e("from %s",i.toB58String()),n}return t}});var Zme=p((kIt,Qme)=>{l();"use strict";var U0=_c().TYPES;Qme.exports=r=>{let e={[U0.GET_VALUE]:Lme()(r),[U0.PUT_VALUE]:Kme()(r),[U0.FIND_NODE]:Vme()(r),[U0.ADD_PROVIDER]:Gme()(r),[U0.GET_PROVIDERS]:Yme()(r),[U0.PING]:Jme()(r)};function t(i){return e[i]}return t}});var r2e=p((CIt,e2e)=>{l();"use strict";var{pipe:Tft}=pi(),t2e=ia(),Rft=_c(),kft=Zme(),Cft=fi();e2e.exports=r=>{let e=Cft.logger(r.peerId,"rpc"),t=kft(r);async function i(s,o){let a=t(o.type);try{await r._add(s)}catch(c){e.error("Failed to update the kbucket store",c)}if(!a){e.error(`no handler found for message type: ${o.type}`);return}return a(s,o)}async function n({stream:s,connection:o}){let a=o.remotePeer;try{await r._add(a)}catch(u){e.error(u)}let c=a.toB58String();e("from: %s",c),await Tft(s.source,t2e.decode(),u=>async function*(){for await(let f of u){let h=Rft.deserialize(f.slice()),d=await i(a,h);d&&(yield d.serialize())}}(),t2e.encode(),s.sink)}return n}});var o2e=p((PIt,i2e)=>{l();"use strict";var T3=ge(),{pipe:n2e}=pi(),PC=ia(),Pft=lb(),{consume:Oft}=Al(),Bft=qd(),Nft=y_(),Dft=r2e(),qft=Df(),Mft=_c(),Lft=fi(),s2e=class{constructor(e){this.dht=e,this.readMessageTimeout=qft.READ_MESSAGE_TIMEOUT,this._log=Lft.logger(this.dht.peerId,"net"),this._rpc=Dft(this.dht),this._onPeerConnected=this._onPeerConnected.bind(this),this._running=!1}async start(){if(this._running)return;if(!this.dht.isStarted)throw T3(new Error("Can not start network"),"ERR_CANNOT_START_NETWORK");this._running=!0,this.dht._clientMode===!1&&this.dht.registrar.handle(this.dht.protocol,this._rpc);let e=new Nft({multicodecs:[this.dht.protocol],handlers:{onConnect:this._onPeerConnected,onDisconnect:()=>{}}});this._registrarId=await this.dht.registrar.register(e)}async stop(){!this.dht.isStarted&&!this.isStarted||(this._running=!1,this._registrarId&&await this.dht.registrar.unregister(this._registrarId))}get isStarted(){return this._running}get isConnected(){return this.dht.isStarted&&this.isStarted}async _onPeerConnected(e){await this.dht._add(e),this._log("added to the routing table: %s",e.toB58String())}async sendRequest(e,t){if(!this.isConnected)throw T3(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeReadMessage(s,t.serialize())}async sendMessage(e,t){if(!this.isConnected)throw T3(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeMessage(s,t.serialize())}async _writeReadMessage(e,t){return Pft(Fft(e,t),this.readMessageTimeout)}_writeMessage(e,t){return n2e([t],PC.encode(),e,Oft)}};async function Fft(r,e){let t=await n2e([e],PC.encode(),r,PC.decode(),async i=>{let n=await Bft(i);if(n)return n.slice()});if(t.length===0)throw T3(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");return Mft.deserialize(t)}i2e.exports=s2e});var f2e=p((OIt,a2e)=>{l();"use strict";var R3=_3(),c2e=fi(),Uft=E3(),Kft=Dr(),u2e=class{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(n=>Kft(n.peerId.id,e.id)))return;let t=await c2e.convertPeerId(e),i={peerId:e,distance:R3(this.originDhtKey,t)};this.peerDistances.push(i),this.peerDistances.sort((n,s)=>R3.compare(n.distance,s.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;let t=await Uft(e,n=>c2e.convertPeerId(n)),i=this.peerDistances[this.peerDistances.length-1].distance;for(let n of t){let s=R3(this.originDhtKey,n);if(R3.compare(s,i)<0)return!0}return!1}};a2e.exports=u2e});var h2e=p((OC,l2e)=>{l();(function(){var r,e,t,i,n,s,o,a,c,u,f,h,d,y,g;t=Math.floor,u=Math.min,e=function(m,x){return m<x?-1:m>x?1:0},c=function(m,x,_,P,q){var X;if(_==null&&(_=0),q==null&&(q=e),_<0)throw new Error("lo must be non-negative");for(P==null&&(P=m.length);_<P;)X=t((_+P)/2),q(x,m[X])<0?P=X:_=X+1;return[].splice.apply(m,[_,_-_].concat(x)),x},s=function(m,x,_){return _==null&&(_=e),m.push(x),y(m,0,m.length-1,_)},n=function(m,x){var _,P;return x==null&&(x=e),_=m.pop(),m.length?(P=m[0],m[0]=_,g(m,0,x)):P=_,P},a=function(m,x,_){var P;return _==null&&(_=e),P=m[0],m[0]=x,g(m,0,_),P},o=function(m,x,_){var P;return _==null&&(_=e),m.length&&_(m[0],x)<0&&(P=[m[0],x],x=P[0],m[0]=P[1],g(m,0,_)),x},i=function(m,x){var _,P,q,X,W,z,Z,ee;for(x==null&&(x=e),z=function(){ee=[];for(var re=0,L=t(m.length/2);0<=L?re<L:re>L;0<=L?re++:re--)ee.push(re);return ee}.apply(this).reverse(),Z=[],P=0,X=z.length;P<X;P++)_=z[P],Z.push(g(m,_,x));return Z},d=function(m,x,_){var P;if(_==null&&(_=e),P=m.indexOf(x),P!==-1)return y(m,0,P,_),g(m,P,_)},f=function(m,x,_){var P,q,X,W,z;if(_==null&&(_=e),q=m.slice(0,x),!q.length)return q;for(i(q,_),z=m.slice(x),X=0,W=z.length;X<W;X++)P=z[X],o(q,P,_);return q.sort(_).reverse()},h=function(m,x,_){var P,q,X,W,z,Z,ee,re,L,b;if(_==null&&(_=e),x*10<=m.length){if(W=m.slice(0,x).sort(_),!W.length)return W;for(X=W[W.length-1],re=m.slice(x),z=0,ee=re.length;z<ee;z++)P=re[z],_(P,X)<0&&(c(W,P,0,null,_),W.pop(),X=W[W.length-1]);return W}for(i(m,_),b=[],q=Z=0,L=u(x,m.length);0<=L?Z<L:Z>L;q=0<=L?++Z:--Z)b.push(n(m,_));return b},y=function(m,x,_,P){var q,X,W;for(P==null&&(P=e),q=m[_];_>x;){if(W=_-1>>1,X=m[W],P(q,X)<0){m[_]=X,_=W;continue}break}return m[_]=q},g=function(m,x,_){var P,q,X,W,z;for(_==null&&(_=e),q=m.length,z=x,X=m[x],P=2*x+1;P<q;)W=P+1,W<q&&!(_(m[P],m[W])<0)&&(P=W),m[x]=m[P],x=P,P=2*x+1;return m[x]=X,y(m,z,x,_)},r=function(){m.push=s,m.pop=n,m.replace=a,m.pushpop=o,m.heapify=i,m.updateItem=d,m.nlargest=f,m.nsmallest=h;function m(x){this.cmp=x??e,this.nodes=[]}return m.prototype.push=function(x){return s(this.nodes,x,this.cmp)},m.prototype.pop=function(){return n(this.nodes,this.cmp)},m.prototype.peek=function(){return this.nodes[0]},m.prototype.contains=function(x){return this.nodes.indexOf(x)!==-1},m.prototype.replace=function(x){return a(this.nodes,x,this.cmp)},m.prototype.pushpop=function(x){return o(this.nodes,x,this.cmp)},m.prototype.heapify=function(){return i(this.nodes,this.cmp)},m.prototype.updateItem=function(x){return d(this.nodes,x,this.cmp)},m.prototype.clear=function(){return this.nodes=[]},m.prototype.empty=function(){return this.nodes.length===0},m.prototype.size=function(){return this.nodes.length},m.prototype.clone=function(){var x;return x=new m,x.nodes=this.nodes.slice(0),x},m.prototype.toArray=function(){return this.nodes.slice(0)},m.prototype.insert=m.prototype.push,m.prototype.top=m.prototype.peek,m.prototype.front=m.prototype.peek,m.prototype.has=m.prototype.contains,m.prototype.copy=m.prototype.clone,m}(),function(m,x){return typeof define=="function"&&define.amd?define([],x):typeof OC=="object"?l2e.exports=x():m.Heap=x()}(this,function(){return r})}).call(OC)});var p2e=p((BIt,d2e)=>{l();d2e.exports=h2e()});var g2e=p((NIt,y2e)=>{l();"use strict";var jft=p2e(),Vft=_3(),zft=xe(),k3=fi(),BC=zft("libp2p:dht:peer-queue"),hb=class{static async fromPeerId(e){let t=await k3.convertPeerId(e);return new hb(t)}static async fromKey(e){let t=await k3.convertBuffer(e);return new hb(t)}constructor(e){BC("create: %b",e),this.from=e,this.heap=new jft(k3.xorCompare)}async enqueue(e){BC("enqueue %s",e.toB58String());let t=await k3.convertPeerId(e),i={id:e,distance:Vft(this.from,t)};this.heap.push(i)}dequeue(){let e=this.heap.pop();return BC("dequeue %s",e.id.toB58String()),e.id}get length(){return this.heap.size()}};y2e.exports=hb});var v2e=p((DIt,b2e)=>{l();"use strict";var Hft=g2e(),Gft=fi(),$ft=3e4,m2e=class{constructor(e,t){if(this.run=e,this.queryFunc=Gft.withTimeout(t,$ft),!this.queryFunc)throw new Error("Path requires a `queryFn` to be specified");if(typeof this.queryFunc!="function")throw new Error("Path expected `queryFn` to be a function. Got "+typeof this.queryFunc);this.initialPeers=[],this.peersToQuery=null,this.res=null}addInitialPeer(e){this.initialPeers.push(e)}async execute(){let e=await Hft.fromKey(this.run.query.key);this.peersToQuery=e,await Promise.all(this.initialPeers.map(t=>this.addPeerToQuery(t))),await this.run.workerQueue(this)}async addPeerToQuery(e){this.run.query.dht._isSelf(e)||this.run.peersSeen.has(e.toB58String())||this.peersToQuery&&await this.peersToQuery.enqueue(e)}};b2e.exports=m2e});var E2e=p((qIt,w2e)=>{l();"use strict";var{default:Wft}=yl(),_2e=class{constructor(e,t,i,n){this.dht=e,this.run=t,this.path=i,this.log=n,this.concurrency=this.dht.concurrency,this.queue=this.setupQueue(),this.execution=null,this.queuedPeerIds=new Set}setupQueue(){let e=new Wft({concurrency:this.concurrency});return e.on("idle",()=>{this.path.peersToQuery&&!this.path.peersToQuery.length&&(this.log("queue:drain"),this.stop())}),e.on("next",()=>{!this.running||e.pending<this.concurrency&&this.fill()}),e}stop(e){!this.running||(this.running=!1,this.queue.clear(),this.log("worker:stop, %d workers still running",this.run.workers.filter(t=>t.running).length),this.execution&&(e?this.execution.reject(e):this.execution.resolve()))}async execute(){this.running=!0,this.execution=null;let e=new Promise((t,i)=>{this.execution={resolve:t,reject:i}});this.fill(),await e}fill(){if(!!this.path.peersToQuery)for(;this.queue.pending+this.queue.size<this.concurrency&&this.path.peersToQuery.length>0;){let e=this.path.peersToQuery.dequeue();this.queuedPeerIds.add(e),this.queue.add(()=>this.processNext(e).catch(t=>{this.log.error("queue",t),this.stop(t)}).finally(()=>{this.queuedPeerIds.delete(e)}))}}async processNext(e){if(!this.running||this.run.peersSeen.has(e.toB58String()))return;let t,i;try{t=await this.run.continueQuerying(this)}catch(o){i=o}if(!this.running)return;if(i)throw i;if(!t){this.stop();return}if(this.run.peersSeen.has(e.toB58String()))return;this.run.peersSeen.add(e.toB58String()),this.log("queue:work");let n,s;try{n=await this.execQuery(e)}catch(o){s=o}if(!!this.running){if(this.log("queue:work:done",s,n),s)throw s;if(n&&n.queryComplete){this.log("query:complete"),this.run.stop();return}n&&n.pathComplete&&this.stop()}}async execQuery(e){let t,i;try{t=await this.path.queryFunc(e)}catch(n){i=n}if(!!this.running){if(i){this.run.errors.push(i);return}if(this.run.peersQueried&&await this.run.peersQueried.add(e),!!t){if(t.pathComplete||t.queryComplete)return this.path.res=t,{pathComplete:t.pathComplete,queryComplete:t.queryComplete};if(t.closerPeers&&t.closerPeers.length>0){let n=async s=>{this.dht._isSelf(s.id)||(this.dht._peerDiscovered(s.id,s.multiaddrs),await this.path.addPeerToQuery(s.id))};await Promise.all(t.closerPeers.map(n))}}}}};w2e.exports=_2e});var A2e=p((MIt,S2e)=>{l();"use strict";var Yft=f2e(),Xft=Lr(),Jft=v2e(),Qft=E2e(),Zft=fi(),x2e=class extends Xft{constructor(e){super();this.query=e,this.running=!1,this.workers=[],this.peersSeen=new Set,this.errors=[],this.peersQueried=null}stop(){if(!!this.running){this.running=!1;for(let e of this.workers)e.stop()}}async execute(e){let t=[],i=Math.min(this.query.dht.disjointPaths,e.length);for(let s=0;s<i;s++)t.push(new Jft(this,this.query.makePath(s,i)));e.forEach((s,o)=>{t[o%i].addInitialPeer(s)}),await this.executePaths(t);let n={finalSet:new Set(this.peersQueried&&this.peersQueried.peers),paths:[]};for(let s of t)s.res&&(s.res.pathComplete||s.res.queryComplete)&&(s.res.success=!0,n.paths.push(s.res));return n}async executePaths(e){this.running=!0,this.emit("start");try{await Promise.all(e.map(t=>t.execute()))}finally{this.stop(),this.emit("complete")}if(this.errors.length===this.peersSeen.size)throw this.errors[0]}async workerQueue(e){await this.init(),await this.startWorker(e)}async startWorker(e){let t=new Qft(this.query.dht,this,e,this.query._log);this.workers.push(t),await t.execute()}async init(){if(!this.peersQueried){if(this.peersQueriedPromise){await this.peersQueriedPromise;return}this.peersQueriedPromise=(async()=>{let e=await Zft.convertBuffer(this.query.key);this.peersQueried=new Yft(e,this.query.dht.kBucketSize)})(),await this.peersQueriedPromise,delete this.peersQueriedPromise}}async continueQuerying(e){if(this.peersQueried&&this.peersQueried.length<this.peersQueried.capacity)return!0;let t=Array.from(e.queuedPeerIds);return!!(this.peersQueried&&await this.peersQueried.anyCloser(t))}};S2e.exports=x2e});var C3=p((LIt,I2e)=>{l();"use strict";var elt=er().multihash,tlt=fi(),rlt=A2e(),T2e=class{constructor(e,t,i){this.dht=e,this.key=t,this.makePath=i,this._log=tlt.logger(this.dht.peerId,"query:"+elt.toB58String(t)),this.running=!1,this._onStart=this._onStart.bind(this),this._onComplete=this._onComplete.bind(this)}async run(e){return this.dht._queryManager.running?e.length===0?(this._log.error("Running query with no peers"),{finalSet:new Set,paths:[]}):(this._run=new rlt(this),this._log(`query running with K=${this.dht.kBucketSize}, A=${this.dht.concurrency}, D=${Math.min(this.dht.disjointPaths,e.length)}`),this._run.once("start",this._onStart),this._run.once("complete",this._onComplete),this._run.execute(e)):(this._log.error("Attempt to run query after shutdown"),{finalSet:new Set,paths:[]})}_onStart(){this.running=!0,this._startTime=Date.now(),this._log("query:start"),this.dht._queryManager.queryStarted(this)}_onComplete(){this.stop()}stop(){this._log(`query:done in ${Date.now()-(this._startTime||0)}ms`),this._run&&this._log(`${this._run.errors.length} of ${this._run.peersSeen.size} peers errored (${this._run.errors.length/this._run.peersSeen.size*100}% fail rate)`),!!this.running&&(this.running=!1,this._run&&(this._run.removeListener("start",this._onStart),this._run.removeListener("complete",this._onComplete),this._run.stop()),this.dht._queryManager.queryCompleted(this))}};I2e.exports=T2e});var P2e=p((FIt,R2e)=>{l();"use strict";var NC=ge(),ilt=lb(),nlt=Dr(),k2e=tt(),C2e=Sl(),DC=Df(),slt=C3(),Eh=fi(),olt=C2e.Record;R2e.exports=r=>{let e=async(n,s)=>r.datastore.put(Eh.bufferToKey(n),s),t=async n=>{r._log(`getLocal ${k2e(n,"base32")}`);let s=await r.datastore.get(Eh.bufferToKey(n));r._log(`found ${k2e(n,"base32")} in local datastore`);let o=olt.deserialize(s);return await r._verifyRecordLocally(o),o},i=async(n,s,o)=>{let a=await Eh.createPutRecord(n,o);return Promise.all(s.map(async c=>{if(!nlt(c.val,o)){if(r._isSelf(c.from)){try{await r._putLocal(n,a)}catch(u){r._log.error("Failed error correcting self",u)}return}try{await r._putValueToPeer(n,a,c.from)}catch(u){r._log.error("Failed error correcting entry",u)}}}))};return{async _putLocal(n,s){return e(n,s)},async put(n,s,o={}){r._log("PutValue %b",n);let a=await Eh.createPutRecord(n,s);await e(n,a);let c=0,u=0;await Eh.mapParallel(r.getClosestPeers(n,{shallow:!0}),async h=>{try{c+=1,await r._putValueToPeer(n,a,h),u+=1}catch(d){r._log.error("Failed to put to peer (%b): %s",h.id,d)}});let f=o.minPeers||c;if(f>u){let h=NC(new Error(`Failed to put value to enough peers: ${u}/${f}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw r._log.error(h),h}},async get(n,s={}){s.timeout=s.timeout||DC.minute,r._log("_get %b",n);let o=await r.getMany(n,DC.GET_MANY_RECORD_COUNT,s),a=o.map(f=>f.val),c=0;try{c=C2e.selection.bestRecord(r.selectors,n,a)}catch(f){if(f.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw f}let u=a[c];if(r._log("GetValue %b %s",n,u),!u)throw NC(new Error("best value was not found"),"ERR_NOT_FOUND");return await i(n,o,u),u},async getMany(n,s,o={}){o.timeout=o.timeout||DC.minute,r._log("getMany %b (%s)",n,s);let a=[],c;try{c=await t(n)}catch(g){if(s===0)throw g}if(c&&a.push({val:c.value,from:r.peerId}),a.length>=s)return a;let u=await Eh.convertBuffer(n),f=r.routingTable.closestPeers(u,r.kBucketSize);if(r._log("peers in rt: %d",f.length),f.length===0){let g="Failed to lookup key! No peers from routing table!";if(r._log.error(g),a.length===0)throw NC(new Error(g),"ERR_NO_PEERS_IN_ROUTING_TABLE");return a}let h=a.length;function d(g,m){let x=Eh.pathSize(s-h,m),_=0;async function P(q){let X,W,z;try{let ee=await r._getValueOrPeers(q,n);X=ee.record,W=ee.peers}catch(ee){if(ee.code!=="ERR_INVALID_RECORD")throw ee;z=ee}let Z={closerPeers:W};return X&&X.value?(a.push({val:X.value,from:q}),_++):z&&(a.push({err:z,from:q}),_++),_>=x&&(Z.pathComplete=!0),Z}return P}let y=new slt(r,n,d);try{await ilt(y.run(f),o.timeout)}catch(g){if(a.length===0)throw g}finally{y.stop()}return a}}}});var N2e=p((UIt,O2e)=>{l();"use strict";var B2e=class{constructor(){this.list=[]}push(e){return this.has(e.id)?!1:(this.list.push(e),!0)}has(e){let t=this.list.find(i=>i.id.equals(e));return Boolean(t)}toArray(){return this.list.slice()}pop(){return this.list.pop()}get length(){return this.list.length}};O2e.exports=B2e});var M2e=p((KIt,D2e)=>{l();"use strict";var alt=N2e(),q2e=class extends alt{constructor(e){super();this.limit=e}push(e){return this.length<this.limit?super.push(e):!1}};D2e.exports=q2e});var V2e=p((jIt,L2e)=>{l();"use strict";var clt=ge(),F2e=lb(),U2e=Df(),K2e=M2e(),P3=_c(),ult=C3(),j2e=fi();L2e.exports=r=>{let e=async(t,i)=>{let n=new P3(P3.TYPES.GET_PROVIDERS,i.bytes,0);return r.network.sendRequest(t,n)};return{async provide(t){r._log(`provide: ${t}`);let i=[];await r.providers.addProvider(t,r.peerId);let n=r.libp2p?r.libp2p.multiaddrs:[],s=new P3(P3.TYPES.ADD_PROVIDER,t.bytes,0);s.providerPeers=[{id:r.peerId,multiaddrs:n}];async function o(a){r._log(`putProvider ${t} to ${a.toB58String()}`);try{await r.network.sendMessage(a,s)}catch(c){i.push(c)}}if(await j2e.mapParallel(r.getClosestPeers(t.bytes),o),i.length)throw clt(new Error(`Failed to provide to ${i.length} of ${r.kBucketSize} peers`),"ERR_SOME_PROVIDES_FAILED",{errors:i})},async*findProviders(t,i={timeout:6e4,maxNumProviders:5}){let n=i.timeout||U2e.minute,s=i.maxNumProviders||U2e.K;r._log(`findProviders ${t}`);let o=new K2e(s);if((await r.providers.getProviders(t)).forEach(d=>{let y=r.peerStore.get(d);y?o.push({id:y.id,multiaddrs:y.addresses.map(g=>g.multiaddr)}):o.push({id:d,multiaddrs:[]})}),o.length>=s){for(let d of o.toArray())yield d;return}let c=[];function u(d,y){let g=j2e.pathSize(s-o.length,y),m=new K2e(g);c.push(m);async function x(_){let P=await e(_,t),q=P.providerPeers;return r._log(`Found ${q.length} provider entries for ${t}`),q.forEach(X=>{m.push({...X})}),m.length>=g?{pathComplete:!0}:{closerPeers:P.closerPeers}}return x}let f=new ult(r,t.bytes,u),h=r.routingTable.closestPeers(t.bytes,r.kBucketSize);try{await F2e(f.run(h),n)}catch(d){if(d.name!==F2e.TimeoutError.name)throw d}finally{f.stop()}c.forEach(d=>{d.toArray().forEach(y=>{o.push(y)})});for(let d of o.toArray())yield d}}}});var G2e=p((VIt,z2e)=>{l();"use strict";var db=ge(),flt=lb(),qC=dt(),llt=za(),hlt=tt(),dlt=Df(),O3=_c(),H2e=C3(),pb=fi();z2e.exports=r=>{let e=async s=>{r._log(`findPeerLocal ${s.toB58String()}`);let o=await r.routingTable.find(s),a=o&&r.peerStore.get(o);if(a)return{id:a.id,multiaddrs:a.addresses.map(c=>c.multiaddr)}},t=async(s,o)=>{let a=new O3(O3.TYPES.GET_VALUE,o,0);return r.network.sendRequest(s,a)},i=async(s,o)=>(r._log(`closerPeersSingle ${hlt(s,"base32")} from ${o.toB58String()}`),(await r.peerRouting._findPeerSingle(o,new qC(s))).closerPeers.filter(c=>!r._isSelf(c.id)).map(c=>(r.peerStore.addressBook.add(c.id,c.multiaddrs),c))),n=async s=>{let o=pb.keyForPublicKey(s),a=await t(s,o);if(!a.record||!a.record.value)throw db(new Error(`Node not responding with its public key: ${s.toB58String()}`),"ERR_INVALID_RECORD");let c=await qC.createFromPubKey(a.record.value);if(!c.equals(s))throw db(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");return c.pubKey};return{async _findPeerSingle(s,o){r._log("findPeerSingle %s",s.toB58String());let a=new O3(O3.TYPES.FIND_NODE,o.id,0);return r.network.sendRequest(s,a)},async findPeer(s,o={timeout:6e4}){o.timeout=o.timeout||dlt.minute,r._log("findPeer %s",s.toB58String());let a=await e(s);if(a!=null)return r._log("found local"),a;let c=await pb.convertPeerId(s),u=r.routingTable.closestPeers(c,r.kBucketSize);if(u.length===0)throw db(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED");if(u.find(m=>m.isEqual(s))){let m=r.peerStore.get(s);if(m)return r._log("found in peerStore"),{id:m.id,multiaddrs:m.addresses.map(x=>x.multiaddr)}}let h=new H2e(r,s.id,()=>async x=>{let _=await this._findPeerSingle(x,s),P=_.closerPeers.find(q=>q.id.isEqual(s));return P?{peer:P,queryComplete:!0}:{closerPeers:_.closerPeers}}),d;try{d=await flt(h.run(u),o.timeout)}finally{h.stop()}let y=!1;if(d.paths.forEach(m=>{m.success&&m.peer&&(y=!0,r.peerStore.addressBook.add(m.peer.id,m.peer.multiaddrs))}),r._log("findPeer %s: %s",s.toB58String(),y),!y)throw db(new Error("No peer found"),"ERR_NOT_FOUND");let g=r.peerStore.get(s);if(!g)throw db(new Error("No peer found in peer store"),"ERR_NOT_FOUND");return{id:g.id,multiaddrs:g.addresses.map(m=>m.multiaddr)}},async*getClosestPeers(s,o={shallow:!1}){r._log("getClosestPeers to %b",s);let a=await pb.convertBuffer(s),c=r.routingTable.closestPeers(a,r.kBucketSize),f=await new H2e(r,s,()=>async d=>({closerPeers:await i(s,d),pathComplete:o.shallow?!0:void 0})).run(c);if(!f||!f.finalSet)return[];let h=await pb.sortClosestPeers(Array.from(f.finalSet),a);for(let d of h.slice(0,r.kBucketSize))yield d},async getPublicKey(s){r._log("getPublicKey %s",s.toB58String());let o=r.peerStore.get(s);if(o&&o.id.pubKey)return r._log("getPublicKey: found local copy"),o.id.pubKey;let a;try{a=await n(s)}catch(f){let h=pb.keyForPublicKey(s),d=await r.get(h);a=llt.keys.unmarshalPublicKey(d)}let c=new qC(s.id,void 0,a),u=(o&&o.addresses||[]).map(f=>f.multiaddr);return r.peerStore.addressBook.add(c,u),r.peerStore.keyBook.set(c,a),a}}}});var Y2e=p((zIt,$2e)=>{l();$2e.exports=MC;var W2e=128,plt=127,ylt=~plt,glt=Math.pow(2,31);function MC(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw MC.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=glt;)e[t++]=r&255|W2e,r/=128;for(;r&ylt;)e[t++]=r&255|W2e,r>>>=7;return e[t]=r|0,MC.bytes=t-i+1,e}});var Q2e=p((HIt,X2e)=>{l();X2e.exports=LC;var blt=128,J2e=127;function LC(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw LC.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&J2e)<<i:(s&J2e)*Math.pow(2,i),i+=7}while(s>=blt);return LC.bytes=n-e,t}});var eve=p((GIt,Z2e)=>{l();var mlt=Math.pow(2,7),vlt=Math.pow(2,14),wlt=Math.pow(2,21),_lt=Math.pow(2,28),Elt=Math.pow(2,35),Slt=Math.pow(2,42),xlt=Math.pow(2,49),Alt=Math.pow(2,56),Ilt=Math.pow(2,63);Z2e.exports=function(r){return r<mlt?1:r<vlt?2:r<wlt?3:r<_lt?4:r<Elt?5:r<Slt?6:r<xlt?7:r<Alt?8:r<Ilt?9:10}});var rve=p(($It,tve)=>{l();tve.exports={encode:Y2e(),decode:Q2e(),encodingLength:eve()}});var cve=p((WIt,ive)=>{l();"use strict";var Tlt=Qy(),nve=rve(),Rlt=dt(),{Key:klt}=ir(),{default:Clt}=yl(),yb=Df(),gb=fi(),sve=class{constructor(e,t,i){this.datastore=e,this._log=gb.logger(t,"providers"),this.cleanupInterval=yb.PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=yb.PROVIDERS_VALIDITY,this.lruCacheSize=i||yb.PROVIDERS_LRU_CACHE_SIZE,this.providers=Tlt(this.lruCacheSize),this.syncQueue=new Clt({concurrency:1})}start(){this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval)}stop(){this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{this._log("start cleanup");let e=Date.now(),t=0,i=0,n=new Map,s=this.datastore.batch(),o=this.datastore.query({prefix:yb.PROVIDERS_KEY_PREFIX});for await(let a of o)try{let{cid:c,peerId:u}=ove(a.key),f=ave(a.value),h=Date.now(),d=h-f,y=d>this.provideValidity;if(this._log("comparing: %d - %d = %d > %d %s",h,f,d,this.provideValidity,y?"(expired)":""),y){i++,s.delete(a.key);let g=n.get(c)||new Set;g.add(u),n.set(c,g)}t++}catch(c){this._log.error(c.message)}this._log("deleting %d / %d entries",i,t),n.size&&await s.commit();for(let[a,c]of n){let u=bb(a),f=this.providers.get(u);if(f){for(let h of c)f.delete(h);f.size===0?this.providers.remove(u):this.providers.set(u,f)}}this._log("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let t=bb(e),i=this.providers.get(t);return i||(i=await Olt(this.datastore,e),this.providers.set(t,i)),i}async addProvider(e,t){return this.syncQueue.add(async()=>{this._log("addProvider %s",e.toBaseEncodedString());let i=await this._getProvidersMap(e);this._log("loaded %s provs",i.size);let n=new Date;i.set(gb.encodeBase32(t.id),n);let s=bb(e);return this.providers.set(s,i),Plt(this.datastore,e,t,n)})}async getProviders(e){return this.syncQueue.add(async()=>(this._log("getProviders %s",e.toBaseEncodedString()),[...(await this._getProvidersMap(e)).keys()].map(i=>new Rlt(gb.decodeBase32(i)))))}};function bb(r){return r=typeof r=="string"?r:gb.encodeBase32(r.bytes),yb.PROVIDERS_KEY_PREFIX+r}async function Plt(r,e,t,i){let n=[bb(e),"/",gb.encodeBase32(t.id)].join(""),s=new klt(n),o=Uint8Array.from(nve.encode(i.getTime()));return r.put(s,o)}function ove(r){let e=r.toString().split("/");if(e.length!==4)throw new Error("incorrectly formatted provider entry key in datastore: "+r);return{cid:e[2],peerId:e[3]}}async function Olt(r,e){let t=new Map,i=r.query({prefix:bb(e)});for await(let n of i){let{peerId:s}=ove(n.key);t.set(s,ave(n.value))}return t}function ave(r){return nve.decode(r)}ive.exports=sve});var fve=p((YIt,FC)=>{l();"use strict";var Blt=E3(),uve=async(r,e,t)=>Blt(new Array(r).fill(),(i,n)=>e(n),t);FC.exports=uve;FC.exports.default=uve});var dve=p((XIt,lve)=>{l();"use strict";var Nlt=za(),Dlt=er(),qlt=dt(),{AbortController:Mlt}=Uf(),Llt=ge(),Flt=fve(),Ult=Df(),{logger:Klt}=fi(),hve=class{constructor(e,t){if(!e)throw new Error("Random Walk needs an instance of the Kademlia DHT");this._kadDHT=e,this._options={...Ult.defaultRandomWalk,...t},this.log=Klt(e.peerId,"random-walk"),this._timeoutId=void 0}start(){this._timeoutId||!this._options.enabled||(this._timeoutId=setTimeout(()=>{this._runPeriodically()},this._options.delay))}stop(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0),this._controller&&this._controller.abort()}async _runPeriodically(){for(;this._timeoutId;){try{await this._walk(this._options.queriesPerPeriod,this._options.timeout)}catch(e){this._kadDHT._log.error("random-walk:error",e)}await new Promise(e=>{this._timeoutId=setTimeout(e,this._options.interval)})}}async _walk(e,t){this.log("start"),this._controller=new Mlt;try{await Flt(e,async i=>{this.log("running query %d",i);try{let n=await this._randomPeerId();if(!this._controller)return;await this._query(n,{timeout:t,signal:this._controller.signal})}catch(n){if(n&&n.code!=="ETIMEDOUT")throw this.log.error("query %d finished with error",i,n),n}this.log("finished query %d",i)})}finally{this._controller=null,this.log("finished queries")}}async _query(e,t){this.log("query:%s",e.toB58String());let i;try{i=await this._kadDHT.findPeer(e,t)}catch(n){if(n&&n.code==="ERR_NOT_FOUND")return;throw n}throw this.log("query:found",i),Llt(new Error(`random-walk: ACTUALLY FOUND PEER: ${i}, ${e.toB58String()}`),"ERR_FOUND_RANDOM_PEER")}async _randomPeerId(){let e=await Dlt(Nlt.randomBytes(16),"sha2-256");return new qlt(e)}};lve.exports=hve});var gve=p((JIt,pve)=>{l();"use strict";var yve=class{constructor(){this.queries=new Set,this.running=!1}queryStarted(e){this.queries.add(e)}queryCompleted(e){this.queries.delete(e)}start(){this.running=!0}stop(){this.running=!1;for(let e of this.queries)e.stop();this.queries.clear()}};pve.exports=yve});var vve=p((QIt,UC)=>{l();"use strict";var{EventEmitter:jlt}=Lr(),B3=ge(),mb=Sl(),{MemoryDatastore:Vlt}=ir(),bve=Dr(),KC=tt(),zlt=Tme(),K0=fi(),vb=Df(),Hlt=o2e(),Glt=P2e(),$lt=V2e(),Wlt=G2e(),N3=_c(),Ylt=cve(),Xlt=dve(),Jlt=gve(),jC=mb.Record,mve=class extends jlt{constructor({libp2p:e,dialer:t,peerId:i,peerStore:n,registrar:s,protocolPrefix:o="/ipfs",forceProtocolLegacy:a=!1,datastore:c=new Vlt,kBucketSize:u=vb.K,clientMode:f=!1,concurrency:h=vb.ALPHA,validators:d={},selectors:y={},randomWalk:g={enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:3e4,delay:1e4},onPut:m=()=>{},onRemove:x=()=>{}}){super();if(!t)throw new Error("libp2p-kad-dht requires an instance of Dialer");this.libp2p=e,this.dialer=t,this.peerId=i,this.peerStore=n,this.registrar=s,this.protocol=o+(a?"":vb.PROTOCOL_DHT),this.kBucketSize=u,this._clientMode=f,this.concurrency=h,this.disjointPaths=Math.ceil(this.kBucketSize/2),this.routingTable=new zlt(this.peerId,this.kBucketSize),this.datastore=c,this.providers=new Ylt(this.datastore,this.peerId),this.validators={pk:mb.validator.validators.pk,...d},this.selectors={pk:mb.selection.selectors.pk,...y},this.network=new Hlt(this),this._log=K0.logger(this.peerId),this.randomWalk=new Xlt(this,g),this._queryManager=new Jlt,this._running=!1,this.contentFetching=Glt(this),this.contentRouting=$lt(this),this.peerRouting=Wlt(this),this.onPut=m,this.onRemove=x}get isStarted(){return this._running}async start(){this._running=!0,this.providers.start(),this._queryManager.start(),await this.network.start(),this.randomWalk.start()}stop(){return this._running=!1,this.randomWalk.stop(),this.providers.stop(),this._queryManager.stop(),this.network.stop()}async put(e,t,i={}){return this.contentFetching.put(e,t,i)}async get(e,t={}){return this.contentFetching.get(e,t)}async getMany(e,t,i={}){return this.contentFetching.getMany(e,t,i)}async removeLocal(e){this._log(`removeLocal: ${KC(e,"base32")}`);let t=K0.bufferToKey(e);try{await this.datastore.delete(t)}catch(i){if(i.code==="ERR_NOT_FOUND")return;throw i}}async _putLocal(e,t){this._log(`_putLocal: ${KC(e,"base32")}`);let i=K0.bufferToKey(e);await this.datastore.put(i,t)}async provide(e){return this.contentRouting.provide(e)}async*findProviders(e,t={timeout:6e3,maxNumProviders:5}){for await(let i of this.contentRouting.findProviders(e,t))yield i}async findPeer(e,t={timeout:6e4}){return this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={shallow:!1}){yield*this.peerRouting.getClosestPeers(e,t)}getPublicKey(e){return this.peerRouting.getPublicKey(e)}_peerDiscovered(e,t){this.emit("peer",{id:e,multiaddrs:t})}async _nearestPeersToQuery(e){let t=await K0.convertBuffer(e.key);return this.routingTable.closestPeers(t,this.kBucketSize).map(n=>{let s=this.peerStore.get(n);return{id:n,multiaddrs:s?s.addresses.map(o=>o.multiaddr):[]}})}async _betterPeersToQuery(e,t){return this._log("betterPeersToQuery"),(await this._nearestPeersToQuery(e)).filter(n=>this._isSelf(n.id)?(this._log.error("trying to return self as closer"),!1):!n.id.isEqual(t))}async _checkLocalDatastore(e){this._log(`checkLocalDatastore: ${KC(e)} %b`,e);let t=K0.bufferToKey(e),i;try{i=await this.datastore.get(t)}catch(s){if(s.code==="ERR_NOT_FOUND")return;throw s}let n=jC.deserialize(i);if(!n)throw B3(new Error("Invalid record"),"ERR_INVALID_RECORD");if(n.timeReceived==null||K0.now()-n.timeReceived.getTime()>vb.MAX_RECORD_AGE){await this.datastore.delete(t),this.onRemove(n);return}return n}async _add(e){await this.routingTable.add(e)}async _verifyRecordLocally(e){this._log("verifyRecordLocally"),await mb.validator.verifyRecord(this.validators,e)}_isSelf(e){return e&&bve(this.peerId.id,e.id)}async _putValueToPeer(e,t,i){let n=new N3(N3.TYPES.PUT_VALUE,e,0);n.record=jC.deserialize(t);let s=await this.network.sendRequest(i,n);if(s.record&&!bve(s.record.value,jC.deserialize(t).value))throw B3(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")}async _getValueOrPeers(e,t){let i=await this._getValueSingle(e,t),n=i.closerPeers,s=i.record;if(s){try{await this._verifyRecordOnline(s)}catch(o){let a="invalid record received, discarded";throw this._log(a),B3(new Error(a),"ERR_INVALID_RECORD")}return{record:s,peers:n}}if(n.length>0)return{peers:n};throw B3(new Error("Not found"),"ERR_NOT_FOUND")}async _getValueSingle(e,t){let i=new N3(N3.TYPES.GET_VALUE,t,0);return this.network.sendRequest(e,i)}async _verifyRecordOnline(e){await mb.validator.verifyRecord(this.validators,e)}};UC.exports=mve;UC.exports.multicodec="/ipfs"+vb.PROTOCOL_DHT});var Eve=p((ZIt,wve)=>{l();"use strict";var Qlt=Aye(),Zlt=b1e(),eht=W1e(),{NOISE:tht}=gme(),rht=vve(),iht=ST(),_ve=vA();wve.exports=()=>({dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[Qlt,Zlt],streamMuxer:[eht],connEncryption:[tht],peerDiscovery:[],dht:rht,pubsub:iht},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!1,clientMode:!0,randomWalk:{enabled:!1},validators:{ipns:_ve.validator},selectors:{ipns:_ve.selector}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0,threshold:1}})});var Ive=p((VC,Sve)=>{l();"use strict";var nht=dt(),{Multiaddr:sht}=lr(),oht=fl(),{EventEmitter:aht}=Lr(),xve=xe(),D3=Object.assign(xve("libp2p:bootstrap"),{error:xve("libp2p:bootstrap:error")}),Ave=class extends aht{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super();this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),D3("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){!this._timer||this._list.forEach(e=>{if(!oht.P2P.matches(e))return D3.error("Invalid multiaddr");let t=new sht(e),i=t.getPeerId();if(!i){D3.error("Invalid bootstrap multiaddr without peer id");return}let n=nht.createFromB58String(i);try{this.emit("peer",{id:n,multiaddrs:[t]})}catch(s){D3.error("Invalid bootstrap peer id",s)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}};VC=Sve.exports=Ave;VC.tag="bootstrap"});var zC=p((e8t,Tve)=>{l();"use strict";var or=_g(),cht=Gr(),uht=ge(),Rve=cue(),fht=Cv().version;Tve.exports=({options:r={},peerId:e,multiaddrs:t=[],repo:i,keychainConfig:n={},config:s={}})=>{let{datastore:o,keys:a}=i,c=lht({options:r,config:s,datastore:o,keys:a,keychainConfig:n,peerId:e,multiaddrs:t});return typeof r.libp2p=="function"?r.libp2p({libp2pOptions:c,options:r,config:s,datastore:o,peerId:e}):k0e().create(c)};function lht({options:r,config:e,datastore:t,keys:i,keychainConfig:n,peerId:s,multiaddrs:o}){let a=()=>{let g=or(e,"Pubsub.Router")||"gossipsub";if(!Rve[g])throw uht(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${g} router.`),"ERR_NOT_SUPPORTED");return Rve[g]},c={datastore:t,peerId:s,modules:{}},u={modules:{pubsub:a()},config:{peerDiscovery:{mdns:{enabled:or(r,"config.Discovery.MDNS.Enabled",or(e,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:or(r,"config.Discovery.webRTCStar.Enabled",or(e,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:or(r,"config.Bootstrap",or(e,"Bootstrap",[]))}},relay:{enabled:or(r,"relay.enabled",or(e,"relay.enabled",!0)),hop:{enabled:or(r,"relay.hop.enabled",or(e,"relay.hop.enabled",!1)),active:or(r,"relay.hop.active",or(e,"relay.hop.active",!1))}},dht:{enabled:or(e,"Routing.Type","none")!=="none",clientMode:or(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:or(r,"dht.kBucketSize",20)},pubsub:{enabled:or(r,"config.Pubsub.Enabled",or(e,"Pubsub.Enabled",!0))},nat:{enabled:!or(e,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:o.map(g=>g.toString()),announce:or(r,"addresses.announce",or(e,"Addresses.Announce",[])),noAnnounce:or(r,"addresses.noAnnounce",or(e,"Addresses.NoAnnounce",[]))},connectionManager:or(r,"connectionManager",{maxConnections:or(r,"config.Swarm.ConnMgr.HighWater",or(e,"Swarm.ConnMgr.HighWater")),minConnections:or(r,"config.Swarm.ConnMgr.LowWater",or(e,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:i,...n},host:{agentVersion:`js-ipfs/${fht}`}},f=Eve(),h=or(r,"libp2p",void 0);typeof h=="function"&&(h=void 0);let d=cht(c,f(),u,h);return or(d,"config.peerDiscovery.bootstrap.list",[]).length>0&&d.modules.peerDiscovery.push(Ive()),d}});var Nve=p((t8t,kve)=>{l();"use strict";var wb=xe()("ipfs:components:peer:storage"),hht=Hoe(),dht=dv(),{ERR_REPO_NOT_INITIALIZED:pht}=n_().errors,yht=ct(),ght=tt(),HC=dt(),{mergeOptions:Cve}=zi(),bht=r5(),{NotEnabledError:mht,NotInitializedError:vht}=Xu(),Pve=zC(),q3=class{constructor(e,t,i,n,s){this.print=n,this.peerId=e,this.keychain=t,this.repo=i,this.print=n,this.isNew=s}static async start(e,t){let{repoAutoMigrate:i,repo:n,onMigrationProgress:s}=t,o=typeof n=="string"||n==null?hht(e,{path:n,autoMigrate:i,onMigrationProgress:s}):n,{peerId:a,keychain:c,isNew:u}=await wht(e,o,t);return new q3(a,c,o,e,u)}};kve.exports=q3;var wht=async(r,e,t)=>{if(!e.closed)return{...await Ove(e,t),isNew:!1};try{return await e.open(),{...await Ove(e,t),isNew:!1}}catch(i){if(i.code!==pht)throw i;if(t.init&&t.init.allowNew===!1)throw new mht("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await _ht(r,e,t),isNew:!0}}},_ht=async(r,e,t)=>{let i=t.init||{},n=await e.exists();if(wb("repo exists?",n),n===!0)throw new Error("repo already exists");let s=i.privateKey?await Eht(i.privateKey):await Sht(r,i),o=xht(s);wb("peer identity: %s",o.PeerID);let a={...Cve(Bve(dht(),i.profiles),t.config),Identity:o};await e.init(a),await e.open(),wb("repo opened");let c=await Pve({options:void 0,multiaddrs:void 0,peerId:s,repo:e,config:a,keychainConfig:{pass:t.pass}});return c.keychain&&c.keychain.opts&&(await c.loadKeychain(),await e.config.set("Keychain",{dek:c.keychain.opts.dek})),{peerId:s,keychain:c.keychain}},Eht=r=>(wb("using user-supplied private-key"),typeof r=="object"?r:HC.createFromPrivKey(yht(r,"base64pad"))),Sht=(r,{algorithm:e="RSA",bits:t=2048})=>(r("generating %s-bit (rsa only) %s keypair...",t,e),HC.create({keyType:e,bits:t})),xht=r=>({PeerID:r.toB58String(),PrivKey:ght(r.privKey.bytes,"base64pad")}),Ove=async(r,e)=>{let t=e.config,i=e.init&&e.init.profiles||[],n=e.pass,s=await r.config.getAll(),o=Aht(Bve(s,i),t);if(s!==o&&await r.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new vht("No private key was found in the config, please intialize the repo");let a=await HC.createFromPrivKey(o.Identity.PrivKey),c=await Pve({options:void 0,multiaddrs:void 0,peerId:a,repo:r,config:o,keychainConfig:{pass:n,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},Aht=(r,e)=>e?Cve(r,e):r,Bve=(r,e)=>(e||[]).reduce((t,i)=>{let n=bht.profiles[i];if(!n)throw new Error(`Could not find profile with name '${i}'`);return wb("applying profile %s",i),n.transform(t)},r)});var Mve=p((r8t,Dve)=>{l();"use strict";var qve=ey();Dve.exports=r=>{if(!(r instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;r.length>0;){let t=qve.decode(r);e.push(t),r=r.slice(qve.decode.bytes)}return e}});var wu=p((i8t,Lve)=>{l();"use strict";var Fve=xe(),Iht=Dr(),Tht=(r,e)=>{let t=["bitswap"];return e&&t.push(e),r&&t.push(`${r.toB58String().slice(0,8)}`),Object.assign(Fve(t.join(":")),{error:Fve(t.concat(["error"]).join(":"))})},GC=(r,e,t)=>{let i=0,n=t.length;for(;i<n;){if(r(e,t[i]))return!0;i+=1}return!1},Rht=(r,e)=>{let t=0,i=e.length,n=[],s;for(;t<i;)s=e[t],GC(r,s,n)||(n[n.length]=s),t+=1;return n},kht=(r,e)=>e.reduce((t,i)=>{let n=r(i);return t[n]?t[n].push(i):t[n]=[i],t},{}),Cht=(r,e,t)=>e.filter(i=>!GC(r,i,t)),Pht=(r,e)=>Array.prototype.slice.call(e,0).sort((t,i)=>{let n=r(t),s=r(i);return n<s?-1:n>s?1:0}),Oht=(r,e)=>{if(r.size!==e.size)return!1;for(let[t,i]of r){let n=e.get(t);if(n===void 0||typeof i.equals=="function"&&!i.equals(n)||i.data&&!(n.data&&Iht(i.data,n.data)))return!1}return!0};Lve.exports={logger:Tht,includesWith:GC,uniqWith:Rht,groupBy:kht,pullAllWith:Cht,sortBy:Pht,isMapEqual:Oht}});var Kve=p((n8t,Uve)=>{l();"use strict";var Ec=hi(),Sc=Ec.Reader,_b=Ec.Writer,Ht=Ec.util,Ot=Ec.roots["ipfs-bitswap"]||(Ec.roots["ipfs-bitswap"]={});Ot.Message=function(){function r(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.wantlist=null,r.prototype.blocks=Ht.emptyArray,r.prototype.payload=Ht.emptyArray,r.prototype.blockPresences=Ht.emptyArray,r.prototype.pendingBytes=0,r.encode=function(t,i){if(i||(i=_b.create()),t.wantlist!=null&&Object.hasOwnProperty.call(t,"wantlist")&&Ot.Message.Wantlist.encode(t.wantlist,i.uint32(10).fork()).ldelim(),t.blocks!=null&&t.blocks.length)for(var n=0;n<t.blocks.length;++n)i.uint32(18).bytes(t.blocks[n]);if(t.payload!=null&&t.payload.length)for(var n=0;n<t.payload.length;++n)Ot.Message.Block.encode(t.payload[n],i.uint32(26).fork()).ldelim();if(t.blockPresences!=null&&t.blockPresences.length)for(var n=0;n<t.blockPresences.length;++n)Ot.Message.BlockPresence.encode(t.blockPresences[n],i.uint32(34).fork()).ldelim();return t.pendingBytes!=null&&Object.hasOwnProperty.call(t,"pendingBytes")&&i.uint32(40).int32(t.pendingBytes),i},r.decode=function(t,i){t instanceof Sc||(t=Sc.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ot.Message;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.wantlist=Ot.Message.Wantlist.decode(t,t.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(t.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(Ot.Message.Block.decode(t,t.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(Ot.Message.BlockPresence.decode(t,t.uint32()));break;case 5:s.pendingBytes=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Ot.Message)return t;var i=new Ot.Message;if(t.wantlist!=null){if(typeof t.wantlist!="object")throw TypeError(".Message.wantlist: object expected");i.wantlist=Ot.Message.Wantlist.fromObject(t.wantlist)}if(t.blocks){if(!Array.isArray(t.blocks))throw TypeError(".Message.blocks: array expected");i.blocks=[];for(var n=0;n<t.blocks.length;++n)typeof t.blocks[n]=="string"?Ht.base64.decode(t.blocks[n],i.blocks[n]=Ht.newBuffer(Ht.base64.length(t.blocks[n])),0):t.blocks[n].length&&(i.blocks[n]=t.blocks[n])}if(t.payload){if(!Array.isArray(t.payload))throw TypeError(".Message.payload: array expected");i.payload=[];for(var n=0;n<t.payload.length;++n){if(typeof t.payload[n]!="object")throw TypeError(".Message.payload: object expected");i.payload[n]=Ot.Message.Block.fromObject(t.payload[n])}}if(t.blockPresences){if(!Array.isArray(t.blockPresences))throw TypeError(".Message.blockPresences: array expected");i.blockPresences=[];for(var n=0;n<t.blockPresences.length;++n){if(typeof t.blockPresences[n]!="object")throw TypeError(".Message.blockPresences: object expected");i.blockPresences[n]=Ot.Message.BlockPresence.fromObject(t.blockPresences[n])}}return t.pendingBytes!=null&&(i.pendingBytes=t.pendingBytes|0),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),i.defaults&&(n.wantlist=null,n.pendingBytes=0),t.wantlist!=null&&t.hasOwnProperty("wantlist")&&(n.wantlist=Ot.Message.Wantlist.toObject(t.wantlist,i)),t.blocks&&t.blocks.length){n.blocks=[];for(var s=0;s<t.blocks.length;++s)n.blocks[s]=i.bytes===String?Ht.base64.encode(t.blocks[s],0,t.blocks[s].length):i.bytes===Array?Array.prototype.slice.call(t.blocks[s]):t.blocks[s]}if(t.payload&&t.payload.length){n.payload=[];for(var s=0;s<t.payload.length;++s)n.payload[s]=Ot.Message.Block.toObject(t.payload[s],i)}if(t.blockPresences&&t.blockPresences.length){n.blockPresences=[];for(var s=0;s<t.blockPresences.length;++s)n.blockPresences[s]=Ot.Message.BlockPresence.toObject(t.blockPresences[s],i)}return t.pendingBytes!=null&&t.hasOwnProperty("pendingBytes")&&(n.pendingBytes=t.pendingBytes),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Ec.util.toJSONOptions)},r.Wantlist=function(){function e(t){if(this.entries=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.entries=Ht.emptyArray,e.prototype.full=!1,e.encode=function(i,n){if(n||(n=_b.create()),i.entries!=null&&i.entries.length)for(var s=0;s<i.entries.length;++s)Ot.Message.Wantlist.Entry.encode(i.entries[s],n.uint32(10).fork()).ldelim();return i.full!=null&&Object.hasOwnProperty.call(i,"full")&&n.uint32(16).bool(i.full),n},e.decode=function(i,n){i instanceof Sc||(i=Sc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ot.Message.Wantlist;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(Ot.Message.Wantlist.Entry.decode(i,i.uint32()));break;case 2:o.full=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ot.Message.Wantlist)return i;var n=new Ot.Message.Wantlist;if(i.entries){if(!Array.isArray(i.entries))throw TypeError(".Message.Wantlist.entries: array expected");n.entries=[];for(var s=0;s<i.entries.length;++s){if(typeof i.entries[s]!="object")throw TypeError(".Message.Wantlist.entries: object expected");n.entries[s]=Ot.Message.Wantlist.Entry.fromObject(i.entries[s])}}return i.full!=null&&(n.full=Boolean(i.full)),n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.entries=[]),n.defaults&&(s.full=!1),i.entries&&i.entries.length){s.entries=[];for(var o=0;o<i.entries.length;++o)s.entries[o]=Ot.Message.Wantlist.Entry.toObject(i.entries[o],n)}return i.full!=null&&i.hasOwnProperty("full")&&(s.full=i.full),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ec.util.toJSONOptions)},e.WantType=function(){var t={},i=Object.create(t);return i[t[0]="Block"]=0,i[t[1]="Have"]=1,i}(),e.Entry=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.block=Ht.newBuffer([]),t.prototype.priority=0,t.prototype.cancel=!1,t.prototype.wantType=0,t.prototype.sendDontHave=!1,t.encode=function(n,s){return s||(s=_b.create()),n.block!=null&&Object.hasOwnProperty.call(n,"block")&&s.uint32(10).bytes(n.block),n.priority!=null&&Object.hasOwnProperty.call(n,"priority")&&s.uint32(16).int32(n.priority),n.cancel!=null&&Object.hasOwnProperty.call(n,"cancel")&&s.uint32(24).bool(n.cancel),n.wantType!=null&&Object.hasOwnProperty.call(n,"wantType")&&s.uint32(32).int32(n.wantType),n.sendDontHave!=null&&Object.hasOwnProperty.call(n,"sendDontHave")&&s.uint32(40).bool(n.sendDontHave),s},t.decode=function(n,s){n instanceof Sc||(n=Sc.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Ot.Message.Wantlist.Entry;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.block=n.bytes();break;case 2:a.priority=n.int32();break;case 3:a.cancel=n.bool();break;case 4:a.wantType=n.int32();break;case 5:a.sendDontHave=n.bool();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof Ot.Message.Wantlist.Entry)return n;var s=new Ot.Message.Wantlist.Entry;switch(n.block!=null&&(typeof n.block=="string"?Ht.base64.decode(n.block,s.block=Ht.newBuffer(Ht.base64.length(n.block)),0):n.block.length&&(s.block=n.block)),n.priority!=null&&(s.priority=n.priority|0),n.cancel!=null&&(s.cancel=Boolean(n.cancel)),n.wantType){case"Block":case 0:s.wantType=0;break;case"Have":case 1:s.wantType=1;break}return n.sendDontHave!=null&&(s.sendDontHave=Boolean(n.sendDontHave)),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.block="":(o.block=[],s.bytes!==Array&&(o.block=Ht.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=s.enums===String?"Block":0,o.sendDontHave=!1),n.block!=null&&n.hasOwnProperty("block")&&(o.block=s.bytes===String?Ht.base64.encode(n.block,0,n.block.length):s.bytes===Array?Array.prototype.slice.call(n.block):n.block),n.priority!=null&&n.hasOwnProperty("priority")&&(o.priority=n.priority),n.cancel!=null&&n.hasOwnProperty("cancel")&&(o.cancel=n.cancel),n.wantType!=null&&n.hasOwnProperty("wantType")&&(o.wantType=s.enums===String?Ot.Message.Wantlist.WantType[n.wantType]:n.wantType),n.sendDontHave!=null&&n.hasOwnProperty("sendDontHave")&&(o.sendDontHave=n.sendDontHave),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ec.util.toJSONOptions)},t}(),e}(),r.Block=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.prefix=Ht.newBuffer([]),e.prototype.data=Ht.newBuffer([]),e.encode=function(i,n){return n||(n=_b.create()),i.prefix!=null&&Object.hasOwnProperty.call(i,"prefix")&&n.uint32(10).bytes(i.prefix),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&n.uint32(18).bytes(i.data),n},e.decode=function(i,n){i instanceof Sc||(i=Sc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ot.Message.Block;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.prefix=i.bytes();break;case 2:o.data=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ot.Message.Block)return i;var n=new Ot.Message.Block;return i.prefix!=null&&(typeof i.prefix=="string"?Ht.base64.decode(i.prefix,n.prefix=Ht.newBuffer(Ht.base64.length(i.prefix)),0):i.prefix.length&&(n.prefix=i.prefix)),i.data!=null&&(typeof i.data=="string"?Ht.base64.decode(i.data,n.data=Ht.newBuffer(Ht.base64.length(i.data)),0):i.data.length&&(n.data=i.data)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.prefix="":(s.prefix=[],n.bytes!==Array&&(s.prefix=Ht.newBuffer(s.prefix))),n.bytes===String?s.data="":(s.data=[],n.bytes!==Array&&(s.data=Ht.newBuffer(s.data)))),i.prefix!=null&&i.hasOwnProperty("prefix")&&(s.prefix=n.bytes===String?Ht.base64.encode(i.prefix,0,i.prefix.length):n.bytes===Array?Array.prototype.slice.call(i.prefix):i.prefix),i.data!=null&&i.hasOwnProperty("data")&&(s.data=n.bytes===String?Ht.base64.encode(i.data,0,i.data.length):n.bytes===Array?Array.prototype.slice.call(i.data):i.data),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ec.util.toJSONOptions)},e}(),r.BlockPresenceType=function(){var e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),r.BlockPresence=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.cid=Ht.newBuffer([]),e.prototype.type=0,e.encode=function(i,n){return n||(n=_b.create()),i.cid!=null&&Object.hasOwnProperty.call(i,"cid")&&n.uint32(10).bytes(i.cid),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(16).int32(i.type),n},e.decode=function(i,n){i instanceof Sc||(i=Sc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ot.Message.BlockPresence;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.cid=i.bytes();break;case 2:o.type=i.int32();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ot.Message.BlockPresence)return i;var n=new Ot.Message.BlockPresence;switch(i.cid!=null&&(typeof i.cid=="string"?Ht.base64.decode(i.cid,n.cid=Ht.newBuffer(Ht.base64.length(i.cid)),0):i.cid.length&&(n.cid=i.cid)),i.type){case"Have":case 0:n.type=0;break;case"DontHave":case 1:n.type=1;break}return n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.cid="":(s.cid=[],n.bytes!==Array&&(s.cid=Ht.newBuffer(s.cid))),s.type=n.enums===String?"Have":0),i.cid!=null&&i.hasOwnProperty("cid")&&(s.cid=n.bytes===String?Ht.base64.encode(i.cid,0,i.cid.length):n.bytes===Array?Array.prototype.slice.call(i.cid):i.cid),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?Ot.Message.BlockPresenceType[i.type]:i.type),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ec.util.toJSONOptions)},e}(),r}();Uve.exports=Ot});var zve=p((s8t,jve)=>{l();"use strict";var Vve=class{constructor(e,t,i){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=i}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString("base58btc")}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};jve.exports=Vve});var Eb=p((o8t,Hve)=>{l();"use strict";var{sortBy:Bht}=wu(),Gve=zve(),$C=class{constructor(e){this.set=new Map,this._stats=e}get length(){return this.set.size}add(e,t,i){let n=j0(),s=e.toString("base58btc"),o=this.set.get(s);o?(o.inc(),o.priority=t,o.wantType===n.WantType.Have&&i===n.WantType.Block&&(o.wantType=i)):(this.set.set(s,new Gve(e,t,i)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let t=e.toString("base58btc"),i=this.set.get(t);!i||(i.dec(),!i.hasRefs()&&(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(Bht(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let t=e.toString("base58btc");return this.set.get(t)}};$C.Entry=Gve;Hve.exports=$C});var Wve=p((c8t,$ve)=>{l();"use strict";var Nht=Eb().Entry;$ve.exports=class{constructor(e,t,i,n,s){this.entry=new Nht(e,t,i),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString("base58btc")} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}});var j0=p((u8t,Yve)=>{l();"use strict";var Xve=xl(),Sb=Qe(),{getName:Dht}=$r(),qht=Mve(),Jve=er(),{isMapEqual:WC}=wu(),{Message:_u}=Kve(),Qve=Wve(),Sn=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,t,i,n,s){i==null&&(i=Sn.WantType.Block);let o=e.toString("base58btc"),a=this.wantlist.get(o);a?(a.wantType===i&&(a.priority=t),n&&(a.cancel=Boolean(n)),s&&(a.sendDontHave=Boolean(s)),i===Sn.WantType.Block&&a.wantType===Sn.WantType.Have&&(a.wantType=i)):this.wantlist.set(o,new Qve(e,t,i,n,s))}addBlock(e){let t=e.cid.toString("base58btc");this.blocks.set(t,e)}addHave(e){let t=e.toString("base58btc");this.blockPresences.has(t)||this.blockPresences.set(t,Sn.BlockPresenceType.Have)}addDontHave(e){let t=e.toString("base58btc");this.blockPresences.has(t)||this.blockPresences.set(t,Sn.BlockPresenceType.DontHave)}cancel(e){let t=e.toString("base58btc");this.wantlist.delete(t),this.addEntry(e,0,Sn.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),cancel:Boolean(t.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values()).map(t=>t.data)};return _u.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:Boolean(t.cancel),sendDontHave:Boolean(t.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};this.blocks.forEach(t=>{e.payload.push(new _u.Block({prefix:t.cid.prefix,data:t.data}))});for(let[t,i]of this.blockPresences)e.blockPresences.push(new _u.BlockPresence({cid:new Sb(t).bytes,type:i}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),_u.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!WC(this.wantlist,e.wantlist)||!WC(this.blocks,e.blocks)||!WC(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}};Sn.deserialize=async r=>{let e=_u.decode(r),t=e.wantlist&&e.wantlist.full||!1,i=new Sn(t);return e.wantlist&&e.wantlist.entries&&e.wantlist.entries.forEach(n=>{if(!n.block)return;let s=new Sb(n.block);i.addEntry(s,n.priority||0,n.wantType,Boolean(n.cancel),Boolean(n.sendDontHave))}),e.blockPresences&&e.blockPresences.forEach(n=>{if(!n.cid)return;let s=new Sb(n.cid);n.type===Sn.BlockPresenceType.Have?i.addHave(s):i.addDontHave(s)}),e.blocks.length>0?(await Promise.all(e.blocks.map(async n=>{let s=await Jve(n,"sha2-256"),o=new Sb(s);i.addBlock(new Xve(n,o))})),i):(e.payload.length>0&&(await Promise.all(e.payload.map(async n=>{if(!n.prefix||!n.data)return;let s=qht(n.prefix),o=s[0],a=s[1],c=s[2],u=await Jve(n.data,c),f=new Sb(o,Dht(a),u);i.addBlock(new Xve(n.data,f))})),i.setPendingBytes(e.pendingBytes)),i)};Sn.blockPresenceSize=r=>r.bytes.length+1;Sn.Entry=Qve;Sn.WantType={Block:_u.Wantlist.WantType.Block,Have:_u.Wantlist.WantType.Have};Sn.BlockPresenceType={Have:_u.BlockPresenceType.Have,DontHave:_u.BlockPresenceType.DontHave};Yve.exports=Sn});var xb=p((f8t,Zve)=>{l();"use strict";var YC=1e3;Zve.exports={maxProvidersPerRequest:3,providerRequestTimeout:10*YC,hasBlockTimeout:15*YC,provideTimeout:15*YC,kMaxPriority:Math.pow(2,31)-1,maxListeners:1e3,wantlistSendDebounceMs:1}});var twe=p((l8t,ewe)=>{l();ewe.exports=Mht;function Mht(r,e,t){var i=null,n=null,s=function(){i&&(clearTimeout(i),n=null,i=null)},o=function(){var c=n;s(),c&&c()},a=function(){if(!e)return r.apply(this,arguments);var c=this,u=arguments,f=t&&!i;if(s(),n=function(){r.apply(c,u)},i=setTimeout(function(){if(i=null,!f){var h=n;return n=null,h()}},e),f)return n()};return a.cancel=s,a.flush=o,a}});var iwe=p((d8t,rwe)=>{l();"use strict";var Lht=twe(),Fht=j0(),Uht=wu().logger,{wantlistSendDebounceMs:Kht}=xb();rwe.exports=class{constructor(e,t,i){this.peerId=t,this.network=i,this.refcnt=1,this._entries=[],this._log=Uht(e,"msgqueue"),this.sendEntries=Lht(this._sendEntries.bind(this),Kht)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new Fht(!1);this._entries.forEach(t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(t){this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),t.message);return}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(t=>{this._log.error("send error: %s",t.message)})}}});var swe=p((y8t,nwe)=>{l();"use strict";var XC=j0(),jht=Eb(),Vht=xb(),zht=iwe(),Hht=wu().logger;nwe.exports=class{constructor(e,t,i){this.peers=new Map,this.wantlist=new jht(i),this.network=t,this._stats=i,this._peerId=e,this._log=Hht(e,"want")}_addEntries(e,t,i){let n=e.map((s,o)=>new XC.Entry(s,Vht.kMaxPriority-o,XC.WantType.Block,t));n.forEach(s=>{s.cancel?i?this.wantlist.removeForce(s.cid.toString()):this.wantlist.remove(s.cid):(this._log("adding to wl"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toB58String());if(t){t.refcnt++;return}t=new zht(this._peerId,e,this.network);let i=new XC(!0);for(let n of this.wantlist.entries())i.addEntry(n[1].cid,n[1].priority);return t.addMessage(i),this.peers.set(e.toB58String(),t),t}_stopPeerHandler(e){let t=this.peers.get(e.toB58String());!t||(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toB58String()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}}});var lwe=p((g8t,owe)=>{l();"use strict";var awe=ia(),{pipe:cwe}=pi(),Ght=y_(),$ht=j0(),uwe=xb(),Wht=wu().logger,JC="/ipfs/bitswap/1.0.0",QC="/ipfs/bitswap/1.1.0",ZC="/ipfs/bitswap/1.2.0",fwe=class{constructor(e,t,i,n={}){this._log=Wht(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[JC],n.b100Only||(this._protocols.unshift(QC),this._protocols.unshift(ZC)),this._stats=i,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this)}start(){this._running=!0,this._libp2p.handle(this._protocols,this._onConnection);let e=new Ght({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=this._libp2p.registrar.register(e);for(let t of this._libp2p.peerStore.peers.values()){let i=this._libp2p.connectionManager.get(t.id);i&&this._onPeerConnect(i.remotePeer)}}stop(){this._running=!1,this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:t,connection:i}){if(!!this._running){this._log("incoming new bitswap %s connection from %s",e,i.remotePeer.toB58String());try{await cwe(t,awe.decode(),async n=>{for await(let s of n)try{let o=await $ht.deserialize(s.slice());await this._bitswap._receiveMessage(i.remotePeer,o)}catch(o){this._bitswap._receiveError(o);break}})}catch(n){this._log(n)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t,i={}){return this._libp2p.contentRouting.findProviders(e,{maxTimeout:uwe.providerRequestTimeout,maxNumProviders:t,signal:i.signal})}async findAndConnect(e,t){let i=[];for await(let n of this.findProviders(e,uwe.maxProvidersPerRequest,t))this._log(`connecting to provider ${n.id}`),i.push(this.connectTo(n.id,t).catch(s=>{this._log.error(s)}));await Promise.all(i)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");let i=e.toB58String();this._log("sendMessage to %s",i,t);let n=await this._libp2p.dial(e),{stream:s,protocol:o}=await n.newStream([ZC,QC,JC]),a;switch(o){case JC:a=t.serializeToBitswap100();break;case QC:case ZC:a=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+o)}Yht(s,a,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){let i=e.toB58String();this._stats&&(t.forEach(n=>this._stats.push(i,"dataSent",n.data.length)),this._stats.push(i,"blocksSent",t.size))}};async function Yht(r,e,t){try{await cwe([e],awe.encode(),r)}catch(i){t(i)}}owe.exports=fwe});var pwe=p((b8t,hwe)=>{l();"use strict";var Xht=Eb(),dwe=class{constructor(e){this.partner=e,this.wantlist=new Xht,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,t,i){this.wantlist.add(e,t,i)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.contains(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};hwe.exports=dwe});var bwe=p((m8t,ywe)=>{l();"use strict";var gwe=class extends Map{constructor(e,t){super();this._cmp=t||this._defaultSort,this._keys=[];for(let[i,n]of e||[])this.set(i,n)}update(e){if(e<0||e>=this._keys.length)return;let t=this._keys[e];this._keys.splice(e,1);let i=this._find(t);this._keys.splice(i,0,t)}set(e,t){if(this.has(e)){let n=this.indexOf(e);this._keys.splice(n,1)}super.set(e,t);let i=this._find(e);return this._keys.splice(i,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let t=this._find(e);if(this._keys[t]===e)return t;for(let i=1;i<this._keys.length;i++){if(this._keys[t+i]===e)return t+i;if(this._keys[t-i]===e)return t-i}return-1}_find(e){let t=0,i=this._keys.length;for(;t<i;){let n=t+i>>>1,s=this._kCmp(this._keys[n],e);if(s<0)t=n+1;else if(s>0)i=n;else return n}return t}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(!!e)for(let i of this._keys)e.apply(t,[[i,this.get(i)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}};ywe.exports=gwe});var Ewe=p((v8t,mwe)=>{l();"use strict";var vwe=bwe(),Jht={hasNewInfo(){return!1},merge(){}},wwe=class{constructor(e=Jht){this._taskMerger=e,this._byPeer=new vwe([],eP.compare)}pushTasks(e,t){let i=this._byPeer.get(e.toB58String());i||(i=new eP(e,this._taskMerger)),i.pushTasks(t),this._byPeer.set(e.toB58String(),i)}popTasks(e){let t=this._head();if(t===void 0)return{tasks:[],pendingSize:0};let{tasks:i,pendingSize:n}=t.popTasks(e);if(i.length===0)return{tasks:i,pendingSize:n};let s=t.peerId;return t.isIdle()?this._byPeer.delete(s.toB58String()):this._byPeer.update(0),{peerId:s,tasks:i,pendingSize:n}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,t){let i=this._byPeer.get(t.toB58String());i&&i.remove(e)}tasksDone(e,t){let i=this._byPeer.get(e.toB58String());if(!i)return;let n=this._byPeer.indexOf(e.toB58String());for(let s of t)i.taskDone(s);this._byPeer.update(n)}},eP=class{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new _we,this._active=new Set}pushTasks(e){for(let t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let t=this._pending.get(e.topic);if(t){e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,t);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let t=[];for(let i of this._active)i.topic===e.topic&&t.push(i);return t.length===0?!0:this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0,i=[],n=this._pending.tasks();for(let s=0;s<n.length&&t<e;s++){let o=n[s];i.push(o),t+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:i,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,t){return e[1]._pending.length===0?1:t[1]._pending.length===0?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}},_we=class{constructor(){this._tasks=new vwe([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){let i=this._tasks.get(e);if(!i)return;let n=this._tasks.indexOf(e);i.task.priority=t,this._tasks.update(n)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}};mwe.exports=wwe});var xwe=p((w8t,Swe)=>{l();"use strict";var Qht={hasNewInfo(r,e){let t=!1,i=!1;for(let n of e)n.data.haveBlock&&(t=!0),n.data.isWantBlock&&(i=!0);return!!(!i&&r.data.isWantBlock||!t&&r.data.haveBlock)},merge(r,e){let t=r.data,i=e.data;!i.haveBlock&&t.haveBlock&&(i.haveBlock=t.haveBlock,i.blockSize=t.blockSize),!i.isWantBlock&&t.isWantBlock&&(i.isWantBlock=!0,(!i.haveBlock||t.haveBlock)&&(i.haveBlock=t.haveBlock,e.size=r.size)),i.isWantBlock&&i.haveBlock&&(e.size=i.blockSize)}};Swe.exports=Qht});var kwe=p((_8t,Awe)=>{l();"use strict";var Iwe=Qe(),Ab=j0(),Twe=Ab.WantType,Zht=Eb(),edt=pwe(),tdt=Ewe(),rdt=xwe(),{logger:idt}=wu(),ndt=16*1024,sdt=1024,Rwe=class{constructor(e,t,i,n,s={}){this._log=idt(e,"engine"),this.blockstore=t,this.network=i,this._stats=n,this._opts=this._processOpts(s),this.ledgerMap=new Map,this._running=!1,this._requestQueue=new tdt(rdt)}_processOpts(e){return{maxSizeReplaceHasWithBlock:sdt,targetMessageSize:ndt,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:t,pendingSize:i}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(t.length===0)return;let n=new Ab(!1);n.setPendingBytes(i);let s=[],o=new Map;for(let c of t){let u=new Iwe(c.topic);c.data.haveBlock?c.data.isWantBlock?(s.push(u),o.set(c.topic,c.data)):n.addHave(u):n.addDontHave(u)}let a=await this._getBlocks(s);for(let[c,u]of o){let f=a.get(c);if(f)n.addBlock(f);else if(u.sendDontHave){let h=new Iwe(c);n.addDontHave(h)}}if(n.empty){e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,n);for(let c of a.values())e&&this.messageSent(e,c)}catch(c){this._log.error(c)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?i.wantlist.sortedEntries():new Map}ledgerForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?{peer:i.partner.toPrint(),value:i.debtRatio(),sent:i.accounting.bytesSent,recv:i.accounting.bytesRecv,exchanged:i.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){!e.length||(this.ledgerMap.forEach(t=>{e.forEach(i=>{let n=t.wantlistContains(i.cid);if(!n)return;let s=i.data.length,o=this._sendAsBlock(n.wantType,s),a=s;o||(a=Ab.blockPresenceSize(n.cid)),this._requestQueue.pushTasks(t.partner,[{topic:n.cid.toString(),priority:n.priority,size:a,data:{blockSize:s,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])})}),this._scheduleProcessTasks())}async messageReceived(e,t){let i=this._findOrCreate(e);if(t.empty)return;if(t.full&&(i.wantlist=new Zht),this._updateBlockAccounting(t.blocks,i),t.wantlist.size===0){this._scheduleProcessTasks();return}let n=[],s=[];t.wantlist.forEach(o=>{o.cancel?(i.cancelWant(o.cid),n.push(o.cid)):(i.wants(o.cid,o.priority,o.wantType),s.push(o))}),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,t){for(let i of t)this._requestQueue.remove(i.toString(),e)}async _addWants(e,t){let i=await this._getBlockSizes(t.map(s=>s.cid)),n=[];for(let s of t){let o=s.cid.toString(),a=i.get(o);if(a==null)s.sendDontHave&&n.push({topic:o,priority:s.priority,size:Ab.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===Twe.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{let c=this._sendAsBlock(s.wantType,a),u=a;c||(u=Ab.blockPresenceSize(s.cid)),n.push({topic:o,priority:s.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,t){return e===Twe.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let t=await this._getBlocks(e);return new Map([...t].map(([i,n])=>[i,n.data.length]))}async _getBlocks(e){let t=new Map;return await Promise.all(e.map(async i=>{try{let n=await this.blockstore.get(i);t.set(i.toString(),n)}catch(n){n.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",i,n)}})),t}_updateBlockAccounting(e,t){e.forEach(i=>{this._log("got block (%s bytes)",i.data.length),t.receivedBytes(i.data.length)})}messageSent(e,t){let i=this._findOrCreate(e);i.sentBytes(t?t.data.length:0),t&&t.cid&&i.wantlist.remove(t.cid)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){}_findOrCreate(e){let t=e.toB58String(),i=this.ledgerMap.get(t);if(i)return i;let n=new edt(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}};Awe.exports=Rwe});var Dwe=p((E8t,Cwe)=>{l();"use strict";var{EventEmitter:odt}=Lr(),adt=xl(),cdt=Dr(),Pwe=tt(),udt=xb(),fdt=wu().logger,Owe=r=>`unwant:${Pwe(r.multihash,"base64")}`,Bwe=r=>`block:${Pwe(r.multihash,"base64")}`,Nwe=class extends odt{constructor(e){super();this.setMaxListeners(udt.maxListeners),this._log=fdt(e,"notif")}hasBlock(e){let t=Bwe(e.cid);this._log(t),this.emit(t,e)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");let i=Bwe(e),n=Owe(e);return this._log(`wantBlock:${e}`),new Promise((s,o)=>{let a=()=>{this.removeListener(i,c),o(new Error(`Block for ${e} unwanted`))},c=u=>{if(this.removeListener(n,a),cdt(e.multihash,u.cid.multihash))(e.version!==u.cid.version||e.codec!==u.cid.codec)&&(u=new adt(u.data,e));else return o(new Error(`Incorrect block received for ${e}`));s(u)};this.once(n,a),this.once(i,c),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.removeListener(i,c),this.removeListener(n,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let t=Owe(e);this._log(t),this.emit(t)}};Cwe.exports=Nwe});var Fwe=p((S8t,qwe)=>{l();"use strict";var{EventEmitter:ldt}=Lr(),Mwe=dR(),Lwe=class extends ldt{constructor(e,t){super();this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(i=>{this._stats[i]=BigInt(0),this._movingAverages[i]={},this._options.movingAverageIntervals.forEach(n=>{(this._movingAverages[i][n]=Mwe(n)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let s=n/t*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=Mwe(a)),c.push(i,s)})}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};qwe.exports=Lwe});var zwe=p((x8t,Uwe)=>{l();"use strict";var{EventEmitter:hdt}=Lr(),Kwe=Fwe(),jwe={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},Vwe=class extends hdt{constructor(e=[],t=jwe){super();let i=Object.assign({},jwe,t);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=e,this._options=i,this._enabled=this._options.enabled,this._global=new Kwe(e,i),this._global.on("update",n=>this.emit("update",n)),this._peers=new Map}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let t=typeof e!="string"&&e.toB58String?e.toB58String():`${e}`;return this._peers.get(t)}push(e,t,i){if(this._enabled&&(this._global.push(t,i),e)){let n=this._peers.get(e);n||(n=new Kwe(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,i)}}disconnected(e){let t=e.toB58String(),i=this._peers.get(t);i&&(i.stop(),this._peers.delete(t))}};Uwe.exports=Vwe});var $we=p((A8t,Hwe)=>{l();"use strict";var ddt=swe(),pdt=lwe(),ydt=kwe(),gdt=Dwe(),bdt=wu().logger,mdt=zwe(),{AbortController:vdt}=Q0(),{anySignal:wdt}=Bh(),_dt={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},Edt=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],Gwe=class{constructor(e,t,i={}){this._libp2p=e,this._log=bdt(this.peerId),this._options=Object.assign({},_dt,i),this._stats=new mdt(Edt,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new pdt(e,this,this._stats),this.blockstore=t,this.engine=new ydt(this.peerId,t,this.network,this._stats),this.wm=new ddt(this.peerId,this.network,this._stats),this.notifications=new gdt(this.peerId)}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(s){this._log("failed to receive message",t)}if(t.blocks.size===0)return;let i=Array.from(t.blocks.values()),n=i.filter(s=>this.wm.wantlist.contains(s.cid)).map(s=>s.cid);this.wm.cancelWants(n),await Promise.all(i.map(async s=>{let o=n.includes(s.cid);await this._handleReceivedBlock(e,s,o)}))}async _handleReceivedBlock(e,t,i){this._log("received block");let n=await this.blockstore.has(t.cid);this._updateReceiveCounters(e.toB58String(),t,n),!!i&&await this.put(t)}_updateReceiveCounters(e,t,i){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",t.data.length),i&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",t.data.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){let i=(u,f)=>(this.wm.wantBlocks([u],f),this.notifications.wantBlock(u,f)),n=!1,s=async(u,f)=>{try{return await this.blockstore.get(u,f)}catch(h){if(h.code!=="ERR_NOT_FOUND")throw h;return n||(n=!0,this.network.findAndConnect(u).catch(d=>this._log.error(d))),i(u,f)}},o=new vdt,a=t.signal?wdt([t.signal,o.signal]):o.signal,c=await Promise.race([this.notifications.wantBlock(e,{signal:a}),s(e,{signal:a})]);return o.abort(),c}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}unwant(e){let t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(i=>this.notifications.unwantBlock(i))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t){await this.blockstore.put(e),this._sendHaveBlockNotifications(e)}async*putMany(e){for await(let t of this.blockstore.putMany(e))this._sendHaveBlockNotifications(t),yield t}_sendHaveBlockNotifications(e){this.notifications.hasBlock(e),this.engine.receivedBlocks([e]),this.network.provide(e.cid).catch(t=>{this._log.error("Failed to provide: %s",t.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}start(){this.wm.start(),this.network.start(),this.engine.start()}stop(){this._stats.stop(),this.wm.stop(),this.network.stop(),this.engine.stop()}};Hwe.exports=Gwe});var Ywe=p((I8t,Wwe)=>{l();"use strict";var Sdt=$we(),xdt=zC(),{Multiaddr:Adt}=lr(),Idt=ge(),M3=class{constructor(e,t,i){this.peerId=e,this.libp2p=t,this.bitswap=i}static async start({peerId:e,repo:t,print:i,options:n}){t.closed&&await t.open();let s=await t.config.getAll(),o=await xdt({options:n,repo:t,peerId:e,multiaddrs:Tdt(e,s),config:s,keychainConfig:void 0});o.keychain&&await o.loadKeychain(),await o.start();for(let c of o.multiaddrs)i(`Swarm listening on ${c}/p2p/${e.toB58String()}`);let a=new Sdt(o,t.blocks,{statsEnabled:!0});return await a.start(),new M3(e,o,a)}static async stop(e){await Promise.all([e.bitswap.stop(),e.libp2p.stop()])}};Wwe.exports=M3;var Tdt=(r,e)=>{let t=r.toB58String(),i=[],n=e.Addresses&&e.Addresses.Swarm||[];for(let s of n){let o=new Adt(s);if(o.protoCodes().includes(Rdt))throw Idt(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=o.getPeerId();a&&a!==t&&(o=o.encapsulate(`/p2p/${t}`)),i.push(o)}return i},Rdt=479});var Jwe=p((T8t,Xwe)=>{l();"use strict";var kdt=Be();Xwe.exports=({network:r})=>{async function e(t={}){let i=[],{libp2p:n}=await r.use(t);for(let[s,o]of n.peerStore.peers.entries())i.push({id:s,addrs:o.addresses.map(a=>a.multiaddr)});return i}return kdt(e)}});var Zwe=p((R8t,Qwe)=>{l();"use strict";var Cdt=Be();Qwe.exports=({network:r})=>{async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.dial(t,i)}return Cdt(e)}});var t_e=p((k8t,e_e)=>{l();"use strict";var Pdt=Be();e_e.exports=({network:r})=>{async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.hangUp(t)}return Pdt(e)}});var i_e=p((C8t,r_e)=>{l();"use strict";var Odt=Be();r_e.exports=({network:r})=>{async function e(t={}){let{libp2p:i}=await r.use(t);return i.multiaddrs}return Odt(e)}});var s_e=p((P8t,n_e)=>{l();"use strict";var Bdt=Be();n_e.exports=({network:r})=>{async function e(t={}){let{libp2p:i}=await r.use(t),n=[];for(let[s,o]of i.connections)for(let a of o){let c={addr:a.remoteAddr,peer:s};(t.verbose||t.direction)&&(c.direction=a.stat.direction),t.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),n.push(c)}return n}return Bdt(e)}});var c_e=p((O8t,o_e)=>{l();"use strict";var Ndt=Jwe(),Ddt=Zwe(),qdt=t_e(),Mdt=i_e(),Ldt=s_e(),a_e=class{constructor({network:e}){this.addrs=Ndt({network:e}),this.connect=Ddt({network:e}),this.disconnect=qdt({network:e}),this.localAddrs=Mdt({network:e}),this.peers=Ldt({network:e})}};o_e.exports=a_e});var f_e=p((B8t,u_e)=>{l();"use strict";var Fdt=f5();u_e.exports=({path:r,repoOwner:e})=>Fdt(r,{singleProcess:e!==!1})});var h_e=p((N8t,l_e)=>{l();"use strict";var Udt=dt(),Ib={success:!0,time:0,text:""},Kdt=Be();l_e.exports=({network:r})=>{async function*e(t,i={}){let{libp2p:n}=await r.use();i.count=i.count||10;let s=Udt.createFromCID(t),o=n.peerStore.get(s),a=o&&o.id;if(!a){yield{...Ib,text:`Looking up peer ${t}`};let f=await n.peerRouting.findPeer(s);a=f&&f.id}if(!a)throw new Error("Peer was not found");yield{...Ib,text:`PING ${a.toB58String()}`};let c=0,u=0;for(let f=0;f<i.count;f++)try{let h=await n.ping(a);u+=h,c++,yield{...Ib,time:h}}catch(h){yield{...Ib,success:!1,text:h.toString()}}if(c){let f=u/c;yield{...Ib,text:`Average latency: ${f}ms`}}}return Kdt(e)}});var g_e=p((D8t,d_e)=>{l();"use strict";var p_e=dt(),y_e=Qe(),L3=ge(),{NotEnabledError:jdt}=Xu(),Vdt=_g(),V0=Be();d_e.exports=({network:r,repo:e})=>{let{get:t,put:i,findProvs:n,findPeer:s,provide:o,query:a}={async get(c,u={}){let{libp2p:f}=await z0(r,u);return f._dht.get(tP(c),u)},async*put(c,u,f){let{libp2p:h}=await z0(r,f);yield*h._dht.put(tP(c),u)},async*findProvs(c,u={numProviders:20}){let{libp2p:f}=await z0(r,u);for await(let h of f._dht.findProviders(tP(c),{maxNumProviders:u.numProviders,signal:u.signal}))yield{id:h.id.toB58String(),addrs:h.addrs}},async findPeer(c,u){let{libp2p:f}=await z0(r,u),h=await f._dht.findPeer(p_e.createFromCID(c));return{id:h.id.toB58String(),addrs:h.multiaddrs}},async*provide(c,u={recursive:!1}){let{libp2p:f}=await z0(r,u);c=Array.isArray(c)?c:[c];for(let y in c)if(typeof c[y]=="string")try{c[y]=new y_e(c[y])}catch(g){throw L3(g,"ERR_INVALID_CID")}if(!(await Promise.all(c.map(y=>e.blocks.has(y)))).every(y=>y))throw L3(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(u.recursive)throw L3(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");for(let y of c)yield f._dht.provide(y)},async*query(c,u){let{libp2p:f}=await z0(r,u);for await(let h of f._dht.getClosestPeers(p_e.createFromCID(c).toBytes()))yield{id:h.toB58String(),addrs:[]}}};return{get:V0(t),put:V0(i),findProvs:V0(n),findPeer:V0(s),provide:V0(o),query:V0(a)}};var zdt=r=>{try{let e=r.toString().split("/").filter(t=>t&&t!=="ipfs"&&t!=="ipns")[0];return new y_e(e).bytes}catch(e){throw L3(e,"ERR_INVALID_CID")}},tP=r=>r instanceof Uint8Array?r:zdt(r),z0=async(r,e)=>{let t=await r.use(e);if(Vdt(t.libp2p,"_config.dht.enabled",!1))return t;throw new jdt("dht not enabled")}});var m_e=p((q8t,b_e)=>{l();"use strict";var Tb=Be(),Hdt=ge(),{NotEnabledError:Gdt}=Xu(),$dt=_g();b_e.exports=({network:r,config:e})=>{let t=$dt(e||{},"Pubsub.Enabled",!0);return{subscribe:t?Tb(i):Rb,unsubscribe:t?Tb(n):Rb,publish:t?Tb(s):Rb,ls:t?Tb(o):Rb,peers:t?Tb(a):Rb};async function i(c,u,f={}){let{libp2p:h}=await r.use(f);return h.pubsub.subscribe(c,u,f)}async function n(c,u,f={}){let{libp2p:h}=await r.use(f);h.pubsub.unsubscribe(c,u,f)}async function s(c,u,f={}){let{libp2p:h}=await r.use(f);if(!u)throw Hdt(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await h.pubsub.publish(c,u)}async function o(c={}){let{libp2p:u}=await r.use(c);return u.pubsub.getTopics()}async function a(c,u={}){let{libp2p:f}=await r.use(u);return f.pubsub.getSubscribers(c)}};var Rb=async()=>{throw new Gdt("pubsub not enabled")}});var __e=p((M8t,v_e)=>{l();"use strict";var{mergeOptions:Wdt}=zi(),{isTest:Ydt}=Lb(),rP=xe()("ipfs"),w_e=ge(),{DAGNode:Xdt}=Mr(),{UnixFS:Jdt}=_i(),Qdt=SU(),{AlreadyInitializedError:Zdt}=Xu(),ept=ct(),tpt=IU(),rpt=RU(),ipt=$U(),npt=YU(),spt=rK(),opt=KV(),apt=SG(),cpt=XG(),upt=ZG(),fpt=t$(),lpt=l$(),hpt=T$(),dpt=X$(),ppt=LX(),ypt=KX(),gpt=VX(),bpt=r5(),mpt=eJ(),vpt=jd(),wpt=uJ(),_pt=dJ(),Ept=hZ(),Spt=PZ(),xpt=nee(),Apt=Vse(),Ipt=Yse(),Tpt=Zse(),Rpt=Voe(),kpt=Nve(),Cpt=Ywe(),Ppt=x2(),Opt=c_e(),Bpt=f_e(),Npt=h_e(),Dpt=g_e(),qpt=m_e(),F3=class{constructor({print:e,storage:t,options:i}){let{peerId:n,repo:s,keychain:o}=t,a=Ppt.create(Cpt),c=wpt(i.preload),u=new Tpt(t.repo),f=Rpt({blockService:u,options:i.ipld}),h=Bpt({path:s.path,repoOwner:i.repoOwner}),d=ipt(),y=npt({network:a}),g=new apt(i),m=new cpt({dns:d,ipns:g,ipld:f,peerId:n,isOnline:y,keychain:o,options:i}),x=spt({ipld:f,name:m}),_=new vpt({repo:s,ipld:f}),P=new opt({gcLock:h,pinManager:_,ipld:f}),q=new dpt({blockService:u,preload:c,gcLock:h,pinManager:_,pin:P}),X=new mpt({ipld:f,preload:c,gcLock:h,pin:P}),W=Object.assign(upt({ipld:f,resolve:x,preload:c}),{local:fpt({repo:t.repo})}),{add:z,addAll:Z,cat:ee,get:re,ls:L}=new ppt({gcLock:h,preload:c,pin:P,block:q,ipld:f,options:i.EXPERIMENTAL}),b=Ept({ipld:f,block:q,blockService:u,repo:s,preload:c,options:i}),w=_pt({files:b,preload:c,options:i.preload});this.preload=c,this.name=m,this.ipld=f,this.ipns=g,this.pin=P,this.resolve=x,this.block=q,this.refs=W,this.start=tpt({network:a,peerId:n,repo:s,blockService:u,preload:c,ipns:g,mfsPreload:w,print:e,keychain:o,options:i}),this.stop=rpt({network:a,preload:c,mfsPreload:w,blockService:u,ipns:g,repo:s}),this.dht=Dpt({network:a,repo:s}),this.pubsub=qpt({network:a,config:i.config}),this.dns=d,this.isOnline=y,this.id=gpt({network:a,peerId:n}),this.version=ypt({repo:s}),this.bitswap=new lpt({network:a}),this.bootstrap=new hpt({repo:s}),this.config=bpt({repo:s}),this.ping=Npt({network:a}),this.add=z,this.addAll=Z,this.cat=ee,this.get=re,this.ls=L,this.dag=X,this.files=b,this.key=new Spt({keychain:o}),this.object=new xpt({ipld:f,preload:c,gcLock:h}),this.repo=new Apt({gcLock:h,pin:P,repo:s,refs:W}),this.stats=new Ipt({repo:s,network:a}),this.swarm=new Opt({network:a}),Object.defineProperty(this,"libp2p",{get(){let U=a.try();return U?U.libp2p:void 0}});let R=()=>Promise.reject(w_e(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),B=async function*(){throw w_e(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=R,this.diag={cmds:R,net:R,sys:R},this.log={level:R,ls:R,tail:B},this.mount=R}async init(){throw new Zdt}static async create(e={}){e=Wdt(Lpt(),e);let t=e.init||{},i=e.silent?rP:console.log,n=await kpt.start(i,e),s=await n.repo.config.getAll(),o=new F3({storage:n,print:i,options:{...e,config:s}});if(await o.preload.start(),o.ipns.startOffline(n),n.isNew&&!t.emptyRepo){let a=await Mpt(o);rP("adding default assets"),await Qdt({addAll:o.addAll,print:i}),rP("initializing IPNS keyspace"),await o.ipns.initializeKeyspace(n.peerId.privKey,ept(`/ipfs/${a}`))}return e.start!==!1&&await o.start(),o}};v_e.exports=F3;var Mpt=async r=>{let e=new Xdt(new Jdt({type:"directory"}).marshal()),t=await r.dag.put(e,{version:0,format:"dag-pb",hashAlg:"sha2-256",preload:!1});return await r.pin.add(t),t},Lpt=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!Ydt,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}})});var x_e=p((L8t,E_e)=>{l();"use strict";var Fpt=kP(),Upt=hO(),Kpt=dt(),jpt=za(),Vpt=ll(),{multiaddr:zpt}=lr(),Hpt=en(),Gpt=$r(),S_e=er(),$pt=S_e.multihash,Wpt=Qe(),{create:Ypt}=__e();E_e.exports={create:Ypt,crypto:jpt,isIPFS:Vpt,CID:Wpt,multiaddr:zpt,multibase:Hpt,multihash:$pt,multihashing:S_e,multicodec:Gpt,PeerId:Kpt,globSource:Fpt,urlSource:Upt}});var Xpt=p((F8t,A_e)=>{l();"use strict";A_e.exports={...x_e()}});return Xpt();})();
/*!
  * prr
  * (c) 2013 Rod Vagg <rod@vagg.org>
  * https://github.com/rvagg/prr
  * License: MIT
  */
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */
//! stable.js 0.1.8, https://github.com/Two-Screen/stable
//!  2018 Angry Bytes and contributors. MIT licensed.
return Ipfs}));
