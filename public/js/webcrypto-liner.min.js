var liner=function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=25)}([function(e,r,t){"use strict";t.d(r,"a",function(){return o});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function o(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}},function(e,r,t){"use strict";t.r(r),function(e){t.d(r,"WebCryptoError",function(){return o}),t.d(r,"AlgorithmError",function(){return a}),t.d(r,"CryptoKeyError",function(){return i}),t.d(r,"PrepareAlgorithm",function(){return s}),t.d(r,"PrepareData",function(){return c}),t.d(r,"BaseCrypto",function(){return u}),t.d(r,"AlgorithmNames",function(){return p}),t.d(r,"Base64Url",function(){return f}),t.d(r,"SubtleCrypto",function(){return F}),t.d(r,"Aes",function(){return y}),t.d(r,"AesAlgorithmError",function(){return m}),t.d(r,"AesWrapKey",function(){return w}),t.d(r,"AesEncrypt",function(){return A}),t.d(r,"AesECB",function(){return g}),t.d(r,"AesCBC",function(){return v}),t.d(r,"AesCTR",function(){return C}),t.d(r,"AesGCM",function(){return d}),t.d(r,"AesKW",function(){return b}),t.d(r,"RsaKeyGenParamsError",function(){return M}),t.d(r,"RsaHashedImportParamsError",function(){return T}),t.d(r,"Rsa",function(){return x}),t.d(r,"RsaSSA",function(){return j}),t.d(r,"RsaPSSParamsError",function(){return W}),t.d(r,"RsaPSS",function(){return H}),t.d(r,"RsaOAEPParamsError",function(){return I}),t.d(r,"RsaOAEP",function(){return Y}),t.d(r,"EcKeyGenParamsError",function(){return S}),t.d(r,"Ec",function(){return L}),t.d(r,"EcAlgorithmError",function(){return O}),t.d(r,"EdDSA",function(){return K}),t.d(r,"EcDSA",function(){return N}),t.d(r,"EcDH",function(){return R}),t.d(r,"ShaAlgorithms",function(){return P}),t.d(r,"Sha",function(){return U});var n=t(0);var o=function(e){function r(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=e.call(this)||this;o.code=0,o.message=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n,o=e,a=/[^%](%\d+)/g,i=[];n=a.exec(o);)i.push({arg:n[1],index:n.index});for(var s=i.length-1;s>=0;s--){var c=i[s],u=c.arg.substring(1),p=c.index+1;o=o.substring(0,p)+arguments[+u]+o.substring(p+1+u.length)}return o=o.replace("%%","%")}.apply(void 0,[r].concat(t));var a=new Error(o.message);return a.name=o.constructor.name,o.stack=a.stack,o}return Object(n.a)(r,e),r.NOT_SUPPORTED="Method is not supported",r}(Error),a=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=1,r}return Object(n.a)(r,e),r.PARAM_REQUIRED="Algorithm hasn't got required paramter '%1'",r.PARAM_WRONG_TYPE="Algorithm has got wrong type for paramter '%1'. Must be %2",r.PARAM_WRONG_VALUE="Algorithm has got wrong value for paramter '%1'. Must be %2",r.WRONG_ALG_NAME="Algorithm has got wrong name '%1'. Must be '%2'",r.UNSUPPORTED_ALGORITHM="Algorithm '%1' is not supported",r.WRONG_USAGE="Algorithm doesn't support key usage '%1'",r}(o),i=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=3,r}return Object(n.a)(r,e),r.EMPTY_KEY="CryptoKey is empty",r.WRONG_KEY_ALG="CryptoKey has wrong algorithm '%1'. Must be '%2'",r.WRONG_KEY_TYPE="CryptoKey has wrong type '%1'. Must be '%2'",r.WRONG_KEY_USAGE="CryptoKey has wrong key usage. Must be '%1'",r.NOT_EXTRACTABLE="CryptoKey is not extractable",r.WRONG_FORMAT="CryptoKey has '%1' type. It can be used with '%2' format",r.UNKNOWN_FORMAT="Unknown format in use '%1'. Must be one of 'raw', 'pkcs8', 'spki'  or 'jwk'",r.ALLOWED_FORMAT="Wrong format value '%1'. Must be %2",r}(o);function s(e){var r;r="string"==typeof e?{name:e}:e,u.checkAlgorithm(r);var t=e;return t.hash&&(t.hash=s(t.hash)),r}function c(e,r){if(!e)throw new o("Parameter '"+r+"' is required and cant be empty");if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))return new Uint8Array(e);if(ArrayBuffer.isView(e)){var t=e.map(function(e){return e});return new Uint8Array(t.buffer)}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new o("Incoming parameter '"+r+"' has wrong data type. Must be ArrayBufferView or ArrayBuffer")}var u=function(){function e(){}return e.checkAlgorithm=function(e){if("object"!=typeof e)throw new TypeError("Wrong algorithm data type. Must be Object");if(!e.name)throw new a(a.PARAM_REQUIRED,"name")},e.checkAlgorithmParams=function(e){this.checkAlgorithm(e)},e.checkKey=function(e,r,t,n){if(void 0===t&&(t=null),void 0===n&&(n=null),!e)throw new i(i.EMPTY_KEY);var o=e.algorithm;if(this.checkAlgorithm(o),r&&o.name.toUpperCase()!==r.toUpperCase())throw new i(i.WRONG_KEY_ALG,o.name,r);if(t&&(!e.type||e.type.toUpperCase()!==t.toUpperCase()))throw new i(i.WRONG_KEY_TYPE,e.type,t);if(n&&!e.usages.some(function(e){return n.toUpperCase()===e.toUpperCase()}))throw new i(i.WRONG_KEY_USAGE,n)},e.checkWrappedKey=function(e){if(!e.extractable)throw new i(i.NOT_EXTRACTABLE)},e.checkKeyUsages=function(e){if(!e||!e.length)throw new o("Parameter 'keyUsages' cannot be empty.")},e.checkFormat=function(e,r){switch(e.toLowerCase()){case"raw":if(r&&"secret"!==r.toLowerCase()&&r&&"public"!==r.toLowerCase())throw new i(i.WRONG_FORMAT,r,"raw");break;case"pkcs8":if(r&&"private"!==r.toLowerCase())throw new i(i.WRONG_FORMAT,r,"pkcs8");break;case"spki":if(r&&"public"!==r.toLowerCase())throw new i(i.WRONG_FORMAT,r,"spki");break;case"jwk":break;default:throw new i(i.UNKNOWN_FORMAT,e)}},e.generateKey=function(e,r,t){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.digest=function(e,r){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.sign=function(e,r,t){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.verify=function(e,r,t,n){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.encrypt=function(e,r,t){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.decrypt=function(e,r,t){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.deriveBits=function(e,r,t){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.deriveKey=function(e,r,t,n,a){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.exportKey=function(e,r){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.importKey=function(e,r,t,n,a){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.wrapKey=function(e,r,t,n){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e.unwrapKey=function(e,r,t,n,a,i,s){return new Promise(function(e,r){throw new o(o.NOT_SUPPORTED)})},e}(),p={RsaSSA:"RSASSA-PKCS1-v1_5",RsaPSS:"RSA-PSS",RsaOAEP:"RSA-OAEP",AesECB:"AES-ECB",AesCTR:"AES-CTR",AesCMAC:"AES-CMAC",AesGCM:"AES-GCM",AesCBC:"AES-CBC",AesKW:"AES-KW",Sha1:"SHA-1",Sha256:"SHA-256",Sha384:"SHA-384",Sha512:"SHA-512",ChaCha20:"CHACHA20",EcDSA:"ECDSA",EdDSA:"EDDSA",EcDH:"ECDH",Hmac:"HMAC",Poly1305:"POLY1305",Pbkdf2:"PBKDF2",DesCBC:"DES-CBC",DesEdeCBC:"DES-EDE3-CBC"};if("undefined"==typeof self){var h=e;h.btoa=function(e){return new Buffer(e,"binary").toString("base64")},h.atob=function(e){return new Buffer(e,"base64").toString("binary")}}var f=function(){function e(){}return e.encode=function(e){var r=this.buffer2string(e);return btoa(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.decode=function(e){for(;e.length%4;)e+="=";var r=e.replace(/\-/g,"+").replace(/_/g,"/");return this.string2buffer(atob(r))},e.buffer2string=function(e){for(var r="",t=e.length,n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r},e.string2buffer=function(e){for(var r=new Uint8Array(e.length),t=e.length,n=0;n<t;n++)r[n]=e.charCodeAt(n);return r},e}(),l=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=7,r}return Object(n.a)(r,e),r}(a),y=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkKeyUsages=function(r){var t=this;e.checkKeyUsages.call(this,r);var n=r.filter(function(e){return-1===t.KEY_USAGES.indexOf(e)});if(n.length)throw new a(a.WRONG_USAGE,n.join(", "))},r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new a(a.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){switch(e.length){case 128:case 192:case 256:break;default:throw new l(l.PARAM_WRONG_VALUE,"length","128, 192 or 256")}},r.generateKey=function(e,r,t){var n=this;return new Promise(function(r,o){n.checkAlgorithm(e),n.checkKeyGenParams(e),n.checkKeyUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r,n){if(a.checkAlgorithm(t),a.checkFormat(e),"raw"!==e.toLowerCase()&&"jwk"!==e.toLowerCase())throw new i(i.ALLOWED_FORMAT,e,"'jwk' or 'raw'");a.checkKeyUsages(o),r(void 0)})},r.ALG_NAME="",r.KEY_USAGES=[],r}(u),m=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=8,r}return Object(n.a)(r,e),r}(a),w=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.wrapKey=function(e,r,t,n){var o=this;return new Promise(function(a,i){o.checkAlgorithmParams(n),o.checkKey(t,o.ALG_NAME,"secret","wrapKey"),o.checkWrappedKey(r),o.checkFormat(e,r.type),a(void 0)})},r.unwrapKey=function(e,r,t,n,o,a,i){var s=this;return new Promise(function(r,o){s.checkAlgorithmParams(n),s.checkKey(t,s.ALG_NAME,"secret","unwrapKey"),s.checkFormat(e),r(void 0)})},r}(y),A=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.encrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","encrypt"),t(void 0)})},r.decrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","decrypt"),t(void 0)})},r.KEY_USAGES=["encrypt","decrypt","wrapKey","unwrapKey"],r}(w),g=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.ALG_NAME=p.AesECB,r}(A),v=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),!e.iv)throw new m(m.PARAM_REQUIRED,"iv");if(!(ArrayBuffer.isView(e.iv)||e.iv instanceof ArrayBuffer))throw new m(m.PARAM_WRONG_TYPE,"iv","ArrayBufferView or ArrayBuffer");if(16!==e.iv.byteLength)throw new m(m.PARAM_WRONG_VALUE,"iv","ArrayBufferView or ArrayBuffer with size 16")},r.ALG_NAME=p.AesCBC,r}(A),C=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),!e.counter||!(ArrayBuffer.isView(e.counter)||e.counter instanceof ArrayBuffer))throw new m(m.PARAM_WRONG_TYPE,"counter","ArrayBufferView or ArrayBuffer");if(16!==e.counter.byteLength)throw new m(m.PARAM_WRONG_VALUE,"counter","ArrayBufferView or ArrayBuffer with size 16");if(!(e.length>0&&e.length<=128))throw new m(m.PARAM_WRONG_VALUE,"length","number [1-128]")},r.ALG_NAME=p.AesCTR,r}(A),d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),e.additionalData&&!(ArrayBuffer.isView(e.additionalData)||e.additionalData instanceof ArrayBuffer))throw new m(m.PARAM_WRONG_TYPE,"additionalData","ArrayBufferView or ArrayBuffer");if(!e.iv)throw new m(m.PARAM_REQUIRED,"iv");if(!(ArrayBuffer.isView(e.iv)||e.iv instanceof ArrayBuffer))throw new m(m.PARAM_WRONG_TYPE,"iv","ArrayBufferView or ArrayBuffer");if(e.tagLength&&![32,64,96,104,112,120,128].some(function(r){return r===e.tagLength}))throw new m(m.PARAM_WRONG_VALUE,"tagLength","32, 64, 96, 104, 112, 120 or 128")},r.ALG_NAME=p.AesGCM,r}(A),b=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithmParams=function(e){this.checkAlgorithm(e)},r.ALG_NAME=p.AesKW,r.KEY_USAGES=["wrapKey","unwrapKey"],r}(w),k=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.encrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","encrypt"),t(void 0)})},r.decrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","decrypt"),t(void 0)})},r.checkKey=function(e,r,t,n){if(void 0===t&&(t=null),void 0===n&&(n=null),!e)throw new i(i.EMPTY_KEY);if(t&&(!e.type||e.type.toUpperCase()!==t.toUpperCase()))throw new i(i.WRONG_KEY_TYPE,e.type,t);if(n&&!e.usages.some(function(e){return n.toUpperCase()===e.toUpperCase()}))throw new i(i.WRONG_KEY_USAGE,n)},r.ALG_NAME="ChaCha20",r.KEY_USAGES=["encrypt","decrypt"],r}(u),E=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),!e.iv)throw new a(a.PARAM_REQUIRED,"iv");if(!(ArrayBuffer.isView(e.iv)||e.iv instanceof ArrayBuffer))throw new a(a.PARAM_WRONG_TYPE,"iv","ArrayBufferView or ArrayBuffer");if(8!==e.iv.byteLength)throw new a(a.PARAM_WRONG_VALUE,"iv","ArrayBufferView or ArrayBuffer with size 8")},r.ALG_NAME=p.DesCBC,r}(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkKeyUsages=function(r){var t=this;e.checkKeyUsages.call(this,r);var n=r.filter(function(e){return-1===t.KEY_USAGES.indexOf(e)});if(n.length)throw new a(a.WRONG_USAGE,n.join(", "))},r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new a(a.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){if(!("length"in e))throw new a(a.PARAM_REQUIRED,"length");if("number"!=typeof e.length)throw new a(a.PARAM_WRONG_TYPE,"length","Number");if(e.length!==this.KEY_LENGTH)throw new a(a.PARAM_WRONG_VALUE,"length",""+this.KEY_LENGTH)},r.generateKey=function(e,r,t){var n=this;return new Promise(function(r){n.checkAlgorithm(e),n.checkKeyGenParams(e),n.checkKeyUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r){if(a.checkAlgorithm(t),a.checkFormat(e),"raw"!==e.toLowerCase()&&"jwk"!==e.toLowerCase())throw new i(i.ALLOWED_FORMAT,e,"'jwk' or 'raw'");a.checkKeyUsages(o),r(void 0)})},r.wrapKey=function(e,r,t,n){var o=this;return new Promise(function(a,i){o.checkAlgorithmParams(n),o.checkKey(t,o.ALG_NAME,"secret","wrapKey"),o.checkWrappedKey(r),o.checkFormat(e,r.type),a(void 0)})},r.unwrapKey=function(e,r,t,n,o,a,i){var s=this;return new Promise(function(r,o){s.checkAlgorithmParams(n),s.checkKey(t,s.ALG_NAME,"secret","unwrapKey"),s.checkFormat(e),r(void 0)})},r.encrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","encrypt"),t(void 0)})},r.decrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","decrypt"),t(void 0)})},r.ALG_NAME="",r.KEY_LENGTH=64,r.KEY_USAGES=["encrypt","decrypt","wrapKey","unwrapKey"],r}(u)),_=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.ALG_NAME=p.DesEdeCBC,r.KEY_LENGTH=192,r}(E),P=[p.Sha1,p.Sha256,p.Sha384,p.Sha512].join(" | "),U=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithm=function(r){var t;switch(t="string"==typeof r?{name:r}:r,e.checkAlgorithm.call(this,t),t.name.toUpperCase()){case p.Sha1:case p.Sha256:case p.Sha384:case p.Sha512:break;default:throw new a(a.WRONG_ALG_NAME,t.name,P)}},r.digest=function(e,r){var t=this;return new Promise(function(r,n){t.checkAlgorithm(e),r(void 0)})},r}(u),S=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=9,r}return Object(n.a)(r,e),r}(a),L=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new a(a.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){if(!e.namedCurve)throw new S(S.PARAM_REQUIRED,"namedCurve");if("string"!=typeof e.namedCurve)throw new S(S.PARAM_WRONG_TYPE,"namedCurve","string");switch(e.namedCurve.toUpperCase()){case"P-256":case"K-256":case"P-384":case"P-521":case"X25519":case"ED25519":break;default:throw new S(S.PARAM_WRONG_VALUE,"namedCurve","K-256, P-256, P-384, P-521, X25519 or ED25519")}},r.checkKeyGenUsages=function(e){var r=this;e.forEach(function(e){for(var t=0;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new o("Unsupported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var n=this;return new Promise(function(r,o){n.checkAlgorithm(e),n.checkKeyGenParams(e),n.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),e&&"raw"===e.toLowerCase()&&"public"===r.type||t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r,n){a.checkKeyGenParams(t),a.checkFormat(e),a.checkKeyGenUsages(o),r(void 0)})},r.ALG_NAME="",r.KEY_USAGES=[],r}(u),O=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=10,r}return Object(n.a)(r,e),r}(a),K=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithmParams=function(e){this.checkAlgorithm(e),U.checkAlgorithm(e.hash)},r.sign=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"private","sign"),t(void 0)})},r.verify=function(e,r,t,n){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"public","verify"),t(void 0)})},r.ALG_NAME=p.EdDSA,r.KEY_USAGES=["sign","verify"],r}(L),N=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithmParams=function(e){this.checkAlgorithm(e),U.checkAlgorithm(e.hash)},r.sign=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"private","sign"),t(void 0)})},r.verify=function(e,r,t,n){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"public","verify"),t(void 0)})},r.ALG_NAME=p.EcDSA,r.KEY_USAGES=["sign","verify"],r}(L),R=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkDeriveParams=function(e){if(this.checkAlgorithm(e),!e.public)throw new O(O.PARAM_REQUIRED,"public");this.checkKey(e.public,this.ALG_NAME,"public")},r.deriveBits=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkDeriveParams(e),n.checkKey(r,n.ALG_NAME,"private","deriveBits"),t(void 0)})},r.deriveKey=function(e,r,t,n,o){var a=this;return new Promise(function(n,o){switch(a.checkDeriveParams(e),a.checkKey(r,a.ALG_NAME,"private","deriveKey"),u.checkAlgorithm(t),t.name.toUpperCase()){case p.AesCBC:v.checkKeyGenParams(t);break;case p.AesCTR:C.checkKeyGenParams(t);break;case p.AesGCM:d.checkKeyGenParams(t);break;case p.AesKW:b.checkKeyGenParams(t);break;default:throw new O("Unsupported name '"+t.name+"' for algorithm in param 'derivedKeyType'")}n(void 0)})},r.ALG_NAME=p.EcDH,r.KEY_USAGES=["deriveKey","deriveBits"],r}(L),G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new a(a.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){if("length"in e&&!(e.length>0&&e.length<=512))throw new a(a.PARAM_WRONG_VALUE,"length","more 0 and less than 512")},r.checkKeyGenUsages=function(e){var r=this;this.checkKeyUsages(e),e.forEach(function(e){for(var t=0;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new o("Unsupported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var n=this;return new Promise(function(r,o){n.checkAlgorithm(e),n.checkKeyGenParams(e),n.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r,n){if(a.checkAlgorithm(t),a.checkFormat(e),"raw"!==e.toLowerCase()&&"jwk"!==e.toLowerCase())throw new i(i.ALLOWED_FORMAT,e,"'jwk' or 'raw'");a.checkKeyGenUsages(o),r(void 0)})},r.sign=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","sign"),t(void 0)})},r.verify=function(e,r,t,n){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"secret","verify"),t(void 0)})},r.ALG_NAME=p.Hmac,r.KEY_USAGES=["sign","verify"],r}(u),B=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new a(a.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkDeriveParams=function(e){if(this.checkAlgorithm(e),!e.salt)throw new a(a.PARAM_REQUIRED,"salt");if(!(ArrayBuffer.isView(e.salt)||e.salt instanceof ArrayBuffer))throw new a(a.PARAM_WRONG_TYPE,"salt","ArrayBuffer or ArrayBufferView");if(!e.iterations)throw new a(a.PARAM_REQUIRED,"iterations");if(!e.hash)throw new a(a.PARAM_REQUIRED,"hash");var r=s(e.hash);U.checkAlgorithm(r)},r.importKey=function(e,r,t,n,a){var s=this;return Promise.resolve().then(function(){if(n)throw new o("KDF keys must set extractable=false");if(s.checkAlgorithm(t),s.checkFormat(e),"raw"!==e.toLowerCase())throw new i(i.ALLOWED_FORMAT,e,"'raw'");s.checkKeyUsages(a)})},r.deriveKey=function(e,r,t,n,o){var i=this;return Promise.resolve().then(function(){switch(i.checkDeriveParams(e),i.checkKey(r,i.ALG_NAME,"secret","deriveKey"),u.checkAlgorithm(t),t.name.toUpperCase()){case p.AesCBC:v.checkKeyGenParams(t),v.checkKeyUsages(o);break;case p.AesCTR:C.checkKeyGenParams(t),C.checkKeyUsages(o);break;case p.AesGCM:d.checkKeyGenParams(t),d.checkKeyUsages(o);break;case p.AesKW:b.checkKeyGenParams(t),b.checkKeyUsages(o);break;case p.Hmac:G.checkKeyGenParams(t),G.checkKeyUsages(o);break;case p.DesCBC:E.checkKeyGenParams(t),E.checkKeyUsages(o);break;case p.DesEdeCBC:_.checkKeyGenParams(t),_.checkKeyUsages(o);break;default:throw new a(a.UNSUPPORTED_ALGORITHM,t)}})},r.deriveBits=function(e,r,t){var n=this;return Promise.resolve().then(function(){if(n.checkDeriveParams(e),n.checkKey(r,n.ALG_NAME,"secret","deriveBits"),!t||"number"!=typeof t)throw new o("Parameter 'length' must be Number and more than 0")})},r.ALG_NAME=p.Pbkdf2,r.KEY_USAGES=["deriveKey","deriveBits"],r}(u),D=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkKeyGenUsages=function(e){var r=this;this.checkKeyUsages(e),e.forEach(function(e){for(var t=0;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new o("Unsupported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r,t){if(a.checkFormat(e),"raw"!==e.toLowerCase()&&"jwk"!==e.toLowerCase())throw new i(i.ALLOWED_FORMAT,e,"'jwk' or 'raw'");a.checkKeyGenUsages(o),r(void 0)})},r.sign=function(e,r,t){var n=this;return new Promise(function(e,t){n.checkKey(r,n.ALG_NAME,"secret","sign"),e(void 0)})},r.verify=function(e,r,t,n){var o=this;return new Promise(function(e,t){o.checkKey(r,o.ALG_NAME,"secret","verify"),e(void 0)})},r.checkKey=function(e,r,t,n){if(void 0===t&&(t=null),void 0===n&&(n=null),!e)throw new i(i.EMPTY_KEY);if(t&&(!e.type||e.type.toUpperCase()!==t.toUpperCase()))throw new i(i.WRONG_KEY_TYPE,e.type,t);if(n&&!e.usages.some(function(e){return n.toUpperCase()===e.toUpperCase()}))throw new i(i.WRONG_KEY_USAGE,n)},r.ALG_NAME=p.Poly1305,r.KEY_USAGES=["sign","verify"],r}(u),M=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=2,r}return Object(n.a)(r,e),r}(a),T=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=6,r}return Object(n.a)(r,e),r}(a),x=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new a(a.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkImportAlgorithm=function(e){if(this.checkAlgorithm(e),!e.hash)throw new T(T.PARAM_REQUIRED,"hash");U.checkAlgorithm(e.hash)},r.checkKeyGenParams=function(e){var r=e.modulusLength;if(!(r>=256&&r<=16384)||r%8)throw new M(M.PARAM_WRONG_VALUE,"modulusLength"," a multiple of 8 bits and >= 256 and <= 16384");var t=e.publicExponent;if(!t)throw new M(M.PARAM_REQUIRED,"publicExponent");if(!ArrayBuffer.isView(t))throw new M(M.PARAM_WRONG_TYPE,"publicExponent","ArrayBufferView");if(3!==t[0]&&(1!==t[0]||0!==t[1]||1!==t[2]))throw new M(M.PARAM_WRONG_VALUE,"publicExponent","Uint8Array([3]) | Uint8Array([1, 0, 1])");if(!e.hash)throw new M(M.PARAM_REQUIRED,"hash",P);U.checkAlgorithm(e.hash)},r.checkKeyGenUsages=function(e){var r=this;this.checkKeyUsages(e),e.forEach(function(e){for(var t=0;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new o("Unsupported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var n=this;return new Promise(function(r,o){n.checkAlgorithm(e),n.checkKeyGenParams(e),n.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r,n){if(a.checkImportAlgorithm(t),a.checkFormat(e),"raw"===e.toLowerCase())throw new i(i.ALLOWED_FORMAT,e,"'JsonWebKey', 'pkcs8' or 'spki'");a.checkKeyGenUsages(o),r(void 0)})},r.ALG_NAME="",r.KEY_USAGES=[],r}(u),j=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.sign=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"private","sign"),t(void 0)})},r.verify=function(e,r,t,n){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"public","verify"),t(void 0)})},r.ALG_NAME=p.RsaSSA,r.KEY_USAGES=["sign","verify"],r}(x),W=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=4,r}return Object(n.a)(r,e),r}(a),H=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithmParams=function(r){var t=r;if(e.checkAlgorithmParams.call(this,t),!t.saltLength)throw new W(W.PARAM_REQUIRED,"saltLength");if(t.saltLength<0)throw new W("Parameter 'saltLength' is outside of numeric range")},r.ALG_NAME=p.RsaPSS,r}(j),I=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=5,r}return Object(n.a)(r,e),r}(a),Y=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.a)(r,e),r.checkAlgorithmParams=function(e){if(e.label&&!(ArrayBuffer.isView(e.label)||e.label instanceof ArrayBuffer))throw new I(I.PARAM_WRONG_TYPE,"label","ArrayBufferView or ArrayBuffer")},r.encrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"public","encrypt"),t(void 0)})},r.decrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"private","decrypt"),t(void 0)})},r.wrapKey=function(e,r,t,n){var o=this;return new Promise(function(a,i){o.checkAlgorithmParams(n),o.checkKey(t,o.ALG_NAME,"public","wrapKey"),o.checkWrappedKey(r),o.checkFormat(e,r.type),a(void 0)})},r.unwrapKey=function(e,r,t,n,o,a,i){var s=this;return new Promise(function(r,o){s.checkAlgorithmParams(n),s.checkKey(t,s.ALG_NAME,"private","unwrapKey"),s.checkFormat(e),r(void 0)})},r.ALG_NAME=p.RsaOAEP,r.KEY_USAGES=["encrypt","decrypt","wrapKey","unwrapKey"],r}(x),F=function(){function e(){}return e.prototype.generateKey=function(e,r,t){return new Promise(function(n,o){var i=s(e),c=u;switch(i.name.toUpperCase()){case p.RsaSSA.toUpperCase():c=j;break;case p.RsaOAEP.toUpperCase():c=Y;break;case p.RsaPSS.toUpperCase():c=H;break;case p.AesECB.toUpperCase():c=g;break;case p.AesCBC.toUpperCase():c=v;break;case p.AesCTR.toUpperCase():c=C;break;case p.AesGCM.toUpperCase():c=d;break;case p.AesKW.toUpperCase():c=b;break;case p.EcDSA.toUpperCase():c=N;break;case p.EdDSA.toUpperCase():c=K;break;case p.EcDH.toUpperCase():c=R;break;case p.Hmac.toUpperCase():c=G;break;case p.DesCBC.toUpperCase():c=E;break;case p.DesEdeCBC.toUpperCase():c=_;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,i.name)}c.generateKey(i,r,t).then(n,o)})},e.prototype.digest=function(e,r){return new Promise(function(t,n){var o=s(e),i=c(r,"data"),h=u;switch(o.name.toUpperCase()){case p.Sha1.toUpperCase():case p.Sha256.toUpperCase():case p.Sha384.toUpperCase():case p.Sha512.toUpperCase():h=U;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,o.name)}h.digest(o,i).then(t,n)})},e.prototype.sign=function(e,r,t){return new Promise(function(n,o){var i=s(e),h=c(t,"data"),f=u;switch(i.name.toUpperCase()){case p.RsaSSA.toUpperCase():f=j;break;case p.RsaPSS.toUpperCase():f=H;break;case p.EcDSA.toUpperCase():f=N;break;case p.EdDSA.toUpperCase():f=K;break;case p.Hmac.toUpperCase():f=G;break;case p.Poly1305.toUpperCase():f=D;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,i.name)}f.sign(i,r,h).then(n,o)})},e.prototype.verify=function(e,r,t,n){return new Promise(function(t,o){var i=s(e),h=c(n,"signature"),f=c(n,"data"),l=u;switch(i.name.toUpperCase()){case p.RsaSSA.toUpperCase():l=j;break;case p.RsaPSS.toUpperCase():l=H;break;case p.EcDSA.toUpperCase():l=N;break;case p.EdDSA.toUpperCase():l=K;break;case p.Hmac.toUpperCase():l=G;break;case p.Poly1305.toUpperCase():l=D;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,i.name)}l.verify(i,r,h,f).then(t,o)})},e.prototype.encrypt=function(e,r,t){return new Promise(function(n,o){var i=s(e),h=c(t,"data"),f=u;switch(i.name.toUpperCase()){case p.RsaOAEP.toUpperCase():f=Y;break;case p.AesECB.toUpperCase():f=g;break;case p.AesCBC.toUpperCase():f=v;break;case p.AesCTR.toUpperCase():f=C;break;case p.AesGCM.toUpperCase():f=d;break;case p.ChaCha20.toUpperCase():f=k;break;case p.DesCBC.toUpperCase():f=E;break;case p.DesEdeCBC.toUpperCase():f=_;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,i.name)}f.encrypt(i,r,h).then(n,o)})},e.prototype.decrypt=function(e,r,t){return new Promise(function(n,o){var i=s(e),h=c(t,"data"),f=u;switch(i.name.toUpperCase()){case p.RsaOAEP.toUpperCase():f=Y;break;case p.AesECB.toUpperCase():f=g;break;case p.AesCBC.toUpperCase():f=v;break;case p.AesCTR.toUpperCase():f=C;break;case p.AesGCM.toUpperCase():f=d;break;case p.ChaCha20.toUpperCase():f=k;break;case p.DesCBC.toUpperCase():f=E;break;case p.DesEdeCBC.toUpperCase():f=_;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,i.name)}f.decrypt(i,r,h).then(n,o)})},e.prototype.deriveBits=function(e,r,t){return new Promise(function(n,o){var i=s(e),c=u;switch(i.name.toUpperCase()){case p.EcDH.toUpperCase():c=R;break;case p.Pbkdf2.toUpperCase():c=B;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,i.name)}c.deriveBits(i,r,t).then(n,o)})},e.prototype.deriveKey=function(e,r,t,n,o){return new Promise(function(i,c){var h=s(e),f=s(t),l=u;switch(h.name.toUpperCase()){case p.EcDH.toUpperCase():l=R;break;case p.Pbkdf2.toUpperCase():l=B;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,h.name)}l.deriveKey(h,r,f,n,o).then(i,c)})},e.prototype.exportKey=function(e,r){return new Promise(function(t,n){if(u.checkKey(r),!r.extractable)throw new i(i.NOT_EXTRACTABLE);var o=u;switch(r.algorithm.name.toUpperCase()){case p.RsaSSA.toUpperCase():o=j;break;case p.RsaPSS.toUpperCase():o=H;break;case p.AesECB.toUpperCase():o=g;break;case p.RsaOAEP.toUpperCase():o=Y;break;case p.AesCBC.toUpperCase():o=v;break;case p.AesCTR.toUpperCase():o=C;break;case p.AesGCM.toUpperCase():o=d;break;case p.AesKW.toUpperCase():o=b;break;case p.EcDSA.toUpperCase():o=N;break;case p.EdDSA.toUpperCase():o=K;break;case p.EcDH.toUpperCase():o=R;break;case p.Hmac.toUpperCase():o=G;break;case p.Poly1305.toUpperCase():o=D;break;case p.DesCBC.toUpperCase():o=E;break;case p.DesEdeCBC.toUpperCase():o=_;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,r.algorithm.name)}o.exportKey(e,r).then(t,n)})},e.prototype.importKey=function(e,r,t,n,o){return new Promise(function(i,c){var h=s(t),f=u;switch(h.name.toUpperCase()){case p.RsaSSA.toUpperCase():f=j;break;case p.RsaPSS.toUpperCase():f=H;break;case p.RsaOAEP.toUpperCase():f=Y;break;case p.AesECB.toUpperCase():f=g;break;case p.AesCBC.toUpperCase():f=v;break;case p.AesCTR.toUpperCase():f=C;break;case p.AesGCM.toUpperCase():f=d;break;case p.AesKW.toUpperCase():f=b;break;case p.EcDSA.toUpperCase():f=N;break;case p.EdDSA.toUpperCase():f=K;break;case p.EcDH.toUpperCase():f=R;break;case p.Hmac.toUpperCase():f=G;break;case p.Pbkdf2.toUpperCase():f=B;break;case p.Poly1305.toUpperCase():f=D;break;case p.DesCBC.toUpperCase():f=E;break;case p.DesEdeCBC.toUpperCase():f=_;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,h.name)}f.importKey(e,r,h,n,o).then(i,c)})},e.prototype.wrapKey=function(e,r,t,n){return new Promise(function(o,i){var c=s(n),h=u;switch(c.name.toUpperCase()){case p.RsaOAEP.toUpperCase():h=Y;break;case p.AesECB.toUpperCase():h=g;break;case p.AesCBC.toUpperCase():h=v;break;case p.AesCTR.toUpperCase():h=C;break;case p.AesGCM.toUpperCase():h=d;break;case p.AesKW.toUpperCase():h=b;break;case p.DesCBC.toUpperCase():h=E;break;case p.DesEdeCBC.toUpperCase():h=_;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,c.name)}h.wrapKey(e,r,t,c).then(o,i)})},e.prototype.unwrapKey=function(e,r,t,n,o,i,h){return new Promise(function(f,l){var y=s(n),m=s(o),w=c(r,"wrappedKey"),A=u;switch(y.name.toUpperCase()){case p.RsaOAEP.toUpperCase():A=Y;break;case p.AesECB.toUpperCase():A=g;break;case p.AesCBC.toUpperCase():A=v;break;case p.AesCTR.toUpperCase():A=C;break;case p.AesGCM.toUpperCase():A=d;break;case p.AesKW.toUpperCase():A=b;break;case p.DesCBC.toUpperCase():A=E;break;case p.DesEdeCBC.toUpperCase():A=_;break;default:throw new a(a.UNSUPPORTED_ALGORITHM,y.name)}A.unwrapKey(e,w,t,y,m,i,h).then(f,l)})},e}()}.call(this,t(13))},function(e,r,t){"use strict";var n,o=this&&this.__extends||(n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)});Object.defineProperty(r,"__esModule",{value:!0});var a=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=10,r}return o(r,e),r.MODULE_NOT_FOUND="Module '%1' is not found. Download it from %2",r.UNSUPPORTED_ALGORITHM="Unsupported algorithm '%1'",r}(t(1).WebCryptoError);r.LinerError=a},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(15),o=t(4),a=function(){function e(){this.subtle=new n.SubtleCrypto}return e.prototype.getRandomValues=function(e){return o.nativeCrypto.getRandomValues(e)},e}();r.Crypto=a},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=t(2);if("undefined"==typeof self){var a=t(14);n={crypto:{subtle:{},getRandomValues:function(e){var r=e.buffer,t=new Uint8Array(r);return a.randomBytes(t.length).forEach(function(e,r){return t[r]=e}),e}}}}else n=self;r.nativeCrypto=n.msCrypto||n.crypto||{},r.nativeSubtle=null;try{r.nativeSubtle=r.nativeCrypto.subtle||r.nativeCrypto.webkitSubtle}catch(e){}function i(e,r){var t=e[r];e[r]=function(){var n=arguments;return new Promise(function(o,a){var i=t.apply(e,n);i.oncomplete=function(e){o(e.target.result)},i.onerror=function(e){a("Error on running '"+r+"' function")}})}}if(n.msCrypto){if(!n.Promise)throw new o.LinerError(o.LinerError.MODULE_NOT_FOUND,"Promise","https://www.promisejs.org");i(r.nativeSubtle,"generateKey"),i(r.nativeSubtle,"digest"),i(r.nativeSubtle,"sign"),i(r.nativeSubtle,"verify"),i(r.nativeSubtle,"encrypt"),i(r.nativeSubtle,"decrypt"),i(r.nativeSubtle,"importKey"),i(r.nativeSubtle,"exportKey"),i(r.nativeSubtle,"wrapKey"),i(r.nativeSubtle,"unwrapKey"),i(r.nativeSubtle,"deriveKey"),i(r.nativeSubtle,"deriveBits")}Math.imul||(Math.imul=function(e,r){var t=65535&e,n=65535&r;return t*n+((e>>>16&65535)*n+t*(r>>>16&65535)<<16>>>0)|0})},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Browser={IE:"Internet Explorer",Safari:"Safari",Edge:"Edge",Chrome:"Chrome",Firefox:"Firefox Mozilla",Mobile:"Mobile"},r.BrowserInfo=function(){var e,t={name:"Unknown",version:"0"},n=self.navigator.userAgent;return(e=/edge\/([\d\.]+)/i.exec(n))?(t.name=r.Browser.Edge,t.version=e[1]):/msie/i.test(n)?(t.name=r.Browser.IE,t.version=/msie ([\d\.]+)/i.exec(n)[1]):/Trident/i.test(n)?(t.name=r.Browser.IE,t.version=/rv:([\d\.]+)/i.exec(n)[1]):/chrome/i.test(n)?(t.name=r.Browser.Chrome,t.version=/chrome\/([\d\.]+)/i.exec(n)[1]):/firefox/i.test(n)?(t.name=r.Browser.Firefox,t.version=/firefox\/([\d\.]+)/i.exec(n)[1]):/mobile/i.test(n)?(t.name=r.Browser.Mobile,t.version=/mobile\/([\w]+)/i.exec(n)[1]):/safari/i.test(n)&&(t.name=r.Browser.Safari,t.version=/version\/([\d\.]+)/i.exec(n)[1]),t},r.string2buffer=function(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r},r.buffer2string=function(e){for(var r="",t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},r.concat=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=new Uint8Array(e.map(function(e){return e.length}).reduce(function(e,r){return e+r})),n=0;return e.forEach(function(e,r){for(var o=0;o<e.length;o++)t[n+o]=e[o];n+=e.length}),t},r.assign=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n=arguments[0],o=1;o<arguments.length;o++){var a=arguments[o];for(var i in a)n[i]=a[i]}return n},r.warn=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];"undefined"!=typeof self&&self.PV_WEBCRYPTO_LINER_LOG&&console.warn.apply(console,arguments)}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e){this.algorithm=e.algorithm,e.type&&(this.type=e.type),this.extractable=e.extractable,this.usages=e.usages}return e.prototype.copy=function(r){var t=new e({algorithm:this.algorithm,type:this.type,extractable:this.extractable,usages:r});return t.key=this.key,t},e}();r.CryptoKey=n},function(e,r){function t(e,r){if(!e)throw new Error(r||"Assertion failed")}e.exports=t,t.equal=function(e,r,t){if(e!=r)throw new Error(t||"Assertion failed: "+e+" != "+r)}},function(e,r,t){"use strict";r.utils=t(20),r.Cipher=t(21),r.DES=t(22),r.CBC=t(23),r.EDE=t(24)},function(e,r){"function"==typeof Object.create?e.exports=function(e,r){e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,r){e.super_=r;var t=function(){};t.prototype=r.prototype,e.prototype=new t,e.prototype.constructor=e}},function(e,r,t){"use strict";var n,o=this&&this.__extends||(n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}),a=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new t(function(r){r(e.value)}).then(i,s)}c((n=n.apply(e,r||[])).next())})},i=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(r,"__esModule",{value:!0});var s=t(1),c=t(2),u=t(6),p=t(5),h=t(4),f=t(3),l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.generateKey=function(e,r,t){var n=this;return Promise.resolve().then(function(){n.checkModule();var o=h.nativeCrypto.getRandomValues(new Uint8Array(e.length/8)),a=new u.CryptoKey({type:"secret",algorithm:e,extractable:r,usages:t});return a.key=o,a})},r.encrypt=function(e,r,t){return Promise.resolve().then(function(){var n;switch(e.name.toUpperCase()){case s.AlgorithmNames.AesECB:var o=e;n=asmCrypto.AES_ECB.encrypt(t,r.key,!!o.padding);break;case s.AlgorithmNames.AesCBC:var a=e;n=asmCrypto.AES_CBC.encrypt(t,r.key,void 0,s.PrepareData(a.iv,"iv"));break;case s.AlgorithmNames.AesGCM:var i=e;i.tagLength=i.tagLength||128;var u=void 0;i.additionalData&&(u=s.PrepareData(i.additionalData,"additionalData")),n=asmCrypto.AES_GCM.encrypt(t,r.key,i.iv,u,i.tagLength/8);break;default:throw new c.LinerError(s.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}return n.buffer})},r.decrypt=function(e,r,t){return Promise.resolve().then(function(){var n;switch(e.name.toUpperCase()){case s.AlgorithmNames.AesECB:var o=e;n=asmCrypto.AES_ECB.decrypt(t,r.key,!!o.padding);break;case s.AlgorithmNames.AesCBC:var a=e;n=asmCrypto.AES_CBC.decrypt(t,r.key,void 0,s.PrepareData(a.iv,"iv"));break;case s.AlgorithmNames.AesGCM:var i=e;i.tagLength=i.tagLength||128;var u=void 0;i.additionalData&&(u=s.PrepareData(i.additionalData,"additionalData")),n=asmCrypto.AES_GCM.decrypt(t,r.key,i.iv,u,i.tagLength/8);break;default:throw new c.LinerError(s.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}return n.buffer})},r.wrapKey=function(e,r,t,n){var o;return Promise.resolve().then(function(){return(o=new f.Crypto).subtle.exportKey(e,r)}).then(function(e){var r;r=e instanceof ArrayBuffer?new Uint8Array(e):p.string2buffer(JSON.stringify(e));var a=t.copy(["encrypt"]);return o.subtle.encrypt(n,a,r)})},r.unwrapKey=function(e,r,t,n,o,a,i){var s;return Promise.resolve().then(function(){s=new f.Crypto;var e=t.copy(["decrypt"]);return s.subtle.decrypt(n,e,r)}).then(function(r){var t;return t="jwk"===e.toLowerCase()?JSON.parse(p.buffer2string(new Uint8Array(r))):new Uint8Array(r),s.subtle.importKey(e,t,o,a,i)})},r.alg2jwk=function(e){return"A"+e.length+/-(\w+)/i.exec(e.name.toUpperCase())[1]},r.jwk2alg=function(e){throw new Error("Not implemented")},r.exportKey=function(e,r){var t=this;return Promise.resolve().then(function(){var n=r.key;return"jwk"===e.toLowerCase()?{alg:t.alg2jwk(r.algorithm),ext:r.extractable,k:s.Base64Url.encode(n),key_ops:r.usages,kty:"oct"}:n.buffer})},r.importKey=function(e,r,t,n,o){return a(this,void 0,void 0,function(){var a,c,p;return i(this,function(i){return"jwk"===e.toLowerCase()?(c=r,a=s.Base64Url.decode(c.k)):a=new Uint8Array(r),(p=new u.CryptoKey({type:"secret",algorithm:t,extractable:n,usages:o})).key=a,[2,p]})})},r.checkModule=function(){if("undefined"==typeof asmCrypto)throw new c.LinerError(c.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js")},r}(s.BaseCrypto);r.AesCrypto=l},function(e,r,t){"use strict";var n,o=this&&this.__extends||(n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}),a=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new t(function(r){r(e.value)}).then(i,s)}c((n=n.apply(e,r||[])).next())})},i=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(r,"__esModule",{value:!0});var s=t(1),c=t(2),u=t(6),p=t(5),h=t(4),f=t(3),l=t(8),y=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.generateKey=function(e,r,t){return Promise.resolve().then(function(){var n=h.nativeCrypto.getRandomValues(new Uint8Array(e.length>>3)),o=new u.CryptoKey({type:"secret",algorithm:e,extractable:r,usages:t});return o.key=n,o})},r.encrypt=function(e,r,t){return a(this,void 0,void 0,function(){var n,o,a;return i(this,function(i){switch(o=s.PrepareData(e.iv,"iv"),e.name.toUpperCase()){case s.AlgorithmNames.DesCBC.toUpperCase():n=l.CBC.instantiate(l.DES).create({key:r.key,type:"encrypt",iv:o});break;case s.AlgorithmNames.DesEdeCBC.toUpperCase():n=l.CBC.instantiate(l.EDE).create({key:r.key,type:"encrypt",iv:o});break;default:throw new c.LinerError(s.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}return a=n.update(t).concat(n.final()),[2,new Uint8Array(a).buffer]})})},r.decrypt=function(e,r,t){return a(this,void 0,void 0,function(){var n,o,a;return i(this,function(i){switch(o=s.PrepareData(e.iv,"iv"),e.name.toUpperCase()){case s.AlgorithmNames.DesCBC.toUpperCase():n=l.CBC.instantiate(l.DES).create({key:r.key,type:"decrypt",iv:o});break;case s.AlgorithmNames.DesEdeCBC.toUpperCase():n=l.CBC.instantiate(l.EDE).create({key:r.key,type:"decrypt",iv:o});break;default:throw new c.LinerError(s.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}return a=n.update(t).concat(n.final()),[2,new Uint8Array(a).buffer]})})},r.wrapKey=function(e,r,t,n){return a(this,void 0,void 0,function(){var o,a;return i(this,function(i){switch(i.label){case 0:return[4,(new f.Crypto).subtle.exportKey(e,r)];case 1:return o=i.sent(),a=o instanceof ArrayBuffer?new Uint8Array(o):p.string2buffer(JSON.stringify(o)),[2,this.encrypt(n,t,a)]}})})},r.unwrapKey=function(e,r,t,n,o,s,c){return a(this,void 0,void 0,function(){var a,u,h,l;return i(this,function(i){switch(i.label){case 0:return a=new f.Crypto,u=t.copy(["decrypt"]),[4,a.subtle.decrypt(n,u,r)];case 1:return h=i.sent(),l="jwk"===e.toLowerCase()?JSON.parse(p.buffer2string(new Uint8Array(h))):new Uint8Array(h),[2,this.importKey(e,l,o,s,c)]}})})},r.alg2jwk=function(e){return"D"+e.length+/-(\w+)/i.exec(e.name.toUpperCase())[1]},r.jwk2alg=function(e){throw new Error("Not implemented")},r.exportKey=function(e,r){var t=this;return Promise.resolve().then(function(){var n=r.key;return"jwk"===e.toLowerCase()?{alg:t.alg2jwk(r.algorithm),ext:r.extractable,k:s.Base64Url.encode(n),key_ops:r.usages,kty:"oct"}:n.buffer})},r.importKey=function(e,r,t,n,o){return a(this,void 0,void 0,function(){var a,c,p;return i(this,function(i){return"jwk"===e.toLowerCase()?(c=r,a=s.Base64Url.decode(c.k)):a=new Uint8Array(r),(p=new u.CryptoKey({type:"secret",algorithm:t,extractable:n,usages:o})).key=a,[2,p]})})},r}(s.BaseCrypto);r.DesCrypto=y},function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),n(t(4)),n(t(3))},function(e,r){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,r){e.exports=require("crypto")},function(e,r,t){"use strict";var n,o=this&&this.__extends||(n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}),a=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new t(function(r){r(e.value)}).then(i,s)}c((n=n.apply(e,r||[])).next())})},i=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(r,"__esModule",{value:!0});var s=t(1),c=t(1),u=t(1),p=t(4),h=t(3),f=t(2),l=t(5),y=t(10),m=t(16),w=t(17),A=t(18),g=t(19),v=t(11),C=[];function d(e,r){return Promise.resolve().then(function(){if(e.key)return e;if(e.extractable)return(new h.Crypto).subtle.exportKey("jwk",e).then(function(t){var n=E(e);return n&&(n=l.assign(n,e.algorithm)),r.importKey("jwk",t,n,!0,e.usages)});throw new f.LinerError("'key' is Native CryptoKey. It can't be converted to JS CryptoKey")})}var b=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.prototype.generateKey=function(r,t,n){var o,a=this,i=arguments;return e.prototype.generateKey.apply(this,i).then(function(e){if(o=u.PrepareAlgorithm(r),!(l.BrowserInfo().name===l.Browser.Edge&&o.name.toUpperCase()===s.AlgorithmNames.AesGCM||P(o.name))&&p.nativeSubtle)try{return p.nativeSubtle.generateKey.apply(p.nativeSubtle,i).catch(function(e){l.warn("WebCrypto: native generateKey for "+o.name+" doesn't work.",e&&e.message||"Unknown message")})}catch(e){l.warn("WebCrypto: native generateKey for "+o.name+" doesn't work.",e&&e.message||"Unknown message")}}).then(function(e){if(e){var i=Promise.resolve(e);if(l.BrowserInfo().name===l.Browser.Safari&&(o.name.toUpperCase()===s.AlgorithmNames.EcDH.toUpperCase()||o.name.toUpperCase()===s.AlgorithmNames.EcDSA.toUpperCase())){var c=e.publicKey;i=i.then(function(){return a.exportKey("jwk",c).then(function(o){return a.exportKey("spki",c).then(function(i){for(var c=s.Base64Url.decode(o.x),u=s.Base64Url.decode(o.y),p=c.length+u.length,h=new Uint8Array(i),f=0;f<p;f++){if(h[h.length-f-1]!==(f<u.length?u[u.length-f-1]:c[c.length+u.length-f-1]))return l.warn("WebCrypto: EC key has wrong public key JWK. Key pair will be recreated"),a.generateKey(r,t,n)}return e})})})}return i.then(function(e){return _(e,n),k(o,e),e})}var u;switch(o.name.toLowerCase()){case s.AlgorithmNames.AesECB.toLowerCase():case s.AlgorithmNames.AesCBC.toLowerCase():case s.AlgorithmNames.AesGCM.toLowerCase():u=y.AesCrypto;break;case s.AlgorithmNames.EcDSA.toLowerCase():case s.AlgorithmNames.EcDH.toLowerCase():u=A.EcCrypto;break;case s.AlgorithmNames.RsaOAEP.toLowerCase():case s.AlgorithmNames.RsaPSS.toLowerCase():case s.AlgorithmNames.RsaSSA.toLowerCase():u=w.RsaCrypto;break;case s.AlgorithmNames.DesCBC.toLowerCase():case s.AlgorithmNames.DesEdeCBC.toLowerCase():u=v.DesCrypto;break;default:throw new f.LinerError(f.LinerError.UNSUPPORTED_ALGORITHM,o.name.toLowerCase())}return u.generateKey(o,t,n)})},r.prototype.digest=function(r,t){var n,o,a=arguments;return e.prototype.digest.apply(this,a).then(function(e){if(n=u.PrepareAlgorithm(r),o=u.PrepareData(t,"data"),p.nativeSubtle)try{return p.nativeSubtle.digest.apply(p.nativeSubtle,a).catch(function(e){l.warn("WebCrypto: native digest for "+n.name+" doesn't work.",e&&e.message||"Unknown message")})}catch(e){l.warn("WebCrypto: native digest for "+n.name+" doesn't work.",e&&e.message||"Unknown message")}}).then(function(e){return e||m.ShaCrypto.digest(n,o)})},r.prototype.sign=function(r,t,n){var o,a,i=arguments;return e.prototype.sign.apply(this,i).then(function(e){o=u.PrepareAlgorithm(r),a=u.PrepareData(n,"data");var s=E(t);if(s&&(i[0]=l.assign(o,s)),p.nativeSubtle)try{return p.nativeSubtle.sign.apply(p.nativeSubtle,i).catch(function(e){l.warn("WebCrypto: native sign for "+o.name+" doesn't work.",e&&e.message||"Unknown message")})}catch(e){l.warn("WebCrypto: native sign for "+o.name+" doesn't work.",e&&e.message||"Unknown message")}}).then(function(e){if(e)return e;var r;switch(o.name.toLowerCase()){case s.AlgorithmNames.EcDSA.toLowerCase():case s.AlgorithmNames.EdDSA.toLowerCase():r=A.EcCrypto;break;case s.AlgorithmNames.RsaSSA.toLowerCase():case s.AlgorithmNames.RsaPSS.toLowerCase():r=w.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.UNSUPPORTED_ALGORITHM,o.name.toLowerCase())}return d(t,r).then(function(e){return r.sign(o,e,a)})})},r.prototype.verify=function(r,t,n,o){var a,i,c,h=arguments;return e.prototype.verify.apply(this,h).then(function(e){a=u.PrepareAlgorithm(r),i=u.PrepareData(n,"data"),c=u.PrepareData(o,"data");var s=E(t);if(s&&(h[0]=l.assign(a,s)),p.nativeSubtle)try{return p.nativeSubtle.verify.apply(p.nativeSubtle,h).catch(function(e){l.warn("WebCrypto: native verify for "+a.name+" doesn't work.",e&&e.message||"Unknown message")})}catch(e){l.warn("WebCrypto: native verify for "+a.name+" doesn't work.",e&&e.message||"Unknown message")}}).then(function(e){if("boolean"==typeof e)return e;var r;switch(a.name.toLowerCase()){case s.AlgorithmNames.EcDSA.toLowerCase():case s.AlgorithmNames.EdDSA.toLowerCase():r=A.EcCrypto;break;case s.AlgorithmNames.RsaSSA.toLowerCase():case s.AlgorithmNames.RsaPSS.toLowerCase():r=w.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.UNSUPPORTED_ALGORITHM,a.name.toLowerCase())}return d(t,r).then(function(e){return r.verify(a,e,i,c)})})},r.prototype.deriveBits=function(r,t,n){var o,a=arguments;return e.prototype.deriveBits.apply(this,a).then(function(e){if(o=u.PrepareAlgorithm(r),p.nativeSubtle)try{return p.nativeSubtle.deriveBits.apply(p.nativeSubtle,a).catch(function(e){l.warn("WebCrypto: native deriveBits for "+o.name+" doesn't work.",e&&e.message||"Unknown message")})}catch(e){l.warn("WebCrypto: native deriveBits for "+o.name+" doesn't work.",e&&e.message||"Unknown message")}}).then(function(e){if(e)return e;var r;switch(o.name.toLowerCase()){case s.AlgorithmNames.EcDH.toLowerCase():r=A.EcCrypto;break;case s.AlgorithmNames.Pbkdf2.toLowerCase():r=g.PbkdfCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"deriveBits")}return r.deriveBits(o,t,n)})},r.prototype.deriveKey=function(r,t,n,o,a){var i,c,h=arguments;return e.prototype.deriveKey.apply(this,h).then(function(e){if(i=u.PrepareAlgorithm(r),c=u.PrepareAlgorithm(n),p.nativeSubtle)try{return p.nativeSubtle.deriveKey.apply(p.nativeSubtle,h).catch(function(e){l.warn("WebCrypto: native deriveKey for "+i.name+" doesn't work.",e&&e.message||"Unknown message")})}catch(e){l.warn("WebCrypto: native deriveKey for "+i.name+" doesn't work.",e&&e.message||"Unknown message")}}).then(function(e){if(e)return _(e,a),e;var r;switch(i.name.toLowerCase()){case s.AlgorithmNames.EcDH.toLowerCase():r=A.EcCrypto;break;case s.AlgorithmNames.Pbkdf2.toLowerCase():r=g.PbkdfCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"deriveBits")}return r.deriveKey(i,t,c,o,a)})},r.prototype.encrypt=function(r,t,n){var o,a,i=arguments;return e.prototype.encrypt.apply(this,i).then(function(e){if(o=u.PrepareAlgorithm(r),a=u.PrepareData(n,"data"),p.nativeSubtle)try{return p.nativeSubtle.encrypt.apply(p.nativeSubtle,i).catch(function(e){l.warn("WebCrypto: native 'encrypt' for "+o.name+" doesn't work.",e&&e.message||"Unknown message")})}catch(e){l.warn("WebCrypto: native 'encrypt' for "+o.name+" doesn't work.",e&&e.message||"Unknown message")}}).then(function(e){if(e){if(l.BrowserInfo().name===l.Browser.IE&&o.name.toUpperCase()===s.AlgorithmNames.AesGCM&&e.ciphertext){var r=new Uint8Array(e.ciphertext.byteLength+e.tag.byteLength),n=0;new Uint8Array(e.ciphertext).forEach(function(e){return r[n++]=e}),new Uint8Array(e.tag).forEach(function(e){return r[n++]=e}),e=r.buffer}return Promise.resolve(e)}var i;switch(o.name.toLowerCase()){case s.AlgorithmNames.AesECB.toLowerCase():case s.AlgorithmNames.AesCBC.toLowerCase():case s.AlgorithmNames.AesGCM.toLowerCase():i=y.AesCrypto;break;case s.AlgorithmNames.RsaOAEP.toLowerCase():i=w.RsaCrypto;break;case s.AlgorithmNames.DesCBC.toLowerCase():case s.AlgorithmNames.DesEdeCBC.toLowerCase():i=v.DesCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"encrypt")}return d(t,i).then(function(e){return i.encrypt(o,e,a)})})},r.prototype.decrypt=function(r,t,n){var o,a,i=arguments;return e.prototype.decrypt.apply(this,i).then(function(e){o=u.PrepareAlgorithm(r);var i=a=u.PrepareData(n,"data");if(l.BrowserInfo().name===l.Browser.IE&&o.name.toUpperCase()===s.AlgorithmNames.AesGCM){var c=a.byteLength-o.tagLength/8;i={ciphertext:a.buffer.slice(0,c),tag:a.buffer.slice(c,a.byteLength)}}if(t.key){var h=void 0;switch(o.name.toLowerCase()){case s.AlgorithmNames.AesECB.toLowerCase():case s.AlgorithmNames.AesCBC.toLowerCase():case s.AlgorithmNames.AesGCM.toLowerCase():h=y.AesCrypto;break;case s.AlgorithmNames.RsaOAEP.toLowerCase():h=w.RsaCrypto;break;case s.AlgorithmNames.DesCBC.toLowerCase():case s.AlgorithmNames.DesEdeCBC.toLowerCase():h=v.DesCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"decrypt")}return h.decrypt(o,t,a)}return p.nativeSubtle.decrypt.call(p.nativeSubtle,o,t,i)})},r.prototype.wrapKey=function(r,t,n,o){var a,i=arguments;return e.prototype.wrapKey.apply(this,i).then(function(e){if(a=u.PrepareAlgorithm(o),p.nativeSubtle)try{return p.nativeSubtle.wrapKey.apply(p.nativeSubtle,i).catch(function(e){l.warn("WebCrypto: native 'wrapKey' for "+a.name+" doesn't work.",e&&e.message||"Unknown message")})}catch(e){l.warn("WebCrypto: native 'wrapKey' for "+a.name+" doesn't work.",e&&e.message||"Unknown message")}}).then(function(e){if(e)return e;var o;switch(a.name.toLowerCase()){case s.AlgorithmNames.AesECB.toLowerCase():case s.AlgorithmNames.AesCBC.toLowerCase():case s.AlgorithmNames.AesGCM.toLowerCase():o=y.AesCrypto;break;case s.AlgorithmNames.RsaOAEP.toLowerCase():o=w.RsaCrypto;break;case s.AlgorithmNames.DesCBC.toLowerCase():case s.AlgorithmNames.DesEdeCBC.toLowerCase():o=v.DesCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"wrapKey")}return o.wrapKey(r,t,n,a)})},r.prototype.unwrapKey=function(r,t,n,o,a,i,c){var h,m,A,g=this,C=arguments;return e.prototype.unwrapKey.apply(this,C).then(function(e){if(h=u.PrepareAlgorithm(o),m=u.PrepareAlgorithm(a),A=u.PrepareData(t,"wrappedKey"),n.key){var d=void 0;switch(h.name.toLowerCase()){case s.AlgorithmNames.AesECB.toLowerCase():case s.AlgorithmNames.AesCBC.toLowerCase():case s.AlgorithmNames.AesGCM.toLowerCase():d=y.AesCrypto;break;case s.AlgorithmNames.RsaOAEP.toLowerCase():d=w.RsaCrypto;break;case s.AlgorithmNames.DesCBC.toLowerCase():case s.AlgorithmNames.DesEdeCBC.toLowerCase():d=v.DesCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"unwrapKey")}return d.unwrapKey(r,A,n,h,m,i,c)}return p.nativeSubtle.unwrapKey.apply(p.nativeSubtle,C).catch(function(e){return g.decrypt(h,n,t).then(function(e){var t;return t="jwk"===r?JSON.parse(l.buffer2string(new Uint8Array(e))):e,g.importKey(r,t,m,i,c)})}).then(function(e){if(e)return _(e,c),e}).catch(function(e){throw console.error(e),new Error("Cannot unwrap key from incoming data")})})},r.prototype.exportKey=function(r,t){var n=arguments;return e.prototype.exportKey.apply(this,n).then(function(){if(p.nativeSubtle)try{return p.nativeSubtle.exportKey.apply(p.nativeSubtle,n).catch(function(e){l.warn("WebCrypto: native 'exportKey' for "+t.algorithm.name+" doesn't work.",e&&e.message||"Unknown message")})}catch(e){l.warn("WebCrypto: native 'exportKey' for "+t.algorithm.name+" doesn't work.",e&&e.message||"Unknown message")}}).then(function(e){if(e){"jwk"===r&&e instanceof ArrayBuffer&&(e=l.buffer2string(new Uint8Array(e)),e=JSON.parse(e));var n=E(t);return n||(n=l.assign({},t.algorithm)),function(e,r,t){if(r&&l.BrowserInfo().name===l.Browser.IE){"extractable"in e&&(e.ext=e.extractable,delete e.extractable);var n=null;switch(r.name.toUpperCase()){case s.AlgorithmNames.RsaOAEP.toUpperCase():case s.AlgorithmNames.RsaPSS.toUpperCase():case s.AlgorithmNames.RsaSSA.toUpperCase():n=w.RsaCrypto;break;case s.AlgorithmNames.AesECB.toUpperCase():case s.AlgorithmNames.AesCBC.toUpperCase():case s.AlgorithmNames.AesGCM.toUpperCase():n=y.AesCrypto;break;default:throw new f.LinerError(f.LinerError.UNSUPPORTED_ALGORITHM,r.name.toUpperCase())}n&&!e.alg&&(e.alg=n.alg2jwk(r)),"key_ops"in e||(e.key_ops=t)}}(e,n,t.usages),Promise.resolve(e)}if(!t.key)throw new f.LinerError("Cannot export native CryptoKey from JS implementation");var o;switch(t.algorithm.name.toLowerCase()){case s.AlgorithmNames.AesECB.toLowerCase():case s.AlgorithmNames.AesCBC.toLowerCase():case s.AlgorithmNames.AesGCM.toLowerCase():o=y.AesCrypto;break;case s.AlgorithmNames.EcDH.toLowerCase():case s.AlgorithmNames.EcDSA.toLowerCase():o=A.EcCrypto;break;case s.AlgorithmNames.RsaSSA.toLowerCase():case s.AlgorithmNames.RsaPSS.toLowerCase():case s.AlgorithmNames.RsaOAEP.toLowerCase():o=w.RsaCrypto;break;case s.AlgorithmNames.Pbkdf2.toLowerCase():o=g.PbkdfCrypto;break;case s.AlgorithmNames.DesCBC.toLowerCase():case s.AlgorithmNames.DesEdeCBC.toLowerCase():o=v.DesCrypto;break;default:throw new f.LinerError(f.LinerError.UNSUPPORTED_ALGORITHM,t.algorithm.name.toLowerCase())}return o.exportKey(r,t)})},r.prototype.importKey=function(r,t,n,o,c){return a(this,void 0,void 0,function(){var a,h,m,C,d,b,E;return i(this,function(i){switch(i.label){case 0:return a={format:r,keyData:t,algorithm:n,extractable:o,keyUsages:c},[4,e.prototype.importKey.call(this,r,t,n,o,c)];case 1:if(i.sent(),m=u.PrepareAlgorithm(n),h=t,C=l.BrowserInfo(),"jwk"!==r||(C.name!==l.Browser.Safari||/^11/.test(C.version))&&C.name!==l.Browser.IE||(l.BrowserInfo().name===l.Browser.IE&&(t=l.assign({},t),U=t,l.BrowserInfo().name===l.Browser.IE&&("ext"in U&&(U.extractable=U.ext,delete U.ext),delete U.key_ops,delete U.alg)),a.keyData=l.string2buffer(JSON.stringify(t)).buffer),ArrayBuffer.isView(t)&&(h=u.PrepareData(t,"keyData")),P(m.name))return[2];if(!p.nativeSubtle)return[3,5];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,p.nativeSubtle.importKey.call(p.nativeSubtle,a.format,a.keyData,a.algorithm,a.extractable,a.keyUsages)];case 3:return d=i.sent(),[3,5];case 4:return b=i.sent(),l.warn("WebCrypto: native 'importKey' for "+m.name+" doesn't work.",b&&b.message||"Unknown message"),[3,5];case 5:if(d)return k(m,d),_(d,c),[2,Promise.resolve(d)];switch(m.name.toLowerCase()){case s.AlgorithmNames.AesECB.toLowerCase():case s.AlgorithmNames.AesCBC.toLowerCase():case s.AlgorithmNames.AesGCM.toLowerCase():E=y.AesCrypto;break;case s.AlgorithmNames.EcDH.toLowerCase():case s.AlgorithmNames.EdDSA.toLowerCase():case s.AlgorithmNames.EcDSA.toLowerCase():E=A.EcCrypto;break;case s.AlgorithmNames.RsaSSA.toLowerCase():case s.AlgorithmNames.RsaPSS.toLowerCase():case s.AlgorithmNames.RsaOAEP.toLowerCase():E=w.RsaCrypto;break;case s.AlgorithmNames.Pbkdf2.toLowerCase():E=g.PbkdfCrypto;break;case s.AlgorithmNames.DesCBC.toLowerCase():case s.AlgorithmNames.DesEdeCBC.toLowerCase():E=v.DesCrypto;break;default:throw new f.LinerError(f.LinerError.UNSUPPORTED_ALGORITHM,m.name.toLowerCase())}return[2,E.importKey(r,h,m,o,c)]}var U})})},r}(c.SubtleCrypto);function k(e,r){l.BrowserInfo().name!==l.Browser.IE&&l.BrowserInfo().name!==l.Browser.Edge&&l.BrowserInfo().name!==l.Browser.Safari||!/^rsa/i.test(e.name)||(r.privateKey?(C.push({hash:e.hash,key:r.privateKey}),C.push({hash:e.hash,key:r.publicKey})):C.push({hash:e.hash,key:r}))}function E(e){var r=null;return C.some(function(t){return t.key===e&&(r=l.assign({},e.algorithm,{hash:t.hash}),!0)}),r}function _(e,r){var t=[];e.privateKey?(t.push(e.privateKey),t.push(e.publicKey)):t.push(e),t.forEach(function(e){"keyUsage"in e&&(e.usages=e.keyUsage||[],e.usages.length||(["verify","encrypt","wrapKey"].forEach(function(t){r.indexOf(t)>-1&&("public"===e.type||"secret"===e.type)&&e.usages.push(t)}),["sign","decrypt","unwrapKey","deriveKey","deriveBits"].forEach(function(t){r.indexOf(t)>-1&&("private"===e.type||"secret"===e.type)&&e.usages.push(t)})))})}function P(e){var r=/AppleWebKit\/(\d+)/.exec(self.navigator.userAgent);return e.toUpperCase()===s.AlgorithmNames.RsaOAEP&&r&&parseInt(r[1],10)<604}r.SubtleCrypto=b,Uint8Array.prototype.forEach||(Uint8Array.prototype.forEach=function(e){for(var r=0;r<this.length;r++)e(this[r],r,this)}),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,r){return new Uint8Array(this.buffer.slice(e,r))}),Uint8Array.prototype.filter||(Uint8Array.prototype.filter=function(e){for(var r=[],t=0;t<this.length;t++)e(this[t],t,this)&&r.push(this[t]);return new Uint8Array(r)})},function(e,r,t){"use strict";var n,o=this&&this.__extends||(n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)});Object.defineProperty(r,"__esModule",{value:!0});var a=t(1),i=t(2),s=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.digest=function(e,r){return Promise.resolve().then(function(){if("undefined"==typeof asmCrypto)throw new i.LinerError(i.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js");switch(e.name.toUpperCase()){case a.AlgorithmNames.Sha1:return asmCrypto.SHA1.bytes(r).buffer;case a.AlgorithmNames.Sha256:return asmCrypto.SHA256.bytes(r).buffer;case a.AlgorithmNames.Sha512:return asmCrypto.SHA512.bytes(r).buffer;default:throw new i.LinerError("Not supported algorithm '"+e.name+"'")}})},r}(a.BaseCrypto);r.ShaCrypto=s},function(e,r,t){"use strict";var n,o=this&&this.__extends||(n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)});Object.defineProperty(r,"__esModule",{value:!0});var a=t(1),i=t(2),s=t(5),c=t(6),u=t(3);function p(e){var r=!0;return e.filter(function(e){return(!r||0!==e)&&(r=!1,!0)})}var h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.generateKey=function(e,r,t){var n=this;return Promise.resolve().then(function(){n.checkModule();var o=3===e.publicExponent[0]?3:65537,s=asmCrypto.RSA.generateKey(e.modulusLength,o),u=new c.CryptoKey({type:"private",algorithm:e,extractable:r,usages:[]}),p=new c.CryptoKey({type:"public",algorithm:e,extractable:!0,usages:[]});switch(u.key=p.key=s,e.name.toLowerCase()){case a.AlgorithmNames.RsaOAEP.toLowerCase():u.usages=n.filterUsages(["decrypt","unwrapKey"],t),p.usages=n.filterUsages(["encrypt","wrapKey"],t);break;case a.AlgorithmNames.RsaSSA.toLowerCase():case a.AlgorithmNames.RsaPSS.toLowerCase():u.usages=n.filterUsages(["sign"],t),p.usages=n.filterUsages(["verify"],t);break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}return{privateKey:u,publicKey:p}})},r.sign=function(e,r,t){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaSSA.toLowerCase():var n=r.algorithm,o=e,s=void 0;switch(n.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_PKCS1_v1_5_SHA1.sign;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_PKCS1_v1_5_SHA256.sign;break;case a.AlgorithmNames.Sha512:s=asmCrypto.RSA_PKCS1_v1_5_SHA512.sign;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}return s(t,r.key).buffer;case a.AlgorithmNames.RsaPSS.toLowerCase():n=r.algorithm,o=e,s=void 0;switch(n.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_PSS_SHA1.sign;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_PSS_SHA256.sign;break;case a.AlgorithmNames.Sha512:s=asmCrypto.RSA_PSS_SHA512.sign;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}return s(t,r.key,o.saltLength).buffer;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.verify=function(e,r,t,n){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaSSA.toLowerCase():var o,s=r.algorithm;switch(s.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:o=asmCrypto.RSA_PKCS1_v1_5_SHA1.verify;break;case a.AlgorithmNames.Sha256:o=asmCrypto.RSA_PKCS1_v1_5_SHA256.verify;break;case a.AlgorithmNames.Sha512:o=asmCrypto.RSA_PKCS1_v1_5_SHA512.verify;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}try{return o(t,n,r.key)}catch(e){return console.warn("Verify error: "+e.message),!1}case a.AlgorithmNames.RsaPSS.toLowerCase():var c=r.algorithm,u=e,p=void 0;switch(c.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:p=asmCrypto.RSA_PSS_SHA1.verify;break;case a.AlgorithmNames.Sha256:p=asmCrypto.RSA_PSS_SHA256.verify;break;case a.AlgorithmNames.Sha512:p=asmCrypto.RSA_PSS_SHA512.verify;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}try{return p(t,n,r.key,u.saltLength)}catch(e){return console.warn("Verify error: "+e.message),!1}default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.encrypt=function(e,r,t){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaOAEP.toLowerCase():var n=r.algorithm,o=e,s=void 0;switch(n.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_OAEP_SHA1.encrypt;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_OAEP_SHA256.encrypt;break;case a.AlgorithmNames.Sha512:s=asmCrypto.RSA_OAEP_SHA512.encrypt;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,n.name+" "+n.hash.name)}var c=void 0;return o.label&&(c=a.PrepareData(o.label,"label")),s(t,r.key,c);default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.decrypt=function(e,r,t){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaOAEP.toLowerCase():var n=r.algorithm,o=e,s=void 0;switch(n.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_OAEP_SHA1.decrypt;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_OAEP_SHA256.decrypt;break;case a.AlgorithmNames.Sha512:s=asmCrypto.RSA_OAEP_SHA512.decrypt;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,n.name+" "+n.hash.name)}var c=void 0;return o.label&&(c=a.PrepareData(o.label,"label")),s(t,r.key,c);default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.wrapKey=function(e,r,t,n){var o;return Promise.resolve().then(function(){return(o=new u.Crypto).subtle.exportKey(e,r)}).then(function(e){var r;r=e instanceof ArrayBuffer?new Uint8Array(e):s.string2buffer(JSON.stringify(e));var a=t.copy(["encrypt"]);return o.subtle.encrypt(n,a,r)})},r.unwrapKey=function(e,r,t,n,o,a,i){var c;return Promise.resolve().then(function(){c=new u.Crypto;var e=t.copy(["decrypt"]);return c.subtle.decrypt(n,e,r)}).then(function(r){var t;return t="jwk"===e.toLowerCase()?JSON.parse(s.buffer2string(new Uint8Array(r))):new Uint8Array(r),c.subtle.importKey(e,t,o,a,i)})},r.alg2jwk=function(e){var r=e.hash,t=/(\d+)/.exec(r.name)[1];switch(e.name.toUpperCase()){case a.AlgorithmNames.RsaOAEP.toUpperCase():return"RSA-OAEP"+("1"===t?"":"-"+t);case a.AlgorithmNames.RsaPSS.toUpperCase():return"PS"+t;case a.AlgorithmNames.RsaSSA.toUpperCase():return"RS"+t;default:throw new a.AlgorithmError(a.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}},r.jwk2alg=function(e){throw new Error("Not implemented")},r.exportKey=function(e,r){var t=this;return Promise.resolve().then(function(){if("jwk"===e.toLowerCase()){var n={kty:"RSA",ext:!0,key_ops:r.usages};return n.alg=t.alg2jwk(r.algorithm),n.n=a.Base64Url.encode(p(r.key[0])),n.e=a.Base64Url.encode(p(r.key[1])),"private"===r.type&&(n.d=a.Base64Url.encode(p(r.key[2])),n.p=a.Base64Url.encode(p(r.key[3])),n.q=a.Base64Url.encode(p(r.key[4])),n.dp=a.Base64Url.encode(p(r.key[5])),n.dq=a.Base64Url.encode(p(r.key[6])),n.qi=a.Base64Url.encode(p(r.key[7]))),n}throw new i.LinerError(i.LinerError.NOT_SUPPORTED)})},r.importKey=function(e,r,t,n,o){return Promise.resolve().then(function(){var s,u=new c.CryptoKey({algorithm:t,extractable:n,usages:o});if(u.key=[],"jwk"===e.toLowerCase())return s=r,u.key[0]=a.Base64Url.decode(s.n),u.key[1]=3===a.Base64Url.decode(s.e)[0]?new Uint8Array([0,0,0,3]):new Uint8Array([0,1,0,1]),s.d?(u.type="private",u.key[2]=a.Base64Url.decode(s.d),u.key[3]=a.Base64Url.decode(s.p),u.key[4]=a.Base64Url.decode(s.q),u.key[5]=a.Base64Url.decode(s.dp),u.key[6]=a.Base64Url.decode(s.dq),u.key[7]=a.Base64Url.decode(s.qi)):u.type="public",u;throw new i.LinerError(i.LinerError.NOT_SUPPORTED)})},r.checkModule=function(){if("undefined"==typeof asmCrypto)throw new i.LinerError(i.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js")},r.filterUsages=function(e,r){return e.filter(function(e){return!!r.filter(function(r){return e===r}).length})},r}(a.BaseCrypto);r.RsaCrypto=h},function(e,r,t){"use strict";var n,o=this&&this.__extends||(n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}),a=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new t(function(r){r(e.value)}).then(i,s)}c((n=n.apply(e,r||[])).next())})},i=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(r,"__esModule",{value:!0});var s=t(1),c=t(2),u=t(6),p=t(5),h=t(3);function f(e){for(var r=new Uint8Array(e),t=[],n=0;n<r.length;n++)t.push(r[n]);return t}function l(e,r){e.length%2&&(e="0"+e);for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n++){var o=e.slice(n,++n+1);t[(n-1)/2]=parseInt(o,16)}if(r){var a=t.length;a=a>32?a>48?66:48:32,t.length<a&&(t=p.concat(new Uint8Array(a-t.length),t))}return t}function y(e,r){for(var t="",n=0;n<e.length;n++){var o=e[n].toString(16);t+=o.length%2?"0"+o:o}if(r){var a=e.length;a=a>32?a>48?66:48:32,t.length/2<a&&(t=new Array(2*a-t.length+1).join("0")+t)}return t}var m=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.generateKey=function(e,r,t){var n=this;return Promise.resolve().then(function(){n.checkModule();var t=new elliptic.ec(n.getNamedCurve(e.namedCurve)),o=new u.CryptoKey({type:"private",algorithm:e,extractable:r,usages:[]}),a=new u.CryptoKey({type:"public",algorithm:e,extractable:!0,usages:[]});return o.key=a.key=t.genKeyPair(),e.name===s.AlgorithmNames.EcDSA?(o.usages=["sign"],a.usages=["verify"]):e.name===s.AlgorithmNames.EcDH?(o.usages=["deriveKey","deriveBits"],a.usages=[]):e.name===s.AlgorithmNames.EdDSA&&(o.usages=["sign"],a.usages=["verify"]),{privateKey:o,publicKey:a}})},r.sign=function(e,r,t){return a(this,void 0,void 0,function(){var n,o,a,c,u;return i(this,function(i){switch(i.label){case 0:return n=e,o=new h.Crypto,e.name.toUpperCase()!==s.AlgorithmNames.EdDSA?[3,2]:(a=t,[4,r.key.sign(a).toBytes()]);case 1:return[2,i.sent()];case 2:return[4,o.subtle.digest(n.hash,t)];case 3:return c=i.sent(),a=f(c),[4,r.key.sign(a)];case 4:return u=i.sent(),[2,l(y(u.r.toArray(),!0)+y(u.s.toArray(),!0)).buffer]}})})},r.verify=function(e,r,t,n){return a(this,void 0,void 0,function(){var o,a,c,u;return i(this,function(i){switch(i.label){case 0:return o=e,e.name.toUpperCase()!==s.AlgorithmNames.EdDSA?[3,1]:(c=f(t),a=n.buffer,[3,3]);case 1:return c={r:t.slice(0,t.byteLength/2),s:t.slice(t.byteLength/2)},[4,(new h.Crypto).subtle.digest(o.hash,n)];case 2:a=i.sent(),i.label=3;case 3:return u=f(a),[2,r.key.verify(u,c)]}})})},r.deriveKey=function(e,r,t,n,o){var a=this;return Promise.resolve().then(function(){return a.deriveBits(e,r,t.length)}).then(function(e){return(new h.Crypto).subtle.importKey("raw",new Uint8Array(e),t,n,o)})},r.deriveBits=function(e,r,t){return Promise.resolve().then(function(){Promise.resolve(null);var n=r.key.derive(e.public.key.getPublic()),o=new Uint8Array(n.toArray()),a=o.length;return a=a>32?a>48?66:48:32,o.length<a&&(o=p.concat(new Uint8Array(a-o.length),o)),o.slice(0,t/8).buffer})},r.exportKey=function(e,r){return Promise.resolve().then(function(){var t=r.key;if("jwk"===e.toLowerCase()){var n=t.getPublic("hex").slice(2),o=n.slice(0,n.length/2),a=n.slice(n.length/2,n.length);return"public"===r.type?{crv:r.algorithm.namedCurve,ext:r.extractable,x:s.Base64Url.encode(l(o,!0)),y:s.Base64Url.encode(l(a,!0)),key_ops:r.usages,kty:"EC"}:{crv:r.algorithm.namedCurve,ext:r.extractable,d:s.Base64Url.encode(l(t.getPrivate("hex"),!0)),x:s.Base64Url.encode(l(o,!0)),y:s.Base64Url.encode(l(a,!0)),key_ops:r.usages,kty:"EC"}}throw new c.LinerError("Format '"+e+"' is not implemented")})},r.importKey=function(e,r,t,n,o){var a=this;return Promise.resolve().then(function(){var i=new u.CryptoKey({algorithm:t,extractable:n,usages:o});if("jwk"!==e.toLowerCase())throw new c.LinerError("Format '"+e+"' is not implemented");var h=a.getNamedCurve(t.namedCurve);console.log(h);var f=void 0;if(f="eddsa"===t.name.toLowerCase()?new elliptic.eddsa(h):new elliptic.ec(h),r.d)"eddsa"===t.name.toLowerCase()?i.key=f.keyFromSecret(s.Base64Url.decode(r.d)):i.key=f.keyFromPrivate(s.Base64Url.decode(r.d)),i.type="private";else{var l=y("ed25519"===h||"curve25519"===h?s.Base64Url.decode(r.x):p.concat(new Uint8Array([4]),s.Base64Url.decode(r.x),s.Base64Url.decode(r.y)));i.key=f.keyFromPublic(l,"hex"),i.type="public"}return i})},r.checkModule=function(){if("undefined"==typeof elliptic)throw new c.LinerError(c.LinerError.MODULE_NOT_FOUND,"elliptic","https://github.com/indutny/elliptic")},r.getNamedCurve=function(e){var r=e.toUpperCase();return["P-256","P-384","P-521","ED25519"].indexOf(r)>-1?r.replace("-","").toLowerCase():"K-256"===r?"secp256k1":"curve25519"},r}(s.BaseCrypto);r.EcCrypto=m},function(e,r,t){"use strict";var n,o=this&&this.__extends||(n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}),a=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new t(function(r){r(e.value)}).then(i,s)}c((n=n.apply(e,r||[])).next())})},i=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(r,"__esModule",{value:!0});var s=t(1),c=t(2),u=t(6),p=t(10),h=t(11),f=t(3),l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.importKey=function(e,r,t,n,o){return a(this,void 0,void 0,function(){var a;return i(this,function(i){if(a=new u.CryptoKey({algorithm:t,extractable:n,type:"secret",usages:o}),!e||"raw"!==e.toLowerCase())throw new c.LinerError("format: Is not 'raw'");return a.key=s.PrepareData(r,"keyData"),[2,a]})})},r.exportKey=function(e,r){return a(this,void 0,void 0,function(){return i(this,function(t){if(e&&"raw"===e.toLowerCase())return[2,r.key.buffer];throw new c.LinerError("format: Is not 'raw'")})})},r.deriveBits=function(e,r,t){return a(this,void 0,void 0,function(){var n,o,a;return i(this,function(i){switch(o=s.PrepareData(e.salt,"salt"),a=s.PrepareData(r.key,"key"),e.hash.name.toUpperCase()){case"SHA-1":n=asmCrypto.PBKDF2_HMAC_SHA1.bytes(a,o,e.iterations,t>>3);break;case"SHA-256":n=asmCrypto.PBKDF2_HMAC_SHA256.bytes(a,o,e.iterations,t>>3);break;default:throw new c.LinerError("algorithm.hash: '"+e.hash.name+"' hash algorithm is not supported")}return[2,n.buffer]})})},r.deriveKey=function(e,r,t,n,o){return a(this,void 0,void 0,function(){var a,u;return i(this,function(i){switch(i.label){case 0:return[4,(new f.Crypto).subtle.deriveBits(e,r,t.length)];case 1:switch(a=i.sent(),t.name.toLowerCase()){case s.AlgorithmNames.AesECB.toLowerCase():case s.AlgorithmNames.AesCBC.toLowerCase():case s.AlgorithmNames.AesGCM.toLowerCase():u=p.AesCrypto;break;case s.AlgorithmNames.DesCBC.toLowerCase():case s.AlgorithmNames.DesEdeCBC.toLowerCase():u=h.DesCrypto;break;default:throw new c.LinerError("derivedKeyType.name: '"+t.name+"' algorithm is not supported")}return[4,u.importKey("raw",a,t,n,o)];case 2:return[2,i.sent()]}})})},r.checkModule=function(){if("undefined"==typeof asmCrypto)throw new c.LinerError(c.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js")},r}(s.BaseCrypto);r.PbkdfCrypto=l},function(e,r,t){"use strict";r.readUInt32BE=function(e,r){return(e[0+r]<<24|e[1+r]<<16|e[2+r]<<8|e[3+r])>>>0},r.writeUInt32BE=function(e,r,t){e[0+t]=r>>>24,e[1+t]=r>>>16&255,e[2+t]=r>>>8&255,e[3+t]=255&r},r.ip=function(e,r,t,n){for(var o=0,a=0,i=6;i>=0;i-=2){for(var s=0;s<=24;s+=8)o<<=1,o|=r>>>s+i&1;for(s=0;s<=24;s+=8)o<<=1,o|=e>>>s+i&1}for(i=6;i>=0;i-=2){for(s=1;s<=25;s+=8)a<<=1,a|=r>>>s+i&1;for(s=1;s<=25;s+=8)a<<=1,a|=e>>>s+i&1}t[n+0]=o>>>0,t[n+1]=a>>>0},r.rip=function(e,r,t,n){for(var o=0,a=0,i=0;i<4;i++)for(var s=24;s>=0;s-=8)o<<=1,o|=r>>>s+i&1,o<<=1,o|=e>>>s+i&1;for(i=4;i<8;i++)for(s=24;s>=0;s-=8)a<<=1,a|=r>>>s+i&1,a<<=1,a|=e>>>s+i&1;t[n+0]=o>>>0,t[n+1]=a>>>0},r.pc1=function(e,r,t,n){for(var o=0,a=0,i=7;i>=5;i--){for(var s=0;s<=24;s+=8)o<<=1,o|=r>>s+i&1;for(s=0;s<=24;s+=8)o<<=1,o|=e>>s+i&1}for(s=0;s<=24;s+=8)o<<=1,o|=r>>s+i&1;for(i=1;i<=3;i++){for(s=0;s<=24;s+=8)a<<=1,a|=r>>s+i&1;for(s=0;s<=24;s+=8)a<<=1,a|=e>>s+i&1}for(s=0;s<=24;s+=8)a<<=1,a|=e>>s+i&1;t[n+0]=o>>>0,t[n+1]=a>>>0},r.r28shl=function(e,r){return e<<r&268435455|e>>>28-r};var n=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];r.pc2=function(e,r,t,o){for(var a=0,i=0,s=n.length>>>1,c=0;c<s;c++)a<<=1,a|=e>>>n[c]&1;for(c=s;c<n.length;c++)i<<=1,i|=r>>>n[c]&1;t[o+0]=a>>>0,t[o+1]=i>>>0},r.expand=function(e,r,t){var n=0,o=0;n=(1&e)<<5|e>>>27;for(var a=23;a>=15;a-=4)n<<=6,n|=e>>>a&63;for(a=11;a>=3;a-=4)o|=e>>>a&63,o<<=6;o|=(31&e)<<1|e>>>31,r[t+0]=n>>>0,r[t+1]=o>>>0};var o=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];r.substitute=function(e,r){for(var t=0,n=0;n<4;n++){t<<=4,t|=o[64*n+(e>>>18-6*n&63)]}for(n=0;n<4;n++){t<<=4,t|=o[256+64*n+(r>>>18-6*n&63)]}return t>>>0};var a=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];r.permute=function(e){for(var r=0,t=0;t<a.length;t++)r<<=1,r|=e>>>a[t]&1;return r>>>0},r.padSplit=function(e,r,t){for(var n=e.toString(2);n.length<r;)n="0"+n;for(var o=[],a=0;a<r;a+=t)o.push(n.slice(a,a+t));return o.join(" ")}},function(e,r,t){"use strict";var n=t(7);function o(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}e.exports=o,o.prototype._init=function(){},o.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},o.prototype._buffer=function(e,r){for(var t=Math.min(this.buffer.length-this.bufferOff,e.length-r),n=0;n<t;n++)this.buffer[this.bufferOff+n]=e[r+n];return this.bufferOff+=t,t},o.prototype._flushBuffer=function(e,r){return this._update(this.buffer,0,e,r),this.bufferOff=0,this.blockSize},o.prototype._updateEncrypt=function(e){var r=0,t=0,n=(this.bufferOff+e.length)/this.blockSize|0,o=new Array(n*this.blockSize);0!==this.bufferOff&&(r+=this._buffer(e,r),this.bufferOff===this.buffer.length&&(t+=this._flushBuffer(o,t)));for(var a=e.length-(e.length-r)%this.blockSize;r<a;r+=this.blockSize)this._update(e,r,o,t),t+=this.blockSize;for(;r<e.length;r++,this.bufferOff++)this.buffer[this.bufferOff]=e[r];return o},o.prototype._updateDecrypt=function(e){for(var r=0,t=0,n=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,o=new Array(n*this.blockSize);n>0;n--)r+=this._buffer(e,r),t+=this._flushBuffer(o,t);return r+=this._buffer(e,r),o},o.prototype.final=function(e){var r,t;return e&&(r=this.update(e)),t="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),r?r.concat(t):t},o.prototype._pad=function(e,r){if(0===r)return!1;for(;r<e.length;)e[r++]=0;return!0},o.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},o.prototype._unpad=function(e){return e},o.prototype._finalDecrypt=function(){n.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},function(e,r,t){"use strict";var n=t(7),o=t(9),a=t(8),i=a.utils,s=a.Cipher;function c(){this.tmp=new Array(2),this.keys=null}function u(e){s.call(this,e);var r=new c;this._desState=r,this.deriveKeys(r,e.key)}o(u,s),e.exports=u,u.create=function(e){return new u(e)};var p=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(e,r){e.keys=new Array(32),n.equal(r.length,this.blockSize,"Invalid key length");var t=i.readUInt32BE(r,0),o=i.readUInt32BE(r,4);i.pc1(t,o,e.tmp,0),t=e.tmp[0],o=e.tmp[1];for(var a=0;a<e.keys.length;a+=2){var s=p[a>>>1];t=i.r28shl(t,s),o=i.r28shl(o,s),i.pc2(t,o,e.keys,a)}},u.prototype._update=function(e,r,t,n){var o=this._desState,a=i.readUInt32BE(e,r),s=i.readUInt32BE(e,r+4);i.ip(a,s,o.tmp,0),a=o.tmp[0],s=o.tmp[1],"encrypt"===this.type?this._encrypt(o,a,s,o.tmp,0):this._decrypt(o,a,s,o.tmp,0),a=o.tmp[0],s=o.tmp[1],i.writeUInt32BE(t,a,n),i.writeUInt32BE(t,s,n+4)},u.prototype._pad=function(e,r){for(var t=e.length-r,n=r;n<e.length;n++)e[n]=t;return!0},u.prototype._unpad=function(e){for(var r=e[e.length-1],t=e.length-r;t<e.length;t++)n.equal(e[t],r);return e.slice(0,e.length-r)},u.prototype._encrypt=function(e,r,t,n,o){for(var a=r,s=t,c=0;c<e.keys.length;c+=2){var u=e.keys[c],p=e.keys[c+1];i.expand(s,e.tmp,0),u^=e.tmp[0],p^=e.tmp[1];var h=i.substitute(u,p),f=s;s=(a^i.permute(h))>>>0,a=f}i.rip(s,a,n,o)},u.prototype._decrypt=function(e,r,t,n,o){for(var a=t,s=r,c=e.keys.length-2;c>=0;c-=2){var u=e.keys[c],p=e.keys[c+1];i.expand(a,e.tmp,0),u^=e.tmp[0],p^=e.tmp[1];var h=i.substitute(u,p),f=a;a=(s^i.permute(h))>>>0,s=f}i.rip(a,s,n,o)}},function(e,r,t){"use strict";var n=t(7),o=t(9),a={};function i(e){n.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var r=0;r<this.iv.length;r++)this.iv[r]=e[r]}r.instantiate=function(e){function r(r){e.call(this,r),this._cbcInit()}o(r,e);for(var t=Object.keys(a),n=0;n<t.length;n++){var i=t[n];r.prototype[i]=a[i]}return r.create=function(e){return new r(e)},r},a._cbcInit=function(){var e=new i(this.options.iv);this._cbcState=e},a._update=function(e,r,t,n){var o=this._cbcState,a=this.constructor.super_.prototype,i=o.iv;if("encrypt"===this.type){for(var s=0;s<this.blockSize;s++)i[s]^=e[r+s];a._update.call(this,i,0,t,n);for(s=0;s<this.blockSize;s++)i[s]=t[n+s]}else{a._update.call(this,e,r,t,n);for(s=0;s<this.blockSize;s++)t[n+s]^=i[s];for(s=0;s<this.blockSize;s++)i[s]=e[r+s]}}},function(e,r,t){"use strict";var n=t(7),o=t(9),a=t(8),i=a.Cipher,s=a.DES;function c(e,r){n.equal(r.length,24,"Invalid key length");var t=r.slice(0,8),o=r.slice(8,16),a=r.slice(16,24);this.ciphers="encrypt"===e?[s.create({type:"encrypt",key:t}),s.create({type:"decrypt",key:o}),s.create({type:"encrypt",key:a})]:[s.create({type:"decrypt",key:a}),s.create({type:"encrypt",key:o}),s.create({type:"decrypt",key:t})]}function u(e){i.call(this,e);var r=new c(this.type,this.options.key);this._edeState=r}o(u,i),e.exports=u,u.create=function(e){return new u(e)},u.prototype._update=function(e,r,t,n){var o=this._edeState;o.ciphers[0]._update(e,r,t,n),o.ciphers[1]._update(t,n,t,n),o.ciphers[2]._update(t,n,t,n)},u.prototype._pad=s.prototype._pad,u.prototype._unpad=s.prototype._unpad},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(12),o=self;n.nativeCrypto&&Object.freeze(n.nativeCrypto.getRandomValues),delete self.crypto,o.crypto=new n.Crypto,Object.freeze(o.crypto),r.crypto=o.crypto}]);
